import{_ as ke,a as Ve,b as De,c as Ie,d as Te,u as E,f as Ue,g as Ne,h as Pe,i as me,j as Q,k as Me,l as Re,m as ze,n as Fe,o as Le,p as je,q as We,r as Be,F as fe,e as Ee,s as K}from"./Checkbox.vue_vue_type_script_setup_true_lang-lNn7Xvff.js";import{e as M,r as L,o as p,c as $,d as r,t as T,a as t,k as o,u as a,F as W,v as B,s as C,b as u,x as oe,B as X,i as D,V as Ye,l as y,W as q,m as N,y as Ae,z as He,X as ee,A as Xe,n as H,g as _e,C as j,D as O,G as P,H as ie,I as re,J as de,_ as V,S as Z,K as ae,L as se,M as ne,N as ge,O as he,P as ve,R as le,Q as we,U as be,T as ce,Y as U,E as Oe,a1 as qe,a2 as Ge,Z as Ke,$ as Ze,a0 as Je}from"../main.js";import{_ as z}from"./Input.vue_vue_type_script_setup_true_lang-KN76Eu9U.js";import{z as R}from"./index-dIKOytT1.js";import{r as Qe,b as et,f as tt}from"./index-C4e3GkC8.js";import{_ as ue}from"./DialogScrollContent.vue_vue_type_script_setup_true_lang-CfLKKdbO.js";import{_ as pe}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUbi7heN.js";import{_ as at}from"./lodash-BtnTHUG3.js";import{_ as ye}from"./Textarea.vue_vue_type_script_setup_true_lang-kLss_npW.js";import{_ as st}from"./index-DhdF1qMN.js";import{_ as nt}from"./index-B4u4F0fw.js";import{_ as lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";var xe=6e4,$e=36e5;function ot(n,e){var s;Qe(1,arguments);var l=et((s=e==null?void 0:e.additionalDigits)!==null&&s!==void 0?s:2);if(l!==2&&l!==1&&l!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var i=ct(n),d;if(i.date){var v=ut(i.date,l);d=pt(v.restDateString,v.year)}if(!d||isNaN(d.getTime()))return new Date(NaN);var x=d.getTime(),w=0,h;if(i.time&&(w=mt(i.time),isNaN(w)))return new Date(NaN);if(i.timezone){if(h=ft(i.timezone),isNaN(h))return new Date(NaN)}else{var c=new Date(x+w),b=new Date(0);return b.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),b.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),b}return new Date(x+w+h)}var G={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},it=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,rt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,dt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ct(n){var e={},s=n.split(G.dateTimeDelimiter),l;if(s.length>2)return e;if(/:/.test(s[0])?l=s[0]:(e.date=s[0],l=s[1],G.timeZoneDelimiter.test(e.date)&&(e.date=n.split(G.timeZoneDelimiter)[0],l=n.substr(e.date.length,n.length))),l){var i=G.timezone.exec(l);i?(e.time=l.replace(i[1],""),e.timezone=i[1]):e.time=l}return e}function ut(n,e){var s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),l=n.match(s);if(!l)return{year:NaN,restDateString:""};var i=l[1]?parseInt(l[1]):null,d=l[2]?parseInt(l[2]):null;return{year:d===null?i:d*100,restDateString:n.slice((l[1]||l[2]).length)}}function pt(n,e){if(e===null)return new Date(NaN);var s=n.match(it);if(!s)return new Date(NaN);var l=!!s[4],i=Y(s[1]),d=Y(s[2])-1,v=Y(s[3]),x=Y(s[4]),w=Y(s[5])-1;if(l)return wt(e,x,w)?_t(e,x,w):new Date(NaN);var h=new Date(0);return!ht(e,d,v)||!vt(e,i)?new Date(NaN):(h.setUTCFullYear(e,d,Math.max(i,v)),h)}function Y(n){return n?parseInt(n):1}function mt(n){var e=n.match(rt);if(!e)return NaN;var s=te(e[1]),l=te(e[2]),i=te(e[3]);return bt(s,l,i)?s*$e+l*xe+i*1e3:NaN}function te(n){return n&&parseFloat(n.replace(",","."))||0}function ft(n){if(n==="Z")return 0;var e=n.match(dt);if(!e)return 0;var s=e[1]==="+"?-1:1,l=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return yt(l,i)?s*(l*$e+i*xe):NaN}function _t(n,e,s){var l=new Date(0);l.setUTCFullYear(n,0,4);var i=l.getUTCDay()||7,d=(e-1)*7+s+1-i;return l.setUTCDate(l.getUTCDate()+d),l}var gt=[31,null,31,30,31,30,31,31,30,31,30,31];function Se(n){return n%400===0||n%4===0&&n%100!==0}function ht(n,e,s){return e>=0&&e<=11&&s>=1&&s<=(gt[e]||(Se(n)?29:28))}function vt(n,e){return e>=1&&e<=(Se(n)?366:365)}function wt(n,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function bt(n,e,s){return n===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&n>=0&&n<25}function yt(n,e){return e>=0&&e<=59}const xt={class:"flex items-center justify-between px-2 pb-10"},$t={class:"flex-1 text-sm text-muted-foreground"},St={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Ct={class:"flex items-center space-x-2"},kt=r("p",{class:"text-sm font-medium"},"Rows per page",-1),Vt={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Dt={class:"flex items-center space-x-2"},It=r("span",{class:"sr-only"},"Go to first page",-1),Tt=r("span",{class:"sr-only"},"Go to previous page",-1),Ut=r("span",{class:"sr-only"},"Go to next page",-1),Nt=r("span",{class:"sr-only"},"Go to last page",-1),Pt=M({__name:"DataTablePagination",props:{table:{}},setup(n){return(e,s)=>{const l=L("VIcon");return p(),$("div",xt,[r("div",$t,T(e.table.getFilteredSelectedRowModel().rows.length)+" of "+T(e.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),r("div",St,[r("div",Ct,[kt,t(a(Ie),{"model-value":`${e.table.getState().pagination.pageSize}`,"onUpdate:modelValue":e.table.setPageSize},{default:o(()=>[t(a(ke),{class:"h-8 w-[70px]"},{default:o(()=>[t(a(Ve),{placeholder:`${e.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),t(a(De),{side:"top"},{default:o(()=>[(p(),$(W,null,B([10,20,30,40,50],i=>t(a(Te),{key:i,value:`${i}`},{default:o(()=>[u(T(i),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),r("div",Vt," Page "+T(e.table.getState().pagination.pageIndex+1)+" of "+T(e.table.getPageCount()),1),r("div",Dt,[t(a(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!e.table.getCanPreviousPage(),onClick:s[0]||(s[0]=i=>e.table.setPageIndex(0))},{default:o(()=>[It,t(l,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(a(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!e.table.getCanPreviousPage(),onClick:s[1]||(s[1]=i=>e.table.previousPage())},{default:o(()=>[Tt,t(l,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(a(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!e.table.getCanNextPage(),onClick:s[2]||(s[2]=i=>e.table.nextPage())},{default:o(()=>[Ut,t(l,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(a(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!e.table.getCanNextPage(),onClick:s[3]||(s[3]=i=>e.table.setPageIndex(e.table.getPageCount()-1))},{default:o(()=>[Nt,t(l,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),Mt={class:"flex items-center justify-between"},Rt={class:"flex flex-1 items-center space-x-2"},zt=M({__name:"DataTableToolbar",props:{table:{}},setup(n){const e=n;return oe(()=>e.table.getState().columnFilters.length>0),(s,l)=>{var i;return p(),$("div",Mt,[r("div",Rt,[t(a(z),{placeholder:"Search...","model-value":((i=s.table.getColumn("verified_name"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:l[0]||(l[0]=d=>s.table.setGlobalFilter(d.target.value))},null,8,["model-value"])])])}}}),Ft={class:"space-y-4 text-muted-foreground"},Lt={class:"rounded-md border"},jt=M({__name:"DataTable",props:{columns:{},data:{}},setup(n){const e=X("phoneStore",E("phone")),s=n,l=D([]),i=D([]),d=D({}),v=D({pageIndex:e.page_index,pageSize:e.page_size}),x=D();function w(c,b){let S;typeof c=="function"?S=c(b.value):S=c,b.value=S,e.set_page_index(S.pageIndex),e.set_page_size(S.pageSize)}const h=Ue({get data(){return s.data},get columns(){return s.columns},state:{get sorting(){return l.value},get columnFilters(){return i.value},get columnVisibility(){return d.value},get rowSelection(){return x.value},get pagination(){return v.value}},enableRowSelection:!0,onSortingChange:c=>q(c,l),onPaginationChange:c=>w(c,v),onColumnFiltersChange:c=>q(c,i),onColumnVisibilityChange:c=>q(c,d),onRowSelectionChange:c=>q(c,x),getCoreRowModel:Re(),getFilteredRowModel:ze(),getPaginationRowModel:Fe(),getSortedRowModel:Le(),getFacetedRowModel:je(),getFacetedUniqueValues:We()});return Ye(()=>{h.setPageIndex(e.page_index),h.setPageSize(e.page_size)}),(c,b)=>(p(),$("div",Ft,[t(zt,{table:a(h)},null,8,["table"]),r("div",Lt,[t(a(Me),null,{default:o(()=>[t(a(Ne),null,{default:o(()=>[(p(!0),$(W,null,B(a(h).getHeaderGroups(),S=>(p(),y(a(Q),{key:S.id},{default:o(()=>[(p(!0),$(W,null,B(S.headers,I=>(p(),y(a(Be),{key:I.id},{default:o(()=>[I.isPlaceholder?N("",!0):(p(),y(a(fe),{key:0,render:I.column.columnDef.header,props:I.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(a(Pe),null,{default:o(()=>{var S;return[(S=a(h).getRowModel().rows)!=null&&S.length?(p(!0),$(W,{key:0},B(a(h).getRowModel().rows,I=>(p(),y(a(Q),{key:I.id,"data-state":I.getIsSelected()&&"selected"},{default:o(()=>[(p(!0),$(W,null,B(I.getVisibleCells(),F=>(p(),y(a(me),{key:F.id},{default:o(()=>[t(a(fe),{render:F.column.columnDef.cell,props:F.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(p(),y(a(Q),{key:1},{default:o(()=>[t(a(me),{colspan:c.columns.length,class:"h-24 text-center"},{default:o(()=>[u(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),t(Pt,{table:a(h)},null,8,["table"])]))}}),A=M({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(n){return(e,s)=>{const l=L("VIcon");return e.column.getCanSort()?(p(),$("div",{key:0,class:H(a(_e)("flex items-center space-x-2",e.$attrs.class??""))},[t(a(Xe),null,{default:o(()=>[t(a(Ae),{"as-child":""},{default:o(()=>[t(a(C),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[r("span",null,T(e.title),1),e.column.getIsSorted()==="desc"?(p(),y(l,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):e.column.getIsSorted()==="asc"?(p(),y(l,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(p(),y(l,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),t(a(He),{align:"start"},{default:o(()=>[t(a(ee),{onClick:s[0]||(s[0]=i=>e.column.toggleSorting(!1))},{default:o(()=>[t(l,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Asc ")]),_:1}),t(a(ee),{onClick:s[1]||(s[1]=i=>e.column.toggleSorting(!0))},{default:o(()=>[t(l,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Desc ")]),_:1}),t(a(Ee)),t(a(ee),{onClick:s[2]||(s[2]=i=>e.column.toggleVisibility(!1))},{default:o(()=>[t(l,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(p(),$("div",{key:1,class:H(e.$attrs.class)},T(e.title),3))}}}),Wt=R.object({id:R.number(),phone_number_id:R.string(),verified_name:R.string(),quality_rating:R.string(),platform_type:R.string(),last_onboarded_time:R.preprocess(n=>{if(typeof n=="string")try{return ot(n)}catch{return new Date(n)}return n},R.date()),display_phone_number:R.string(),is_default_phone:R.boolean()}),Bt=M({__name:"DataTableSetDefaultPhone",props:{row:{}},setup(n){const e=X("tableStore",E("phone")),l=j({id:n.row.id}),i=D(!1),{toast:d}=O(),v=async()=>{i.value=!0;try{const w=await P.post("/api/setup/phone/setdefault",{...l});await e.refresh(e.page_index),d({title:w.data.message,variant:"success"})}catch(w){var x=w.response.data.message||"";d({title:"Whoops, something went wrong",description:x,variant:"destructive"})}finally{i.value=!1}};return(x,w)=>{const h=L("VIcon");return p(),$("div",null,[t(a(C),{variant:"default",size:"sm",class:"p-2 px-3",onClick:v,disabled:i.value},{default:o(()=>[i.value?(p(),y(h,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):N("",!0),u(" Set Default ")]),_:1},8,["disabled"])])}}}),Et={class:"grid gap-4 py-4"},Yt={class:"flex justify-center"},At=["src"],Ht={class:"grid grid-cols-4 items-center"},Xt={class:"col-span-3"},Ot=r("p",{class:"col-start-2 col-span-3 text-sm text-gray-500 dark:text-gray-300"},[u(" Recommended Type: 640px x 640px "),r("b",null,"JPG/JPEG"),u(" (MAX. 5MB) ")],-1),qt={class:"grid grid-cols-4 items-center gap-4"},Gt={class:"grid grid-cols-4 items-center gap-4"},Kt={class:"grid grid-cols-4 items-center gap-4"},Zt={class:"grid grid-cols-4 items-center gap-4"},Jt={class:"grid grid-cols-4 items-center gap-4"},Qt={class:"flex gap-2 col-span-3"},ea={class:"grid grid-cols-4 items-center gap-4"},ta={class:"col-span-3"},aa={key:0,class:"grid grid-cols-4 items-center gap-4"},sa=M({__name:"DataTableUpdateWhatsappProfile",props:{row:{}},setup(n){X("phoneStore",E("phone"));const s=j({phone_number_id:n.row.phone_number_id,image_url:"",about:"",address:"",description:"",email:"",vertical:"",website1:"",website2:"",new_image:null}),l=j({is_loading:!1,is_open:!1,data:[{value:"",label:""}]});async function i(){l.is_loading=!0;try{var k="/api/setup/whatsapp_business/category/list";const f=await P.get(k,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});l.data=f.data.Result}catch(f){var m=f.response.data.message||"";w({title:"Whoops, something went wrong",description:m,variant:"destructive"})}finally{l.is_loading=!1}}const d=D(!1),v=D(!1),x=D(null),{toast:w}=O();async function h(){try{const m=await P.get(`/api/setup/whatsapp-profile/${s.phone_number_id}`);console.log(m.data.Result),Object.assign(s,m.data.Result)}catch(m){var k=m.response.data.message||"";w({title:"Whoops, something went wrong",description:k,variant:"destructive"})}finally{d.value=!1}}const c=oe(()=>s.new_image?URL.createObjectURL(s.new_image):s.image_url);async function b(){d.value=!0;try{const k=await P.patch(`/api/setup/whatsapp-profile/${s.phone_number_id}`,{...s},{headers:{"Content-Type":"multipart/form-data"}});S(),w({title:k.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}function S(){v.value=!v.value,v.value&&(h(),i())}function I(k){s.vertical=k.id,l.is_open=!1}const F=k=>{var f;const m=k.target;if((f=m.files)!=null&&f.length){const _=m.files[0];if(_.size>5*1024*1024){w({title:"The file size must be under 5MB",variant:"destructive"}),m.value="";return}s.new_image=_}};return(k,m)=>{const f=L("VIcon");return p(),$("div",null,[r("div",null,[t(a(C),{variant:"default",size:"sm",class:"p-2 px-3",onClick:S},{default:o(()=>[u(" Profile ")]),_:1})]),t(a(ce),{open:v.value,"onUpdate:open":m[7]||(m[7]=_=>v.value=_)},{default:o(()=>[t(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(a(ie),null,{default:o(()=>[t(a(re),null,{default:o(()=>[u("Whatsapp Profile")]),_:1}),t(a(de),null,{default:o(()=>[u(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),r("div",Et,[r("div",Yt,[r("img",{id:"picture",src:c.value,class:"mx-auto size-48 mb-4 h-full"},null,8,At)]),r("div",Ht,[t(a(V),{for:"profile_picture",class:"mr-4 text-right"},{default:o(()=>[u(" Profile Picture ")]),_:1}),r("div",Xt,[t(a(z),{id:"profile_picture",type:"file",onChange:F,class:"col-span-3"})]),Ot]),t(Z),r("div",qt,[t(a(V),{for:"about",class:"text-right"},{default:o(()=>[u(" About ")]),_:1}),t(a(z),{id:"about",modelValue:s.about,"onUpdate:modelValue":m[0]||(m[0]=_=>s.about=_),placeholder:"Lot 1919, Taman Bandar Puteri, 5000 Selangor.",class:"col-span-3"},null,8,["modelValue"])]),r("div",Gt,[t(a(V),{for:"address",class:"text-right"},{default:o(()=>[u(" Address ")]),_:1}),t(a(z),{id:"address",modelValue:s.address,"onUpdate:modelValue":m[1]||(m[1]=_=>s.address=_),placeholder:"Lot 1111, Tmana Mawar Baiduri, 5000 Selangor",class:"col-span-3"},null,8,["modelValue"])]),r("div",Kt,[t(a(V),{for:"description",class:"text-right"},{default:o(()=>[u(" Description ")]),_:1}),t(ye,{id:"description",modelValue:s.description,"onUpdate:modelValue":m[2]||(m[2]=_=>s.description=_),placeholder:"Description...",class:"col-span-3"},null,8,["modelValue"])]),r("div",Zt,[t(a(V),{for:"email",class:"text-right"},{default:o(()=>[u(" Email ")]),_:1}),t(a(z),{id:"email",modelValue:s.email,"onUpdate:modelValue":m[3]||(m[3]=_=>s.email=_),placeholder:"hello@gmail.com",class:"col-span-3"},null,8,["modelValue"])]),r("div",Jt,[t(a(V),{for:"websites",class:"text-right"},{default:o(()=>[u(" Websites ")]),_:1}),r("div",Qt,[t(a(z),{id:"website",modelValue:s.website1,"onUpdate:modelValue":m[4]||(m[4]=_=>s.website1=_),placeholder:"https://facebook.com",class:"w-1/2"},null,8,["modelValue"]),t(a(z),{id:"website",modelValue:s.website2,"onUpdate:modelValue":m[5]||(m[5]=_=>s.website2=_),placeholder:"https://kckok.my",class:"w-1/2"},null,8,["modelValue"])])]),r("div",ea,[t(a(V),{for:"customer",class:"text-right leading-normal"},{default:o(()=>[u(" Category ")]),_:1}),r("div",ta,[t(a(ae),{open:l.is_open,"onUpdate:open":m[6]||(m[6]=_=>l.is_open=_)},{default:o(()=>[t(a(se),{"as-child":""},{default:o(()=>[t(a(C),{variant:"outline",role:"combobox","aria-expanded":l.is_open,class:"w-full justify-between px-3",disabled:l.is_loading},{default:o(()=>{var _;return[u(T(s.vertical?(_=l.data.find(g=>g.id===s.vertical))==null?void 0:_.label:"Select Category")+" ",1),l.is_loading?(p(),y(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(p(),y(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(a(ne),{class:"w-[500px] p-1"},{default:o(()=>[t(a(ge),null,{default:o(()=>[t(a(he),{class:"h-9",placeholder:"Search category..."}),t(a(ve),null,{default:o(()=>[u("No category found.")]),_:1}),l.is_loading?(p(),y(a(le),{key:1},{default:o(()=>[t(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2 my-2 mx-auto"})]),_:1})):(p(),y(a(le),{key:0},{default:o(()=>[t(a(we),null,{default:o(()=>[(p(!0),$(W,null,B(l.data,_=>(p(),y(a(be),{key:_.id,value:_.value??"",onSelect:()=>I(_)},{default:o(()=>[u(T(_.label)+" ",1),t(f,{name:"fa-check",class:H(["ml-auto h-4 w-4",s.vertical===_.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1},8,["open"])])])]),t(Z),x.value?(p(),$("div",aa,[t(a(V),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),u(" "+T(x.value),1)]),_:1})])):N("",!0),t(a(pe),{class:"flex justify-end"},{default:o(()=>[t(a(C),{type:"submit",onClick:b,disabled:d.value},{default:o(()=>[d.value?(p(),y(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):N("",!0),u(" Update")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),na={class:"grid gap-4 py-4"},la={class:"grid grid-cols-4 items-center gap-4"},oa={key:0,class:"grid grid-cols-4 items-center gap-4"},ia=M({__name:"DataTableSendTestMessage",props:{row:{}},setup(n){const e=X("tableStore",E("phone")),l=j({id:n.row.id,phone:""}),i=D(!1),d=D(!1),v=D(null),{toast:x}=O(),w=async()=>{i.value=!0;try{const b=await P.post("/api/setup/phone/send-test-message",{...l});await e.refresh(e.page_index),x({title:b.data.message,variant:"success"})}catch(b){var c=b.response.data.message||"";x({title:"Whoops, something went wrong",description:c,variant:"destructive"})}finally{i.value=!1}};function h(){d.value=!d.value}return(c,b)=>{const S=L("VIcon"),I=L("Label"),F=L("Separator");return p(),$("div",null,[r("div",null,[t(a(C),{variant:"default",size:"sm",class:"p-2 px-3",onClick:h},{default:o(()=>[i.value?(p(),y(S,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):N("",!0),u(" Send Message ")]),_:1})]),t(a(ce),{open:d.value,"onUpdate:open":b[1]||(b[1]=k=>d.value=k)},{default:o(()=>[t(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(a(ie),null,{default:o(()=>[t(a(re),null,{default:o(()=>[u("Send Test Message")]),_:1}),t(a(de),null,{default:o(()=>[u(" Insert the phone number, click send. ")]),_:1})]),_:1}),r("div",na,[r("div",la,[t(I,{for:"phone",class:"text-right"},{default:o(()=>[u(" Phone Number ")]),_:1}),t(a(z),{id:"about",modelValue:l.phone,"onUpdate:modelValue":b[0]||(b[0]=k=>l.phone=k),placeholder:"60129884721",class:"col-span-3"},null,8,["modelValue"])])]),t(F),v.value?(p(),$("div",oa,[t(I,{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(S,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),u(" "+T(v.value),1)]),_:1})])):N("",!0),t(a(pe),{class:"flex justify-end"},{default:o(()=>[t(a(C),{type:"submit",onClick:w,disabled:i.value},{default:o(()=>[i.value?(p(),y(S,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):N("",!0),u(" Send")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ra={class:"flex gap-1"},da=M({__name:"DataTableRowActions",props:{row:{}},setup(n){const e=n,s=oe(()=>Wt.parse(e.row.original));return(l,i)=>(p(),$("div",ra,[t(Bt,{row:s.value},null,8,["row"]),t(sa,{row:s.value},null,8,["row"]),t(ia,{row:s.value},null,8,["row"])]))}}),ca=[{id:"select",header:({table:n})=>U(K,{checked:n.getIsAllPageRowsSelected()||n.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":e=>n.toggleAllPageRowsSelected(!!e),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:n})=>U(K,{checked:n.getIsSelected(),"onUpdate:checked":e=>n.toggleSelected(!!e),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"verified_name",header:({column:n})=>U(A,{column:n,title:"Name"}),cell:({row:n})=>U("div",{class:"w-20 underline"},n.getValue("verified_name")),enableSorting:!0,enableHiding:!0,filterFn:(n,e,s)=>{var d;const l=((d=n.getValue(e))==null?void 0:d.toString().toLowerCase())??"",i=s==null?void 0:s.toString().toLowerCase();return l.includes(i)},meta:{title:"Name"}},{accessorKey:"quality_rating",header:({column:n})=>U(A,{column:n,title:"Quality Rating"}),cell:({row:n})=>U("div",{class:"w-fit"},n.getValue("quality_rating")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(n,e,s)=>{var d;const l=((d=n.getValue(e))==null?void 0:d.toString().toLowerCase())??"",i=s==null?void 0:s.toString().toLowerCase();return l.includes(i)},meta:{title:"Quality Rating"}},{accessorKey:"last_onboarded_time",header:({column:n})=>U(A,{column:n,title:n.columnDef.meta.title}),cell:({row:n})=>{const e=n.getValue("last_onboarded_time");if(!e||typeof e!="string"&&typeof e!="number")return U("div",{class:"w-fit"},"");const s={year:"numeric",month:"long",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},l=new Intl.DateTimeFormat("en-US",s).format(new Date(e));return U("div",{class:"w-fit"},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Last Onboarded Time"}},{accessorKey:"display_phone_number",header:({column:n})=>U(A,{column:n,title:n.columnDef.meta.title}),cell:({row:n})=>U("div",{class:"w-fit"},n.getValue("display_phone_number")),enableSorting:!0,enableHiding:!0,meta:{title:"Display Phone Number"}},{accessorKey:"is_default_phone",header:({column:n})=>U(A,{column:n,title:n.columnDef.meta.title}),cell:({row:n})=>{const e=n.getValue("is_default_phone");return U(st,{variant:e?"success":"outline"},e?"YES":"NO")},enableSorting:!0,enableHiding:!0,meta:{title:"Default Phone"}},{id:"actions",cell:({row:n})=>U(da,{row:n})}],ua={class:"grid gap-4 py-4"},pa={class:"grid grid-cols-4 items-center gap-4"},ma=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),fa={class:"grid grid-cols-4 items-center gap-4"},_a=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ga={class:"col-span-3"},ha={class:"grid grid-cols-4 items-center gap-4"},va={class:"grid grid-cols-4 items-center gap-4"},wa={class:"grid grid-cols-4 items-center gap-4"},ba={class:"grid grid-cols-4 items-center gap-4"},ya={class:"grid grid-cols-4 items-center gap-4"},xa={class:"col-span-3"},$a={key:0,class:"grid grid-cols-4 items-center gap-4"},Sa=M({__name:"EditCompanyModal",setup(n){const e=j({name:"",country:0,whatsapp_business_account_id:"",notes:"",is_active:!1,is_onboarded:!1,date_live:null}),s=j({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),l=D("");async function i(m,f){s.is_loading=!0;try{var _=`/api/country/list?search=${m}`;f&&(_+=`&current_country=${f}`);const g=await P.get(_,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});s.data=g.data.Result}catch(g){console.error("There was an error fetching the select list:",g)}finally{s.is_loading=!1}}const d=D(!1),v=D(!1),x=D(null),{toast:w}=O();Oe(l,at.debounce(async m=>{s.is_open&&await i(m,e.country)},500));async function h(){try{const m=await P.get("/api/company/setup/");Object.assign(e,m.data.Result),e.country&&await i("",e.country)}catch{v.value=!1,w({title:"Whoops, something went wrong",description:"An unexpected error occurred",variant:"destructive"})}finally{d.value=!1}}function c(){var f;const m=[{condition:e.name==null||e.name=="",message:"Company name cannot be blank"},{condition:((f=e.country)==null?void 0:f.toString)==null,message:"Country cannot be blank"}];for(let _ of m)if(_.condition)return x.value=_.message,!1;return!0}async function b(){if(c()){d.value=!0;try{const f=await P.patch("http://127.0.0.1:8000/api/company/setup/",{...e},{headers:{"Content-Type":"application/json"}});S(),x.value="",w({title:f.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred",variant:"destructive"})}finally{d.value=!1}}}function S(){v.value=!v.value,v.value&&(h(),i(l.value))}function I(m){e.country=m.id,s.is_open=!1}function F(m){const f=new Date(m);e.date_live=tt(f,"yyyy-MM-dd")}function k(m){l.value=m.target.value}return(m,f)=>{const _=L("VIcon");return p(),$("div",null,[r("div",null,[t(a(C),{variant:"default",size:"sm",class:"p-2 px-3",onClick:S},{default:o(()=>[u(" Edit Company ")]),_:1})]),t(a(ce),{open:v.value,"onUpdate:open":f[9]||(f[9]=g=>v.value=g)},{default:o(()=>[t(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(a(ie),null,{default:o(()=>[t(a(re),null,{default:o(()=>[u("Edit Company")]),_:1}),t(a(de),null,{default:o(()=>[u(" Insert the details of the company here. Click edit when you're done. ")]),_:1})]),_:1}),r("div",ua,[r("div",pa,[t(a(V),{for:"company_name",class:"text-right"},{default:o(()=>[u(" Company Name "),ma]),_:1}),t(a(z),{id:"company_name",modelValue:e.name,"onUpdate:modelValue":f[0]||(f[0]=g=>e.name=g),placeholder:"George Sdn Bhd",class:"col-span-3"},null,8,["modelValue"])]),r("div",fa,[t(a(V),{for:"country",class:"text-right leading-normal"},{default:o(()=>[u(" Country "),_a]),_:1}),r("div",ga,[t(a(ae),{open:s.is_open,"onUpdate:open":f[2]||(f[2]=g=>s.is_open=g)},{default:o(()=>[t(a(se),{"as-child":""},{default:o(()=>[t(a(C),{variant:"outline",role:"combobox","aria-expanded":s.is_open,class:"w-full justify-between px-3",disabled:s.is_loading},{default:o(()=>{var g;return[u(T(e.country?(g=s.data.find(Ce=>Ce.id===e.country))==null?void 0:g.label:"Select Country")+" ",1),s.is_loading?(p(),y(_,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(p(),y(_,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(a(ne),{class:"w-[500px] p-1"},{default:o(()=>[t(a(ge),null,{default:o(()=>[t(a(he),{class:"h-9",modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=g=>l.value=g),placeholder:"Search country...",onInput:k},null,8,["modelValue"]),t(a(ve),null,{default:o(()=>[u("No country found.")]),_:1}),t(a(le),null,{default:o(()=>[t(a(we),null,{default:o(()=>[(p(!0),$(W,null,B(s.data,g=>(p(),y(a(be),{key:g.id,value:g.value??"",onSelect:()=>I(g)},{default:o(()=>[u(T(g.label)+" ",1),t(_,{name:"fa-check",class:H(["ml-auto h-4 w-4",e.country===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),t(Z),r("div",ha,[t(a(V),{for:"whatsapp_business_id",class:"text-right"},{default:o(()=>[u(" Whatsapp Business ID ")]),_:1}),t(a(z),{id:"whatsapp_business_id",modelValue:e.whatsapp_business_account_id,"onUpdate:modelValue":f[3]||(f[3]=g=>e.whatsapp_business_account_id=g),placeholder:"XXXXXXXXXXXX",class:"col-span-3"},null,8,["modelValue"])]),t(Z),r("div",va,[t(a(V),{for:"is_active",class:"text-right"},{default:o(()=>[u(" Notes ")]),_:1}),t(a(ye),{id:"is_active",modelValue:e.notes,"onUpdate:modelValue":f[4]||(f[4]=g=>e.notes=g),placeholder:"Leave your footnote here...",class:"col-span-3"},null,8,["modelValue"])]),r("div",wa,[t(a(V),{for:"is_active",class:"text-right"},{default:o(()=>[u(" Active ")]),_:1}),t(a(K),{id:"is_active",checked:e.is_active,"onUpdate:checked":f[5]||(f[5]=g=>e.is_active=g),"update:open":"form.is_active = $event",class:"col-span-3"},null,8,["checked"])]),r("div",ba,[t(a(V),{for:"is_onboarded",class:"text-right"},{default:o(()=>[u(" Onboarded ")]),_:1}),t(a(K),{id:"is_onboarded",checked:e.is_onboarded,"onUpdate:checked":f[6]||(f[6]=g=>e.is_onboarded=g),"update:open":"form.is_active = $event",class:"col-span-3"},null,8,["checked"])]),r("div",ya,[t(a(V),{for:"email",class:"text-right"},{default:o(()=>[u(" Active Date ")]),_:1}),r("div",xa,[t(a(ae),null,{default:o(()=>[t(a(se),{"as-child":""},{default:o(()=>[t(a(C),{variant:"outline",class:H(a(_e)("w-full justify-start text-left font-normal",!e.date_live&&"text-muted-foreground"))},{default:o(()=>[t(_,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),r("span",null,T(e.date_live?e.date_live:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),t(a(ne),{class:"w-auto p-0"},{default:o(()=>[t(a(nt),{modelValue:e.date_live,"onUpdate:modelValue":[f[7]||(f[7]=g=>e.date_live=g),f[8]||(f[8]=g=>F(g))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}},null,8,["modelValue"])]),_:1})]),_:1})])])]),x.value?(p(),$("div",$a,[t(a(V),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),u(" "+T(x.value),1)]),_:1})])):N("",!0),t(a(pe),{class:"flex justify-end"},{default:o(()=>[t(a(C),{type:"submit",onClick:b,disabled:d.value},{default:o(()=>[d.value?(p(),y(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):N("",!0),u(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),J=n=>(qe("data-v-71a2033b"),n=n(),Ge(),n),Ca=J(()=>r("h4",{class:"text-lg font-bold py-3"},"Company",-1)),ka={class:"w-full border-t-2 border-primary bg-secondary mb-5"},Va={class:"p-2"},Da={class:"p-2"},Ia=J(()=>r("h4",{class:"text-lg font-bold py-3"},"Management",-1)),Ta={class:"w-full border-t-2 border-primary bg-secondary gap-4 overflow-auto"},Ua={class:"pb-2"},Na=J(()=>r("td",{class:"p-2 text-sm w-1/4"},"Whatsapp Template",-1)),Pa=J(()=>r("td",{class:"font-bold text-center"},"Created",-1)),Ma={class:"px-2"},Ra={class:"px-2"},za=M({__name:"Import",setup(n){const e=X("phoneStore",E("phone")),s=j({is_loading:!1}),l=j({is_loading:!1}),i=j({is_loading:!1}),{toast:d}=O();async function v(){i.is_loading=!0;try{const c=await P.post("/api/refresh/company");await e.refresh(e.page_index),d({title:c.data.message,variant:"success"})}catch(c){var h=c.response.data.message||"";d({title:"Whoops, something went wrong",description:h,variant:"destructive"})}finally{i.is_loading=!1}}async function x(){s.is_loading=!0;try{const c=await P.post("/api/export/reminder-template");d({title:c.data.message,variant:"success"})}catch(c){var h=c.response.data.message||"";d({title:"Whoops, something went wrong",description:h,variant:"destructive"})}finally{s.is_loading=!1}}async function w(){l.is_loading=!0;try{const c=await P.post("/api/setup/template");d({title:c.data.message,variant:"success"})}catch(c){var h=c.response.data.message||"";d({title:"Whoops, something went wrong",description:h,variant:"destructive"})}finally{l.is_loading=!1}}return(h,c)=>{const b=L("VIcon");return p(),$("div",null,[Ca,r("table",ka,[r("tr",null,[r("td",Va,[t(Sa)]),r("td",Da,[t(a(C),{onClick:c[0]||(c[0]=()=>v()),disabled:i.is_loading},{default:o(()=>[i.is_loading?(p(),y(b,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):N("",!0),t(b,{name:"fa-sync",class:"h-4 w-4 shrink-0 mr-2"}),u(" Business Account")]),_:1},8,["disabled"])])])]),Ia,r("table",Ta,[r("tr",Ua,[Na,Pa,r("td",Ma,[t(a(C),{class:"my-2",onClick:c[1]||(c[1]=()=>x()),disabled:s.is_loading},{default:o(()=>[s.is_loading?(p(),y(b,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):N("",!0),t(b,{name:"fa-share-square",class:"h-4 w-4 shrink-0 mr-2"}),u(" Export Reminder Template")]),_:1},8,["disabled"])]),r("td",Ra,[t(a(C),{class:"my-2",onClick:c[2]||(c[2]=()=>w()),disabled:l.is_loading},{default:o(()=>[l.is_loading?(p(),y(b,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):N("",!0),t(b,{name:"fa-sync",class:"h-4 w-4 shrink-0 mr-2"}),u(" Import")]),_:1},8,["disabled"])])])])])}}}),Fa=lt(za,[["__scopeId","data-v-71a2033b"]]),La={class:"p-8 space-y-4 h-full"},ja=r("div",{class:"flex items-center justify-between space-y-2"},[r("div",null,[r("h2",{class:"text-2xl font-bold tracking-tight"},"Setup")])],-1),Wa=r("hr",null,null,-1),Ba=r("div",{class:"flex items-center justify-between space-y-2 my-2"},[r("div",null,[r("h3",{class:"text-lg font-bold tracking-tight"},"Phone Number")])],-1),Ea={class:"border-t-primary border-t-4 border-2 rounded"},Ya="/api/setup/phone",as=M({__name:"Setup",setup(n){const e=E("phone"),s=l=>({id:l.id,phone_number_id:l.phone_number_id,verified_name:l.verified_name,quality_rating:l.quality_rating,platform_type:l.platform_type,last_onboarded_time:l.last_onboarded_time,display_phone_number:l.display_phone_number,is_default_phone:l.is_default_phone});return Ke(()=>{e.fetch(Ya,0,s)}),Je("phoneStore",e),Ze(()=>{e.$reset()}),(l,i)=>(p(),$("div",La,[ja,Wa,t(Fa),r("div",null,[Ba,r("div",Ea,[t(jt,{data:a(e).tasks,columns:a(ca),class:"bg-white p-3"},null,8,["data","columns"])])])]))}});export{as as default};
