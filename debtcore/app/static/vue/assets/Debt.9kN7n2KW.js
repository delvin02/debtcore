import{_ as Re,a as Ue,b as Ae,c as je,d as He,e as Se,u as ee,f as Ne,g as Le,h as Be,i as we,j as de,k as Ee,l as Ye,m as We,n as Ke,o as Ge,p as qe,q as Qe,r as Xe,F as xe,z as U,s as $e}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as j,r as L,o as c,c as v,d as r,t as x,a as e,k as a,u as t,F,v as A,s as k,b as m,x as se,l as b,Y as O,m as T,N as q,a4 as le,a5 as me,a8 as ne,a6 as pe,a7 as J,a9 as Z,Q,R as X,n as Y,g as oe,at as Oe,y as Ce,z as Ve,A as De,B as te,E as W,i as S,I as re,K as _e,H as N,U as ge,W as ve,X as he,a3 as Me,_ as z,Z as be,C as Je,D as ie,T as ue,ae as Ie,ar as Ze,as as ze,j as et,au as tt,av as at,aw as st,ax as lt,a0 as V,ay as ke,G as nt,a1 as ot,a2 as it}from"../main.js";import{_ as ae}from"./index.DhdF1qMN.js";import{_ as rt}from"./CommandSeparator.vue_vue_type_script_setup_true_lang.DZgg3MH5.js";import{_ as ct,a as dt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as ye}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";import{_ as Pe}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.DOcqctDd.js";import{_ as Fe}from"./lodash.BtnTHUG3.js";import{f as Te}from"./index.BccI3ZLR.js";import{l as ut,A as ft}from"./index.EdlJKn0d.js";import"./index.5qndC0qu.js";const mt={class:"flex flex-col md:flex-row items-center justify-between px-2 pb-10"},pt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},_t={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},gt={class:"flex items-center space-x-2"},vt=r("p",{class:"text-sm font-medium"},"Rows per page",-1),ht={class:"flex w-[100px] items-center justify-center text-sm font-medium"},bt={class:"flex items-center space-x-2"},yt=r("span",{class:"sr-only"},"Go to first page",-1),wt=r("span",{class:"sr-only"},"Go to previous page",-1),xt=r("span",{class:"sr-only"},"Go to next page",-1),$t=r("span",{class:"sr-only"},"Go to last page",-1),kt=j({__name:"DataTablePagination",props:{table:{}},setup(i){return(n,l)=>{const s=L("VIcon");return c(),v("div",mt,[r("div",pt,x(n.table.getFilteredSelectedRowModel().rows.length)+" of "+x(n.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),r("div",_t,[r("div",gt,[vt,e(t(je),{"model-value":`${n.table.getState().pagination.pageSize}`,"onUpdate:modelValue":n.table.setPageSize},{default:a(()=>[e(t(Re),{class:"h-8 w-[70px]"},{default:a(()=>[e(t(Ue),{placeholder:`${n.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(t(Ae),{side:"top"},{default:a(()=>[(c(),v(F,null,A([10,20,30,40,50],d=>e(t(He),{key:d,value:`${d}`},{default:a(()=>[m(x(d),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),r("div",ht," Page "+x(n.table.getState().pagination.pageIndex+1)+" of "+x(n.table.getPageCount()),1),r("div",bt,[e(t(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanPreviousPage(),onClick:l[0]||(l[0]=d=>n.table.setPageIndex(0))},{default:a(()=>[yt,e(s,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanPreviousPage(),onClick:l[1]||(l[1]=d=>n.table.previousPage())},{default:a(()=>[wt,e(s,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanNextPage(),onClick:l[2]||(l[2]=d=>n.table.nextPage())},{default:a(()=>[xt,e(s,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanNextPage(),onClick:l[3]||(l[3]=d=>n.table.setPageIndex(n.table.getPageCount()-1))},{default:a(()=>[$t,e(s,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),fe=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claimed",icon:"fa-check-circle"},{value:"3",label:"Canceled",icon:"fa-times-circle"}],St={class:"hidden space-x-1 lg:flex"},Ct={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Vt=j({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(i){const n=i,l=se(()=>{var d;return(d=n.column)==null?void 0:d.getFacetedUniqueValues()}),s=se(()=>{var d;return new Set((d=n.column)==null?void 0:d.getFilterValue())});return(d,p)=>{const y=L("VIcon"),D=L("CheckIcon");return c(),b(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:a(()=>[e(y,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),m(" "+x(d.title)+" ",1),s.value.size>0?(c(),v(F,{key:0},[e(t(O),{orientation:"vertical",class:"mx-2 h-4"}),e(t(ae),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:a(()=>[m(x(s.value.size),1)]),_:1}),r("div",St,[s.value.size>2?(c(),b(t(ae),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x(s.value.size)+" selected ",1)]),_:1})):(c(!0),v(F,{key:1},A(d.options.filter($=>s.value.has($.value)),$=>(c(),b(t(ae),{key:$.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x($.label),1)]),_:2},1024))),128))])],64)):T("",!0)]),_:1})]),_:1}),e(t(Q),{class:"w-[200px] p-0",align:"start"},{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(me),{placeholder:d.title},null,8,["placeholder"]),e(t(ne),null,{default:a(()=>[e(t(pe),null,{default:a(()=>[m("No results found.")]),_:1}),e(t(J),null,{default:a(()=>[(c(!0),v(F,null,A(d.options,$=>(c(),b(t(Z),{key:$.value,value:$,onSelect:w=>{var C;s.value.has($.value)?s.value.delete($.value):s.value.add($.value);const M=Array.from(s.value);(C=d.column)==null||C.setFilterValue(M.length?M:void 0)}},{default:a(()=>{var w;return[r("div",{class:Y(t(oe)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",s.value.has($.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(D,{class:Y(t(oe)("h-4 w-4"))},null,8,["class"])],2),$.icon?(c(),b(Oe($.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):T("",!0),r("span",null,x($.label),1),(w=l.value)!=null&&w.get($.value)?(c(),v("span",Ct,x(l.value.get($.value)),1)):T("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),s.value.size>0?(c(),v(F,{key:0},[e(t(rt)),e(t(J),null,{default:a(()=>[e(t(Z),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:p[0]||(p[0]=$=>{var w;return(w=d.column)==null?void 0:w.setFilterValue(void 0)})},{default:a(()=>[m(" Clear filters ")]),_:1})]),_:1})],64)):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Dt=j({__name:"DataTableViewOptions",props:{table:{}},setup(i){const n=i,l=se(()=>n.table.getAllColumns().filter(s=>typeof s.accessorFn<"u"&&s.getCanHide()));return(s,d)=>(c(),b(t(De),null,{default:a(()=>[e(t(Ce),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:a(()=>[m(" View ")]),_:1})]),_:1}),e(t(Ve),{align:"end",class:"w-[150px]"},{default:a(()=>[e(t(ct),null,{default:a(()=>[m("Toggle columns")]),_:1}),e(t(Se)),(c(!0),v(F,null,A(l.value,p=>(c(),b(t(dt),{key:p.id,class:"capitalize",checked:p.getIsVisible(),"onUpdate:checked":y=>p.toggleVisibility(!!y)},{default:a(()=>{var y;return[m(x(((y=p.columnDef.meta)==null?void 0:y.title)||p.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),Mt={class:"grid gap-4 py-4"},It={class:"grid grid-cols-4 items-center gap-4"},zt=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Pt={class:"grid grid-cols-4 items-center gap-4"},Ft=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Tt={class:"col-span-3"},Rt={class:"grid grid-cols-4 items-center gap-4"},Ut=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),At={class:"grid grid-cols-4 items-center gap-4"},jt=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ht={class:"col-span-3"},Nt={class:"grid grid-cols-4 items-center gap-4"},Lt=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Bt={class:"grid grid-cols-4 items-center gap-4"},Et=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Yt={class:"col-span-3"},Wt={class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Kt=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Gt={class:"col-span-3"},qt=r("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),r("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),Qt={key:0,class:"grid grid-cols-4 items-center gap-4"},Xt=j({__name:"DataTableCreateDebt",setup(i){const n=te("tableStore",ee("debt")),l=W({invoice:"",customer:null,amount:null,invoice_date:null,term:7,status:null,document:null}),s=W({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=W({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=S("");async function y(_){s.is_loading=!0;try{const o=await N.get(`/api/customer/list?search=${_||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});s.data=o.data.Result}catch(o){console.error("There was an error fetching the select list:",o)}finally{s.is_loading=!1}}async function D(){s.is_loading=!0;try{const _=await N.get("/api/debt/status/create/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});d.data=_.data.Result,l.status=1}catch{M({title:"Whoops, something went wrong",description:"There was an error fetching the select list.",variant:"destructive"})}finally{d.is_loading=!1}}const $=S(!1),w=S(!1),h=S(null);S();const{toast:M}=re();_e(p,Fe.debounce(async _=>{w.value&&await y(_)},500));function C(){var o;const _=[{condition:l.invoice==="",message:"Invoice cannot be blank"},{condition:((o=l.invoice_date)==null?void 0:o.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let f of _)if(f.condition)return h.value=f.message,!1;return!0}async function R(){if(C()){$.value=!0;try{const o=await N.post("/api/debt",{...l},{headers:{"Content-Type":"multipart/form-data"}});I(),await n.refresh(n.page_index),M({title:o.data.Result,variant:"success"})}catch{M({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{$.value=!1}}}function I(){w.value=!w.value,w.value&&(y(p.value),D())}function H(_){l.customer=_.id,s.is_open=!1}function B(_){l.status=_.id,d.is_open=!1}function K(_){var f;const o=_.target;if((f=o.files)!=null&&f.length){const u=o.files[0];if(u.type!=="application/pdf"){M({title:"Please select a PDF file",variant:"destructive"}),o.value="";return}if(u.size>5*1024*1024){M({title:"The file size must be under 5MB",variant:"destructive"}),o.value="";return}l.document=u}}function P(_){const o=new Date(_);l.invoice_date=Te(o,"yyyy-MM-dd")}return(_,o)=>{const f=L("VIcon");return c(),v("div",null,[r("div",null,[e(t(k),{variant:"default",size:"sm",class:"h-8 ml-2 flex",onClick:I},{default:a(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(t(be),{open:w.value,"onUpdate:open":o[7]||(o[7]=u=>w.value=u)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Create Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click create when you're done. ")]),_:1})]),_:1}),r("div",Mt,[r("div",It,[e(t(z),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),zt]),_:1}),e(t(E),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":o[0]||(o[0]=u=>l.invoice=u),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),r("div",Pt,[e(t(z),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),Ft]),_:1}),r("div",Tt,[e(t(X),{open:s.is_open,"onUpdate:open":o[2]||(o[2]=u=>s.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":s.is_open,class:"w-full justify-between px-3",disabled:s.is_loading},{default:a(()=>{var u;return[m(x(l.customer?(u=s.data.find(g=>g.id===l.customer))==null?void 0:u.label:"Select customer")+" ",1),s.is_loading?(c(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=u=>p.value=u),placeholder:"Search customer..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(ne),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),v(F,null,A(s.data,u=>(c(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>H(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:Y(["ml-auto h-4 w-4",l.customer===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),r("div",Rt,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),Ut]),_:1}),e(t(E),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":o[3]||(o[3]=u=>l.amount=u===""?null:u),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),r("div",At,[e(t(z),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),jt]),_:1}),r("div",Ht,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",class:Y(t(oe)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(f,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),r("span",null,x(l.invoice_date?l.invoice_date:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Pe),{"onUpdate:modelValue":o[4]||(o[4]=u=>P(u)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),r("div",Nt,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Lt]),_:1}),e(t(E),{id:"amount",modelValue:l.term,"onUpdate:modelValue":o[5]||(o[5]=u=>l.term=u),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),r("div",Bt,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status "),Et]),_:1}),r("div",Yt,[e(t(X),{open:d.is_open,"onUpdate:open":o[6]||(o[6]=u=>d.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":d.is_open,class:"w-full justify-between px-3",disabled:d.is_loading},{default:a(()=>{var u;return[m(x(l.status?(u=d.data.find(g=>g.id===l.status))==null?void 0:u.label:"Select status")+" ",1),d.is_loading?(c(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(ne),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),v(F,null,A(d.data,u=>(c(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>B(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:Y(["ml-auto h-4 w-4",l.status===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(O),r("div",Wt,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment "),Kt]),_:1}),r("div",Gt,[e(t(E),{id:"name",type:"file",onChange:K,class:"col-span-3"})]),qt])]),e(O),h.value?(c(),v("div",Qt,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(h.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[e(t(k),{type:"submit",onClick:R,disabled:$.value},{default:a(()=>[$.value?(c(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ot=j({__name:"DataTableRefreshButton",setup(i){const n=te("tableStore",ee("debt")),l=()=>{n.refresh(n.page_index)};return(s,d)=>{const p=L("VIcon");return c(),v("div",null,[e(t(k),{variant:"outline",size:"default",class:"flex h-8 ml-2",onClick:l},{default:a(()=>[e(p,{name:"md-refresh",class:"size-4"})]),_:1})])}}}),Jt={class:"flex items-center justify-between"},Zt={class:"flex flex-1 items-center space-x-2"},ea=j({__name:"DataTableToolbar",props:{table:{}},setup(i){const n=i,l=se(()=>n.table.getState().columnFilters.length>0);return(s,d)=>{var p;return c(),v("div",Jt,[r("div",Zt,[e(t(E),{placeholder:"Search...","model-value":((p=s.table.getColumn("invoice"))==null?void 0:p.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:d[0]||(d[0]=y=>s.table.setGlobalFilter(y.target.value))},null,8,["model-value"]),s.table.getColumn("status")?(c(),b(Vt,{key:0,column:s.table.getColumn("status"),title:"Status",options:t(fe)},null,8,["column","options"])):T("",!0),l.value?(c(),b(t(k),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:d[1]||(d[1]=y=>s.table.resetColumnFilters())},{default:a(()=>[m(" Reset ")]),_:1})):T("",!0)]),e(Dt,{table:s.table},null,8,["table"]),e(Ot),e(Xt,{table:s.table},null,8,["table"])])}}}),ta={class:"space-y-4 text-muted-foreground"},aa={key:0,class:"text-center"},sa={key:1,class:"rounded-md border"},la=j({__name:"DataTable",props:{columns:{},data:{}},setup(i){const n=te("tableStore",ee("debt")),l=i,s=S([]),d=S([]),p=S({}),y=S({pageIndex:n.page_index,pageSize:n.page_size}),D=S();function $(h,M){let C;typeof h=="function"?C=h(M.value):C=h,M.value=C,n.set_page_index(C.pageIndex),n.set_page_size(C.pageSize)}const w=Ne({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return s.value},get columnFilters(){return d.value},get columnVisibility(){return p.value},get rowSelection(){return D.value},get pagination(){return y.value}},enableRowSelection:!0,onSortingChange:h=>ie(h,s),onPaginationChange:h=>$(h,y),onColumnFiltersChange:h=>ie(h,d),onColumnVisibilityChange:h=>ie(h,p),onRowSelectionChange:h=>ie(h,D),getCoreRowModel:Ye(),getFilteredRowModel:We(),getPaginationRowModel:Ke(),getSortedRowModel:Ge(),getFacetedRowModel:qe(),getFacetedUniqueValues:Qe()});return Je(()=>{w.setPageIndex(n.page_index),w.setPageSize(n.page_size)}),(h,M)=>{const C=L("VIcon");return c(),v("div",ta,[e(ea,{table:t(w)},null,8,["table"]),t(n).is_loading?(c(),v("div",aa,[e(C,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(c(),v("div",sa,[e(t(Ee),{class:"text-xs"},{default:a(()=>[e(t(Le),null,{default:a(()=>[(c(!0),v(F,null,A(t(w).getHeaderGroups(),R=>(c(),b(t(de),{key:R.id},{default:a(()=>[(c(!0),v(F,null,A(R.headers,I=>(c(),b(t(Xe),{key:I.id},{default:a(()=>[I.isPlaceholder?T("",!0):(c(),b(t(xe),{key:0,render:I.column.columnDef.header,props:I.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(t(Be),{id:"dbTableBody"},{default:a(()=>{var R;return[(R=t(w).getRowModel().rows)!=null&&R.length?(c(!0),v(F,{key:0},A(t(w).getRowModel().rows,I=>(c(),b(t(de),{key:I.id,"data-state":I.getIsSelected()&&"selected"},{default:a(()=>[(c(!0),v(F,null,A(I.getVisibleCells(),H=>(c(),b(t(we),{key:H.id},{default:a(()=>[e(t(xe),{render:H.column.columnDef.cell,props:H.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(c(),b(t(de),{key:1},{default:a(()=>[e(t(we),{colspan:h.columns.length,class:"h-24 text-center"},{default:a(()=>[m(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})])),e(kt,{table:t(w)},null,8,["table"])])}}}),G=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(i){return(n,l)=>{const s=L("VIcon");return n.column.getCanSort()?(c(),v("div",{key:0,class:Y(t(oe)("flex items-center space-x-2",n.$attrs.class??""))},[e(t(De),null,{default:a(()=>[e(t(Ce),{"as-child":""},{default:a(()=>[e(t(k),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:a(()=>[r("span",null,x(n.title),1),n.column.getIsSorted()==="desc"?(c(),b(s,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):n.column.getIsSorted()==="asc"?(c(),b(s,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(c(),b(s,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(t(Ve),{align:"start"},{default:a(()=>[e(t(ue),{onClick:l[0]||(l[0]=d=>n.column.toggleSorting(!1))},{default:a(()=>[e(s,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Asc ")]),_:1}),e(t(ue),{onClick:l[1]||(l[1]=d=>n.column.toggleSorting(!0))},{default:a(()=>[e(s,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Desc ")]),_:1}),e(t(Se)),e(t(ue),{onClick:l[2]||(l[2]=d=>n.column.toggleVisibility(!1))},{default:a(()=>[e(s,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(c(),v("div",{key:1,class:Y(n.$attrs.class)},x(n.title),3))}}}),na=U.object({id:U.number(),invoice:U.string(),customer_name:U.string().min(2).max(50),invoice_date:U.preprocess(i=>typeof i=="string"?new Date(i):i,U.date()),due_date:U.preprocess(i=>typeof i=="string"?new Date(i):i,U.date()),term:U.number(),amount:U.string(),document_url:U.string(),status:U.number(),editable:U.boolean()}),oa={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},ia={class:"col-span-3"},ra=r("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),r("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),ca={key:1},da={class:"flex justify-center my-auto items-center place-items-center mb-2"},ua={class:"mx-2"},fa={key:1,class:"flex justify-center my-auto items-center place-items-center"},ma=["src"],pa={key:0,class:"grid grid-cols-4 items-center gap-4"},_a=j({__name:"DataTableCheckAttachment",props:{row:{}},setup(i){const n=te("tableStore",ee("debt")),l=i,s=W({document:null,document_url:l.row.document_url}),d=W({pdf:void 0,pages:void 0,info:void 0}),p=S(1),y=S(!1),D=S(!1),$=S(null),w=S(window.innerHeight-250),{toast:h}=re();function M(_){h({title:"PDF loading error",variant:"destructive"})}async function C(){try{y.value=!0;const _=await N.get(`/api/debt/${l.row.id}/document/`);s.document_url=_.data.Result.document_url;const o=ft(s.document_url,{onError:M});ze(()=>{d.pdf=o.pdf,d.pages=o.pages,d.info=o.info})}catch{B(),h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}const R=()=>{const _=document.querySelector("#vp > div > div > div > canvas");if(_){const o=_.offsetHeight,f=window.innerHeight-250,u=680;f>o&&o<u?w.value=o:f>o?w.value=f:w.value=Math.min(Math.max(o,u),f)}};function I(){const _=[{condition:s.document==null,message:"Attachment cannot be blank"}];for(let o of _)if(o.condition)return $.value=o.message,!1;return!0}async function H(){if(I()){y.value=!0;try{const o=await N.patch(`/api/debt/${l.row.id}/document/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});K(),await n.refresh(n.page_index),h({title:o.data.Result,variant:"success"})}catch{h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function B(){s.document_url=null}async function K(){D.value=!D.value,D.value&&await C()}function P(_){var f;const o=_.target;if((f=o.files)!=null&&f.length){const u=o.files[0];if(u.type!=="application/pdf"){h({title:"Please select a PDF file",variant:"destructive"}),o.value="";return}if(u.size>5*1024*1024){h({title:"The file size must be under 5MB",variant:"destructive"}),o.value="";return}s.document=u}}return(_,o)=>{const f=L("VIcon");return c(),v("div",null,[r("div",null,[e(t(k),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:K},{default:a(()=>[e(f,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),e(t(be),{class:"my-2",open:D.value,"onUpdate:open":o[2]||(o[2]=u=>D.value=u)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-fit"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Attachment Overview")]),_:1})]),_:1}),r("div",null,[s.document_url?s.document_url.endsWith(".pdf")?(c(),v("div",ca,[r("div",da,[e(t(k),{variant:"secondary",onClick:o[0]||(o[0]=u=>p.value=p.value>1?p.value-1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),r("span",ua,x(p.value)+" / "+x(d.pages),1),e(t(k),{variant:"secondary",onClick:o[1]||(o[1]=u=>p.value=p.value<d.pages?p.value+1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),e(t(Ie),{class:"border border-primary md:w-[720px] w-full",style:Ze([{"overflow-y":"auto","overflow-x":"hidden"},{height:w.value+"px"}])},{default:a(()=>[y.value?(c(),v("div",fa,[e(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])):(c(),b(t(ut),{key:0,pdf:d.pdf,page:p.value,"fit-parent":"",onLoaded:R,"annonation-layer":""},null,8,["pdf","page"]))]),_:1},8,["style"])])):(c(),v("img",{key:2,src:s.document_url,alt:"Document preview",class:"object-contain"},null,8,ma)):(c(),v("div",oa,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment ")]),_:1}),r("div",ia,[e(t(E),{id:"name",type:"file",onChange:P,class:"col-span-3"})]),ra]))]),e(t(O)),$.value?(c(),v("div",pa,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x($.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[s.document_url?(c(),b(t(k),{key:0,class:"bg-red-600 text-white",onClick:B,disabled:y.value},{default:a(()=>[m(" Replace")]),_:1},8,["disabled"])):(c(),b(t(k),{key:1,onClick:H,disabled:y.value},{default:a(()=>[y.value?(c(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ga={class:"grid gap-4 py-4"},va={class:"grid grid-cols-4 items-center gap-4"},ha=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ba={class:"grid grid-cols-4 items-center gap-4"},ya=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),wa={class:"col-span-3"},xa={class:"grid grid-cols-4 items-center gap-4"},$a=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ka={class:"grid grid-cols-4 items-center gap-4"},Sa=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ca={class:"col-span-3"},Va={class:"grid grid-cols-4 items-center gap-4"},Da=r("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ma={class:"grid grid-cols-4 items-center gap-4"},Ia={class:"col-span-3"},za={key:0,class:"grid grid-cols-4 items-center gap-4"},Pa=j({__name:"DataTableEditModal",props:{row:{}},setup(i){const n=te("tableStore",ee("debt")),l=i,s=W({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),d=W({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=W({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),y=S("");async function D(o){d.is_loading=!0;try{const f=await N.get(`/api/customer/list?search=${o||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});d.data=f.data.Result}catch{C({title:"Whoops, something went wrong",description:"There was an error fetching the select list",variant:"destructive"})}finally{d.is_loading=!1}}async function $(){d.is_loading=!0;try{const o=await N.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});p.data=o.data.Result}catch(o){console.error("There was an error fetching the select list:",o)}finally{p.is_loading=!1}}const w=S(!1),h=S(!1),M=S(null),{toast:C}=re();_e(y,Fe.debounce(async o=>{h.value&&await D(o)},500));async function R(){try{const o=await N.get(`/api/debt/${l.row.id}/`);Object.assign(s,o.data.Result)}catch(o){console.log(o)}finally{w.value=!1}}function I(){var f;const o=[{condition:s.invoice==null,message:"Invoice cannot be blank"},{condition:((f=s.invoice_date)==null?void 0:f.toString)==null,message:"Invoice Date cannot be blank"},{condition:s.status==null,message:"Status cannot be blank"},{condition:s.customer==null,message:"Customer cannot be blank"}];for(let u of o)if(u.condition)return M.value=u.message,!1;return!0}async function H(){if(I()){w.value=!0;try{const f=await N.patch(`/api/debt/${l.row.id}/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});B(),await n.refresh(n.page_index),console.log("hello "+n.page_index),C({title:f.data.Result,variant:"success"})}catch{C({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{w.value=!1}}}function B(){h.value=!h.value,h.value&&(R(),D(y.value),$())}function K(o){s.customer=o.id,d.is_open=!1}function P(o){s.status=o.id,p.is_open=!1}function _(o){const f=new Date(o);s.invoice_date=Te(f,"yyyy-MM-dd")}return(o,f)=>{const u=L("VIcon");return c(),v("div",null,[r("div",null,[e(t(k),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:B},{default:a(()=>[e(u,{name:"fa-pen",class:"size-4"})]),_:1})]),e(t(be),{open:h.value,"onUpdate:open":f[7]||(f[7]=g=>h.value=g)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Edit Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),r("div",ga,[r("div",va,[e(t(z),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),ha]),_:1}),e(t(E),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":f[0]||(f[0]=g=>s.invoice=g),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),r("div",ba,[e(t(z),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),ya]),_:1}),r("div",wa,[e(t(X),{open:d.is_open,"onUpdate:open":f[2]||(f[2]=g=>d.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":d.is_open,class:"w-full justify-between px-3",disabled:d.is_loading},{default:a(()=>{var g;return[m(x(s.customer?(g=d.data.find(ce=>ce.id===s.customer))==null?void 0:g.label:"Select customer")+" ",1),d.is_loading?(c(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:y.value,"onUpdate:modelValue":f[1]||(f[1]=g=>y.value=g),placeholder:"Search country..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(ne),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),v(F,null,A(d.data,g=>(c(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>K(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:Y(["ml-auto h-4 w-4",s.customer===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),r("div",xa,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),$a]),_:1}),e(t(E),{id:"amount",modelValue:s.amount===null?"":s.amount,"onUpdate:modelValue":f[3]||(f[3]=g=>s.amount=g===""?null:g),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),r("div",ka,[e(t(z),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),Sa]),_:1}),r("div",Ca,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",class:Y(t(oe)("w-full justify-start text-left font-normal",!s.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(u,{name:"bi-calendar-fill",class:"mr-2 size-4"}),r("span",null,x(s.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Pe),{"onUpdate:modelValue":f[4]||(f[4]=g=>_(g)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),r("div",Va,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Da]),_:1}),e(t(E),{id:"amount",modelValue:s.term,"onUpdate:modelValue":f[5]||(f[5]=g=>s.term=g),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),r("div",Ma,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status ")]),_:1}),r("div",Ia,[e(t(X),{open:p.is_open,"onUpdate:open":f[6]||(f[6]=g=>p.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":p.is_open,class:"w-full justify-between px-3",disabled:p.is_loading},{default:a(()=>{var g;return[m(x(s.status?(g=p.data.find(ce=>ce.id===s.status))==null?void 0:g.label:"Select status")+" ",1),p.is_loading?(c(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(ne),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),v(F,null,A(p.data,g=>(c(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>P(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:Y(["ml-auto h-4 w-4",s.status===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),e(O),M.value?(c(),v("div",za,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(M.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[e(t(k),{type:"submit",onClick:H,disabled:w.value},{default:a(()=>[w.value?(c(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Fa={class:"flex flex-col justify-between"},Ta={class:"pr-4"},Ra={class:"flex justify-between"},Ua={key:0,class:"text-primary font-bold flex place-items-center self-center"},Aa={key:1,class:"text-primary font-bold"},ja={class:"text-primary"},Ha={class:"text-sm"},Na={class:"flex mt-2 gap-2"},La={class:"text-xs mt-2"},Ba=j({__name:"DataTableBacklog",props:{row:{}},setup(i){const n=et(),l=i,s=W({debt:l.row.id,message:""}),d=W([]),p=S(!1),y=S(!1),D=S(null),{toast:$}=re();var w=S(null),h=S(null),M=S(0),C=te("height");async function R(){try{const P=await N.get(`/api/debt/${l.row.id}/backlog/`);d.splice(0,d.length,...P.data.Result),p.value=!1}catch{$({title:"Whoops, something went wrong",description:"Form initialisation error.",variant:"destructive"})}finally{p.value=!1}}function I(){const P=[{condition:s.message=="",message:"Message cannot be blank"},{condition:s.message.length<5,message:"Maybe a little more context?"}];for(let _ of P)if(_.condition)return D.value=_.message,!1;return!0}async function H(){if(I()){p.value=!0;try{const _=await N.post(`/api/debt/${l.row.id}/backlog/`,{...s},{headers:{"Content-Type":"application/json"}});await R(),$({title:_.data.Result,variant:"success"}),s.message="",D.value=""}catch{$({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{p.value=!1}}}const B=()=>{ze().then(()=>{var P,_;C&&(M.value=C.value-((((P=w.value)==null?void 0:P.clientHeight)||0)+(((_=h.value)==null?void 0:_.clientHeight)||0))-50)})};_e([w,h],B,{immediate:!0});function K(){y.value=!y.value,y.value&&(R(),B())}return(P,_)=>{const o=L("VIcon"),f=L("Label");return c(),v("div",null,[r("div",null,[e(t(k),{variant:"secondary",size:"sm",class:"h-8 flex border border-primary",onClick:K},{default:a(()=>[e(o,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),e(t(lt),{open:y.value,"onUpdate:open":_[1]||(_[1]=u=>y.value=u)},{default:a(()=>[e(t(tt),{class:"h-screen",side:"right"},{default:a(()=>[r("div",{ref_key:"headerElement",ref:w},[e(t(at),null,{default:a(()=>[e(t(st),null,{default:a(()=>[m("Backlog - "+x(l.row.invoice),1)]),_:1})]),_:1})],512),e(t(O),{class:"mt-2 mb-4 border-primary border"}),r("div",Fa,[e(t(Ie),{class:"flex flex-col h-full",style:{height:"80vh"}},{default:a(()=>[r("div",Ta,[(c(!0),v(F,null,A(d,(u,g)=>(c(),v("div",{key:g,class:"pr-4 my-2"},[r("div",Ra,[u.is_system_generated?(c(),v("div",Ua,[e(o,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),m(" System Generated ")])):(c(),v("div",Aa,x(u.created_by_name),1))]),r("div",null,[r("div",ja,x(u.created_date),1),e(t(O),{variant:"default"}),r("div",null,x(u.message),1)])]))),128))])]),_:1}),r("div",{class:"flex flex-col",ref_key:"footerElement",ref:h},[D.value?(c(),b(f,{key:0,for:"error",class:"text-red-600 flex"},{default:a(()=>[e(o,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),r("p",Ha,x(D.value),1)]),_:1})):T("",!0),r("div",Na,[e(t(E),{id:"message",modelValue:s.message,"onUpdate:modelValue":_[0]||(_[0]=u=>s.message=u),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),e(t(k),{type:"submit",onClick:H,disabled:p.value},{default:a(()=>[m(" Save ")]),_:1},8,["disabled"])]),r("p",La,x(t(n).getUsername),1)],512)])]),_:1})]),_:1},8,["open"])])}}}),Ea={class:"flex gap-1"},Ya=j({__name:"DataTableRowActions",props:{row:{}},setup(i){const n=i,l=se(()=>na.parse(n.row.original));return(s,d)=>(c(),v("div",Ea,[l.value.editable?(c(),b(Pa,{key:0,row:l.value},null,8,["row"])):T("",!0),e(_a,{row:l.value},null,8,["row"]),e(Ba,{row:l.value},null,8,["row"])]))}}),Wa=[{id:"select",header:({table:i})=>V($e,{checked:i.getIsAllPageRowsSelected()||i.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":n=>i.toggleAllPageRowsSelected(!!n),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:i})=>V($e,{checked:i.getIsSelected(),"onUpdate:checked":n=>i.toggleSelected(!!n),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:i})=>V(G,{column:i,title:"Invoice"}),cell:({row:i})=>{const n=fe.find(l=>l.value===i.original.status.toString());return n?V("div",{class:`w-20 font-bold ${n.label=="Canceled"?"line-through decoration-red-600":""}`},i.getValue("invoice")):null},enableSorting:!0,enableHiding:!0,filterFn:(i,n,l)=>{var p;const s=((p=i.getValue(n))==null?void 0:p.toString().toLowerCase())??"",d=l==null?void 0:l.toString().toLowerCase();return s.includes(d)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:i})=>V(G,{column:i,title:"Customer"}),cell:({row:i})=>V("div",{class:"w-fit"},i.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(i,n,l)=>{var p;const s=((p=i.getValue(n))==null?void 0:p.toString().toLowerCase())??"",d=l==null?void 0:l.toString().toLowerCase();return s.includes(d)},meta:{title:"Customer"}},{accessorKey:"invoice_date",header:({column:i})=>V(G,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>{const n=i.getValue("invoice_date");let l="";if(n){const s=new Date(Date.parse(n));isNaN(s.getTime())?l="Not Provided":l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return V("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:i})=>V(G,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>{const n=i.getValue("due_date");let l="";if(n){const s=new Date(n);isNaN(s.getTime())?l="Not Provided":l=s.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return V("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"term",header:({column:i})=>V(G,{column:i,title:"Term"}),cell:({row:i})=>V("div",{class:"w-fit"},i.getValue("term")),enableHiding:!0,meta:{title:"Term"}},{accessorKey:"amount",header:({column:i})=>V(G,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>V(ae,{variant:"destructive"},"RM "+i.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:i})=>V(G,{column:i,title:"Attachment"}),cell:({row:i})=>{const n=i.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return V(ke,{name:n.icon,class:`${n.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:i})=>V(G,{column:i,title:"Status"}),cell:({row:i})=>{const n=fe.find(l=>l.value===i.original.status.toString());return n?V(ae,{variant:"secondary",class:"inline items-center whitespace-nowrap"},[n.icon&&V(ke,{name:n.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),V("span",n.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(i,n,l)=>{const s=i.getValue(n);if(!s)return!1;const d=s.toString().toLowerCase();return l.some(y=>d.includes(y.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:i})=>V(Ya,{row:i})}],Ka={class:"p-4 md:p-8 space-y-8 h-full"},Ga=r("div",{class:"flex items-center justify-between space-y-2"},[r("div",null,[r("h2",{class:"text-2xl font-bold tracking-tight"},"Debt"),r("p",{class:"text-muted-foreground"},"Here's a list of your existing debts!")])],-1),qa="/api/debt",is=j({__name:"Debt",setup(i){const n=ee("debt"),l=s=>({id:s.id,status:s.status,invoice:s.invoice,customer_name:s.customer_name,invoice_date:new Date(s.invoice_date),due_date:new Date(s.due_date),term:s.term,amount:s.amount,document_url:s.document_url,editable:s.editable});return nt(async()=>{await n.fetch(qa,0,l)}),it("tableStore",n),ot(()=>{n.$reset()}),(s,d)=>(c(),v("div",Ka,[Ga,e(la,{data:t(n).tasks,columns:t(Wa)},null,8,["data","columns"])]))}});export{is as default};
