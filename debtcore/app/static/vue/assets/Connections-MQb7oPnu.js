import{_ as p,a as m,b,c as d,d as w}from"./CardContent.vue_vue_type_script_setup_true_lang-BOvowWh0.js";import{e as _,o as c,c as x,f as W,n as A,u as t,g as T,aD as S,X as y,U as C,v as $,x as V,r as D,l as r,k as s,d as n,a,b as o,B as g,s as k,i as E,aE as N}from"../main.js";import{_ as v}from"./index-DhdF1qMN.js";const z=_({__name:"CardFooter",props:{class:{}},setup(u){const e=u;return(i,l)=>(c(),x("div",{class:A(t(T)("flex items-center p-6 pt-0",e.class))},[W(i.$slots,"default")],2))}}),I=u=>S(u,{state:()=>({is_authenticated:!1,authenticate_url:"",url:"",link:"",is_loading:!1}),actions:{async init(e){this.url=e,this.is_loading=!0;try{const i=await y.get(e,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=i.data.Result.is_authenticated,this.authenticate_url=i.data.Result.authenticate_url}catch(i){console.log("this was an error initializing the connection",i)}finally{this.is_loading=!1}},async disconnect(){this.is_loading=!0;try{const e=await y.put(this.url,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=!1}catch(e){console.log("There was an error disconnecting the connection",e)}finally{this.is_loading=!1}}}})(),O={class:"flex border-t-4 border-green-600/80 rounded"},P={class:"flex items-stretch"},R=n("b",null,"'Connect to WhatsApp'",-1),U=n("b",null,"'Disconnect from WhatsApp'",-1),j=n("b",null,"'Authenticate'",-1),q=n("a",{href:"https://metastatus.com/whatsapp-business-api",class:"text-blue-600 underline"},"Status",-1),F=["href"],M=_({__name:"Whatsapp",setup(u){const e=I("whatsapp"),{toast:i}=C();$(()=>{e.init("/api/connections/facebook")});const l=()=>{e.disconnect(),i({title:"Whatsapp disconnected successfully!",variant:"success"})};return V(()=>{e.$reset()}),(B,h)=>{const f=D("VIcon");return t(e).is_loading?(c(),r(t(w),{key:1},{default:s(()=>[a(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})]),_:1})):(c(),r(t(w),{key:0,class:"shadow-none"},{default:s(()=>[n("div",O,[a(t(m),null,{default:s(()=>[a(t(p),null,{default:s(()=>[a(f,{name:"fa-whatsapp",class:"size-24 fill-green-500"})]),_:1})]),_:1}),a(t(m),{class:"flex-1"},{default:s(()=>[a(t(b),{class:"py-2 pl-0"},{default:s(()=>[n("div",P,[a(t(p),null,{default:s(()=>[o("WhatsApp Business")]),_:1}),t(e).is_authenticated?(c(),r(t(v),{key:0,class:"ml-3",variant:"success"},{default:s(()=>[o(" Connected")]),_:1})):(c(),r(t(v),{key:1,class:"ml-3",variant:"destructive"},{default:s(()=>[o(" Not Connected")]),_:1}))])]),_:1}),a(t(g),{class:"w-full"}),a(t(b),{class:"py-2 pl-0"},{default:s(()=>[n("div",null,[a(t(d),null,{default:s(()=>[o("To connect to WhatsApp Business, click the "),R,o(" button. You will be taken to the Meta Business website to allow DebtCore to connect to your Organisation.")]),_:1}),a(t(d),null,{default:s(()=>[o("To disconnect from WhatsApp Business, click the "),U,o(" button. This button will only be displayed when a connection has been established.")]),_:1}),a(t(d),{class:"mt-4"},{default:s(()=>[o("When the connection requires authentication, click the "),j,o(" button. You will be taken to the QBO website to re-establish connection to your Organisation.")]),_:1}),a(t(d),{class:"mt-8"},{default:s(()=>[o("Whatsapp Business API "),q,o(".")]),_:1})])]),_:1})]),_:1})]),a(t(g),{class:"w-full"}),a(t(z),{class:"flex items-end justify-end mt-5"},{default:s(()=>[t(e).is_authenticated?(c(),r(t(k),{key:1,variant:"destructive",onClick:h[0]||(h[0]=()=>l())},{default:s(()=>[o(" Disconnect")]),_:1})):(c(),r(t(k),{key:0,variant:"default"},{default:s(()=>[n("a",{href:t(e).authenticate_url}," Connect to WhatsApp",8,F)]),_:1}))]),_:1})]),_:1}))}}}),Y={class:"p-8 space-y-8"},H=n("div",{class:"flex items-center justify-between space-y-2"},[n("div",null,[n("h2",{class:"text-2xl font-bold tracking-tight"},"Connections"),n("p",{class:"text-muted-foreground"},"Here's a list of your connected apps!")])],-1),J=_({__name:"Connections",setup(u){const e=N();E("Unknown");const{toast:i}=C();return $(()=>{const l=e.query.error;l&&i({title:"Authentication Failed!",description:l,variant:"destructive"})}),(l,B)=>(c(),x("div",Y,[H,n("div",null,[a(M)])]))}});export{J as default};
