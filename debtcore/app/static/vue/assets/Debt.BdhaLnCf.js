import{_ as Re,a as Ae,b as je,c as He,d as Ne,e as ke,u as ne,f as Le,g as Ee,h as Be,i as ye,j as de,k as Ye,l as Ke,m as We,n as Ge,o as qe,p as Qe,q as Xe,r as Oe,F as we,z as U,s as xe}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as j,r as B,o as d,c as v,d as i,t as x,a as e,k as a,u as t,F,v as R,s as C,b as m,x as te,l as b,Y as O,m as T,N as q,a4 as ae,a5 as me,a8 as se,a6 as pe,a7 as J,a9 as Z,Q,R as X,n as L,g as le,at as Je,y as Se,z as Ce,A as Ve,B as oe,E,i as S,I as re,K as De,H,U as _e,W as ge,X as ve,a3 as Me,_ as P,Z as he,C as Ze,D as ie,T as ue,ae as Ie,ar as Pe,as as ze,j as et,au as tt,av as at,aw as st,ax as lt,a0 as D,ay as $e,G as nt,a1 as ot,a2 as it}from"../main.js";import{_ as ee}from"./index.DhdF1qMN.js";import{_ as rt}from"./CommandSeparator.vue_vue_type_script_setup_true_lang.DZgg3MH5.js";import{_ as ct,a as dt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as be}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";import{_ as Fe}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.DOcqctDd.js";import{_ as Te}from"./lodash.BtnTHUG3.js";import{f as Ue}from"./index.BccI3ZLR.js";import{l as ut,A as ft}from"./index.EdlJKn0d.js";import"./index.5qndC0qu.js";const mt={class:"flex flex-col md:flex-row items-center justify-between px-2 pb-10"},pt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},_t={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},gt={class:"flex items-center space-x-2"},vt=i("p",{class:"text-sm font-medium"},"Rows per page",-1),ht={class:"flex w-[100px] items-center justify-center text-sm font-medium"},bt={class:"flex items-center space-x-2"},yt=i("span",{class:"sr-only"},"Go to first page",-1),wt=i("span",{class:"sr-only"},"Go to previous page",-1),xt=i("span",{class:"sr-only"},"Go to next page",-1),$t=i("span",{class:"sr-only"},"Go to last page",-1),kt=j({__name:"DataTablePagination",props:{table:{}},setup(r){return(n,l)=>{const s=B("VIcon");return d(),v("div",mt,[i("div",pt,x(n.table.getFilteredSelectedRowModel().rows.length)+" of "+x(n.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),i("div",_t,[i("div",gt,[vt,e(t(He),{"model-value":`${n.table.getState().pagination.pageSize}`,"onUpdate:modelValue":n.table.setPageSize},{default:a(()=>[e(t(Re),{class:"h-8 w-[70px]"},{default:a(()=>[e(t(Ae),{placeholder:`${n.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(t(je),{side:"top"},{default:a(()=>[(d(),v(F,null,R([10,20,30,40,50],c=>e(t(Ne),{key:c,value:`${c}`},{default:a(()=>[m(x(c),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),i("div",ht," Page "+x(n.table.getState().pagination.pageIndex+1)+" of "+x(n.table.getPageCount()),1),i("div",bt,[e(t(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanPreviousPage(),onClick:l[0]||(l[0]=c=>n.table.setPageIndex(0))},{default:a(()=>[yt,e(s,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanPreviousPage(),onClick:l[1]||(l[1]=c=>n.table.previousPage())},{default:a(()=>[wt,e(s,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanNextPage(),onClick:l[2]||(l[2]=c=>n.table.nextPage())},{default:a(()=>[xt,e(s,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanNextPage(),onClick:l[3]||(l[3]=c=>n.table.setPageIndex(n.table.getPageCount()-1))},{default:a(()=>[$t,e(s,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),fe=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claimed",icon:"fa-check-circle"},{value:"3",label:"Canceled",icon:"fa-times-circle"}],St={class:"hidden space-x-1 lg:flex"},Ct={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Vt=j({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(r){const n=r,l=te(()=>{var c;return(c=n.column)==null?void 0:c.getFacetedUniqueValues()}),s=te(()=>{var c;return new Set((c=n.column)==null?void 0:c.getFilterValue())});return(c,p)=>{const y=B("VIcon"),M=B("CheckIcon");return d(),b(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:a(()=>[e(y,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),m(" "+x(c.title)+" ",1),s.value.size>0?(d(),v(F,{key:0},[e(t(O),{orientation:"vertical",class:"mx-2 h-4"}),e(t(ee),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:a(()=>[m(x(s.value.size),1)]),_:1}),i("div",St,[s.value.size>2?(d(),b(t(ee),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x(s.value.size)+" selected ",1)]),_:1})):(d(!0),v(F,{key:1},R(c.options.filter($=>s.value.has($.value)),$=>(d(),b(t(ee),{key:$.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x($.label),1)]),_:2},1024))),128))])],64)):T("",!0)]),_:1})]),_:1}),e(t(Q),{class:"w-[200px] p-0",align:"start"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{placeholder:c.title},null,8,["placeholder"]),e(t(se),null,{default:a(()=>[e(t(pe),null,{default:a(()=>[m("No results found.")]),_:1}),e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.options,$=>(d(),b(t(Z),{key:$.value,value:$,onSelect:w=>{var k;s.value.has($.value)?s.value.delete($.value):s.value.add($.value);const V=Array.from(s.value);(k=c.column)==null||k.setFilterValue(V.length?V:void 0)}},{default:a(()=>{var w;return[i("div",{class:L(t(le)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",s.value.has($.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(M,{class:L(t(le)("h-4 w-4"))},null,8,["class"])],2),$.icon?(d(),b(Je($.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):T("",!0),i("span",null,x($.label),1),(w=l.value)!=null&&w.get($.value)?(d(),v("span",Ct,x(l.value.get($.value)),1)):T("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),s.value.size>0?(d(),v(F,{key:0},[e(t(rt)),e(t(J),null,{default:a(()=>[e(t(Z),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:p[0]||(p[0]=$=>{var w;return(w=c.column)==null?void 0:w.setFilterValue(void 0)})},{default:a(()=>[m(" Clear filters ")]),_:1})]),_:1})],64)):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Dt=j({__name:"DataTableViewOptions",props:{table:{}},setup(r){const n=r;console.log(n.table.getAllColumns());const l=te(()=>n.table.getAllColumns().filter(s=>typeof s.accessorFn<"u"&&s.getCanHide()));return console.log(l),(s,c)=>(d(),b(t(Ve),null,{default:a(()=>[e(t(Se),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:a(()=>[m(" View ")]),_:1})]),_:1}),e(t(Ce),{align:"end",class:"w-[150px]"},{default:a(()=>[e(t(ct),null,{default:a(()=>[m("Toggle columns")]),_:1}),e(t(ke)),(d(!0),v(F,null,R(l.value,p=>(d(),b(t(dt),{key:p.id,class:"capitalize",checked:p.getIsVisible(),"onUpdate:checked":y=>p.toggleVisibility(!!y)},{default:a(()=>{var y;return[m(x(((y=p.columnDef.meta)==null?void 0:y.title)||p.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),Mt={class:"grid gap-4 py-4"},It={class:"grid grid-cols-4 items-center gap-4"},Pt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),zt={class:"grid grid-cols-4 items-center gap-4"},Ft=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Tt={class:"col-span-3"},Ut={class:"grid grid-cols-4 items-center gap-4"},Rt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),At={class:"grid grid-cols-4 items-center gap-4"},jt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ht={class:"col-span-3"},Nt={class:"grid grid-cols-4 items-center gap-4"},Lt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Et={class:"grid grid-cols-4 items-center gap-4"},Bt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Yt={class:"col-span-3"},Kt={class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Wt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Gt={class:"col-span-3"},qt=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),Qt={key:0,class:"grid grid-cols-4 items-center gap-4"},Xt=j({__name:"DataTableCreateDebt",setup(r){const n=oe("tableStore",ne("debt")),l=E({invoice:"",customer:null,amount:null,invoice_date:null,term:7,status:null,document:null}),s=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),c=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=S("");async function y(_){s.is_loading=!0;try{const o=await H.get(`/api/customer/list?search=${_||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});s.data=o.data.Result}catch(o){console.error("There was an error fetching the select list:",o)}finally{s.is_loading=!1}}async function M(){s.is_loading=!0;try{const _=await H.get("/api/debt/status/create/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=_.data.Result,l.status=1}catch{V({title:"Whoops, something went wrong",description:"There was an error fetching the select list.",variant:"destructive"})}finally{c.is_loading=!1}}const $=S(!1),w=S(!1),h=S(null);S();const{toast:V}=re();De(p,Te.debounce(async _=>{w.value&&await y(_)},500));function k(){var o;const _=[{condition:l.invoice==="",message:"Invoice cannot be blank"},{condition:((o=l.invoice_date)==null?void 0:o.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let f of _)if(f.condition)return h.value=f.message,!1;return!0}async function I(){if(k()){$.value=!0;try{const o=await H.post("/api/debt",{...l},{headers:{"Content-Type":"multipart/form-data"}});A(),await n.refresh(n.page_index),V({title:o.data.Result,variant:"success"})}catch{V({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{$.value=!1}}}function A(){w.value=!w.value,w.value&&(y(p.value),M())}function G(_){l.customer=_.id,s.is_open=!1}function Y(_){l.status=_.id,c.is_open=!1}function K(_){var f;const o=_.target;if((f=o.files)!=null&&f.length){const u=o.files[0];if(u.type!=="application/pdf"){V({title:"Please select a PDF file",variant:"destructive"}),o.value="";return}if(u.size>5*1024*1024){V({title:"The file size must be under 5MB",variant:"destructive"}),o.value="";return}l.document=u}}function z(_){const o=new Date(_);l.invoice_date=Ue(o,"yyyy-MM-dd")}return(_,o)=>{const f=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 ml-2 flex",onClick:A},{default:a(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(t(he),{open:w.value,"onUpdate:open":o[7]||(o[7]=u=>w.value=u)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ge),null,{default:a(()=>[e(t(ve),null,{default:a(()=>[m("Create Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click create when you're done. ")]),_:1})]),_:1}),i("div",Mt,[i("div",It,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),Pt]),_:1}),e(t(N),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":o[0]||(o[0]=u=>l.invoice=u),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",zt,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),Ft]),_:1}),i("div",Tt,[e(t(X),{open:s.is_open,"onUpdate:open":o[2]||(o[2]=u=>s.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":s.is_open,class:"w-full justify-between px-3",disabled:s.is_loading},{default:a(()=>{var u;return[m(x(l.customer?(u=s.data.find(g=>g.id===l.customer))==null?void 0:u.label:"Select customer")+" ",1),s.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=u=>p.value=u),placeholder:"Search customer..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(s.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>G(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:L(["ml-auto h-4 w-4",l.customer===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",Ut,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),Rt]),_:1}),e(t(N),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":o[3]||(o[3]=u=>l.amount=u===""?null:u),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",At,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),jt]),_:1}),i("div",Ht,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",class:L(t(le)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(f,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),i("span",null,x(l.invoice_date?l.invoice_date:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Fe),{"onUpdate:modelValue":o[4]||(o[4]=u=>z(u)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Nt,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Lt]),_:1}),e(t(N),{id:"amount",modelValue:l.term,"onUpdate:modelValue":o[5]||(o[5]=u=>l.term=u),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Et,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status "),Bt]),_:1}),i("div",Yt,[e(t(X),{open:c.is_open,"onUpdate:open":o[6]||(o[6]=u=>c.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var u;return[m(x(l.status?(u=c.data.find(g=>g.id===l.status))==null?void 0:u.label:"Select status")+" ",1),c.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>Y(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:L(["ml-auto h-4 w-4",l.status===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(O),i("div",Kt,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment "),Wt]),_:1}),i("div",Gt,[e(t(N),{id:"name",type:"file",onChange:K,class:"col-span-3"})]),qt])]),e(O),h.value?(d(),v("div",Qt,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(h.value),1)]),_:1})])):T("",!0),e(t(be),{class:"flex justify-end"},{default:a(()=>[e(t(C),{type:"submit",onClick:I,disabled:$.value},{default:a(()=>[$.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ot={class:"flex items-center justify-between"},Jt={class:"flex flex-1 items-center space-x-2"},Zt=j({__name:"DataTableToolbar",props:{table:{}},setup(r){const n=r,l=te(()=>n.table.getState().columnFilters.length>0);return(s,c)=>{var p;return d(),v("div",Ot,[i("div",Jt,[e(t(N),{placeholder:"Search...","model-value":((p=s.table.getColumn("invoice"))==null?void 0:p.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:c[0]||(c[0]=y=>s.table.setGlobalFilter(y.target.value))},null,8,["model-value"]),s.table.getColumn("status")?(d(),b(Vt,{key:0,column:s.table.getColumn("status"),title:"Status",options:t(fe)},null,8,["column","options"])):T("",!0),l.value?(d(),b(t(C),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:c[1]||(c[1]=y=>s.table.resetColumnFilters())},{default:a(()=>[m(" Reset ")]),_:1})):T("",!0)]),e(Dt,{table:s.table},null,8,["table"]),e(Xt,{table:s.table},null,8,["table"])])}}}),ea={class:"space-y-4 text-muted-foreground"},ta={class:"rounded-md border"},aa=j({__name:"DataTable",props:{columns:{},data:{}},setup(r){const n=oe("tableStore",ne("debt")),l=r,s=S([]),c=S([]),p=S({}),y=S({pageIndex:n.page_index,pageSize:n.page_size}),M=S();function $(h,V){let k;typeof h=="function"?k=h(V.value):k=h,V.value=k,n.set_page_index(k.pageIndex),n.set_page_size(k.pageSize)}const w=Le({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return s.value},get columnFilters(){return c.value},get columnVisibility(){return p.value},get rowSelection(){return M.value},get pagination(){return y.value}},enableRowSelection:!0,onSortingChange:h=>ie(h,s),onPaginationChange:h=>$(h,y),onColumnFiltersChange:h=>ie(h,c),onColumnVisibilityChange:h=>ie(h,p),onRowSelectionChange:h=>ie(h,M),getCoreRowModel:Ke(),getFilteredRowModel:We(),getPaginationRowModel:Ge(),getSortedRowModel:qe(),getFacetedRowModel:Qe(),getFacetedUniqueValues:Xe()});return Ze(()=>{w.setPageIndex(n.page_index),w.setPageSize(n.page_size)}),(h,V)=>(d(),v("div",ea,[e(Zt,{table:t(w)},null,8,["table"]),i("div",ta,[e(t(Ye),{class:"text-xs"},{default:a(()=>[e(t(Ee),null,{default:a(()=>[(d(!0),v(F,null,R(t(w).getHeaderGroups(),k=>(d(),b(t(de),{key:k.id},{default:a(()=>[(d(!0),v(F,null,R(k.headers,I=>(d(),b(t(Oe),{key:I.id},{default:a(()=>[I.isPlaceholder?T("",!0):(d(),b(t(we),{key:0,render:I.column.columnDef.header,props:I.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(t(Be),{id:"dbTableBody"},{default:a(()=>{var k;return[(k=t(w).getRowModel().rows)!=null&&k.length?(d(!0),v(F,{key:0},R(t(w).getRowModel().rows,I=>(d(),b(t(de),{key:I.id,"data-state":I.getIsSelected()&&"selected"},{default:a(()=>[(d(!0),v(F,null,R(I.getVisibleCells(),A=>(d(),b(t(ye),{key:A.id},{default:a(()=>[e(t(we),{render:A.column.columnDef.cell,props:A.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),b(t(de),{key:1},{default:a(()=>[e(t(ye),{colspan:h.columns.length,class:"h-24 text-center"},{default:a(()=>[m(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(kt,{table:t(w)},null,8,["table"])]))}}),W=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(r){return(n,l)=>{const s=B("VIcon");return n.column.getCanSort()?(d(),v("div",{key:0,class:L(t(le)("flex items-center space-x-2",n.$attrs.class??""))},[e(t(Ve),null,{default:a(()=>[e(t(Se),{"as-child":""},{default:a(()=>[e(t(C),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:a(()=>[i("span",null,x(n.title),1),n.column.getIsSorted()==="desc"?(d(),b(s,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):n.column.getIsSorted()==="asc"?(d(),b(s,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(d(),b(s,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(t(Ce),{align:"start"},{default:a(()=>[e(t(ue),{onClick:l[0]||(l[0]=c=>n.column.toggleSorting(!1))},{default:a(()=>[e(s,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Asc ")]),_:1}),e(t(ue),{onClick:l[1]||(l[1]=c=>n.column.toggleSorting(!0))},{default:a(()=>[e(s,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Desc ")]),_:1}),e(t(ke)),e(t(ue),{onClick:l[2]||(l[2]=c=>n.column.toggleVisibility(!1))},{default:a(()=>[e(s,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(d(),v("div",{key:1,class:L(n.$attrs.class)},x(n.title),3))}}}),sa=U.object({id:U.number(),invoice:U.string(),customer_name:U.string().min(2).max(50),invoice_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),due_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),term:U.number(),amount:U.string(),document_url:U.string(),status:U.number(),editable:U.boolean()}),la={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},na={class:"col-span-3"},oa=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),ia={key:1},ra={class:"flex justify-center my-auto items-center place-items-center mb-2"},ca={class:"mx-2"},da={class:"flex justify-center my-auto items-center place-items-center"},ua=["src"],fa={key:0,class:"grid grid-cols-4 items-center gap-4"},ma=j({__name:"DataTableCheckAttachment",props:{row:{}},setup(r){const n=oe("tableStore",ne("debt")),l=r,s=E({document:null,document_url:l.row.document_url}),c=E({pdf:void 0,pages:void 0,info:void 0}),p=S(1),y=S(!1),M=S(!1),$=S(null),w=S(window.innerHeight-250),{toast:h}=re();function V(_){h({title:"PDF loading error",variant:"destructive"})}async function k(){try{y.value=!0;const _=await H.get(`/api/debt/${l.row.id}/document/`);s.document_url=_.data.Result.document_url;const o=ft(s.document_url,{onError:V});ze(()=>{c.pdf=o.pdf,c.pages=o.pages,c.info=o.info})}catch{Y(),h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}const I=()=>{const _=document.querySelector("#vp > div > div > div > canvas");if(_){const o=_.offsetHeight,f=window.innerHeight-250,u=680;f>o&&o<u?w.value=o:f>o?w.value=f:w.value=Math.min(Math.max(o,u),f)}};function A(){const _=[{condition:s.document==null,message:"Attachment cannot be blank"}];for(let o of _)if(o.condition)return $.value=o.message,!1;return!0}async function G(){if(A()){y.value=!0;try{const o=await H.patch(`/api/debt/${l.row.id}/document/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});K(),await n.refresh(n.page_index),h({title:o.data.Result,variant:"success"})}catch{h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function Y(){s.document_url=null}function K(){M.value=!M.value,M.value&&k()}function z(_){var f;const o=_.target;if((f=o.files)!=null&&f.length){const u=o.files[0];if(u.type!=="application/pdf"){h({title:"Please select a PDF file",variant:"destructive"}),o.value="";return}if(u.size>5*1024*1024){h({title:"The file size must be under 5MB",variant:"destructive"}),o.value="";return}s.document=u}}return(_,o)=>{const f=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:K},{default:a(()=>[e(f,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),e(t(he),{class:"my-2",open:M.value,"onUpdate:open":o[2]||(o[2]=u=>M.value=u)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-fit"},{default:a(()=>[e(t(ge),null,{default:a(()=>[e(t(ve),null,{default:a(()=>[m("Attachment Overview")]),_:1})]),_:1}),i("div",null,[s.document_url?s.document_url.endsWith(".pdf")?(d(),v("div",ia,[i("div",ra,[e(t(C),{variant:"secondary",onClick:o[0]||(o[0]=u=>p.value=p.value>1?p.value-1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),i("span",ca,x(p.value)+" / "+x(c.pages),1),e(t(C),{variant:"secondary",onClick:o[1]||(o[1]=u=>p.value=p.value<c.pages?p.value+1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),e(t(Ie),{class:"border border-primary md:w-[720px] w-full",style:Pe([{"overflow-y":"auto","overflow-x":"hidden"},{height:w.value+"px"}])},{default:a(()=>[e(t(ut),{pdf:c.pdf,page:p.value,"fit-parent":"",onLoaded:I,"annonation-layer":""},{default:a(()=>[i("div",da,[e(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(d(),v("img",{key:2,src:s.document_url,alt:"Document preview",class:"object-contain"},null,8,ua)):(d(),v("div",la,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment ")]),_:1}),i("div",na,[e(t(N),{id:"name",type:"file",onChange:z,class:"col-span-3"})]),oa]))]),e(t(O)),$.value?(d(),v("div",fa,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x($.value),1)]),_:1})])):T("",!0),e(t(be),{class:"flex justify-end"},{default:a(()=>[s.document_url?(d(),b(t(C),{key:0,class:"bg-red-600 text-white",onClick:Y,disabled:y.value},{default:a(()=>[m(" Replace")]),_:1},8,["disabled"])):(d(),b(t(C),{key:1,onClick:G,disabled:y.value},{default:a(()=>[y.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),pa={class:"grid gap-4 py-4"},_a={class:"grid grid-cols-4 items-center gap-4"},ga=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),va={class:"grid grid-cols-4 items-center gap-4"},ha=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ba={class:"col-span-3"},ya={class:"grid grid-cols-4 items-center gap-4"},wa=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),xa={class:"grid grid-cols-4 items-center gap-4"},$a=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ka={class:"col-span-3"},Sa={class:"grid grid-cols-4 items-center gap-4"},Ca=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Va={class:"grid grid-cols-4 items-center gap-4"},Da={class:"col-span-3"},Ma={key:0,class:"grid grid-cols-4 items-center gap-4"},Ia=j({__name:"DataTableEditModal",props:{row:{}},setup(r){const n=oe("tableStore",ne("debt")),l=r,s=E({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),c=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),y=S("");async function M(o){c.is_loading=!0;try{const f=await H.get(`/api/customer/list?search=${o||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=f.data.Result}catch{k({title:"Whoops, something went wrong",description:"There was an error fetching the select list",variant:"destructive"})}finally{c.is_loading=!1}}async function $(){c.is_loading=!0;try{const o=await H.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});p.data=o.data.Result}catch(o){console.error("There was an error fetching the select list:",o)}finally{p.is_loading=!1}}const w=S(!1),h=S(!1),V=S(null),{toast:k}=re();De(y,Te.debounce(async o=>{h.value&&await M(o)},500));async function I(){try{const o=await H.get(`/api/debt/${l.row.id}/`);Object.assign(s,o.data.Result)}catch(o){console.log(o)}finally{w.value=!1}}function A(){var f;const o=[{condition:s.invoice==null,message:"Invoice cannot be blank"},{condition:((f=s.invoice_date)==null?void 0:f.toString)==null,message:"Invoice Date cannot be blank"},{condition:s.status==null,message:"Status cannot be blank"},{condition:s.customer==null,message:"Customer cannot be blank"}];for(let u of o)if(u.condition)return V.value=u.message,!1;return!0}async function G(){if(A()){w.value=!0;try{const f=await H.patch(`/api/debt/${l.row.id}/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});Y(),await n.refresh(n.page_index),console.log("hello "+n.page_index),k({title:f.data.Result,variant:"success"})}catch{k({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{w.value=!1}}}function Y(){h.value=!h.value,h.value&&(I(),M(y.value),$())}function K(o){s.customer=o.id,c.is_open=!1}function z(o){s.status=o.id,p.is_open=!1}function _(o){const f=new Date(o);s.invoice_date=Ue(f,"yyyy-MM-dd")}return(o,f)=>{const u=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:Y},{default:a(()=>[e(u,{name:"fa-pen",class:"size-4"})]),_:1})]),e(t(he),{open:h.value,"onUpdate:open":f[7]||(f[7]=g=>h.value=g)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ge),null,{default:a(()=>[e(t(ve),null,{default:a(()=>[m("Edit Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),i("div",pa,[i("div",_a,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),ga]),_:1}),e(t(N),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":f[0]||(f[0]=g=>s.invoice=g),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",va,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),ha]),_:1}),i("div",ba,[e(t(X),{open:c.is_open,"onUpdate:open":f[2]||(f[2]=g=>c.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var g;return[m(x(s.customer?(g=c.data.find(ce=>ce.id===s.customer))==null?void 0:g.label:"Select customer")+" ",1),c.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:y.value,"onUpdate:modelValue":f[1]||(f[1]=g=>y.value=g),placeholder:"Search country..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>K(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:L(["ml-auto h-4 w-4",s.customer===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",ya,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),wa]),_:1}),e(t(N),{id:"amount",modelValue:s.amount===null?"":s.amount,"onUpdate:modelValue":f[3]||(f[3]=g=>s.amount=g===""?null:g),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",xa,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),$a]),_:1}),i("div",ka,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",class:L(t(le)("w-full justify-start text-left font-normal",!s.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(u,{name:"bi-calendar-fill",class:"mr-2 size-4"}),i("span",null,x(s.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Fe),{"onUpdate:modelValue":f[4]||(f[4]=g=>_(g)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Sa,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Ca]),_:1}),e(t(N),{id:"amount",modelValue:s.term,"onUpdate:modelValue":f[5]||(f[5]=g=>s.term=g),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Va,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status ")]),_:1}),i("div",Da,[e(t(X),{open:p.is_open,"onUpdate:open":f[6]||(f[6]=g=>p.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":p.is_open,class:"w-full justify-between px-3",disabled:p.is_loading},{default:a(()=>{var g;return[m(x(s.status?(g=p.data.find(ce=>ce.id===s.status))==null?void 0:g.label:"Select status")+" ",1),p.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(p.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>z(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:L(["ml-auto h-4 w-4",s.status===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),e(O),V.value?(d(),v("div",Ma,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(V.value),1)]),_:1})])):T("",!0),e(t(be),{class:"flex justify-end"},{default:a(()=>[e(t(C),{type:"submit",onClick:G,disabled:w.value},{default:a(()=>[w.value?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Pa={class:"pr-4"},za={class:"flex justify-between"},Fa={key:0,class:"text-primary font-bold flex place-items-center self-center"},Ta={key:1,class:"text-primary font-bold"},Ua={class:"text-primary"},Ra={class:"text-sm"},Aa={class:"flex mt-2 gap-2"},ja={class:"text-xs mt-2"},Ha=j({__name:"DataTableBacklog",props:{row:{}},setup(r){const n=et(),l=r,s=E({debt:l.row.id,message:""}),c=E([]),p=S(!1),y=S(!1),M=S(null),{toast:$}=re();var w=S(null),h=S(null),V=S(0),k=oe("height");async function I(){try{const z=await H.get(`/api/debt/${l.row.id}/backlog/`);c.splice(0,c.length,...z.data.Result),p.value=!1}catch{p.value=!1}}function A(){const z=[{condition:s.message=="",message:"Message cannot be blank"},{condition:s.message.length<5,message:"Maybe a little more context?"}];for(let _ of z)if(_.condition)return M.value=_.message,!1;return!0}async function G(){if(A()){p.value=!0;try{const _=await H.post(`/api/debt/${l.row.id}/backlog/`,{...s},{headers:{"Content-Type":"application/json"}});await I(),$({title:_.data.Result,variant:"success"}),s.message="",M.value=""}catch{$({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{p.value=!1}}}const Y=()=>{ze().then(()=>{var z,_;k&&(V.value=k.value-((((z=w.value)==null?void 0:z.clientHeight)||0)+(((_=h.value)==null?void 0:_.clientHeight)||0))-25)})};function K(){y.value=!y.value,y.value&&(I(),Y())}return(z,_)=>{const o=B("VIcon"),f=B("Label");return d(),v("div",null,[i("div",null,[e(t(C),{variant:"secondary",size:"sm",class:"h-8 flex border border-primary",onClick:K},{default:a(()=>[e(o,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),e(t(lt),{open:y.value,"onUpdate:open":_[1]||(_[1]=u=>y.value=u)},{default:a(()=>[e(t(tt),{class:"h-screen",side:"right"},{default:a(()=>[i("div",{ref_key:"headerElement",ref:w},[e(t(at),null,{default:a(()=>[e(t(st),null,{default:a(()=>[m("Backlog - "+x(l.row.invoice),1)]),_:1})]),_:1})],512),e(t(O),{class:"mt-2 mb-4 border-primary border"}),e(t(Ie),{class:"flex flex-col",style:Pe({height:t(V)+"px"})},{default:a(()=>[i("div",Pa,[(d(!0),v(F,null,R(c,(u,g)=>(d(),v("div",{key:g,class:"pr-4 my-2"},[i("div",za,[u.is_system_generated?(d(),v("div",Fa,[e(o,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),m(" System Generated ")])):(d(),v("div",Ta,x(u.created_by_name),1))]),i("div",null,[i("div",Ua,x(u.created_date),1),e(t(O),{variant:"default"}),i("div",null,x(u.message),1)])]))),128))])]),_:1},8,["style"]),i("div",{class:"flex flex-col",ref_key:"footerElement",ref:h},[M.value?(d(),b(f,{key:0,for:"error",class:"text-red-600 flex"},{default:a(()=>[e(o,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),i("p",Ra,x(M.value),1)]),_:1})):T("",!0),i("div",Aa,[e(t(N),{id:"message",modelValue:s.message,"onUpdate:modelValue":_[0]||(_[0]=u=>s.message=u),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),e(t(C),{type:"submit",onClick:G},{default:a(()=>[m(" Save ")]),_:1})]),i("p",ja,x(t(n).getUsername),1)],512)]),_:1})]),_:1},8,["open"])])}}}),Na={class:"flex gap-1"},La=j({__name:"DataTableRowActions",props:{row:{}},setup(r){const n=r,l=te(()=>sa.parse(n.row.original));return(s,c)=>(d(),v("div",Na,[l.value.editable?(d(),b(Ia,{key:0,row:l.value},null,8,["row"])):T("",!0),e(ma,{row:l.value},null,8,["row"]),e(Ha,{row:l.value},null,8,["row"])]))}}),Ea=[{id:"select",header:({table:r})=>D(xe,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":n=>r.toggleAllPageRowsSelected(!!n),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:r})=>D(xe,{checked:r.getIsSelected(),"onUpdate:checked":n=>r.toggleSelected(!!n),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:r})=>D(W,{column:r,title:"Invoice"}),cell:({row:r})=>{const n=fe.find(l=>l.value===r.original.status.toString());return n?D("div",{class:`w-20 font-bold ${n.label=="Canceled"?"line-through decoration-red-600":""}`},r.getValue("invoice")):null},enableSorting:!0,enableHiding:!0,filterFn:(r,n,l)=>{var p;const s=((p=r.getValue(n))==null?void 0:p.toString().toLowerCase())??"",c=l==null?void 0:l.toString().toLowerCase();return s.includes(c)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:r})=>D(W,{column:r,title:"Customer"}),cell:({row:r})=>D("div",{class:"w-fit"},r.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(r,n,l)=>{var p;const s=((p=r.getValue(n))==null?void 0:p.toString().toLowerCase())??"",c=l==null?void 0:l.toString().toLowerCase();return s.includes(c)},meta:{title:"Customer"}},{accessorKey:"invoice_date",header:({column:r})=>D(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const n=r.getValue("invoice_date");let l="";if(n){const s=new Date(Date.parse(n));isNaN(s.getTime())?l="Not Provided":l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:r})=>D(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const n=r.getValue("due_date");let l="";if(n){const s=new Date(n);isNaN(s.getTime())?l="Not Provided":l=s.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"term",header:({column:r})=>D(W,{column:r,title:"Term"}),cell:({row:r})=>D("div",{class:"w-fit"},r.getValue("term")),enableHiding:!0,meta:{title:"Term"}},{accessorKey:"amount",header:({column:r})=>D(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>D(ee,{variant:"destructive"},"RM "+r.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:r})=>D(W,{column:r,title:"Attachment"}),cell:({row:r})=>{const n=r.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return D($e,{name:n.icon,class:`${n.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:r})=>D(W,{column:r,title:"Status"}),cell:({row:r})=>{const n=fe.find(l=>l.value===r.original.status.toString());return n?D(ee,{variant:"secondary",class:"inline items-center whitespace-nowrap"},[n.icon&&D($e,{name:n.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),D("span",n.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(r,n,l)=>{const s=r.getValue(n);if(!s)return!1;const c=s.toString().toLowerCase();return l.some(y=>c.includes(y.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:r})=>D(La,{row:r})}],Ba={class:"p-4 md:p-8 space-y-8 h-full"},Ya=i("div",{class:"flex items-center justify-between space-y-2"},[i("div",null,[i("h2",{class:"text-2xl font-bold tracking-tight"},"Debt"),i("p",{class:"text-muted-foreground"},"Here's a list of your existing debts!")])],-1),Ka={key:0,class:"text-center"},Wa={key:1},Ga="/api/debt",os=j({__name:"Debt",setup(r){const n=ne("debt"),l=s=>({id:s.id,status:s.status,invoice:s.invoice,customer_name:s.customer_name,invoice_date:new Date(s.invoice_date),due_date:new Date(s.due_date),term:s.term,amount:s.amount,document_url:s.document_url,editable:s.editable});return nt(async()=>{await n.fetch(Ga,0,l)}),it("tableStore",n),console.log(n),ot(()=>{n.$reset()}),(s,c)=>{const p=B("VIcon");return d(),v("div",Ba,[Ya,t(n).is_loading?(d(),v("div",Ka,[e(p,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(d(),v("div",Wa,[e(aa,{data:t(n).tasks,columns:t(Ea)},null,8,["data","columns"])]))])}}});export{os as default};
