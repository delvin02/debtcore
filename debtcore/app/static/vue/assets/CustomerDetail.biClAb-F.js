import{_ as Ke,a as We,b as Ye,c as Ge,d as Qe,e as ze,u as te,f as Xe,g as Ze,h as Je,i as Ce,j as be,k as et,l as tt,m as at,n as st,o as lt,p as nt,q as ot,r as it,F as Ve,z as j,s as De}from"./Checkbox.vue_vue_type_script_setup_true_lang.0dpU0WqK.js";import{e as F,o as u,c as g,f as rt,n as W,u as s,g as _e,r as H,d as c,t as v,a as t,k as o,F as P,v as E,s as S,b as p,x as G,l as x,Y as ee,m as A,N as ie,a4 as we,a5 as Me,a8 as xe,a6 as Pe,a7 as ue,a9 as me,Q as re,R as ce,at as ct,y as Te,z as je,A as Ae,i as D,B as pe,C as dt,D as ae,E as O,G as $e,H as L,T as ye,I as ke,U as Ue,W as He,X as Ee,_ as B,ae as Le,ar as ut,Z as Ne,as as mt,K as ft,a3 as _t,j as pt,au as gt,av as vt,aw as ht,ax as bt,a0 as C,ay as Ie,a1 as yt,az as wt,a2 as xt}from"../main.js";import{_ as Z}from"./index.DhdF1qMN.js";import{_ as $t}from"./CommandSeparator.vue_vue_type_script_setup_true_lang.CXBSyJqZ.js";import{_ as kt,a as St}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.H-PZVEjJ.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang.-kCyUBhQ.js";import{_ as se,a as le,b as ne}from"./CardDescription.vue_vue_type_script_setup_true_lang.nuAmEoIx.js";import{_ as oe}from"./CardContent.vue_vue_type_script_setup_true_lang.D46BGtUZ.js";import{_ as Be}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as Ct}from"./lodash.BtnTHUG3.js";import{l as Vt,A as Dt}from"./index.BNcAqlD7.js";import{_ as It}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.Dvo5YOt3.js";import{f as Rt}from"./index.BccI3ZLR.js";import"./index.5qndC0qu.js";const Ft=F({__name:"SheetFooter",props:{class:{}},setup(a){const e=a;return(l,n)=>(u(),g("div",{class:W(s(_e)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",e.class))},[rt(l.$slots,"default")],2))}}),zt={class:"flex flex-col items-center justify-between px-2 pb-10"},Mt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},Pt={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Tt={class:"flex items-center space-x-2"},jt=c("p",{class:"text-sm font-medium"},"Rows per page",-1),At={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Ut={class:"flex items-center space-x-2"},Ht=c("span",{class:"sr-only"},"Go to first page",-1),Et=c("span",{class:"sr-only"},"Go to previous page",-1),Lt=c("span",{class:"sr-only"},"Go to next page",-1),Nt=c("span",{class:"sr-only"},"Go to last page",-1),Bt=F({__name:"DataTablePagination",props:{table:{}},setup(a){return(e,l)=>{const n=H("VIcon");return u(),g("div",zt,[c("div",Mt,v(e.table.getFilteredSelectedRowModel().rows.length)+" of "+v(e.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),c("div",Pt,[c("div",Tt,[jt,t(s(Ge),{"model-value":`${e.table.getState().pagination.pageSize}`,"onUpdate:modelValue":e.table.setPageSize},{default:o(()=>[t(s(Ke),{class:"h-8 w-[70px]"},{default:o(()=>[t(s(We),{placeholder:`${e.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),t(s(Ye),{side:"top"},{default:o(()=>[(u(),g(P,null,E([10,20,30,40,50],r=>t(s(Qe),{key:r,value:`${r}`},{default:o(()=>[p(v(r),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),c("div",At," Page "+v(e.table.getState().pagination.pageIndex+1)+" of "+v(e.table.getPageCount()),1),c("div",Ut,[t(s(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!e.table.getCanPreviousPage(),onClick:l[0]||(l[0]=r=>e.table.setPageIndex(0))},{default:o(()=>[Ht,t(n,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!e.table.getCanPreviousPage(),onClick:l[1]||(l[1]=r=>e.table.previousPage())},{default:o(()=>[Et,t(n,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!e.table.getCanNextPage(),onClick:l[2]||(l[2]=r=>e.table.nextPage())},{default:o(()=>[Lt,t(n,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!e.table.getCanNextPage(),onClick:l[3]||(l[3]=r=>e.table.setPageIndex(e.table.getPageCount()-1))},{default:o(()=>[Nt,t(n,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),fe=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claimed",icon:"fa-check-circle"},{value:"3",label:"Canceled",icon:"fa-times-circle"}],Ot={class:"hidden space-x-1 lg:flex"},qt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Kt=F({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(a){const e=a,l=G(()=>{var i;return(i=e.column)==null?void 0:i.getFacetedUniqueValues()}),n=G(()=>{var i;return new Set((i=e.column)==null?void 0:i.getFilterValue())}),r=i=>{var f;n.value.has(i)?n.value.delete(i):n.value.add(i);const h=Array.from(n.value);(f=e.column)==null||f.setFilterValue(h.length?h:void 0)};return(i,d)=>{const h=H("VIcon");return u(),x(s(ce),null,{default:o(()=>[t(s(ie),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:o(()=>[t(h,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),p(" "+v(i.title)+" ",1),n.value.size>0?(u(),g(P,{key:0},[t(s(ee),{orientation:"vertical",class:"mx-2 h-4"}),t(s(Z),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:o(()=>[p(v(n.value.size),1)]),_:1}),c("div",Ot,[n.value.size>2?(u(),x(s(Z),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(v(n.value.size)+" selected ",1)]),_:1})):(u(!0),g(P,{key:1},E(i.options.filter(f=>n.value.has(f.value)),f=>(u(),x(s(Z),{key:f.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(v(f.label),1)]),_:2},1024))),128))])],64)):A("",!0)]),_:1})]),_:1}),t(s(re),{class:"w-[200px] p-0",align:"start"},{default:o(()=>[t(s(we),null,{default:o(()=>[t(s(Me),{placeholder:i.title},null,8,["placeholder"]),t(s(xe),null,{default:o(()=>[t(s(Pe),null,{default:o(()=>[p("No results found.")]),_:1}),t(s(ue),null,{default:o(()=>[(u(!0),g(P,null,E(i.options,f=>(u(),x(s(me),{key:f.value,value:f,onSelect:()=>r(f.value)},{default:o(()=>{var b;return[c("div",{class:W(s(_e)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n.value.has(f.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[t(h,{name:"fa-check",class:"h-4 w-4"})],2),f.icon?(u(),x(ct(f.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):A("",!0),c("span",null,v(f.label),1),(b=l.value)!=null&&b.get(f.value)?(u(),g("span",qt,v(l.value.get(f.value)),1)):A("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),n.value.size>0?(u(),g(P,{key:0},[t(s($t)),t(s(ue),null,{default:o(()=>[t(s(me),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:d[0]||(d[0]=()=>{var f;return(f=e.column)==null?void 0:f.setFilterValue(void 0)})},{default:o(()=>[p(" Clear filters ")]),_:1})]),_:1})],64)):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Wt=F({__name:"DataTableViewOptions",props:{table:{}},setup(a){const e=a,l=G(()=>e.table.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()));return(n,r)=>(u(),x(s(Ae),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:o(()=>[p(" View ")]),_:1})]),_:1}),t(s(je),{align:"end",class:"w-[150px]"},{default:o(()=>[t(s(kt),null,{default:o(()=>[p("Toggle columns")]),_:1}),t(s(ze)),(u(!0),g(P,null,E(l.value,i=>(u(),x(s(St),{key:i.id,class:"capitalize",checked:i.getIsVisible(),"onUpdate:checked":d=>i.toggleVisibility(!!d)},{default:o(()=>{var d;return[p(v(((d=i.columnDef.meta)==null?void 0:d.title)||i.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}});var Yt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Gt=`\r
`,Qt="\uFEFF",ge=a=>Object.assign({},Yt,a);class Xt extends Error{constructor(e){super(e),this.name="CsvGenerationError"}}class Zt extends Error{constructor(e){super(e),this.name="EmptyHeadersError"}}class Jt extends Error{constructor(e){super(e),this.name="CsvDownloadEnvironmentError"}}class ea extends Error{constructor(e){super(e),this.name="UnsupportedDataFormatError"}}var X=a=>a,U=a=>a,J=X,ve=X,Q=X,Re=X,Fe=X,ta=function(a,e){return e=='"'&&a.indexOf('"')>-1?a.replace(/"/g,'""'):a},aa=a=>Re(typeof a=="object"?a.key:a),sa=a=>Fe(typeof a=="object"?a.displayLabel:a),la=(a,...e)=>e.reduce((l,n)=>n(l),a),na=a=>e=>a.useBom?ve(U(e)+Qt):e,oa=a=>e=>a.showTitle?Se(ve(U(e)+a.title))(Q("")):e,Se=a=>e=>ve(U(a)+U(e)+Gt),Oe=a=>(e,l)=>ia(a)(Q(U(e)+U(l))),ia=a=>e=>X(U(e)+a.fieldSeparator),ra=(a,e)=>l=>{if(!a.showColumnHeaders)return l;if(e.length<1)throw new Zt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let n=Q("");for(let r=0;r<e.length;r++){const i=sa(e[r]);n=Oe(a)(n,qe(a,U(i)))}return n=Q(U(n).slice(0,-1)),Se(l)(n)},ca=(a,e,l)=>n=>{let r=n;for(var i=0;i<l.length;i++){let d=Q("");for(let h=0;h<e.length;h++){const f=aa(e[h]),b=l[i][U(f)];d=Oe(a)(d,qe(a,b))}d=Q(U(d).slice(0,-1)),r=Se(r)(d)}return r},da=a=>+a===a&&(!isFinite(a)||!!(a%1)),ua=(a,e)=>{if(da(e)){if(a.decimalSeparator==="locale")return J(e.toLocaleString());if(a.decimalSeparator)return J(e.toString().replace(".",a.decimalSeparator))}return J(e.toString())},de=(a,e)=>{let l=e;return(a.quoteStrings||a.fieldSeparator&&e.indexOf(a.fieldSeparator)>-1||a.quoteCharacter&&e.indexOf(a.quoteCharacter)>-1||e.indexOf(`
`)>-1||e.indexOf("\r")>-1)&&(l=a.quoteCharacter+ta(e,a.quoteCharacter)+a.quoteCharacter),J(l)},ma=(a,e)=>{const l=e?"true":"false";return J(a.boolDisplay[l])},fa=(a,e)=>typeof e>"u"&&a.replaceUndefinedWith!==void 0?de(a,a.replaceUndefinedWith+""):e===null?de(a,"null"):de(a,""),qe=(a,e)=>{if(typeof e=="number")return ua(a,e);if(typeof e=="string")return de(a,e);if(typeof e=="boolean"&&a.boolDisplay)return ma(a,e);if(e===null||typeof e>"u")return fa(a,e);throw new ea(`
    typeof ${typeof e} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},_a=a=>e=>{const l=ge(a),n=l.useKeysAsHeaders?Object.keys(e[0]):l.columnHeaders;let r=la(ve(""),na(l),oa(l),ra(l,n),ca(l,n,e));if(U(r).length<1)throw new Xt("Output is empty. Is your data formatted correctly?");return r},pa=a=>e=>{const l=ge(a),n=U(e),r=l.useTextFile?"plain":"csv";return new Blob([n],{type:`text/${r};charset=utf8;`})},ga=a=>e=>{if(!window)throw new Jt("Downloading only supported in a browser environment.");const l=pa(a)(e),n=ge(a),r=n.useTextFile?"txt":"csv",i=`${n.filename}.${r}`,d=document.createElement("a");d.download=i,d.href=URL.createObjectURL(l),d.setAttribute("visibility","hidden"),document.body.appendChild(d),d.click(),document.body.removeChild(d)};const va=F({__name:"DataTableExportReport",props:{table:{}},setup(a){const e=a,l=D(!1),n=ge({fieldSeparator:",",filename:"report",decimalSeparator:".",useKeysAsHeaders:!0}),r=d=>d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),i=()=>{l.value=!0;const h=e.table.getFilteredRowModel().rows.map(b=>{var R;const w=b.getValue("invoice"),T=r(b.getValue("invoice_date")),I=r(b.getValue("due_date")),V=b.getValue("overdue")+" day(s)",$="RM "+b.getValue("amount"),z=`=HYPERLINK("${window.location.origin}${b.getValue("document_url")}", "Click Link Here")`,N=(R=fe.find(q=>q.value===b.original.status.toString()))==null?void 0:R.label;return{invoice:w,invoice_date:T,due_date:I,overdue:V,amount:$,attachment:z,status:N}}),f=_a(n)(h);ga(n)(f),l.value=!1};return(d,h)=>{const f=H("VIcon");return u(),g("div",null,[t(s(S),{variant:"secondary",size:"sm",class:"flex h-8 ml-2",onClick:i},{default:o(()=>[l.value?(u(),x(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-4"})):(u(),x(f,{key:1,name:"fa-download",class:"size-4"}))]),_:1})])}}}),ha=F({__name:"DataTableRefreshButton",setup(a){const e=pe("tableStore",te("customer_detail")),l=()=>{e.refresh(e.page_index)};return(n,r)=>{const i=H("VIcon");return u(),g("div",null,[t(s(S),{variant:"outline",size:"default",class:"flex h-8 ml-2",onClick:l},{default:o(()=>[t(i,{name:"md-refresh",class:"size-4"})]),_:1})])}}}),ba={class:"flex items-center justify-between"},ya={class:"flex flex-1 items-center space-x-2"},wa=F({__name:"DataTableToolbar",props:{table:{}},setup(a){const e=a,l=G(()=>e.table.getState().columnFilters.length>0);return(n,r)=>{var i;return u(),g("div",ba,[c("div",ya,[t(s(Y),{placeholder:"Search...","model-value":((i=n.table.getColumn("invoice"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:r[0]||(r[0]=d=>n.table.setGlobalFilter(d.target.value))},null,8,["model-value"]),n.table.getColumn("status")?(u(),x(Kt,{key:0,column:n.table.getColumn("status"),title:"Status",options:s(fe)},null,8,["column","options"])):A("",!0),l.value?(u(),x(s(S),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:r[1]||(r[1]=d=>n.table.resetColumnFilters())},{default:o(()=>[p(" Reset ")]),_:1})):A("",!0)]),t(Wt,{table:n.table},null,8,["table"]),t(ha),t(va,{table:n.table},null,8,["table"])])}}}),xa={class:"space-y-4 text-muted-foreground"},$a={key:0,class:"text-center"},ka={key:1,class:"rounded-md border"},Sa=F({__name:"DataTable",props:{columns:{},data:{}},setup(a){const e=pe("tableStore",te("customer_detail")),l=a,n=D([]),r=D([]),i=D({}),d=D({pageIndex:e.page_index,pageSize:e.page_size}),h=D();function f(w,T){let I;typeof w=="function"?I=w(T.value):I=w,T.value=I,e.set_page_index(I.pageIndex),e.set_page_size(I.pageSize)}const b=Xe({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return n.value},get columnFilters(){return r.value},get columnVisibility(){return i.value},get rowSelection(){return h.value},get pagination(){return d.value}},enableRowSelection:!0,onSortingChange:w=>ae(w,n),onPaginationChange:w=>f(w,d),onColumnFiltersChange:w=>ae(w,r),onColumnVisibilityChange:w=>ae(w,i),onRowSelectionChange:w=>ae(w,h),getCoreRowModel:tt(),getFilteredRowModel:at(),getPaginationRowModel:st(),getSortedRowModel:lt(),getFacetedRowModel:nt(),getFacetedUniqueValues:ot()});return dt(()=>{b.setPageIndex(e.page_index),b.setPageSize(e.page_size)}),(w,T)=>{const I=H("VIcon");return u(),g("div",xa,[t(wa,{table:s(b)},null,8,["table"]),s(e).is_loading?(u(),g("div",$a,[t(I,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(u(),g("div",ka,[t(s(et),{class:"text-xs"},{default:o(()=>[t(s(Ze),null,{default:o(()=>[(u(!0),g(P,null,E(s(b).getHeaderGroups(),V=>(u(),x(s(be),{key:V.id},{default:o(()=>[(u(!0),g(P,null,E(V.headers,$=>(u(),x(s(it),{key:$.id},{default:o(()=>[$.isPlaceholder?A("",!0):(u(),x(s(Ve),{key:0,render:$.column.columnDef.header,props:$.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(s(Je),{id:"dbTableBody"},{default:o(()=>{var V;return[(V=s(b).getRowModel().rows)!=null&&V.length?(u(!0),g(P,{key:0},E(s(b).getRowModel().rows,$=>(u(),x(s(be),{key:$.id,"data-state":$.getIsSelected()&&"selected"},{default:o(()=>[(u(!0),g(P,null,E($.getVisibleCells(),z=>(u(),x(s(Ce),{key:z.id},{default:o(()=>[t(s(Ve),{render:z.column.columnDef.cell,props:z.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),x(s(be),{key:1},{default:o(()=>[t(s(Ce),{colspan:w.columns.length,class:"h-24 text-center"},{default:o(()=>[p(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})])),t(Bt,{table:s(b)},null,8,["table"])])}}}),Ca={class:"grid grid-cols-2 md:grid-cols-4 mb-2 gap-4"},Va={class:"text-2xl font-bold"},Da={class:"text-2xl font-bold"},Ia={class:"text-2xl font-bold"},Ra={class:"text-2xl font-bold"},Fa=F({__name:"CustomerDetailCard",props:{customer_id:{}},setup(a){const e=a,l=O({all_time_revenue:0,outstanding_debt_amount:0,overdue_amount:"0.00",total_invoices:"0.00"}),n=`/api/customer/${e.customer_id}/debt/card`,r=async()=>{try{const i=await L.get(n);Object.assign(l,i.data.Result)}catch(i){console.log(i)}};return $e(()=>{r()}),(i,d)=>(u(),g("div",null,[c("div",Ca,[c("div",null,[t(s(ne),null,{default:o(()=>[t(s(se),null,{default:o(()=>[t(s(le),null,{default:o(()=>[p("All Time Revenue")]),_:1})]),_:1}),t(s(oe),null,{default:o(()=>[c("div",Va,[c("h1",null,"RM "+v(l.all_time_revenue),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(se),null,{default:o(()=>[t(s(le),null,{default:o(()=>[p("Outstanding Debt Amount")]),_:1})]),_:1}),t(s(oe),null,{default:o(()=>[c("div",Da,[c("h1",null,"RM "+v(l.outstanding_debt_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(se),null,{default:o(()=>[t(s(le),null,{default:o(()=>[p("Overdue Amount")]),_:1})]),_:1}),t(s(oe),null,{default:o(()=>[c("div",Ia,[c("h1",null,"RM "+v(l.overdue_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(se),null,{default:o(()=>[t(s(le),null,{default:o(()=>[p("Total Invoices")]),_:1})]),_:1}),t(s(oe),null,{default:o(()=>[c("div",Ra,[c("h1",null,v(l.total_invoices),1)])]),_:1})]),_:1})])])]))}}),za={class:"p-4 bg-secondary"},Ma={class:"text-3xl font-bold tracking-tight mt-2 mb-4"},Pa={class:"flex justify-items-center place-items-center items-center"},Ta={class:"text-muted-foreground ml-2 place-self-center"},ja={class:"flex justify-items-center place-items-center items-center"},Aa={class:"text-muted-foreground ml-2 place-self-center"},Ua={class:"flex justify-items-center place-items-center items-center"},Ha={class:"text-muted-foreground ml-2 place-self-center"},Ea=F({__name:"CustomerDetailInfo",props:{customer_id:{}},setup(a){const e=a,l=O({name:"",whatsapp_phone_number:"",streetAddress:"",city:"",state:"",postcode:"",country_name:""}),n=`/api/customer/${e.customer_id}/`,r=async()=>{try{const d=await L.get(n);Object.assign(l,d.data.Result)}catch(d){console.log(d)}};var i=G(()=>{const h=[l.streetAddress,l.city,l.state,l.postcode].filter(f=>f);return h.length?h.join(", "):""});return $e(()=>{r()}),(d,h)=>{const f=H("VIcon");return u(),g("div",za,[c("h2",Ma,v(l.name),1),c("div",Pa,[t(f,{name:"fa-phone-alt",class:"w-4 h-4"}),c("p",Ta,v(l.whatsapp_phone_number.replace(/(\d{3})(\d{4})(\d{4})/,"$1 $2 $3")),1)]),c("div",ja,[t(f,{name:"fa-address-book",class:"w-4 h-4"}),c("p",Aa,v(s(i)),1)]),c("div",Ua,[t(f,{name:"fa-map-pin",class:"w-4 h-4"}),c("p",Ha,v(l.country_name),1)])])}}}),K=F({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(a){return(e,l)=>{const n=H("VIcon");return e.column.getCanSort()?(u(),g("div",{key:0,class:W(s(_e)("flex items-center space-x-2",e.$attrs.class??""))},[t(s(Ae),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(S),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[c("span",null,v(e.title),1),e.column.getIsSorted()==="desc"?(u(),x(n,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):e.column.getIsSorted()==="asc"?(u(),x(n,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(u(),x(n,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),t(s(je),{align:"start"},{default:o(()=>[t(s(ye),{onClick:l[0]||(l[0]=r=>e.column.toggleSorting(!1))},{default:o(()=>[t(n,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Asc ")]),_:1}),t(s(ye),{onClick:l[1]||(l[1]=r=>e.column.toggleSorting(!0))},{default:o(()=>[t(n,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Desc ")]),_:1}),t(s(ze)),t(s(ye),{onClick:l[2]||(l[2]=r=>e.column.toggleVisibility(!1))},{default:o(()=>[t(n,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(u(),g("div",{key:1,class:W(e.$attrs.class)},v(e.title),3))}}}),La=j.object({id:j.number(),invoice:j.string(),invoice_date:j.preprocess(a=>typeof a=="string"?new Date(a):a,j.date()),due_date:j.preprocess(a=>typeof a=="string"?new Date(a):a,j.date()),term:j.number(),overdue:j.number(),amount:j.string(),document_url:j.string(),status:j.number(),editable:j.boolean()}),Na={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Ba={class:"col-span-3"},Oa=c("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[p(" Accepted Type: "),c("b",null,"PDF"),p(" (MAX. 5MB) ")],-1),qa={key:1},Ka={class:"flex justify-center my-auto items-center place-items-center mb-2"},Wa={class:"mx-2"},Ya={class:"flex justify-center my-auto items-center place-items-center"},Ga=["src"],Qa={key:0,class:"grid grid-cols-4 items-center gap-4"},Xa=F({__name:"DataTableCheckAttachment",props:{row:{}},setup(a){const e=pe("tableStore",te("customer_detail")),l=a,n=O({document:null,document_url:l.row.document_url}),r=O({pdf:void 0,pages:void 0,info:void 0}),i=D(1),d=D(!1),h=D(!1),f=D(null),b=D(window.innerHeight-250),{toast:w}=ke();function T(M){w({title:"PDF loading error",variant:"destructive"})}async function I(){try{d.value=!0;const M=await L.get(`/api/debt/${l.row.id}/document/`);n.document_url=M.data.Result.document_url;const m=Dt(n.document_url,{onError:T});mt(()=>{r.pdf=m.pdf,r.pages=m.pages,r.info=m.info})}catch{N(),w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}const V=()=>{const M=document.querySelector("#vp > div > div > div > canvas");if(M){const m=M.offsetHeight,_=window.innerHeight-250,k=680;_>m&&m<k?b.value=m:_>m?b.value=_:b.value=Math.min(Math.max(m,k),_)}};function $(){const M=[{condition:n.document==null,message:"Attachment cannot be blank"}];for(let m of M)if(m.condition)return f.value=m.message,!1;return!0}async function z(){if($()){d.value=!0;try{const m=await L.patch(`/api/debt/${l.row.id}/document/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});R(),await e.refresh(e.page_index),w({title:m.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}}function N(){n.document_url=null}function R(){h.value=!h.value,h.value&&I()}function q(M){var _;const m=M.target;if((_=m.files)!=null&&_.length){const k=m.files[0];if(k.type!=="application/pdf"){w({title:"Please select a PDF file",variant:"destructive"}),m.value="";return}if(k.size>5*1024*1024){w({title:"The file size must be under 5MB",variant:"destructive"}),m.value="";return}n.document=k}}return(M,m)=>{const _=H("VIcon");return u(),g("div",null,[c("div",null,[t(s(S),{variant:"default",size:"sm",class:"h-8 flex",onClick:R},{default:o(()=>[t(_,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),t(s(Ne),{class:"my-2",open:h.value,"onUpdate:open":m[2]||(m[2]=k=>h.value=k)},{default:o(()=>[t(s(Ue),{isSideBar:!1,class:"sm:max-w-fit"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Ee),null,{default:o(()=>[p("Attachment Overview")]),_:1})]),_:1}),c("div",null,[n.document_url?n.document_url.endsWith(".pdf")?(u(),g("div",qa,[c("div",Ka,[t(s(S),{variant:"secondary",onClick:m[0]||(m[0]=k=>i.value=i.value>1?i.value-1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),c("span",Wa,v(i.value)+" / "+v(r.pages),1),t(s(S),{variant:"secondary",onClick:m[1]||(m[1]=k=>i.value=i.value<r.pages?i.value+1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),t(s(Le),{class:"border border-primary md:w-[720px] w-full",style:ut([{"overflow-y":"auto","overflow-x":"hidden"},{height:b.value+"px"}])},{default:o(()=>[t(s(Vt),{pdf:r.pdf,page:i.value,"fit-parent":"",onLoaded:V,"annonation-layer":""},{default:o(()=>[c("div",Ya,[t(_,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(u(),g("img",{key:2,src:n.document_url,alt:"Document preview",class:"object-contain"},null,8,Ga)):(u(),g("div",Na,[t(s(B),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Attachment ")]),_:1}),c("div",Ba,[t(s(Y),{id:"name",type:"file",onChange:q,class:"col-span-3"})]),Oa]))]),t(s(ee)),f.value?(u(),g("div",Qa,[t(s(B),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+v(f.value),1)]),_:1})])):A("",!0),t(s(Be),{class:"flex justify-end"},{default:o(()=>[n.document_url?(u(),x(s(S),{key:0,class:"bg-red-600 text-white",onClick:N,disabled:d.value},{default:o(()=>[p(" Replace")]),_:1},8,["disabled"])):(u(),x(s(S),{key:1,onClick:z,disabled:d.value},{default:o(()=>[d.value?(u(),x(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):A("",!0),p(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Za={class:"grid gap-4 py-4"},Ja={class:"grid grid-cols-4 items-center gap-4"},es=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ts={class:"grid grid-cols-4 items-center gap-4"},as=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ss={class:"col-span-3"},ls={class:"grid grid-cols-4 items-center gap-4"},ns=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),os={class:"grid grid-cols-4 items-center gap-4"},is=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),rs={class:"col-span-3"},cs={class:"grid grid-cols-4 items-center gap-4"},ds=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),us={class:"grid grid-cols-4 items-center gap-4"},ms={class:"col-span-3"},fs={key:0,class:"grid grid-cols-4 items-center gap-4"},_s=F({__name:"DataTableEditModal",props:{row:{}},setup(a){const e=pe("tableStore",te("customer_detail")),l=a,n=O({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),r=O({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),i=O({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=D("");async function h(m){r.is_loading=!0;try{const _=await L.get(`/api/customer/list?search=${m||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{r.is_loading=!1}}async function f(){r.is_loading=!0;try{const m=await L.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=m.data.Result}catch(m){console.error("There was an error fetching the select list:",m)}finally{i.is_loading=!1}}const b=D(!1),w=D(!1),T=D(null),{toast:I}=ke();ft(d,Ct.debounce(async m=>{w.value&&await h(m)},500));async function V(){try{const m=await L.get(`/api/debt/${l.row.id}/`);Object.assign(n,m.data.Result)}catch(m){console.log(m)}finally{b.value=!1}}function $(){var _;const m=[{condition:n.invoice==null,message:"Invoice cannot be blank"},{condition:((_=n.invoice_date)==null?void 0:_.toString)==null,message:"Invoice Date cannot be blank"},{condition:n.status==null,message:"Status cannot be blank"},{condition:n.customer==null,message:"Customer cannot be blank"}];for(let k of m)if(k.condition)return T.value=k.message,!1;return!0}async function z(){if($()){b.value=!0;try{const _=await L.patch(`/api/debt/${l.row.id}/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});N(),await e.refresh(e.page_index),I({title:_.data.Result,variant:"success"})}catch{I({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{b.value=!1}}}function N(){w.value=!w.value,w.value&&(V(),h(d.value),f())}function R(m){n.customer=m.id,r.is_open=!1}function q(m){n.status=m.id,i.is_open=!1}function M(m){const _=new Date(m);n.invoice_date=Rt(_,"yyyy-MM-dd")}return(m,_)=>{const k=H("VIcon");return u(),g("div",null,[c("div",null,[t(s(S),{variant:"default",size:"sm",class:"flex h-8",onClick:N},{default:o(()=>[t(k,{name:"fa-pen",class:"size-4"})]),_:1})]),t(s(Ne),{open:w.value,"onUpdate:open":_[7]||(_[7]=y=>w.value=y)},{default:o(()=>[t(s(Ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Ee),null,{default:o(()=>[p("Edit Debt")]),_:1}),t(s(_t),null,{default:o(()=>[p(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),c("div",Za,[c("div",Ja,[t(s(B),{for:"invoice",class:"text-right"},{default:o(()=>[p(" Invoice "),es]),_:1}),t(s(Y),{id:"invoice",modelValue:n.invoice,"onUpdate:modelValue":_[0]||(_[0]=y=>n.invoice=y),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),c("div",ts,[t(s(B),{for:"customer",class:"text-right leading-normal"},{default:o(()=>[p(" Customer "),as]),_:1}),c("div",ss,[t(s(ce),{open:r.is_open,"onUpdate:open":_[2]||(_[2]=y=>r.is_open=y)},{default:o(()=>[t(s(ie),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:o(()=>{var y;return[p(v(n.customer?(y=r.data.find(he=>he.id===n.customer))==null?void 0:y.label:"Select customer")+" ",1),r.is_loading?(u(),x(k,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x(k,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(re),{class:"w-[500px] p-1"},{default:o(()=>[t(s(we),null,{default:o(()=>[t(s(Me),{class:"h-9",modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=y=>d.value=y),placeholder:"Search country..."},null,8,["modelValue"]),t(s(Pe),null,{default:o(()=>[p("No customer found.")]),_:1}),t(s(xe),null,{default:o(()=>[t(s(ue),null,{default:o(()=>[(u(!0),g(P,null,E(r.data,y=>(u(),x(s(me),{key:y.id,value:y.value??"",onSelect:()=>R(y)},{default:o(()=>[p(v(y.label)+" ",1),t(k,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.customer===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),c("div",ls,[t(s(B),{for:"amount",class:"text-right"},{default:o(()=>[p(" Amount "),ns]),_:1}),t(s(Y),{id:"amount",modelValue:n.amount===null?"":n.amount,"onUpdate:modelValue":_[3]||(_[3]=y=>n.amount=y===""?null:y),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),c("div",os,[t(s(B),{for:"email",class:"text-right"},{default:o(()=>[p(" Invoice Date "),is]),_:1}),c("div",rs,[t(s(ce),null,{default:o(()=>[t(s(ie),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",class:W(s(_e)("w-full justify-start text-left font-normal",!n.invoice_date&&"text-muted-foreground"))},{default:o(()=>[t(k,{name:"bi-calendar-fill",class:"mr-2 size-4"}),c("span",null,v(n.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),t(s(re),{class:"w-auto p-0"},{default:o(()=>[t(s(It),{"onUpdate:modelValue":_[4]||(_[4]=y=>M(y)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),c("div",cs,[t(s(B),{for:"amount",class:"text-right"},{default:o(()=>[p(" Payment Term "),ds]),_:1}),t(s(Y),{id:"amount",modelValue:n.term,"onUpdate:modelValue":_[5]||(_[5]=y=>n.term=y),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),c("div",us,[t(s(B),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Status ")]),_:1}),c("div",ms,[t(s(ce),{open:i.is_open,"onUpdate:open":_[6]||(_[6]=y=>i.is_open=y)},{default:o(()=>[t(s(ie),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:o(()=>{var y;return[p(v(n.status?(y=i.data.find(he=>he.id===n.status))==null?void 0:y.label:"Select status")+" ",1),i.is_loading?(u(),x(k,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x(k,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(re),{class:"w-[500px] p-1"},{default:o(()=>[t(s(we),null,{default:o(()=>[t(s(xe),null,{default:o(()=>[t(s(ue),null,{default:o(()=>[(u(!0),g(P,null,E(i.data,y=>(u(),x(s(me),{key:y.id,value:y.value??"",onSelect:()=>q(y)},{default:o(()=>[p(v(y.label)+" ",1),t(k,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.status===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),t(ee),T.value?(u(),g("div",fs,[t(s(B),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(k,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+v(T.value),1)]),_:1})])):A("",!0),t(s(Be),{class:"flex justify-end"},{default:o(()=>[t(s(S),{type:"submit",onClick:z,disabled:b.value},{default:o(()=>[b.value?(u(),x(k,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):A("",!0),p(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ps={class:"pr-4"},gs={class:"flex justify-between mt-2"},vs={key:0,class:"text-primary font-bold flex place-items-center self-center"},hs={key:1,class:"text-primary font-bold"},bs={class:"text-primary"},ys={class:"text-sm"},ws={class:"text-xs mt-2"},xs=F({__name:"DataTableBacklog",props:{row:{}},setup(a){const e=pt(),l=a,n=O({debt:l.row.id,message:""}),r=O([]),i=D(!1),d=D(!1),h=D(null),{toast:f}=ke();async function b(){try{const V=await L.get(`/api/debt/${l.row.id}/backlog/`);r.splice(0,r.length,...V.data.Result),i.value=!1}catch{i.value=!1}}function w(){const V=[{condition:n.message=="",message:"Message cannot be blank"},{condition:n.message.length<5,message:"Maybe a little more context?"}];for(let $ of V)if($.condition)return h.value=$.message,!1;return!0}async function T(){if(w()){i.value=!0;try{const $=await L.post(`/api/debt/${l.row.id}/backlog/`,{...n},{headers:{"Content-Type":"application/json"}});await b(),f({title:$.data.Result,variant:"success"}),n.message="",h.value=""}catch{f({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{i.value=!1}}}function I(){d.value=!d.value,d.value&&b()}return(V,$)=>{const z=H("VIcon"),N=H("Label");return u(),g("div",null,[c("div",null,[t(s(S),{variant:"secondary",size:"sm",class:"h-8 flex border border-primary",onClick:I},{default:o(()=>[t(z,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),t(s(bt),{open:d.value,"onUpdate:open":$[1]||($[1]=R=>d.value=R)},{default:o(()=>[t(s(gt),{class:"w-[720px]",side:"right"},{default:o(()=>[t(s(vt),null,{default:o(()=>[t(s(ht),null,{default:o(()=>[p("Backlog - "+v(l.row.invoice),1)]),_:1})]),_:1}),t(s(ee),{class:"mt-2 mb-4"}),t(s(Le),{class:"h-[80vh] flex flex-col"},{default:o(()=>[c("div",ps,[(u(!0),g(P,null,E(r,(R,q)=>(u(),g("div",{key:q,class:"ml-2 pr-4"},[c("div",gs,[R.is_system_generated?(u(),g("div",vs,[t(z,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),p(" System Generated ")])):(u(),g("div",hs,v(R.created_by_name),1))]),c("div",null,[c("div",bs,v(R.created_date),1),t(s(ee),{variant:"default"}),c("div",null,v(R.message),1)])]))),128))])]),_:1}),h.value?(u(),x(N,{key:0,for:"error",class:"text-red-600 flex"},{default:o(()=>[t(z,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c("p",ys,v(h.value),1)]),_:1})):A("",!0),t(s(Ft),{class:"mt-2 justify-between"},{default:o(()=>[t(s(Y),{id:"message",modelValue:n.message,"onUpdate:modelValue":$[0]||($[0]=R=>n.message=R),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),t(s(S),{type:"submit",onClick:T,disabled:i.value},{default:o(()=>[p(" Save ")]),_:1},8,["disabled"])]),_:1}),c("p",ws,v(s(e).getUsername),1)]),_:1})]),_:1},8,["open"])])}}}),$s={class:"flex gap-1"},ks=F({__name:"DataTableRowActions",props:{row:{}},setup(a){const e=a,l=G(()=>La.parse(e.row.original));return(n,r)=>(u(),g("div",$s,[l.value.editable?(u(),x(_s,{key:0,row:l.value},null,8,["row"])):A("",!0),t(Xa,{row:l.value},null,8,["row"]),t(xs,{row:l.value},null,8,["row"])]))}}),Ss=[{id:"select",header:({table:a})=>C(De,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":e=>a.toggleAllPageRowsSelected(!!e),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:a})=>C(De,{checked:a.getIsSelected(),"onUpdate:checked":e=>a.toggleSelected(!!e),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:a})=>C(K,{column:a,title:"Invoice"}),cell:({row:a})=>{const e=fe.find(l=>l.value===a.original.status.toString());return e?C("div",{class:`w-20 font-bold ${e.label=="Canceled"?"line-through decoration-red-600":""}`},a.getValue("invoice")):null},enableSorting:!0,enableHiding:!0,filterFn:(a,e,l)=>{var i;const n=((i=a.getValue(e))==null?void 0:i.toString().toLowerCase())??"",r=l==null?void 0:l.toString().toLowerCase();return n.includes(r)},meta:{title:"Invoice"}},{accessorKey:"invoice_date",header:({column:a})=>C(K,{column:a,title:a.columnDef.meta.title}),cell:({row:a})=>{const e=a.getValue("invoice_date");let l="";if(e){const n=new Date(Date.parse(e));isNaN(n.getTime())?l="Not Provided":l=n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return C("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:a})=>C(K,{column:a,title:a.columnDef.meta.title}),cell:({row:a})=>{const e=a.getValue("due_date");let l="";if(e){const n=new Date(e);isNaN(n.getTime())?l="Not Provided":l=n.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return C("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"overdue",header:({column:a})=>C(K,{column:a,title:"Overdue"}),cell:({row:a})=>{const e=a.getValue("overdue");let l;return e==1?l="1 day":e>0?l=`${e} day(s)`:e===0?l="0 day":l="No overdue",C("div",{class:"w-fit text-red-600 font-bold"},l)},enableHiding:!0,meta:{title:"Overdue"}},{accessorKey:"amount",header:({column:a})=>C(K,{column:a,title:a.columnDef.meta.title}),cell:({row:a})=>C(Z,{variant:"destructive"},"RM "+a.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:a})=>C(K,{column:a,title:"Attachment"}),cell:({row:a})=>{const e=a.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return C(Ie,{name:e.icon,class:`${e.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:a})=>C(K,{column:a,title:"Status"}),cell:({row:a})=>{const e=fe.find(l=>l.value===a.original.status.toString());return e?C(Z,{variant:"secondary",class:"inline items-center whitespace-nowrap"},[e.icon&&C(Ie,{name:e.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),C("span",{},e.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(a,e,l)=>{const n=a.getValue(e);if(!n)return!1;const r=n.toString().toLowerCase();return l.some(d=>r.includes(d.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:a})=>C(ks,{row:a})}],Cs={class:"md:hidden"},Vs={class:"block h-full flex-1 flex-col space-y-8 p-4 md:p-8 md:flex"},Ds=c("div",{class:"mb-4"},[c("h2",{class:"text-2xl font-bold tracking-tight"},"Statement")],-1),Bs=F({__name:"CustomerDetail",setup(a){const l=wt().params.customer_id,n=te("customer_detail"),r=`/api/customer/${l}/debt`,i=d=>({id:d.id,status:d.status,invoice:d.invoice,invoice_date:new Date(d.invoice_date),due_date:new Date(d.due_date),overdue:d.overdue,amount:d.amount,term:d.term,document_url:d.document_url,editable:d.editable});return $e(async()=>{await n.fetch(r,0,i)}),xt("tableStore",n),yt(()=>{n.$reset()}),(d,h)=>{const f=H("VPImage");return u(),g(P,null,[c("div",Cs,[t(f,{alt:"Tasks",width:"1280",height:"1214",class:"block",image:{dark:"/examples/tasks-dark.png",light:"/examples/tasks-light.png"}})]),c("div",Vs,[t(Ea,{customer_id:s(l)},null,8,["customer_id"]),t(Fa,{customer_id:s(l)},null,8,["customer_id"]),c("div",null,[Ds,t(Sa,{data:s(n).tasks,columns:s(Ss)},null,8,["data","columns"])])])],64)}}});export{Bs as default};
