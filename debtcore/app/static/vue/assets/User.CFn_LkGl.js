import{_ as ke,a as Ce,b as Se,c as Ve,d as Re,e as ye,u as K,f as Pe,g as Ue,h as Ie,i as he,j as ie,k as De,l as Ne,m as Te,n as Fe,o as ze,p as je,q as Me,r as Ee,F as we,z as H,s as ve}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as z,r as G,o as r,c as v,d as m,t as x,a as e,k as s,u as a,F as T,v as F,s as V,b as c,x as de,l as w,y as be,z as xe,A as $e,B as le,E as B,i as P,I as ce,U as ue,W as me,X as pe,a3 as fe,_ as S,R as W,N as Q,Q as X,a4 as Y,a5 as Z,a6 as ee,a8 as ae,a7 as se,Y as Ae,m as E,Z as _e,H as N,a9 as te,n as L,C as He,D as q,T as re,g as Be,a0 as I,G as Le,a1 as Ge,a2 as Ke}from"../main.js";import{_ as Oe,a as qe}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as ge}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as D}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";const Je={class:"flex flex-col md:flex-row items-center justify-between px-2 pb-10"},We={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},Qe={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Xe={class:"flex items-center space-x-2"},Ye=m("p",{class:"text-sm font-medium"},"Rows per page",-1),Ze={class:"flex w-[100px] items-center justify-center text-sm font-medium"},ea={class:"flex items-center space-x-2"},aa=m("span",{class:"sr-only"},"Go to first page",-1),sa=m("span",{class:"sr-only"},"Go to previous page",-1),ta=m("span",{class:"sr-only"},"Go to next page",-1),la=m("span",{class:"sr-only"},"Go to last page",-1),na=z({__name:"DataTablePagination",props:{table:{}},setup(d){return(n,t)=>{const l=G("VIcon");return r(),v("div",Je,[m("div",We,x(n.table.getFilteredSelectedRowModel().rows.length)+" of "+x(n.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),m("div",Qe,[m("div",Xe,[Ye,e(a(Ve),{"model-value":`${n.table.getState().pagination.pageSize}`,"onUpdate:modelValue":n.table.setPageSize},{default:s(()=>[e(a(ke),{class:"h-8 w-[70px]"},{default:s(()=>[e(a(Ce),{placeholder:`${n.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(a(Se),{side:"top"},{default:s(()=>[(r(),v(T,null,F([10,20,30,40,50],i=>e(a(Re),{key:i,value:`${i}`},{default:s(()=>[c(x(i),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),m("div",Ze," Page "+x(n.table.getState().pagination.pageIndex+1)+" of "+x(n.table.getPageCount()),1),m("div",ea,[e(a(V),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanPreviousPage(),onClick:t[0]||(t[0]=i=>n.table.setPageIndex(0))},{default:s(()=>[aa,e(l,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanPreviousPage(),onClick:t[1]||(t[1]=i=>n.table.previousPage())},{default:s(()=>[sa,e(l,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"h-8 w-8 p-0",disabled:!n.table.getCanNextPage(),onClick:t[2]||(t[2]=i=>n.table.nextPage())},{default:s(()=>[ta,e(l,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!n.table.getCanNextPage(),onClick:t[3]||(t[3]=i=>n.table.setPageIndex(n.table.getPageCount()-1))},{default:s(()=>[la,e(l,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),oa=z({__name:"DataTableViewOptions",props:{table:{}},setup(d){const n=d,t=de(()=>n.table.getAllColumns().filter(l=>typeof l.accessorFn<"u"&&l.getCanHide()));return(l,i)=>(r(),w(a($e),null,{default:s(()=>[e(a(be),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:s(()=>[c(" View ")]),_:1})]),_:1}),e(a(xe),{align:"end",class:"w-[150px]"},{default:s(()=>[e(a(Oe),null,{default:s(()=>[c("Toggle columns")]),_:1}),e(a(ye)),(r(!0),v(T,null,F(t.value,p=>(r(),w(a(qe),{key:p.id,class:"capitalize",checked:p.getIsVisible(),"onUpdate:checked":R=>p.toggleVisibility(!!R)},{default:s(()=>{var R;return[c(x(((R=p.columnDef.meta)==null?void 0:R.title)||p.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),ia={class:"grid gap-4 py-4"},ra={class:"grid grid-cols-4 items-center gap-4"},da={class:"grid grid-cols-4 items-center gap-4"},ca={class:"grid grid-cols-4 items-center gap-4"},ua={class:"grid grid-cols-4 items-center gap-4"},ma={class:"col-span-3"},pa={class:"grid grid-cols-4 items-center gap-4"},fa={class:"col-span-3"},_a={class:"grid grid-cols-4 items-center gap-4"},ga={class:"grid grid-cols-4 items-center gap-4"},ha={key:0,class:"grid grid-cols-4 items-center gap-4"},wa=z({__name:"DataTableCreateModal",setup(d){const n=le("tableStore",K("user")),t=B({id:void 0,name:"",surname:"",email:"",company:null,role:null,password:"",confirm_password:""}),l=B({is_loading:!0,is_open:!1,data:[{value:"",label:""}]}),i=B({is_loading:!0,is_open:!1,data:[{value:"",label:""}]});async function p(){l.is_loading=!0;try{const k=await N.get("/api/company/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});l.data=k.data.Result}catch(k){console.error("There was an error fetching the select list:",k)}finally{l.is_loading=!1}}async function R(){i.is_loading=!0;try{const k=await N.get("/api/role-choices/",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=k.data.Result}catch(k){console.error("There was an error fetching the select list:",k)}finally{i.is_loading=!1}}const j=async()=>{await p(),await R()},U=P(!1),b=P(!1),f=P(null),{toast:g}=ce();function h(){const k=[{condition:t.name==="",message:"Name cannot be blank"},{condition:t.email==="",message:"Email cannot be blank"},{condition:t.company==null,message:"Company must be selected"},{condition:t.password!=t.confirm_password,message:"Passwords do not match"},{condition:t.password.length<9,message:"Password must consists more than 8 characters"},{condition:t.password=="",message:"Password cannot be blank"}];for(let y of k)if(y.condition)return f.value=y.message,!1;return!0}async function $(){var _;if(!h())return;U.value=!0;const y=JSON.parse(((_=document.getElementById("drf_csrf"))==null?void 0:_.textContent)||"{}");try{const o=await N.post("/api/user",{...t},{headers:{"Content-Type":"application/json",[y.csrfHeaderName]:y.csrfToken}});M(),await n.refresh(n.page_index),g({title:o.data.Result,variant:"success"})}catch{g({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{U.value=!1}}function M(){b.value||j(),b.value=!b.value}function ne(k){t.company=k.id,l.is_open=!1}function O(k){t.role=k.id||0,i.is_open=!1}return(k,y)=>{const _=G("VIcon");return r(),v("div",null,[m("div",null,[e(a(V),{variant:"default",size:"sm",class:"h-8 ml-2 flex",onClick:M},{default:s(()=>[e(_,{name:"fa-plus",class:"size-4"})]),_:1})]),e(a(_e),{open:b.value,"onUpdate:open":y[7]||(y[7]=o=>b.value=o)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(me),null,{default:s(()=>[e(a(pe),null,{default:s(()=>[c("Create User")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the details of the user here. Click create when you're done. ")]),_:1})]),_:1}),m("div",ia,[m("div",ra,[e(a(S),{for:"surname",class:"text-right"},{default:s(()=>[c(" Surname ")]),_:1}),e(a(D),{id:"surname",modelValue:t.surname,"onUpdate:modelValue":y[0]||(y[0]=o=>t.surname=o),placeholder:"Lee",class:"col-span-3"},null,8,["modelValue"])]),m("div",da,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Name ")]),_:1}),e(a(D),{id:"name",modelValue:t.name,"onUpdate:modelValue":y[1]||(y[1]=o=>t.name=o),placeholder:"Susan",class:"col-span-3"},null,8,["modelValue"])]),m("div",ca,[e(a(S),{for:"email",class:"text-right"},{default:s(()=>[c(" Email ")]),_:1}),e(a(D),{id:"email",modelValue:t.email,"onUpdate:modelValue":y[2]||(y[2]=o=>t.email=o),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),m("div",ua,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Company ")]),_:1}),m("div",ma,[e(a(W),{open:l.is_open,"onUpdate:open":y[3]||(y[3]=o=>l.is_open=o)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":l.is_open,class:"w-full justify-between px-3",disabled:l.is_loading},{default:s(()=>{var o;return[c(x(t.company?(o=l.data.find(C=>C.id===t.company))==null?void 0:o.label:"Select company")+" ",1),l.is_loading?(r(),w(_,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),w(_,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search company..."}),e(a(ee),null,{default:s(()=>[c("No company found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),v(T,null,F(l.data,o=>(r(),w(a(te),{key:o.value,value:o.value??"",onSelect:()=>ne(o)},{default:s(()=>[c(x(o.label)+" ",1),e(_,{name:"fa-check",class:L(["ml-auto h-4 w-4",t.company===o.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),m("div",pa,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Role ")]),_:1}),m("div",fa,[e(a(W),{open:i.is_open,"onUpdate:open":y[4]||(y[4]=o=>i.is_open=o)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:s(()=>{var o;return[c(x(t.role?(o=i.data.find(C=>C.id===t.role))==null?void 0:o.label:"Select Role")+" ",1),l.is_loading?(r(),w(_,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),w(_,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search framework..."}),e(a(ee),null,{default:s(()=>[c("No framework found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),v(T,null,F(i.data,o=>(r(),w(a(te),{key:o.value,value:o.value??"",onSelect:()=>O(o)},{default:s(()=>[c(x(o.label)+" ",1),e(_,{name:"fa-check",class:L(["ml-auto h-4 w-4",t.role===o.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(Ae),m("div",_a,[e(a(S),{for:"password",class:"text-right"},{default:s(()=>[c(" Password ")]),_:1}),e(a(D),{id:"password",modelValue:t.password,"onUpdate:modelValue":y[5]||(y[5]=o=>t.password=o),placeholder:"***********",class:"col-span-3",type:"password"},null,8,["modelValue"])]),m("div",ga,[e(a(S),{for:"confirm_password",class:"text-right"},{default:s(()=>[c(" Confirm Password ")]),_:1}),e(a(D),{id:"confirm_password",modelValue:t.confirm_password,"onUpdate:modelValue":y[6]||(y[6]=o=>t.confirm_password=o),placeholder:"***********",class:"col-span-3",type:"password"},null,8,["modelValue"])])]),f.value?(r(),v("div",ha,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+x(f.value),1)]),_:1})])):E("",!0),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:$,disabled:U.value},{default:s(()=>[U.value?(r(),w(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):E("",!0),c(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),va={class:"flex items-center justify-between"},ya={class:"flex flex-1 items-center space-x-2"},ba=z({__name:"DataTableToolbar",props:{table:{}},setup(d){const n=d,t=de(()=>n.table.getState().columnFilters.length>0);return(l,i)=>{var p;return r(),v("div",va,[m("div",ya,[e(a(D),{placeholder:"Search...","model-value":((p=l.table.getColumn("name"))==null?void 0:p.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:i[0]||(i[0]=R=>l.table.setGlobalFilter(R.target.value))},null,8,["model-value"]),t.value?(r(),w(a(V),{key:0,variant:"default",class:"h-8 px-2 lg:px-3",onClick:i[1]||(i[1]=R=>l.table.resetColumnFilters())},{default:s(()=>[c(" Reset ")]),_:1})):E("",!0)]),e(oa,{table:l.table},null,8,["table"]),e(wa,{table:l.table},null,8,["table"])])}}}),xa={class:"space-y-4"},$a={class:"rounded-md border"},ka=z({__name:"DataTable",props:{columns:{},data:{}},setup(d){const n=le("tableStore",K("user")),t=d,l=P([]),i=P([]),p=P({}),R=P({pageIndex:n.page_index,pageSize:n.page_size}),j=P({});function U(f,g){let h;typeof f=="function"?h=f(g.value):h=f,g.value=h,n.set_page_index(h.pageIndex),n.set_page_size(h.pageSize)}const b=Pe({get data(){return t.data},get columns(){return t.columns},state:{get sorting(){return l.value},get columnFilters(){return i.value},get columnVisibility(){return p.value},get rowSelection(){return j.value}},enableRowSelection:!0,onSortingChange:f=>q(f,l),onPaginationChange:f=>U(f,R),onColumnFiltersChange:f=>q(f,i),onColumnVisibilityChange:f=>q(f,p),onRowSelectionChange:f=>q(f,j),getCoreRowModel:Ne(),getFilteredRowModel:Te(),getPaginationRowModel:Fe(),getSortedRowModel:ze(),getFacetedRowModel:je(),getFacetedUniqueValues:Me()});return He(()=>{b.setPageIndex(n.page_index),b.setPageSize(n.page_size)}),(f,g)=>(r(),v("div",xa,[e(ba,{table:a(b)},null,8,["table"]),m("div",$a,[e(a(De),null,{default:s(()=>[e(a(Ue),null,{default:s(()=>[(r(!0),v(T,null,F(a(b).getHeaderGroups(),h=>(r(),w(a(ie),{key:h.id},{default:s(()=>[(r(!0),v(T,null,F(h.headers,$=>(r(),w(a(Ee),{key:$.id},{default:s(()=>[$.isPlaceholder?E("",!0):(r(),w(a(we),{key:0,render:$.column.columnDef.header,props:$.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(a(Ie),{id:"dbTableBody"},{default:s(()=>{var h;return[(h=a(b).getRowModel().rows)!=null&&h.length?(r(!0),v(T,{key:0},F(a(b).getRowModel().rows,$=>(r(),w(a(ie),{key:$.id,"data-state":$.getIsSelected()&&"selected"},{default:s(()=>[(r(!0),v(T,null,F($.getVisibleCells(),M=>(r(),w(a(he),{key:M.id},{default:s(()=>[e(a(we),{render:M.column.columnDef.cell,props:M.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(r(),w(a(ie),{key:1},{default:s(()=>[e(a(he),{colspan:f.columns.length,class:"h-24 text-center"},{default:s(()=>[c(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(na,{table:a(b)},null,8,["table"])]))}}),J=z({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(d){return(n,t)=>{const l=G("VIcon");return n.column.getCanSort()?(r(),v("div",{key:0,class:L(a(Be)("flex items-center space-x-2",n.$attrs.class??""))},[e(a($e),null,{default:s(()=>[e(a(be),{"as-child":""},{default:s(()=>[e(a(V),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:s(()=>[m("span",null,x(n.title),1),n.column.getIsSorted()==="desc"?(r(),w(l,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):n.column.getIsSorted()==="asc"?(r(),w(l,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(r(),w(l,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(a(xe),{align:"start"},{default:s(()=>[e(a(re),{onClick:t[0]||(t[0]=i=>n.column.toggleSorting(!1))},{default:s(()=>[e(l,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Asc ")]),_:1}),e(a(re),{onClick:t[1]||(t[1]=i=>n.column.toggleSorting(!0))},{default:s(()=>[e(l,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Desc ")]),_:1}),e(a(ye)),e(a(re),{onClick:t[2]||(t[2]=i=>n.column.toggleVisibility(!1))},{default:s(()=>[e(l,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(r(),v("div",{key:1,class:L(n.$attrs.class)},x(n.title),3))}}}),Ca=H.object({id:H.string(),name:H.string(),email:H.string(),company_name:H.string().nullable(),last_login:H.preprocess(d=>d instanceof Date?d:typeof d=="string"?new Date(d):d,H.date()).nullable()}),Sa={class:"grid gap-4 py-4"},Va={class:"grid grid-cols-4 items-center gap-4"},Ra={class:"grid grid-cols-4 items-center gap-4"},Pa={class:"grid grid-cols-4 items-center gap-4"},Ua={class:"grid grid-cols-4 items-center gap-4"},Ia={class:"col-span-3"},Da={class:"grid grid-cols-4 items-center gap-4"},Na={class:"col-span-3"},Ta={key:0,class:"grid grid-cols-4 items-center gap-4"},Fa=z({__name:"DataTableEditModal",props:{row:{}},setup(d){const n=le("tableStore",K("user")),t=d,l=B({id:t.row.id,name:"",surname:"",email:"",company:null,role:null}),i=B({is_loading:!0,is_open:!1,data:[{value:"",label:""}]}),p=B({is_loading:!0,is_open:!1,data:[{value:"",label:""}]});async function R(){i.is_loading=!0;try{const _=await N.get("/api/company/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{i.is_loading=!1}}async function j(){p.is_loading=!0;try{const _=await N.get("/api/role-choices/",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});p.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{p.is_loading=!1}}async function U(){try{const _=await N.get(`/api/user/${t.row.id}/`);Object.assign(l,_.data.Result)}catch(_){console.error(_),f.value=!1}}const b=async()=>{await R(),await j(),await U()},f=P(!1),g=P(!1),h=P(null),{toast:$}=ce();function M(){const _=[{condition:l.name==="",message:"Name cannot be blank"},{condition:l.email==="",message:"Email cannot be blank"},{condition:l.company==null,message:"Company must be selected"}];for(let o of _)if(o.condition)return h.value=o.message,!1;return!0}async function ne(){var C;if(!M())return;f.value=!0;const o=JSON.parse(((C=document.getElementById("drf_csrf"))==null?void 0:C.textContent)||"{}");try{const u=await N.patch("/api/user",{...l},{headers:{"Content-Type":"application/json",[o.csrfHeaderName]:o.csrfToken}});O(),await n.refresh(n.page_index),$({title:u.data.Result,variant:"success"})}catch(u){let A="An unexpected error occurred.";if(N.isAxiosError(u)&&u.response)if(u.response.data.details&&typeof u.response.data.details=="object"){const oe=Object.keys(u.response.data.details);oe.length>0&&u.response.data.details[oe[0]].length>0&&(A=u.response.data.details[oe[0]][0])}else u.response.data.error&&(A=u.response.data.error);$({title:"Whoops, something went wrong",description:A||"",variant:"destructive"})}finally{f.value=!1}}function O(){g.value||b(),g.value=!g.value}function k(_){l.company=_.id,i.is_open=!1}function y(_){l.role=_.id||0,p.is_open=!1}return(_,o)=>{const C=G("VIcon");return r(),v("div",null,[m("div",null,[e(a(V),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:O},{default:s(()=>[e(C,{name:"fa-pen",class:"size-4"})]),_:1})]),e(a(_e),{open:g.value,"onUpdate:open":o[5]||(o[5]=u=>g.value=u)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(me),null,{default:s(()=>[e(a(pe),null,{default:s(()=>[c("Edit User")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the details of the user here. Click edit when you're done. ")]),_:1})]),_:1}),m("div",Sa,[m("div",Va,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Surname ")]),_:1}),e(a(D),{id:"name",modelValue:l.surname,"onUpdate:modelValue":o[0]||(o[0]=u=>l.surname=u),placeholder:"Lee",class:"col-span-3"},null,8,["modelValue"])]),m("div",Ra,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Name ")]),_:1}),e(a(D),{id:"name",modelValue:l.name,"onUpdate:modelValue":o[1]||(o[1]=u=>l.name=u),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),m("div",Pa,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Email ")]),_:1}),e(a(D),{id:"name",modelValue:l.email,"onUpdate:modelValue":o[2]||(o[2]=u=>l.email=u),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),m("div",Ua,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Company ")]),_:1}),m("div",Ia,[e(a(W),{open:i.is_open,"onUpdate:open":o[3]||(o[3]=u=>i.is_open=u)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:s(()=>{var u;return[c(x(l.company?(u=i.data.find(A=>A.id===l.company))==null?void 0:u.label:"Select company")+" ",1),i.is_loading?(r(),w(C,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),w(C,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search company..."}),e(a(ee),null,{default:s(()=>[c("No company found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),v(T,null,F(i.data,u=>(r(),w(a(te),{key:u.value,value:u.value??"",onSelect:()=>k(u)},{default:s(()=>[c(x(u.label)+" ",1),e(C,{name:"fa-check",class:L(["ml-auto h-4 w-4",l.company===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),m("div",Da,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Role ")]),_:1}),m("div",Na,[e(a(W),{open:p.is_open,"onUpdate:open":o[4]||(o[4]=u=>p.is_open=u)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":p.is_open,class:"w-full justify-between px-3",disabled:p.is_loading},{default:s(()=>{var u;return[c(x(l.role?(u=p.data.find(A=>A.id===l.role))==null?void 0:u.label:"Select Role")+" ",1),i.is_loading?(r(),w(C,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),w(C,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search framework..."}),e(a(ee),null,{default:s(()=>[c("No role found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),v(T,null,F(p.data,u=>(r(),w(a(te),{key:u.value,value:u.value??"",onSelect:()=>y(u)},{default:s(()=>[c(x(u.label)+" ",1),e(C,{name:"fa-check",class:L(["ml-auto h-4 w-4",l.role===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),h.value?(r(),v("div",Ta,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(C,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+x(h.value),1)]),_:1})])):E("",!0)]),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:ne,disabled:f.value},{default:s(()=>[f.value?(r(),w(C,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):E("",!0),c(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),za={class:"grid gap-4 py-4"},ja={class:"grid grid-cols-4 items-center gap-4"},Ma={class:"grid grid-cols-4 items-center gap-4"},Ea={key:0,class:"grid grid-cols-4 items-center gap-4"},Aa=z({__name:"DataTableEditPasswordModal",props:{row:{}},setup(d){le("tableStore",K("user"));const t=B({id:d.row.id,password:"",confirm_password:""}),l=P(!1),i=P(!1),p=P(null),{toast:R}=ce();async function j(){var f;if(p.value=null,t.password!=t.confirm_password){p.value="Passwords do not match.";return}if(t.password==""||t.confirm_password==""){p.value="Password cannot be blank.";return}if(t.password.length<8){p.value="Passowrd must consists more than 8 characters";return}l.value=!0;const b=JSON.parse(((f=document.getElementById("drf_csrf"))==null?void 0:f.textContent)||"{}");try{const g=await N.post("/api/user/change-password/",{...t},{headers:{"Content-Type":"application/json",[b.csrfHeaderName]:b.csrfToken}});U(),R({title:g.data.Result,variant:"success"}),t.confirm_password="",t.password=""}catch(g){let h="An unexpected error occurred.";if(N.isAxiosError(g)&&g.response)if(g.response.data.details&&typeof g.response.data.details=="object"){const $=Object.keys(g.response.data.details);$.length>0&&g.response.data.details[$[0]].length>0&&(h=g.response.data.details[$[0]][0])}else g.response.data.error&&(h=g.response.data.error);R({title:"Whoops, something went wrong",description:h||"",variant:"destructive"})}finally{l.value=!1}}function U(){i.value=!i.value}return(b,f)=>{const g=G("VIcon");return r(),v("div",null,[m("div",null,[e(a(V),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:U},{default:s(()=>[e(g,{name:"fa-lock",class:"size-4"})]),_:1})]),e(a(_e),{open:i.value,"onUpdate:open":f[2]||(f[2]=h=>i.value=h)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(me),null,{default:s(()=>[e(a(pe),null,{default:s(()=>[c("Change Password")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the latest password of the user here. Click update when you're done. ")]),_:1})]),_:1}),m("div",za,[m("div",ja,[e(a(S),{for:"password",class:"text-right"},{default:s(()=>[c(" Password ")]),_:1}),e(a(D),{id:"password",modelValue:t.password,"onUpdate:modelValue":f[0]||(f[0]=h=>t.password=h),placeholder:"********",class:"col-span-3",type:"password"},null,8,["modelValue"])]),m("div",Ma,[e(a(S),{for:"confirm_password",class:"text-right"},{default:s(()=>[c(" Confirm Password ")]),_:1}),e(a(D),{id:"confirm_password",modelValue:t.confirm_password,"onUpdate:modelValue":f[1]||(f[1]=h=>t.confirm_password=h),placeholder:"********",class:"col-span-3",type:"password"},null,8,["modelValue"])])]),p.value?(r(),v("div",Ea,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(g,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+x(p.value),1)]),_:1})])):E("",!0),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:j,disabled:l.value},{default:s(()=>[l.value?(r(),w(g,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):E("",!0),c(" Update")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ha={class:"flex gap-1"},Ba=z({__name:"DataTableRowActions",props:{row:{}},setup(d){const n=d,t=de(()=>Ca.parse(n.row.original));return(l,i)=>(r(),v("div",Ha,[e(Fa,{row:t.value},null,8,["row"]),e(Aa,{row:t.value},null,8,["row"])]))}}),La=[{id:"select",header:({table:d})=>I(ve,{checked:d.getIsAllPageRowsSelected()||d.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":n=>d.toggleAllPageRowsSelected(!!n),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:d})=>I(ve,{checked:d.getIsSelected(),"onUpdate:checked":n=>d.toggleSelected(!!n),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"name",header:({column:d})=>I(J,{column:d,title:"Name"}),cell:({row:d})=>I("div",{class:"w-fit"},d.getValue("name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(d,n,t)=>{var p;const l=((p=d.getValue(n))==null?void 0:p.toString().toLowerCase())??"",i=t==null?void 0:t.toString().toLowerCase();return l.includes(i)},meta:{title:"Name"}},{accessorKey:"email",header:({column:d})=>I(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>I("div",{class:"w-fit"},d.getValue("email")),enableSorting:!0,enableHiding:!0,meta:{title:"Email"}},{accessorKey:"company_name",header:({column:d})=>I(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>I("div",{class:"w-fit"},d.getValue("company_name")),enableSorting:!0,enableHiding:!0,meta:{title:"Company Name"}},{accessorKey:"last_login",header:({column:d})=>I(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>{const n=d.getValue("last_login");let t="";if(n){const l=new Date(n);!isNaN(l.getTime())&&l.getTime()!==new Date(0).getTime()?t=l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):t="Not provided"}else t="Not provided";return I("div",{class:`w-fit ${t!=="Not provided"?"":"text-red-600 font-bold"}`},t)},enableSorting:!0,enableHiding:!0,meta:{title:"Last Login"}},{id:"actions",cell:({row:d})=>I(Ba,{row:d})}],Ga={class:"p-4 md:p-8 space-y-8 h-full"},Ka=m("div",{class:"flex items-center justify-between space-y-2"},[m("div",null,[m("h2",{class:"text-2xl font-bold tracking-tight"},"User Management"),m("p",{class:"text-muted-foreground"},"Here's a list of your existing users!")])],-1),Oa={key:0,class:"text-center"},qa={key:1},Ja="/api/user",es=z({__name:"User",setup(d){const n=K("user"),t=l=>({id:l.id,name:l.name,email:l.email,company_name:l.company_name,last_login:new Date(l.last_login)});return Le(async()=>{await n.fetch(Ja,0,t)}),Ke("tableStore",n),Ge(()=>{n.$reset()}),(l,i)=>{const p=G("VIcon");return r(),v("div",Ga,[Ka,a(n).is_loading?(r(),v("div",Oa,[e(p,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(r(),v("div",qa,[e(ka,{data:a(n).tasks,columns:a(La)},null,8,["data","columns"])]))])}}});export{es as default};
