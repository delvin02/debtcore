import{_ as ge,a as he,b as we,c as ye,d as be,e as ne,u as N,f as ve,g as xe,h as $e,i as ue,j as J,k as Se,l as Ce,m as Ve,n as ke,o as De,p as Pe,q as Fe,r as Ie,F as fe,z as L,s as pe}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as h,x as R,aj as oe,o as d,l as f,k as r,a,u as e,d as c,c as p,v as B,F as P,am as T,g as F,O as Le,b as u,t as S,al as G,f as M,aL as Re,aM as Me,P as q,aN as Be,aO as ze,r as U,s as k,y as re,z as ie,A as de,m as H,B as Y,i as I,C as Te,D as O,$ as W,E as K,I as Q,K as Ue,G as _e,J as Ae,H as X,Y as te,N as ae,n as j,aP as Z,Q as se,R as le,a4 as je,a5 as He,a6 as Ne,a8 as Ke,a7 as Ye,a9 as Oe,T as ee,U as Ee,W as We,X as Ge,_ as E,Z as qe,ag as Qe,ah as Xe,aQ as Je,aR as Ze,aS as et,aT as tt,aU as at,aV as st,aW as lt,aX as nt,a0 as y,a1 as ot,a2 as rt}from"../main.js";import{_ as it,a as dt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as ce}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";import{_ as ct,a as ut,b as me,d as ft,c as pt,e as mt,f as _t,g as gt}from"./RangeCalendarHeadCell.vue_vue_type_script_setup_true_lang.wPydTvov.js";import{C as ht,a as wt,_ as yt}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.DOcqctDd.js";import{_ as bt}from"./lodash.BtnTHUG3.js";import{_ as vt}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import"./index.5qndC0qu.js";const xt={class:"flex flex-col gap-y-4 mt-4 sm:flex-row sm:gap-x-4 sm:gap-y-0"},$t=h({__name:"RangeCalendar",props:{defaultPlaceholder:{},defaultValue:{},modelValue:{},placeholder:{},pagedNavigation:{type:Boolean},preventDeselect:{type:Boolean},weekStartsOn:{},weekdayFormat:{},calendarLabel:{},fixedWeeks:{type:Boolean},maxValue:{},minValue:{},locale:{},numberOfMonths:{},disabled:{type:Boolean},readonly:{type:Boolean},initialFocus:{type:Boolean},isDateDisabled:{type:Function},isDateUnavailable:{type:Function},dir:{},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:placeholder","update:startValue"],setup(s,{emit:t}){const l=s,n=t,o=R(()=>{const{class:m,...v}=l;return v}),i=oe(o,n);return(m,v)=>(d(),f(e(Le),T({class:e(F)("p-3",l.class)},e(i)),{default:r(({grid:D,weekDays:$})=>[a(e(St),null,{default:r(()=>[a(e(kt)),a(e(Ct)),a(e(Vt))]),_:1}),c("div",xt,[(d(!0),p(P,null,B(D,_=>(d(),f(e(ct),{key:_.value.toString()},{default:r(()=>[a(e(ut),null,{default:r(()=>[a(e(me),null,{default:r(()=>[(d(!0),p(P,null,B($,C=>(d(),f(e(ft),{key:C},{default:r(()=>[u(S(C),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a(e(pt),null,{default:r(()=>[(d(!0),p(P,null,B(_.rows,(C,x)=>(d(),f(e(me),{key:`weekDate-${x}`,class:"mt-2 w-full"},{default:r(()=>[(d(!0),p(P,null,B(C,b=>(d(),f(e(mt),{key:b.toString(),date:b},{default:r(()=>[a(e(_t),{day:b,month:_.value},null,8,["day","month"])]),_:2},1032,["date"]))),128))]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},16,["class"]))}}),St=h({__name:"RangeCalendarHeader",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:o,...i}=t;return i}),n=G(l);return(o,i)=>(d(),f(e(Re),T({class:e(F)("relative flex w-full items-center justify-between pt-1",t.class)},e(n)),{default:r(()=>[M(o.$slots,"default")]),_:3},16,["class"]))}}),Ct=h({__name:"RangeCalendarHeading",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:o,...i}=t;return i}),n=G(l);return(o,i)=>(d(),f(e(Me),T({class:e(F)("text-sm font-medium",t.class)},e(n)),{default:r(({headingValue:m})=>[M(o.$slots,"default",{headingValue:m},()=>[u(S(m),1)])]),_:3},16,["class"]))}}),Vt=h({__name:"RangeCalendarNextButton",props:{step:{},asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:o,...i}=t;return i}),n=G(l);return(o,i)=>(d(),f(e(Be),T({class:e(F)(e(q)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",t.class)},e(n)),{default:r(()=>[M(o.$slots,"default",{},()=>[a(e(ht),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),kt=h({__name:"RangeCalendarPrevButton",props:{step:{},asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:o,...i}=t;return i}),n=G(l);return(o,i)=>(d(),f(e(ze),T({class:e(F)(e(q)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",t.class)},e(n)),{default:r(()=>[M(o.$slots,"default",{},()=>[a(e(wt),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Dt={class:"flex flex-col md:flex-row items-center justify-between px-2 pb-10"},Pt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},Ft={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},It={class:"flex items-center space-x-2"},Lt=c("p",{class:"text-sm font-medium"},"Rows per page",-1),Rt={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Mt={class:"flex items-center space-x-2"},Bt=c("span",{class:"sr-only"},"Go to first page",-1),zt=c("span",{class:"sr-only"},"Go to previous page",-1),Tt=c("span",{class:"sr-only"},"Go to next page",-1),Ut=c("span",{class:"sr-only"},"Go to last page",-1),At=h({__name:"DataTablePagination",props:{table:{}},setup(s){return(t,l)=>{const n=U("VIcon");return d(),p("div",Dt,[c("div",Pt,S(t.table.getFilteredSelectedRowModel().rows.length)+" of "+S(t.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),c("div",Ft,[c("div",It,[Lt,a(e(ye),{"model-value":`${t.table.getState().pagination.pageSize}`,"onUpdate:modelValue":t.table.setPageSize},{default:r(()=>[a(e(ge),{class:"h-8 w-[70px]"},{default:r(()=>[a(e(he),{placeholder:`${t.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),a(e(we),{side:"top"},{default:r(()=>[(d(),p(P,null,B([10,20,30,40,50],o=>a(e(be),{key:o,value:`${o}`},{default:r(()=>[u(S(o),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),c("div",Rt," Page "+S(t.table.getState().pagination.pageIndex+1)+" of "+S(t.table.getPageCount()),1),c("div",Mt,[a(e(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanPreviousPage(),onClick:l[0]||(l[0]=o=>t.table.setPageIndex(0))},{default:r(()=>[Bt,a(n,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanPreviousPage(),onClick:l[1]||(l[1]=o=>t.table.previousPage())},{default:r(()=>[zt,a(n,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanNextPage(),onClick:l[2]||(l[2]=o=>t.table.nextPage())},{default:r(()=>[Tt,a(n,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanNextPage(),onClick:l[3]||(l[3]=o=>t.table.setPageIndex(t.table.getPageCount()-1))},{default:r(()=>[Ut,a(n,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),jt=h({__name:"DataTableViewOptions",props:{table:{}},setup(s){const t=s,l=R(()=>t.table.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()));return(n,o)=>(d(),f(e(de),null,{default:r(()=>[a(e(re),{"as-child":""},{default:r(()=>[a(e(k),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:r(()=>[u(" View ")]),_:1})]),_:1}),a(e(ie),{align:"end",class:"w-[150px]"},{default:r(()=>[a(e(it),null,{default:r(()=>[u("Toggle columns")]),_:1}),a(e(ne)),(d(!0),p(P,null,B(l.value,i=>(d(),f(e(dt),{key:i.id,class:"capitalize",checked:i.getIsVisible(),"onUpdate:checked":m=>i.toggleVisibility(!!m)},{default:r(()=>{var m;return[u(S(((m=i.columnDef.meta)==null?void 0:m.title)||i.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),Ht={class:"flex items-center justify-between"},Nt={class:"flex flex-1 items-center space-x-2"},Kt=h({__name:"DataTableToolbar",props:{table:{}},setup(s){const t=s,l=R(()=>t.table.getState().columnFilters.length>0);return(n,o)=>{var i;return d(),p("div",Ht,[c("div",Nt,[a(e(ce),{placeholder:"Search...","model-value":((i=n.table.getColumn("invoice"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:o[0]||(o[0]=m=>n.table.setGlobalFilter(m.target.value))},null,8,["model-value"]),l.value?(d(),f(e(k),{key:0,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:o[1]||(o[1]=m=>n.table.resetColumnFilters())},{default:r(()=>[u(" Reset ")]),_:1})):H("",!0)]),a(jt,{table:n.table},null,8,["table"])])}}}),Yt={class:"flex flex-col space-y-4 text-muted-foreground"},Ot={class:"flex rounded-md border"},Et=h({__name:"DataTable",props:{columns:{},data:{}},setup(s){const t=Y("tableStore",N("session")),l=s,n=I([]),o=I([]),i=I({}),m=I({pageIndex:t.page_index,pageSize:t.page_size}),v=I();function D(_,C){let x;typeof _=="function"?x=_(C.value):x=_,C.value=x,t.set_page_index(x.pageIndex),t.set_page_size(x.pageSize)}const $=ve({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return n.value},get columnFilters(){return o.value},get columnVisibility(){return i.value},get rowSelection(){return v.value},get pagination(){return m.value}},enableRowSelection:!0,onSortingChange:_=>O(_,n),onPaginationChange:_=>D(_,m),onColumnFiltersChange:_=>O(_,o),onColumnVisibilityChange:_=>O(_,i),onRowSelectionChange:_=>O(_,v),getCoreRowModel:Ce(),getFilteredRowModel:Ve(),getPaginationRowModel:ke(),getSortedRowModel:De(),getFacetedRowModel:Pe(),getFacetedUniqueValues:Fe()});return Te(()=>{$.setPageIndex(t.page_index),$.setPageSize(t.page_size)}),(_,C)=>(d(),p("div",Yt,[a(Kt,{table:e($)},null,8,["table"]),c("div",Ot,[a(e(Se),{class:"text-xs"},{default:r(()=>[a(e(xe),null,{default:r(()=>[(d(!0),p(P,null,B(e($).getHeaderGroups(),x=>(d(),f(e(J),{key:x.id},{default:r(()=>[(d(!0),p(P,null,B(x.headers,b=>(d(),f(e(Ie),{key:b.id},{default:r(()=>[b.isPlaceholder?H("",!0):(d(),f(e(fe),{key:0,render:b.column.columnDef.header,props:b.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(e($e),{id:"dbTableBody"},{default:r(()=>{var x;return[(x=e($).getRowModel().rows)!=null&&x.length?(d(!0),p(P,{key:0},B(e($).getRowModel().rows,b=>(d(),f(e(J),{key:b.id,"data-state":b.getIsSelected()&&"selected"},{default:r(()=>[(d(!0),p(P,null,B(b.getVisibleCells(),w=>(d(),f(e(ue),{key:w.id},{default:r(()=>[a(e(fe),{render:w.column.columnDef.cell,props:w.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),f(e(J),{key:1},{default:r(()=>[a(e(ue),{colspan:_.columns.length,class:"h-24 text-center"},{default:r(()=>[u(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),a(At,{table:e($)},null,8,["table"])]))}}),Wt={class:"border border-secondary rounded"},Gt={class:"bg-border/30 p-4"},qt={class:"flex flex-col gap-4"},Qt={class:"flex flex-col md:flex-row gap-x-2 md:justify-items-center md:items-center mx-auto w-full"},Xt=c("div",{class:"w-1/3 text-left lg:text-right my-auto"},[c("p",null,"Invoice")],-1),Jt={class:"flex flex-col md:flex-row gap-x-2 md:justify-items-center md:items-center mx-auto w-full"},Zt=c("div",{class:"w-1/3 text-left lg:text-right my-auto"},[c("p",null,"Schduled Date")],-1),ea={class:"flex flex-col md:flex-row gap-x-2 md:justify-items-center md:items-center mx-auto w-full"},ta=c("div",{class:"w-1/3 text-left lg:text-right my-auto"},[c("p",null,"Company")],-1),aa={class:"flex self-end justify-end justify-self-end space-x-2"},sa={class:"p-4"},la={class:"flex justify-end space-x-2"},na=h({__name:"DashboardCard",setup(s){const t=Y("tableStore",N("session")),l=new W(new Date().getFullYear(),new Date().getMonth()+1,new Date().getDate()),n=I({start:new W(2024,5,20).subtract({months:3}),end:l}),o=K({invoice:"",date:n.value,company:null}),i=K({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),{toast:m}=Q(),v=I("");async function D(b){i.is_loading=!0;try{const w=await X.get(`/api/company/list?search=${b||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=w.data.Result}catch{m({title:"Whoops, something went wrong",description:"There is an error fetching the companies.",variant:"destructive"})}finally{i.is_loading=!1}}Ue(v,bt.debounce(async b=>{await D(b)},300));const $=()=>{t.set_filter(o),t.refresh(t.page_index)},_=()=>{t.set_filter({}),t.refresh(0)};_e(()=>{D()});const C=new Ae("en-US",{dateStyle:"medium"});function x(b){b.id==o.company?o.company=null:o.company=b.id,i.is_open=!1}return(b,w)=>{const V=U("VIcon");return d(),p("div",Wt,[c("div",Gt,[c("div",qt,[c("div",Qt,[Xt,a(e(ce),{id:"invoice",modelValue:o.invoice,"onUpdate:modelValue":w[0]||(w[0]=g=>o.invoice=g),class:"w-full lg:w-1/3"},null,8,["modelValue"])]),a(e(te),{class:"my-1"}),c("div",Jt,[Zt,a(e(le),null,{default:r(()=>[a(e(ae),{"as-child":""},{default:r(()=>[a(e(k),{variant:"outline",class:j(e(F)("w-full lg:w-1/3 justify-start text-left font-normal",!o.date&&"text-muted-foreground"))},{default:r(()=>[a(V,{name:"bi-calendar-fill",class:"mr-2 h-4 w-4"}),o.date.start?(d(),p(P,{key:0},[o.date.end?(d(),p(P,{key:0},[u(S(e(C).format(o.date.start.toDate(e(Z)())))+" - "+S(e(C).format(o.date.end.toDate(e(Z)()))),1)],64)):(d(),p(P,{key:1},[u(S(e(C).format(o.date.start.toDate(e(Z)()))),1)],64))],64)):(d(),p(P,{key:1},[u(" Pick a date ")],64))]),_:1},8,["class"])]),_:1}),a(e(se),{class:"w-auto p-0"},{default:r(()=>[a(e($t),{modelValue:o.date,"onUpdate:modelValue":w[1]||(w[1]=g=>o.date=g),"initial-focus":"","number-of-months":2,"onUpdate:startValue":w[2]||(w[2]=g=>o.date.start=g)},null,8,["modelValue"])]),_:1})]),_:1})]),c("div",ea,[ta,a(e(le),{class:"col-span-1",open:i.is_open,"onUpdate:open":w[4]||(w[4]=g=>i.is_open=g)},{default:r(()=>[a(e(ae),{"as-child":""},{default:r(()=>[a(e(k),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full lg:w-1/3 justify-between px-3",disabled:i.is_loading},{default:r(()=>{var g;return[u(S(o.company?(g=i.data.find(A=>A.id===o.company))==null?void 0:g.label:"Select company")+" ",1),i.is_loading?(d(),f(V,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),f(V,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),a(e(se),{class:"md:w-[500px] p-1"},{default:r(()=>[a(e(je),null,{default:r(()=>[a(e(He),{class:"h-9",modelValue:v.value,"onUpdate:modelValue":w[3]||(w[3]=g=>v.value=g),placeholder:"Search company..."},null,8,["modelValue"]),a(e(Ne),null,{default:r(()=>[u("No company found.")]),_:1}),a(e(Ke),null,{default:r(()=>[a(e(Ye),null,{default:r(()=>[(d(!0),p(P,null,B(i.data,g=>(d(),f(e(Oe),{key:g.id,value:g.value??"",onSelect:()=>x(g)},{default:r(()=>[u(S(g.label)+" ",1),a(V,{name:"fa-check",class:j(["ml-auto h-4 w-4",o.company===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),c("div",aa,[a(e(k),{onClick:$,class:"w-[100px]"},{default:r(()=>[u("Filter")]),_:1})])])]),a(e(te),{class:"border-primary"}),c("div",sa,[c("div",la,[a(e(k),{onClick:_,class:"w-[100px]"},{default:r(()=>[u("All")]),_:1})])])])}}}),z=h({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(s){return(t,l)=>{const n=U("VIcon");return t.column.getCanSort()?(d(),p("div",{key:0,class:j(e(F)("flex items-center space-x-2",t.$attrs.class??""))},[a(e(de),null,{default:r(()=>[a(e(re),{"as-child":""},{default:r(()=>[a(e(k),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:r(()=>[c("span",null,S(t.title),1),t.column.getIsSorted()==="desc"?(d(),f(n,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):t.column.getIsSorted()==="asc"?(d(),f(n,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(d(),f(n,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),a(e(ie),{align:"start"},{default:r(()=>[a(e(ee),{onClick:l[0]||(l[0]=o=>t.column.toggleSorting(!1))},{default:r(()=>[a(n,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Asc ")]),_:1}),a(e(ee),{onClick:l[1]||(l[1]=o=>t.column.toggleSorting(!0))},{default:r(()=>[a(n,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Desc ")]),_:1}),a(e(ne)),a(e(ee),{onClick:l[2]||(l[2]=o=>t.column.toggleVisibility(!1))},{default:r(()=>[a(n,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),u(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(d(),p("div",{key:1,class:j(t.$attrs.class)},S(t.title),3))}}}),oa=L.object({id:L.number(),invoice:L.string(),company_name:L.string(),customer_name:L.string().min(2).max(50),event_display:L.string(),scheduled_date:L.preprocess(s=>typeof s=="string"?new Date(s):s,L.date()),completed_date:L.string().nullable(),status:L.string(),additional_info:L.string(),change_info:L.string().nullable(),editable:L.boolean()}),ra=h({__name:"DataTableRefreshSession",props:{row:{}},setup(s){const t=Y("sessionStore",N("session")),n=K({id:s.row.id}),o=I(!1),{toast:i}=Q();async function m(){o.value=!0;try{const v=await X.patch("/api/session/refresh_session",{...n},{headers:{"Content-Type":"multipart/form-data"}});await t.refresh(t.page_index),i({title:v.data.Result,variant:"success"})}catch{i({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{o.value=!1}}return(v,D)=>{const $=U("VIcon");return d(),p("div",null,[c("div",null,[a(e(k),{variant:"ghost",size:"sm",class:"h-8 flex justify-start w-full",onClick:m},{default:r(()=>[a($,{name:"md-refresh",class:"size-4 mr-2"}),u(" Refresh Schedule ")]),_:1})])])}}}),ia={class:"grid gap-4 py-4"},da={class:"grid grid-cols-4 items-center gap-4"},ca={class:"grid grid-cols-4 items-center gap-4"},ua={class:"col-span-3"},fa={key:0,class:"grid grid-cols-4 items-center gap-4"},pa=h({__name:"DataTableEditScheduleModal",props:{row:{}},setup(s){const t=Y("sessionStore",N("session")),l=s,n=K({id:l.row.id,invoice:l.row.invoice,scheduled_date:new W(l.row.scheduled_date.getFullYear(),l.row.scheduled_date.getMonth()+1,l.row.scheduled_date.getDate())}),o=I(!1),i=I(!1),m=I(null),{toast:v}=Q(),D=gt(new Date,1),$=new W(D.getFullYear(),D.getMonth()+1,D.getDate());function _(){const w=[{condition:n.scheduled_date==null,message:"Schedule Date cannot be blank"}];for(let V of w)if(V.condition)return m.value=V.message,!1;return!0}async function C(){if(_()){o.value=!0;try{const V=await X.patch(`/api/session/${l.row.id}/scheduled_date`,{...n},{headers:{"Content-Type":"multipart/form-data"}});x(),await t.refresh(t.page_index),v({title:V.data.Result,variant:"success"})}catch{v({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{o.value=!1}}}function x(){i.value=!i.value}function b(w){n.scheduled_date=w}return(w,V)=>{const g=U("VIcon");return d(),p("div",null,[c("div",null,[a(e(k),{variant:"ghost",size:"sm",class:"h-8 flex justify-start w-full",onClick:x},{default:r(()=>[a(g,{name:"fa-pen",class:"size-4 mr-2"}),u(" Edit Schedule ")]),_:1})]),a(e(qe),{open:i.value,"onUpdate:open":V[2]||(V[2]=A=>i.value=A)},{default:r(()=>[a(e(Ee),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:r(()=>[a(e(We),null,{default:r(()=>[a(e(Ge),null,{default:r(()=>[u("Reschedule Reminder")]),_:1})]),_:1}),c("div",ia,[c("div",da,[a(e(E),{for:"invoice",class:"text-right"},{default:r(()=>[u(" Invoice ")]),_:1}),a(e(ce),{id:"invoice",modelValue:n.invoice,"onUpdate:modelValue":V[0]||(V[0]=A=>n.invoice=A),class:"col-span-3",disabled:""},null,8,["modelValue"])]),c("div",ca,[a(e(E),{for:"email",class:"text-right"},{default:r(()=>[u(" Schedule Date ")]),_:1}),c("div",ua,[a(e(le),null,{default:r(()=>[a(e(ae),{"as-child":""},{default:r(()=>[a(e(k),{variant:"outline",class:j(e(F)("w-full justify-start text-left font-normal",!n.scheduled_date&&"text-muted-foreground"))},{default:r(()=>[a(g,{name:"bi-calendar-fill",class:"mr-2 size-4"}),c("span",null,S(n.scheduled_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),a(e(se),{class:"w-auto p-0"},{default:r(()=>[a(e(yt),{mode:"date","min-value":e($),"model-value":n.scheduled_date,"onUpdate:modelValue":V[1]||(V[1]=A=>b(A)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"},"is-required":""},null,8,["min-value","model-value"])]),_:1})]),_:1})])])]),a(te),m.value?(d(),p("div",fa,[a(e(E),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:r(()=>[a(g,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),u(" "+S(m.value),1)]),_:1})])):H("",!0),a(e(vt),{class:"flex justify-end"},{default:r(()=>[a(e(k),{type:"submit",onClick:C,disabled:o.value},{default:r(()=>[o.value?(d(),f(g,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):H("",!0),u(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ma=h({__name:"AlertDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean}},emits:["update:open"],setup(s,{emit:t}){const o=oe(s,t);return(i,m)=>(d(),f(e(Je),Qe(Xe(e(o))),{default:r(()=>[M(i.$slots,"default")]),_:3},16))}}),_a=h({__name:"AlertDialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(s,{emit:t}){const l=s,n=t,o=R(()=>{const{class:m,...v}=l;return v}),i=oe(o,n);return(m,v)=>(d(),f(e(tt),null,{default:r(()=>[a(e(Ze),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(et),T(e(i),{class:e(F)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l.class)}),{default:r(()=>[M(m.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),ga=h({__name:"AlertDialogHeader",props:{class:{}},setup(s){const t=s;return(l,n)=>(d(),p("div",{class:j(e(F)("flex flex-col gap-y-2 text-center sm:text-left",t.class))},[M(l.$slots,"default")],2))}}),ha=h({__name:"AlertDialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:n,...o}=t;return o});return(n,o)=>(d(),f(e(at),T(l.value,{class:e(F)("text-lg font-semibold",t.class)}),{default:r(()=>[M(n.$slots,"default")]),_:3},16,["class"]))}}),wa=h({__name:"AlertDialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:n,...o}=t;return o});return(n,o)=>(d(),f(e(st),T(l.value,{class:e(F)("text-sm text-muted-foreground",t.class)}),{default:r(()=>[M(n.$slots,"default")]),_:3},16,["class"]))}}),ya=h({__name:"AlertDialogFooter",props:{class:{}},setup(s){const t=s;return(l,n)=>(d(),p("div",{class:j(e(F)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",t.class))},[M(l.$slots,"default")],2))}}),ba=h({__name:"AlertDialogAction",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:n,...o}=t;return o});return(n,o)=>(d(),f(e(lt),T(l.value,{class:e(F)(e(q)(),t.class)}),{default:r(()=>[M(n.$slots,"default")]),_:3},16,["class"]))}}),va=h({__name:"AlertDialogCancel",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const t=s,l=R(()=>{const{class:n,...o}=t;return o});return(n,o)=>(d(),f(e(nt),T(l.value,{class:e(F)(e(q)({variant:"outline"}),"mt-2 sm:mt-0",t.class)}),{default:r(()=>[M(n.$slots,"default")]),_:3},16,["class"]))}}),xa={key:0,class:"grid grid-cols-4 items-center gap-4"},$a=h({__name:"DataTableSendMessageModal",props:{row:{}},setup(s){const t=Y("sessionStore",N("session")),l=s;K({id:l.row.id,customer_name:l.row.customer_name});const n=I(!1),o=I(!1),i=I(null),{toast:m}=Q();async function v(){n.value=!0;try{const $=await X.post(`/api/session/${l.row.id}/send_whatsapp`);D(),await t.refresh(t.page_index),m({title:"Operation in queue",description:$.data.Result,variant:"success"})}catch{m({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{n.value=!1}}function D(){o.value=!o.value}return($,_)=>{const C=U("VIcon");return d(),p("div",null,[c("div",null,[a(e(k),{size:"sm",class:"hidden w-full h-8 lg:flex bg-green-500",onClick:D},{default:r(()=>[a(C,{name:"bi-whatsapp",class:"size-4 mr-2"}),u(" Send Whatsapp Message ")]),_:1})]),a(e(ma),{open:o.value,"onUpdate:open":_[0]||(_[0]=x=>o.value=x)},{default:r(()=>[a(e(_a),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:r(()=>[a(e(ga),null,{default:r(()=>[a(e(ha),null,{default:r(()=>[u("Are you sure?")]),_:1}),a(e(wa),null,{default:r(()=>[u(" This action will send a payment reminder to "+S(l.row.customer_name),1)]),_:1})]),_:1}),i.value?(d(),p("div",xa,[a(e(E),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:r(()=>[a(C,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),u(" "+S(i.value),1)]),_:1})])):H("",!0),a(e(ya),{class:"flex justify-end"},{default:r(()=>[a(e(va),null,{default:r(()=>[u("Cancel")]),_:1}),a(e(ba),{onClick:v,disabled:n.value},{default:r(()=>[n.value?(d(),f(C,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):H("",!0),u(" Send")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Sa={class:"w-fit mx-auto"},Ca=c("span",{class:"sr-only"},"Open menu",-1),Va=h({__name:"DataTableRowActions",props:{row:{}},setup(s){const t=s,l=R(()=>oa.parse(t.row.original));return(n,o)=>{const i=U("VIcon");return d(),p("div",Sa,[a(e(de),null,{default:r(()=>[a(e(re),{"as-child":""},{default:r(()=>[a(e(k),{variant:"default",class:"flex h-8 w-8 p-0"},{default:r(()=>[a(i,{name:"bi-three-dots",class:"size-4"}),Ca]),_:1})]),_:1}),a(e(ie),{align:"end",class:"w-min-fit"},{default:r(()=>[a(pa,{row:l.value},null,8,["row"]),a(ra,{row:l.value},null,8,["row"]),a(e(ne)),a($a,{row:l.value},null,8,["row"])]),_:1})]),_:1})])}}}),ka=[{id:"select",header:({table:s})=>y(pe,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":t=>s.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:s})=>y(pe,{checked:s.getIsSelected(),"onUpdate:checked":t=>s.toggleSelected(!!t),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"id",header:({column:s})=>y(z,{column:s,title:"Id"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("id")),enableSorting:!0,enableHiding:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())??"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Id"}},{accessorKey:"invoice",header:({column:s})=>y(z,{column:s,title:"Invoice"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())??"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Invoice"}},{accessorKey:"company_name",header:({column:s})=>y(z,{column:s,title:"Company"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("company_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())??"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Company"}},{accessorKey:"customer_name",header:({column:s})=>y(z,{column:s,title:"Customer"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())??"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Customer"}},{accessorKey:"event_display",header:({column:s})=>y(z,{column:s,title:"Event Type"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("event_display")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())??"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Event Type"}},{accessorKey:"scheduled_date",header:({column:s})=>y(z,{column:s,title:s.columnDef.meta.title}),cell:({row:s})=>{const t=s.getValue("scheduled_date");let l="";if(t){const n=new Date(Date.parse(t));isNaN(n.getTime())?l="Not Provided":l=n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return y("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Scheduled Date"}},{accessorKey:"status",header:({column:s})=>y(z,{column:s,title:"Status"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("status")),enableSorting:!0,enableHiding:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())||"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Status"}},{accessorKey:"additional_info",header:({column:s})=>y(z,{column:s,title:"Additional Info"}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("additional_info")),enableSorting:!0,enableHiding:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())||"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Additional Info"}},{accessorKey:"change_info",header:({column:s})=>y(z,{column:s,title:"Change Info"}),cell:({row:s})=>y("div",{class:"w-44"},s.getValue("change_info")),enableSorting:!0,enableHiding:!0,filterFn:(s,t,l)=>{var i;const n=((i=s.getValue(t))==null?void 0:i.toString().toLowerCase())||"",o=l==null?void 0:l.toString().toLowerCase();return n.includes(o)},meta:{title:"Change Info"}},{accessorKey:"completed_date",header:({column:s})=>y(z,{column:s,title:s.columnDef.meta.title}),cell:({row:s})=>y("div",{class:"w-fit"},s.getValue("completed_date")),enableSorting:!0,enableHiding:!0,meta:{title:"Completed Date"}},{id:"actions",cell:({row:s})=>y(Va,{row:s})}],Da={class:"p-4 md:p-8 space-y-8 h-full"},Pa=c("div",{class:"flex items-center justify-between space-y-2"},[c("div",null,[c("h2",{class:"text-2xl font-bold tracking-tight"},"Session")])],-1),Fa={key:0,class:"text-center"},Ia={key:1},La="/api/session",Na=h({__name:"Session",setup(s){const t=N("session"),l=n=>({id:n.id,invoice:n.invoice,company_name:n.company_name,customer_name:n.customer_name,event_display:n.event_display,scheduled_date:n.scheduled_date,completed_date:n.completed_date,status:n.status_display,additional_info:n.additional_info,change_info:n.change_info,editable:n.editable});return _e(async()=>{await t.fetch(La,0,l)}),rt("tableStore",t),ot(()=>{t.$reset()}),(n,o)=>{const i=U("VIcon");return d(),p("div",Da,[Pa,a(na),e(t).is_loading?(d(),p("div",Fa,[a(i,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(d(),p("div",Ia,[a(Et,{data:e(t).tasks,columns:e(ka)},null,8,["data","columns"])]))])}}});export{Na as default};
