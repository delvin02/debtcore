import{_ as Ue,a as Re,b as Ae,c as je,d as He,e as Se,u as ne,f as Ne,g as Le,h as Ee,i as we,j as de,k as Be,l as Ye,m as Ke,n as We,o as Ge,p as qe,q as Qe,r as Xe,F as xe,z as U,s as $e}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as j,r as Y,o as d,c as h,d as i,t as x,a as e,k as a,u as t,F,v as R,s as C,b as m,x as te,l as b,Y as O,m as T,N as q,a4 as ae,a5 as me,a8 as se,a6 as pe,a7 as J,a9 as Z,Q,R as X,n as E,g as le,at as Oe,y as Ce,z as Ve,A as De,B as oe,E as B,i as S,I as re,K as _e,H,U as ge,W as ve,X as he,a3 as Me,_ as P,Z as be,C as Je,D as ie,T as ue,ae as Ie,ar as Ze,as as Pe,j as et,au as tt,av as at,aw as st,ax as lt,a0 as V,ay as ke,G as nt,a1 as ot,a2 as it}from"../main.js";import{_ as ee}from"./index.DhdF1qMN.js";import{_ as rt}from"./CommandSeparator.vue_vue_type_script_setup_true_lang.DZgg3MH5.js";import{_ as ct,a as dt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as ye}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as L}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";import{_ as ze}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.DOcqctDd.js";import{_ as Fe}from"./lodash.BtnTHUG3.js";import{f as Te}from"./index.BccI3ZLR.js";import{l as ut,A as ft}from"./index.EdlJKn0d.js";import"./index.5qndC0qu.js";const mt={class:"flex flex-col md:flex-row items-center justify-between px-2 pb-10"},pt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},_t={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},gt={class:"flex items-center space-x-2"},vt=i("p",{class:"text-sm font-medium"},"Rows per page",-1),ht={class:"flex w-[100px] items-center justify-center text-sm font-medium"},bt={class:"flex items-center space-x-2"},yt=i("span",{class:"sr-only"},"Go to first page",-1),wt=i("span",{class:"sr-only"},"Go to previous page",-1),xt=i("span",{class:"sr-only"},"Go to next page",-1),$t=i("span",{class:"sr-only"},"Go to last page",-1),kt=j({__name:"DataTablePagination",props:{table:{}},setup(r){return(o,l)=>{const s=Y("VIcon");return d(),h("div",mt,[i("div",pt,x(o.table.getFilteredSelectedRowModel().rows.length)+" of "+x(o.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),i("div",_t,[i("div",gt,[vt,e(t(je),{"model-value":`${o.table.getState().pagination.pageSize}`,"onUpdate:modelValue":o.table.setPageSize},{default:a(()=>[e(t(Ue),{class:"h-8 w-[70px]"},{default:a(()=>[e(t(Re),{placeholder:`${o.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(t(Ae),{side:"top"},{default:a(()=>[(d(),h(F,null,R([10,20,30,40,50],c=>e(t(He),{key:c,value:`${c}`},{default:a(()=>[m(x(c),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),i("div",ht," Page "+x(o.table.getState().pagination.pageIndex+1)+" of "+x(o.table.getPageCount()),1),i("div",bt,[e(t(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanPreviousPage(),onClick:l[0]||(l[0]=c=>o.table.setPageIndex(0))},{default:a(()=>[yt,e(s,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanPreviousPage(),onClick:l[1]||(l[1]=c=>o.table.previousPage())},{default:a(()=>[wt,e(s,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanNextPage(),onClick:l[2]||(l[2]=c=>o.table.nextPage())},{default:a(()=>[xt,e(s,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(C),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanNextPage(),onClick:l[3]||(l[3]=c=>o.table.setPageIndex(o.table.getPageCount()-1))},{default:a(()=>[$t,e(s,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),fe=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claimed",icon:"fa-check-circle"},{value:"3",label:"Canceled",icon:"fa-times-circle"}],St={class:"hidden space-x-1 lg:flex"},Ct={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Vt=j({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(r){const o=r,l=te(()=>{var c;return(c=o.column)==null?void 0:c.getFacetedUniqueValues()}),s=te(()=>{var c;return new Set((c=o.column)==null?void 0:c.getFilterValue())});return(c,p)=>{const y=Y("VIcon"),D=Y("CheckIcon");return d(),b(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:a(()=>[e(y,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),m(" "+x(c.title)+" ",1),s.value.size>0?(d(),h(F,{key:0},[e(t(O),{orientation:"vertical",class:"mx-2 h-4"}),e(t(ee),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:a(()=>[m(x(s.value.size),1)]),_:1}),i("div",St,[s.value.size>2?(d(),b(t(ee),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x(s.value.size)+" selected ",1)]),_:1})):(d(!0),h(F,{key:1},R(c.options.filter($=>s.value.has($.value)),$=>(d(),b(t(ee),{key:$.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x($.label),1)]),_:2},1024))),128))])],64)):T("",!0)]),_:1})]),_:1}),e(t(Q),{class:"w-[200px] p-0",align:"start"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{placeholder:c.title},null,8,["placeholder"]),e(t(se),null,{default:a(()=>[e(t(pe),null,{default:a(()=>[m("No results found.")]),_:1}),e(t(J),null,{default:a(()=>[(d(!0),h(F,null,R(c.options,$=>(d(),b(t(Z),{key:$.value,value:$,onSelect:w=>{var k;s.value.has($.value)?s.value.delete($.value):s.value.add($.value);const M=Array.from(s.value);(k=c.column)==null||k.setFilterValue(M.length?M:void 0)}},{default:a(()=>{var w;return[i("div",{class:E(t(le)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",s.value.has($.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(D,{class:E(t(le)("h-4 w-4"))},null,8,["class"])],2),$.icon?(d(),b(Oe($.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):T("",!0),i("span",null,x($.label),1),(w=l.value)!=null&&w.get($.value)?(d(),h("span",Ct,x(l.value.get($.value)),1)):T("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),s.value.size>0?(d(),h(F,{key:0},[e(t(rt)),e(t(J),null,{default:a(()=>[e(t(Z),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:p[0]||(p[0]=$=>{var w;return(w=c.column)==null?void 0:w.setFilterValue(void 0)})},{default:a(()=>[m(" Clear filters ")]),_:1})]),_:1})],64)):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Dt=j({__name:"DataTableViewOptions",props:{table:{}},setup(r){const o=r,l=te(()=>o.table.getAllColumns().filter(s=>typeof s.accessorFn<"u"&&s.getCanHide()));return(s,c)=>(d(),b(t(De),null,{default:a(()=>[e(t(Ce),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:a(()=>[m(" View ")]),_:1})]),_:1}),e(t(Ve),{align:"end",class:"w-[150px]"},{default:a(()=>[e(t(ct),null,{default:a(()=>[m("Toggle columns")]),_:1}),e(t(Se)),(d(!0),h(F,null,R(l.value,p=>(d(),b(t(dt),{key:p.id,class:"capitalize",checked:p.getIsVisible(),"onUpdate:checked":y=>p.toggleVisibility(!!y)},{default:a(()=>{var y;return[m(x(((y=p.columnDef.meta)==null?void 0:y.title)||p.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),Mt={class:"grid gap-4 py-4"},It={class:"grid grid-cols-4 items-center gap-4"},Pt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),zt={class:"grid grid-cols-4 items-center gap-4"},Ft=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Tt={class:"col-span-3"},Ut={class:"grid grid-cols-4 items-center gap-4"},Rt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),At={class:"grid grid-cols-4 items-center gap-4"},jt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ht={class:"col-span-3"},Nt={class:"grid grid-cols-4 items-center gap-4"},Lt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Et={class:"grid grid-cols-4 items-center gap-4"},Bt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Yt={class:"col-span-3"},Kt={class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Wt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Gt={class:"col-span-3"},qt=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),Qt={key:0,class:"grid grid-cols-4 items-center gap-4"},Xt=j({__name:"DataTableCreateDebt",setup(r){const o=oe("tableStore",ne("debt")),l=B({invoice:"",customer:null,amount:null,invoice_date:null,term:7,status:null,document:null}),s=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),c=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=S("");async function y(_){s.is_loading=!0;try{const n=await H.get(`/api/customer/list?search=${_||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});s.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{s.is_loading=!1}}async function D(){s.is_loading=!0;try{const _=await H.get("/api/debt/status/create/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=_.data.Result,l.status=1}catch{M({title:"Whoops, something went wrong",description:"There was an error fetching the select list.",variant:"destructive"})}finally{c.is_loading=!1}}const $=S(!1),w=S(!1),v=S(null);S();const{toast:M}=re();_e(p,Fe.debounce(async _=>{w.value&&await y(_)},500));function k(){var n;const _=[{condition:l.invoice==="",message:"Invoice cannot be blank"},{condition:((n=l.invoice_date)==null?void 0:n.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let f of _)if(f.condition)return v.value=f.message,!1;return!0}async function I(){if(k()){$.value=!0;try{const n=await H.post("/api/debt",{...l},{headers:{"Content-Type":"multipart/form-data"}});A(),await o.refresh(o.page_index),M({title:n.data.Result,variant:"success"})}catch{M({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{$.value=!1}}}function A(){w.value=!w.value,w.value&&(y(p.value),D())}function G(_){l.customer=_.id,s.is_open=!1}function N(_){l.status=_.id,c.is_open=!1}function K(_){var f;const n=_.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){M({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){M({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}l.document=u}}function z(_){const n=new Date(_);l.invoice_date=Te(n,"yyyy-MM-dd")}return(_,n)=>{const f=Y("VIcon");return d(),h("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 ml-2 flex",onClick:A},{default:a(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(t(be),{open:w.value,"onUpdate:open":n[7]||(n[7]=u=>w.value=u)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Create Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click create when you're done. ")]),_:1})]),_:1}),i("div",Mt,[i("div",It,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),Pt]),_:1}),e(t(L),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":n[0]||(n[0]=u=>l.invoice=u),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",zt,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),Ft]),_:1}),i("div",Tt,[e(t(X),{open:s.is_open,"onUpdate:open":n[2]||(n[2]=u=>s.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":s.is_open,class:"w-full justify-between px-3",disabled:s.is_loading},{default:a(()=>{var u;return[m(x(l.customer?(u=s.data.find(g=>g.id===l.customer))==null?void 0:u.label:"Select customer")+" ",1),s.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=u=>p.value=u),placeholder:"Search customer..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),h(F,null,R(s.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>G(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:E(["ml-auto h-4 w-4",l.customer===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",Ut,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),Rt]),_:1}),e(t(L),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":n[3]||(n[3]=u=>l.amount=u===""?null:u),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",At,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),jt]),_:1}),i("div",Ht,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",class:E(t(le)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(f,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),i("span",null,x(l.invoice_date?l.invoice_date:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(ze),{"onUpdate:modelValue":n[4]||(n[4]=u=>z(u)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Nt,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Lt]),_:1}),e(t(L),{id:"amount",modelValue:l.term,"onUpdate:modelValue":n[5]||(n[5]=u=>l.term=u),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Et,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status "),Bt]),_:1}),i("div",Yt,[e(t(X),{open:c.is_open,"onUpdate:open":n[6]||(n[6]=u=>c.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var u;return[m(x(l.status?(u=c.data.find(g=>g.id===l.status))==null?void 0:u.label:"Select status")+" ",1),c.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),h(F,null,R(c.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>N(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:E(["ml-auto h-4 w-4",l.status===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(O),i("div",Kt,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment "),Wt]),_:1}),i("div",Gt,[e(t(L),{id:"name",type:"file",onChange:K,class:"col-span-3"})]),qt])]),e(O),v.value?(d(),h("div",Qt,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(v.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[e(t(C),{type:"submit",onClick:I,disabled:$.value},{default:a(()=>[$.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ot={class:"flex items-center justify-between"},Jt={class:"flex flex-1 items-center space-x-2"},Zt=j({__name:"DataTableToolbar",props:{table:{}},setup(r){const o=r,l=te(()=>o.table.getState().columnFilters.length>0);return(s,c)=>{var p;return d(),h("div",Ot,[i("div",Jt,[e(t(L),{placeholder:"Search...","model-value":((p=s.table.getColumn("invoice"))==null?void 0:p.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:c[0]||(c[0]=y=>s.table.setGlobalFilter(y.target.value))},null,8,["model-value"]),s.table.getColumn("status")?(d(),b(Vt,{key:0,column:s.table.getColumn("status"),title:"Status",options:t(fe)},null,8,["column","options"])):T("",!0),l.value?(d(),b(t(C),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:c[1]||(c[1]=y=>s.table.resetColumnFilters())},{default:a(()=>[m(" Reset ")]),_:1})):T("",!0)]),e(Dt,{table:s.table},null,8,["table"]),e(Xt,{table:s.table},null,8,["table"])])}}}),ea={class:"space-y-4 text-muted-foreground"},ta={class:"rounded-md border"},aa=j({__name:"DataTable",props:{columns:{},data:{}},setup(r){const o=oe("tableStore",ne("debt")),l=r,s=S([]),c=S([]),p=S({}),y=S({pageIndex:o.page_index,pageSize:o.page_size}),D=S();function $(v,M){let k;typeof v=="function"?k=v(M.value):k=v,M.value=k,o.set_page_index(k.pageIndex),o.set_page_size(k.pageSize)}const w=Ne({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return s.value},get columnFilters(){return c.value},get columnVisibility(){return p.value},get rowSelection(){return D.value},get pagination(){return y.value}},enableRowSelection:!0,onSortingChange:v=>ie(v,s),onPaginationChange:v=>$(v,y),onColumnFiltersChange:v=>ie(v,c),onColumnVisibilityChange:v=>ie(v,p),onRowSelectionChange:v=>ie(v,D),getCoreRowModel:Ye(),getFilteredRowModel:Ke(),getPaginationRowModel:We(),getSortedRowModel:Ge(),getFacetedRowModel:qe(),getFacetedUniqueValues:Qe()});return Je(()=>{w.setPageIndex(o.page_index),w.setPageSize(o.page_size)}),(v,M)=>(d(),h("div",ea,[e(Zt,{table:t(w)},null,8,["table"]),i("div",ta,[e(t(Be),{class:"text-xs"},{default:a(()=>[e(t(Le),null,{default:a(()=>[(d(!0),h(F,null,R(t(w).getHeaderGroups(),k=>(d(),b(t(de),{key:k.id},{default:a(()=>[(d(!0),h(F,null,R(k.headers,I=>(d(),b(t(Xe),{key:I.id},{default:a(()=>[I.isPlaceholder?T("",!0):(d(),b(t(xe),{key:0,render:I.column.columnDef.header,props:I.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(t(Ee),{id:"dbTableBody"},{default:a(()=>{var k;return[(k=t(w).getRowModel().rows)!=null&&k.length?(d(!0),h(F,{key:0},R(t(w).getRowModel().rows,I=>(d(),b(t(de),{key:I.id,"data-state":I.getIsSelected()&&"selected"},{default:a(()=>[(d(!0),h(F,null,R(I.getVisibleCells(),A=>(d(),b(t(we),{key:A.id},{default:a(()=>[e(t(xe),{render:A.column.columnDef.cell,props:A.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),b(t(de),{key:1},{default:a(()=>[e(t(we),{colspan:v.columns.length,class:"h-24 text-center"},{default:a(()=>[m(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(kt,{table:t(w)},null,8,["table"])]))}}),W=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(r){return(o,l)=>{const s=Y("VIcon");return o.column.getCanSort()?(d(),h("div",{key:0,class:E(t(le)("flex items-center space-x-2",o.$attrs.class??""))},[e(t(De),null,{default:a(()=>[e(t(Ce),{"as-child":""},{default:a(()=>[e(t(C),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:a(()=>[i("span",null,x(o.title),1),o.column.getIsSorted()==="desc"?(d(),b(s,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):o.column.getIsSorted()==="asc"?(d(),b(s,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(d(),b(s,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(t(Ve),{align:"start"},{default:a(()=>[e(t(ue),{onClick:l[0]||(l[0]=c=>o.column.toggleSorting(!1))},{default:a(()=>[e(s,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Asc ")]),_:1}),e(t(ue),{onClick:l[1]||(l[1]=c=>o.column.toggleSorting(!0))},{default:a(()=>[e(s,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Desc ")]),_:1}),e(t(Se)),e(t(ue),{onClick:l[2]||(l[2]=c=>o.column.toggleVisibility(!1))},{default:a(()=>[e(s,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(d(),h("div",{key:1,class:E(o.$attrs.class)},x(o.title),3))}}}),sa=U.object({id:U.number(),invoice:U.string(),customer_name:U.string().min(2).max(50),invoice_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),due_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),term:U.number(),amount:U.string(),document_url:U.string(),status:U.number(),editable:U.boolean()}),la={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},na={class:"col-span-3"},oa=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),ia={key:1},ra={class:"flex justify-center my-auto items-center place-items-center mb-2"},ca={class:"mx-2"},da={class:"flex justify-center my-auto items-center place-items-center"},ua=["src"],fa={key:0,class:"grid grid-cols-4 items-center gap-4"},ma=j({__name:"DataTableCheckAttachment",props:{row:{}},setup(r){const o=oe("tableStore",ne("debt")),l=r,s=B({document:null,document_url:l.row.document_url}),c=B({pdf:void 0,pages:void 0,info:void 0}),p=S(1),y=S(!1),D=S(!1),$=S(null),w=S(window.innerHeight-250),{toast:v}=re();function M(_){v({title:"PDF loading error",variant:"destructive"})}async function k(){try{y.value=!0;const _=await H.get(`/api/debt/${l.row.id}/document/`);s.document_url=_.data.Result.document_url;const n=ft(s.document_url,{onError:M});Pe(()=>{c.pdf=n.pdf,c.pages=n.pages,c.info=n.info})}catch{N(),v({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}const I=()=>{const _=document.querySelector("#vp > div > div > div > canvas");if(_){const n=_.offsetHeight,f=window.innerHeight-250,u=680;f>n&&n<u?w.value=n:f>n?w.value=f:w.value=Math.min(Math.max(n,u),f)}};function A(){const _=[{condition:s.document==null,message:"Attachment cannot be blank"}];for(let n of _)if(n.condition)return $.value=n.message,!1;return!0}async function G(){if(A()){y.value=!0;try{const n=await H.patch(`/api/debt/${l.row.id}/document/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});K(),await o.refresh(o.page_index),v({title:n.data.Result,variant:"success"})}catch{v({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function N(){s.document_url=null}function K(){D.value=!D.value,D.value&&k()}function z(_){var f;const n=_.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){v({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){v({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}s.document=u}}return(_,n)=>{const f=Y("VIcon");return d(),h("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:K},{default:a(()=>[e(f,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),e(t(be),{class:"my-2",open:D.value,"onUpdate:open":n[2]||(n[2]=u=>D.value=u)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-fit"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Attachment Overview")]),_:1})]),_:1}),i("div",null,[s.document_url?s.document_url.endsWith(".pdf")?(d(),h("div",ia,[i("div",ra,[e(t(C),{variant:"secondary",onClick:n[0]||(n[0]=u=>p.value=p.value>1?p.value-1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),i("span",ca,x(p.value)+" / "+x(c.pages),1),e(t(C),{variant:"secondary",onClick:n[1]||(n[1]=u=>p.value=p.value<c.pages?p.value+1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),e(t(Ie),{class:"border border-primary md:w-[720px] w-full",style:Ze([{"overflow-y":"auto","overflow-x":"hidden"},{height:w.value+"px"}])},{default:a(()=>[e(t(ut),{pdf:c.pdf,page:p.value,"fit-parent":"",onLoaded:I,"annonation-layer":""},{default:a(()=>[i("div",da,[e(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(d(),h("img",{key:2,src:s.document_url,alt:"Document preview",class:"object-contain"},null,8,ua)):(d(),h("div",la,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment ")]),_:1}),i("div",na,[e(t(L),{id:"name",type:"file",onChange:z,class:"col-span-3"})]),oa]))]),e(t(O)),$.value?(d(),h("div",fa,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x($.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[s.document_url?(d(),b(t(C),{key:0,class:"bg-red-600 text-white",onClick:N,disabled:y.value},{default:a(()=>[m(" Replace")]),_:1},8,["disabled"])):(d(),b(t(C),{key:1,onClick:G,disabled:y.value},{default:a(()=>[y.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),pa={class:"grid gap-4 py-4"},_a={class:"grid grid-cols-4 items-center gap-4"},ga=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),va={class:"grid grid-cols-4 items-center gap-4"},ha=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ba={class:"col-span-3"},ya={class:"grid grid-cols-4 items-center gap-4"},wa=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),xa={class:"grid grid-cols-4 items-center gap-4"},$a=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ka={class:"col-span-3"},Sa={class:"grid grid-cols-4 items-center gap-4"},Ca=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Va={class:"grid grid-cols-4 items-center gap-4"},Da={class:"col-span-3"},Ma={key:0,class:"grid grid-cols-4 items-center gap-4"},Ia=j({__name:"DataTableEditModal",props:{row:{}},setup(r){const o=oe("tableStore",ne("debt")),l=r,s=B({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),c=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),y=S("");async function D(n){c.is_loading=!0;try{const f=await H.get(`/api/customer/list?search=${n||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=f.data.Result}catch{k({title:"Whoops, something went wrong",description:"There was an error fetching the select list",variant:"destructive"})}finally{c.is_loading=!1}}async function $(){c.is_loading=!0;try{const n=await H.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});p.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{p.is_loading=!1}}const w=S(!1),v=S(!1),M=S(null),{toast:k}=re();_e(y,Fe.debounce(async n=>{v.value&&await D(n)},500));async function I(){try{const n=await H.get(`/api/debt/${l.row.id}/`);Object.assign(s,n.data.Result)}catch(n){console.log(n)}finally{w.value=!1}}function A(){var f;const n=[{condition:s.invoice==null,message:"Invoice cannot be blank"},{condition:((f=s.invoice_date)==null?void 0:f.toString)==null,message:"Invoice Date cannot be blank"},{condition:s.status==null,message:"Status cannot be blank"},{condition:s.customer==null,message:"Customer cannot be blank"}];for(let u of n)if(u.condition)return M.value=u.message,!1;return!0}async function G(){if(A()){w.value=!0;try{const f=await H.patch(`/api/debt/${l.row.id}/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});N(),await o.refresh(o.page_index),console.log("hello "+o.page_index),k({title:f.data.Result,variant:"success"})}catch{k({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{w.value=!1}}}function N(){v.value=!v.value,v.value&&(I(),D(y.value),$())}function K(n){s.customer=n.id,c.is_open=!1}function z(n){s.status=n.id,p.is_open=!1}function _(n){const f=new Date(n);s.invoice_date=Te(f,"yyyy-MM-dd")}return(n,f)=>{const u=Y("VIcon");return d(),h("div",null,[i("div",null,[e(t(C),{variant:"default",size:"sm",class:"h-8 lg:flex",onClick:N},{default:a(()=>[e(u,{name:"fa-pen",class:"size-4"})]),_:1})]),e(t(be),{open:v.value,"onUpdate:open":f[7]||(f[7]=g=>v.value=g)},{default:a(()=>[e(t(ge),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(ve),null,{default:a(()=>[e(t(he),null,{default:a(()=>[m("Edit Debt")]),_:1}),e(t(Me),null,{default:a(()=>[m(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),i("div",pa,[i("div",_a,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),ga]),_:1}),e(t(L),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":f[0]||(f[0]=g=>s.invoice=g),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",va,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),ha]),_:1}),i("div",ba,[e(t(X),{open:c.is_open,"onUpdate:open":f[2]||(f[2]=g=>c.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var g;return[m(x(s.customer?(g=c.data.find(ce=>ce.id===s.customer))==null?void 0:g.label:"Select customer")+" ",1),c.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(me),{class:"h-9",modelValue:y.value,"onUpdate:modelValue":f[1]||(f[1]=g=>y.value=g),placeholder:"Search country..."},null,8,["modelValue"]),e(t(pe),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),h(F,null,R(c.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>K(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:E(["ml-auto h-4 w-4",s.customer===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",ya,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),wa]),_:1}),e(t(L),{id:"amount",modelValue:s.amount===null?"":s.amount,"onUpdate:modelValue":f[3]||(f[3]=g=>s.amount=g===""?null:g),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",xa,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),$a]),_:1}),i("div",ka,[e(t(X),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",class:E(t(le)("w-full justify-start text-left font-normal",!s.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(u,{name:"bi-calendar-fill",class:"mr-2 size-4"}),i("span",null,x(s.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(ze),{"onUpdate:modelValue":f[4]||(f[4]=g=>_(g)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Sa,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Ca]),_:1}),e(t(L),{id:"amount",modelValue:s.term,"onUpdate:modelValue":f[5]||(f[5]=g=>s.term=g),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Va,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status ")]),_:1}),i("div",Da,[e(t(X),{open:p.is_open,"onUpdate:open":f[6]||(f[6]=g=>p.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(C),{variant:"outline",role:"combobox","aria-expanded":p.is_open,class:"w-full justify-between px-3",disabled:p.is_loading},{default:a(()=>{var g;return[m(x(s.status?(g=p.data.find(ce=>ce.id===s.status))==null?void 0:g.label:"Select status")+" ",1),p.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),h(F,null,R(p.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>z(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:E(["ml-auto h-4 w-4",s.status===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),e(O),M.value?(d(),h("div",Ma,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(M.value),1)]),_:1})])):T("",!0),e(t(ye),{class:"flex justify-end"},{default:a(()=>[e(t(C),{type:"submit",onClick:G,disabled:w.value},{default:a(()=>[w.value?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Pa={class:"flex flex-col justify-between"},za={class:"pr-4"},Fa={class:"flex justify-between"},Ta={key:0,class:"text-primary font-bold flex place-items-center self-center"},Ua={key:1,class:"text-primary font-bold"},Ra={class:"text-primary"},Aa={class:"text-sm"},ja={class:"flex mt-2 gap-2"},Ha={class:"text-xs mt-2"},Na=j({__name:"DataTableBacklog",props:{row:{}},setup(r){const o=et(),l=r,s=B({debt:l.row.id,message:""}),c=B([]),p=S(!1),y=S(!1),D=S(null),{toast:$}=re();var w=S(null),v=S(null),M=S(0),k=oe("height");async function I(){try{const z=await H.get(`/api/debt/${l.row.id}/backlog/`);c.splice(0,c.length,...z.data.Result),p.value=!1}catch{$({title:"Whoops, something went wrong",description:"Form initialisation error.",variant:"destructive"})}finally{p.value=!1}}function A(){const z=[{condition:s.message=="",message:"Message cannot be blank"},{condition:s.message.length<5,message:"Maybe a little more context?"}];for(let _ of z)if(_.condition)return D.value=_.message,!1;return!0}async function G(){if(A()){p.value=!0;try{const _=await H.post(`/api/debt/${l.row.id}/backlog/`,{...s},{headers:{"Content-Type":"application/json"}});await I(),$({title:_.data.Result,variant:"success"}),s.message="",D.value=""}catch{$({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{p.value=!1}}}const N=()=>{Pe().then(()=>{var z,_;k&&(M.value=k.value-((((z=w.value)==null?void 0:z.clientHeight)||0)+(((_=v.value)==null?void 0:_.clientHeight)||0))-50)})};_e([w,v],N,{immediate:!0});function K(){y.value=!y.value,y.value&&(I(),N())}return(z,_)=>{const n=Y("VIcon"),f=Y("Label");return d(),h("div",null,[i("div",null,[e(t(C),{variant:"secondary",size:"sm",class:"h-8 flex border border-primary",onClick:K},{default:a(()=>[e(n,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),e(t(lt),{open:y.value,"onUpdate:open":_[1]||(_[1]=u=>y.value=u)},{default:a(()=>[e(t(tt),{class:"h-screen",side:"right"},{default:a(()=>[i("div",{ref_key:"headerElement",ref:w},[e(t(at),null,{default:a(()=>[e(t(st),null,{default:a(()=>[m("Backlog - "+x(l.row.invoice),1)]),_:1})]),_:1})],512),e(t(O),{class:"mt-2 mb-4 border-primary border"}),i("div",Pa,[e(t(Ie),{class:"flex flex-col h-full",style:{height:"85vh"}},{default:a(()=>[i("div",za,[(d(!0),h(F,null,R(c,(u,g)=>(d(),h("div",{key:g,class:"pr-4 my-2"},[i("div",Fa,[u.is_system_generated?(d(),h("div",Ta,[e(n,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),m(" System Generated ")])):(d(),h("div",Ua,x(u.created_by_name),1))]),i("div",null,[i("div",Ra,x(u.created_date),1),e(t(O),{variant:"default"}),i("div",null,x(u.message),1)])]))),128))])]),_:1}),i("div",{class:"flex flex-col",ref_key:"footerElement",ref:v},[D.value?(d(),b(f,{key:0,for:"error",class:"text-red-600 flex"},{default:a(()=>[e(n,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),i("p",Aa,x(D.value),1)]),_:1})):T("",!0),i("div",ja,[e(t(L),{id:"message",modelValue:s.message,"onUpdate:modelValue":_[0]||(_[0]=u=>s.message=u),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),e(t(C),{type:"submit",onClick:G},{default:a(()=>[m(" Save ")]),_:1})]),i("p",Ha,x(t(o).getUsername),1)],512)])]),_:1})]),_:1},8,["open"])])}}}),La={class:"flex gap-1"},Ea=j({__name:"DataTableRowActions",props:{row:{}},setup(r){const o=r,l=te(()=>sa.parse(o.row.original));return(s,c)=>(d(),h("div",La,[l.value.editable?(d(),b(Ia,{key:0,row:l.value},null,8,["row"])):T("",!0),e(ma,{row:l.value},null,8,["row"]),e(Na,{row:l.value},null,8,["row"])]))}}),Ba=[{id:"select",header:({table:r})=>V($e,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":o=>r.toggleAllPageRowsSelected(!!o),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:r})=>V($e,{checked:r.getIsSelected(),"onUpdate:checked":o=>r.toggleSelected(!!o),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:r})=>V(W,{column:r,title:"Invoice"}),cell:({row:r})=>{const o=fe.find(l=>l.value===r.original.status.toString());return o?V("div",{class:`w-20 font-bold ${o.label=="Canceled"?"line-through decoration-red-600":""}`},r.getValue("invoice")):null},enableSorting:!0,enableHiding:!0,filterFn:(r,o,l)=>{var p;const s=((p=r.getValue(o))==null?void 0:p.toString().toLowerCase())??"",c=l==null?void 0:l.toString().toLowerCase();return s.includes(c)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:r})=>V(W,{column:r,title:"Customer"}),cell:({row:r})=>V("div",{class:"w-fit"},r.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(r,o,l)=>{var p;const s=((p=r.getValue(o))==null?void 0:p.toString().toLowerCase())??"",c=l==null?void 0:l.toString().toLowerCase();return s.includes(c)},meta:{title:"Customer"}},{accessorKey:"invoice_date",header:({column:r})=>V(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const o=r.getValue("invoice_date");let l="";if(o){const s=new Date(Date.parse(o));isNaN(s.getTime())?l="Not Provided":l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return V("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:r})=>V(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const o=r.getValue("due_date");let l="";if(o){const s=new Date(o);isNaN(s.getTime())?l="Not Provided":l=s.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return V("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"term",header:({column:r})=>V(W,{column:r,title:"Term"}),cell:({row:r})=>V("div",{class:"w-fit"},r.getValue("term")),enableHiding:!0,meta:{title:"Term"}},{accessorKey:"amount",header:({column:r})=>V(W,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>V(ee,{variant:"destructive"},"RM "+r.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:r})=>V(W,{column:r,title:"Attachment"}),cell:({row:r})=>{const o=r.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return V(ke,{name:o.icon,class:`${o.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:r})=>V(W,{column:r,title:"Status"}),cell:({row:r})=>{const o=fe.find(l=>l.value===r.original.status.toString());return o?V(ee,{variant:"secondary",class:"inline items-center whitespace-nowrap"},[o.icon&&V(ke,{name:o.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),V("span",o.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(r,o,l)=>{const s=r.getValue(o);if(!s)return!1;const c=s.toString().toLowerCase();return l.some(y=>c.includes(y.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:r})=>V(Ea,{row:r})}],Ya={class:"p-4 md:p-8 space-y-8 h-full"},Ka=i("div",{class:"flex items-center justify-between space-y-2"},[i("div",null,[i("h2",{class:"text-2xl font-bold tracking-tight"},"Debt"),i("p",{class:"text-muted-foreground"},"Here's a list of your existing debts!")])],-1),Wa={key:0,class:"text-center"},Ga={key:1},qa="/api/debt",is=j({__name:"Debt",setup(r){const o=ne("debt"),l=s=>({id:s.id,status:s.status,invoice:s.invoice,customer_name:s.customer_name,invoice_date:new Date(s.invoice_date),due_date:new Date(s.due_date),term:s.term,amount:s.amount,document_url:s.document_url,editable:s.editable});return nt(async()=>{await o.fetch(qa,0,l)}),it("tableStore",o),ot(()=>{o.$reset()}),(s,c)=>{const p=Y("VIcon");return d(),h("div",Ya,[Ka,t(o).is_loading?(d(),h("div",Wa,[e(p,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(d(),h("div",Ga,[e(aa,{data:t(o).tasks,columns:t(Ba)},null,8,["data","columns"])]))])}}});export{is as default};
