import{_ as Te,a as Ue,b as Re,c as Ae,d as je,e as $e,u as ne,f as Le,g as Ne,h as He,i as be,j as ce,k as Be,l as Ye,m as Ee,n as Ke,o as We,p as Ge,q as qe,r as Qe,F as ye,z as R,s as we}from"./Checkbox.vue_vue_type_script_setup_true_lang-eutFf37Q.js";import{e as j,r as E,o as c,c as g,d,t as w,a as e,k as a,u as t,F as T,v as A,s as k,b as m,x as te,l as v,Q as X,m as U,O as q,X as ae,Y as fe,a0 as se,Z as me,$ as J,a1 as Z,P as Q,N as O,n as B,g as le,ao as Oe,y as ke,z as Se,A as Ce,B as ie,E as Y,i as C,J as re,V as Ve,H as L,K as _e,L as pe,M as ge,W as De,_ as z,R as ve,C as Xe,D as oe,I as ue,a9 as Me,am as Je,an as Ze,j as et,S as M,a5 as xe,G as tt,T as at,U as st}from"../main.js";import{_ as ee}from"./index-DhdF1qMN.js";import{_ as lt,a as nt,c as ot,b as it,d as rt}from"./index-DD070ssz.js";import{_ as dt,a as ct}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang-vQutYflC.js";import{_ as he}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUbi7heN.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-B0xvdIsq.js";import{_ as Ie}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-BxpccqsK.js";import{_ as Pe}from"./lodash-BtnTHUG3.js";import{f as ze}from"./index-DNZ2qQq3.js";import{l as ut,f as ft,_ as mt}from"./index-q2fvKXnx.js";const _t={class:"flex items-center justify-between px-2 pb-10"},pt={class:"flex-1 text-sm text-muted-foreground"},gt={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},vt={class:"flex items-center space-x-2"},ht=d("p",{class:"text-sm font-medium"},"Rows per page",-1),bt={class:"flex w-[100px] items-center justify-center text-sm font-medium"},yt={class:"flex items-center space-x-2"},wt=d("span",{class:"sr-only"},"Go to first page",-1),xt=d("span",{class:"sr-only"},"Go to previous page",-1),$t=d("span",{class:"sr-only"},"Go to next page",-1),kt=d("span",{class:"sr-only"},"Go to last page",-1),St=j({__name:"DataTablePagination",props:{table:{}},setup(i){return(o,l)=>{const s=E("VIcon");return c(),g("div",_t,[d("div",pt,w(o.table.getFilteredSelectedRowModel().rows.length)+" of "+w(o.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),d("div",gt,[d("div",vt,[ht,e(t(Ae),{"model-value":`${o.table.getState().pagination.pageSize}`,"onUpdate:modelValue":o.table.setPageSize},{default:a(()=>[e(t(Te),{class:"h-8 w-[70px]"},{default:a(()=>[e(t(Ue),{placeholder:`${o.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(t(Re),{side:"top"},{default:a(()=>[(c(),g(T,null,A([10,20,30,40,50],r=>e(t(je),{key:r,value:`${r}`},{default:a(()=>[m(w(r),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),d("div",bt," Page "+w(o.table.getState().pagination.pageIndex+1)+" of "+w(o.table.getPageCount()),1),d("div",yt,[e(t(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanPreviousPage(),onClick:l[0]||(l[0]=r=>o.table.setPageIndex(0))},{default:a(()=>[wt,e(s,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanPreviousPage(),onClick:l[1]||(l[1]=r=>o.table.previousPage())},{default:a(()=>[xt,e(s,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanNextPage(),onClick:l[2]||(l[2]=r=>o.table.nextPage())},{default:a(()=>[$t,e(s,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanNextPage(),onClick:l[3]||(l[3]=r=>o.table.setPageIndex(o.table.getPageCount()-1))},{default:a(()=>[kt,e(s,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),Fe=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claiming",icon:"fa-circle"},{value:"3",label:"Done",icon:"fa-check-circle"},{value:"4",label:"Canceled",icon:"fa-times-circle"}],Ct={class:"hidden space-x-1 lg:flex"},Vt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Dt=j({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(i){const o=i,l=te(()=>{var r;return(r=o.column)==null?void 0:r.getFacetedUniqueValues()}),s=te(()=>{var r;return new Set((r=o.column)==null?void 0:r.getFilterValue())});return(r,_)=>{const h=E("VIcon"),I=E("CheckIcon");return c(),v(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:a(()=>[e(h,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),m(" "+w(r.title)+" ",1),s.value.size>0?(c(),g(T,{key:0},[e(t(X),{orientation:"vertical",class:"mx-2 h-4"}),e(t(ee),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:a(()=>[m(w(s.value.size),1)]),_:1}),d("div",Ct,[s.value.size>2?(c(),v(t(ee),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(w(s.value.size)+" selected ",1)]),_:1})):(c(!0),g(T,{key:1},A(r.options.filter(x=>s.value.has(x.value)),x=>(c(),v(t(ee),{key:x.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(w(x.label),1)]),_:2},1024))),128))])],64)):U("",!0)]),_:1})]),_:1}),e(t(Q),{class:"w-[200px] p-0",align:"start"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{placeholder:r.title},null,8,["placeholder"]),e(t(se),null,{default:a(()=>[e(t(me),null,{default:a(()=>[m("No results found.")]),_:1}),e(t(J),null,{default:a(()=>[(c(!0),g(T,null,A(r.options,x=>(c(),v(t(Z),{key:x.value,value:x,onSelect:y=>{var S;s.value.has(x.value)?s.value.delete(x.value):s.value.add(x.value);const P=Array.from(s.value);(S=r.column)==null||S.setFilterValue(P.length?P:void 0)}},{default:a(()=>{var y;return[d("div",{class:B(t(le)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",s.value.has(x.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(I,{class:B(t(le)("h-4 w-4"))},null,8,["class"])],2),x.icon?(c(),v(Oe(x.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):U("",!0),d("span",null,w(x.label),1),(y=l.value)!=null&&y.get(x.value)?(c(),g("span",Vt,w(l.value.get(x.value)),1)):U("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),s.value.size>0?(c(),g(T,{key:0},[e(t(lt)),e(t(J),null,{default:a(()=>[e(t(Z),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:_[0]||(_[0]=x=>{var y;return(y=r.column)==null?void 0:y.setFilterValue(void 0)})},{default:a(()=>[m(" Clear filters ")]),_:1})]),_:1})],64)):U("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Mt=j({__name:"DataTableViewOptions",props:{table:{}},setup(i){const o=i;console.log(o.table.getAllColumns());const l=te(()=>o.table.getAllColumns().filter(s=>typeof s.accessorFn<"u"&&s.getCanHide()));return console.log(l),(s,r)=>(c(),v(t(Ce),null,{default:a(()=>[e(t(ke),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:a(()=>[m(" View ")]),_:1})]),_:1}),e(t(Se),{align:"end",class:"w-[150px]"},{default:a(()=>[e(t(dt),null,{default:a(()=>[m("Toggle columns")]),_:1}),e(t($e)),(c(!0),g(T,null,A(l.value,_=>(c(),v(t(ct),{key:_.id,class:"capitalize",checked:_.getIsVisible(),"onUpdate:checked":h=>_.toggleVisibility(!!h)},{default:a(()=>{var h;return[m(w(((h=_.columnDef.meta)==null?void 0:h.title)||_.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),It={class:"grid gap-4 py-4"},Pt={class:"grid grid-cols-4 items-center gap-4"},zt=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ft={class:"grid grid-cols-4 items-center gap-4"},Tt=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ut={class:"col-span-3"},Rt={class:"grid grid-cols-4 items-center gap-4"},At=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),jt={class:"grid grid-cols-4 items-center gap-4"},Lt=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Nt={class:"col-span-3"},Ht={class:"grid grid-cols-4 items-center gap-4"},Bt=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Yt={class:"grid grid-cols-4 items-center gap-4"},Et=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Kt={class:"col-span-3"},Wt={class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Gt=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),qt={class:"col-span-3"},Qt=d("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),d("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),Ot={key:0,class:"grid grid-cols-4 items-center gap-4"},Xt=j({__name:"DataTableCreateDebt",setup(i){const o=ie("tableStore",ne("debt")),l=Y({invoice:"",customer:null,amount:null,invoice_date:null,term:7,status:null,document:null}),s=Y({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),r=Y({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),_=C("");async function h($){s.is_loading=!0;try{const n=await L.get(`/api/customer/list?search=${$||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});s.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{s.is_loading=!1}}async function I(){s.is_loading=!0;try{const $=await L.get("/api/debt/status/create/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=$.data.Result,l.status=1}catch{P({title:"Whoops, something went wrong",description:"There was an error fetching the select list.",variant:"destructive"})}finally{r.is_loading=!1}}const x=C(!1),y=C(!1),b=C(null);C();const{toast:P}=re();Ve(_,Pe.debounce(async $=>{y.value&&await h($)},500));function S(){var n;const $=[{condition:l.invoice==="",message:"Invoice cannot be blank"},{condition:((n=l.invoice_date)==null?void 0:n.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let f of $)if(f.condition)return b.value=f.message,!1;return!0}async function V(){if(S()){x.value=!0;try{const n=await L.post("/api/debt",{...l},{headers:{"Content-Type":"multipart/form-data"}});D(),await o.refresh(o.page_index),P({title:n.data.Result,variant:"success"})}catch{P({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{x.value=!1}}}function D(){y.value=!y.value,y.value&&(h(_.value),I())}function N($){l.customer=$.id,s.is_open=!1}function K($){l.status=$.id,r.is_open=!1}function F($){var f;const n=$.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){P({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){P({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}l.document=u}}function G($){const n=new Date($);l.invoice_date=ze(n,"yyyy-MM-dd")}return($,n)=>{const f=E("VIcon");return c(),g("div",null,[d("div",null,[e(t(k),{variant:"default",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:D},{default:a(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(t(ve),{open:y.value,"onUpdate:open":n[8]||(n[8]=u=>y.value=u)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(pe),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Create Debt")]),_:1}),e(t(De),null,{default:a(()=>[m(" Insert the details of the debt here. Click create when you're done. ")]),_:1})]),_:1}),d("div",It,[d("div",Pt,[e(t(z),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),zt]),_:1}),e(t(H),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":n[0]||(n[0]=u=>l.invoice=u),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),d("div",Ft,[e(t(z),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),Tt]),_:1}),d("div",Ut,[e(t(O),{open:s.is_open,"onUpdate:open":n[2]||(n[2]=u=>s.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":s.is_open,class:"w-full justify-between px-3",disabled:s.is_loading},{default:a(()=>{var u;return[m(w(l.customer?(u=s.data.find(p=>p.id===l.customer))==null?void 0:u.label:"Select customer")+" ",1),s.is_loading?(c(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),v(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{class:"h-9",modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=u=>_.value=u),placeholder:"Search country..."},null,8,["modelValue"]),e(t(me),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),g(T,null,A(s.data,u=>(c(),v(t(Z),{key:u.id,value:u.value??"",onSelect:()=>N(u)},{default:a(()=>[m(w(u.label)+" ",1),e(f,{name:"fa-check",class:B(["ml-auto h-4 w-4",l.customer===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),d("div",Rt,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),At]),_:1}),e(t(H),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":n[3]||(n[3]=u=>l.amount=u===""?null:u),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),d("div",jt,[e(t(z),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),Lt]),_:1}),d("div",Nt,[e(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",class:B(t(le)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(f,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),d("span",null,w(l.invoice_date?l.invoice_date:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Ie),{modelValue:l.invoice_date,"onUpdate:modelValue":[n[4]||(n[4]=u=>l.invoice_date=u),n[5]||(n[5]=u=>G(u))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}},null,8,["modelValue"])]),_:1})]),_:1})])]),d("div",Ht,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Bt]),_:1}),e(t(H),{id:"amount",modelValue:l.term,"onUpdate:modelValue":n[6]||(n[6]=u=>l.term=u),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),d("div",Yt,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status "),Et]),_:1}),d("div",Kt,[e(t(O),{open:r.is_open,"onUpdate:open":n[7]||(n[7]=u=>r.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:a(()=>{var u;return[m(w(l.status?(u=r.data.find(p=>p.id===l.status))==null?void 0:u.label:"Select status")+" ",1),r.is_loading?(c(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),v(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),g(T,null,A(r.data,u=>(c(),v(t(Z),{key:u.id,value:u.value??"",onSelect:()=>K(u)},{default:a(()=>[m(w(u.label)+" ",1),e(f,{name:"fa-check",class:B(["ml-auto h-4 w-4",l.status===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(X),d("div",Wt,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment "),Gt]),_:1}),d("div",qt,[e(t(H),{id:"name",type:"file",onChange:F,class:"col-span-3"})]),Qt])]),e(X),b.value?(c(),g("div",Ot,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+w(b.value),1)]),_:1})])):U("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[e(t(k),{type:"submit",onClick:V,disabled:x.value},{default:a(()=>[x.value?(c(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):U("",!0),m(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Jt={class:"flex items-center justify-between"},Zt={class:"flex flex-1 items-center space-x-2"},ea=j({__name:"DataTableToolbar",props:{table:{}},setup(i){const o=i,l=te(()=>o.table.getState().columnFilters.length>0);return(s,r)=>{var _;return c(),g("div",Jt,[d("div",Zt,[e(t(H),{placeholder:"Search...","model-value":((_=s.table.getColumn("invoice"))==null?void 0:_.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:r[0]||(r[0]=h=>s.table.setGlobalFilter(h.target.value))},null,8,["model-value"]),s.table.getColumn("status")?(c(),v(Dt,{key:0,column:s.table.getColumn("status"),title:"Status",options:t(Fe)},null,8,["column","options"])):U("",!0),l.value?(c(),v(t(k),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:r[1]||(r[1]=h=>s.table.resetColumnFilters())},{default:a(()=>[m(" Reset ")]),_:1})):U("",!0)]),e(Mt,{table:s.table},null,8,["table"]),e(Xt,{table:s.table},null,8,["table"])])}}}),ta={class:"space-y-4 text-muted-foreground"},aa={class:"rounded-md border"},sa=j({__name:"DataTable",props:{columns:{},data:{}},setup(i){const o=ie("tableStore",ne("debt")),l=i,s=C([]),r=C([]),_=C({}),h=C({pageIndex:o.page_index,pageSize:o.page_size}),I=C();function x(b,P){let S;typeof b=="function"?S=b(P.value):S=b,P.value=S,o.set_page_index(S.pageIndex),o.set_page_size(S.pageSize)}const y=Le({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return s.value},get columnFilters(){return r.value},get columnVisibility(){return _.value},get rowSelection(){return I.value},get pagination(){return h.value}},enableRowSelection:!0,onSortingChange:b=>oe(b,s),onPaginationChange:b=>x(b,h),onColumnFiltersChange:b=>oe(b,r),onColumnVisibilityChange:b=>oe(b,_),onRowSelectionChange:b=>oe(b,I),getCoreRowModel:Ye(),getFilteredRowModel:Ee(),getPaginationRowModel:Ke(),getSortedRowModel:We(),getFacetedRowModel:Ge(),getFacetedUniqueValues:qe()});return Xe(()=>{y.setPageIndex(o.page_index),y.setPageSize(o.page_size)}),(b,P)=>(c(),g("div",ta,[e(ea,{table:t(y)},null,8,["table"]),d("div",aa,[e(t(Be),{class:"text-xs"},{default:a(()=>[e(t(Ne),null,{default:a(()=>[(c(!0),g(T,null,A(t(y).getHeaderGroups(),S=>(c(),v(t(ce),{key:S.id},{default:a(()=>[(c(!0),g(T,null,A(S.headers,V=>(c(),v(t(Qe),{key:V.id},{default:a(()=>[V.isPlaceholder?U("",!0):(c(),v(t(ye),{key:0,render:V.column.columnDef.header,props:V.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(t(He),{id:"dbTableBody"},{default:a(()=>{var S;return[(S=t(y).getRowModel().rows)!=null&&S.length?(c(!0),g(T,{key:0},A(t(y).getRowModel().rows,V=>(c(),v(t(ce),{key:V.id,"data-state":V.getIsSelected()&&"selected"},{default:a(()=>[(c(!0),g(T,null,A(V.getVisibleCells(),D=>(c(),v(t(be),{key:D.id},{default:a(()=>[e(t(ye),{render:D.column.columnDef.cell,props:D.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(c(),v(t(ce),{key:1},{default:a(()=>[e(t(be),{colspan:b.columns.length,class:"h-24 text-center"},{default:a(()=>[m(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(St,{table:t(y)},null,8,["table"])]))}}),W=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(i){return(o,l)=>{const s=E("VIcon");return o.column.getCanSort()?(c(),g("div",{key:0,class:B(t(le)("flex items-center space-x-2",o.$attrs.class??""))},[e(t(Ce),null,{default:a(()=>[e(t(ke),{"as-child":""},{default:a(()=>[e(t(k),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:a(()=>[d("span",null,w(o.title),1),o.column.getIsSorted()==="desc"?(c(),v(s,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):o.column.getIsSorted()==="asc"?(c(),v(s,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(c(),v(s,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(t(Se),{align:"start"},{default:a(()=>[e(t(ue),{onClick:l[0]||(l[0]=r=>o.column.toggleSorting(!1))},{default:a(()=>[e(s,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Asc ")]),_:1}),e(t(ue),{onClick:l[1]||(l[1]=r=>o.column.toggleSorting(!0))},{default:a(()=>[e(s,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Desc ")]),_:1}),e(t($e)),e(t(ue),{onClick:l[2]||(l[2]=r=>o.column.toggleVisibility(!1))},{default:a(()=>[e(s,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(c(),g("div",{key:1,class:B(o.$attrs.class)},w(o.title),3))}}}),la=R.object({id:R.number(),invoice:R.string(),customer_name:R.string().min(2).max(50),invoice_date:R.preprocess(i=>typeof i=="string"?new Date(i):i,R.date()),due_date:R.preprocess(i=>typeof i=="string"?new Date(i):i,R.date()),term:R.number(),amount:R.string(),document_url:R.string(),status:R.number(),editable:R.boolean()}),na={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},oa={class:"col-span-3"},ia=d("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),d("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),ra={key:1},da={class:"flex justify-center my-auto items-center place-items-center mb-2"},ca={class:"mx-2"},ua={class:"flex justify-center my-auto items-center place-items-center"},fa=["src"],ma={key:0,class:"grid grid-cols-4 items-center gap-4"},_a=j({__name:"DataTableCheckAttachment",props:{row:{}},setup(i){const o=ie("tableStore",ne("debt")),l=i,s=Y({document:null,document_url:l.row.document_url}),r=Y({pdf:void 0,pages:void 0,info:void 0}),_=C(1),h=C(!1),I=C(!1),x=C(null),y=C(window.innerHeight-250),{toast:b}=re();function P($){b({title:"PDF loading error",variant:"destructive"})}async function S(){try{h.value=!0;const $=await L.get(`/api/debt/${l.row.id}/document/`);s.document_url=$.data.Result.document_url;const n=ft(s.document_url,{onError:P});Ze(()=>{r.pdf=n.pdf,r.pages=n.pages,r.info=n.info})}catch{K(),b({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{h.value=!1}}const V=()=>{const $=document.querySelector("#vp > div > div > div > canvas");if($){const n=$.offsetHeight,f=window.innerHeight-250,u=680;f>n&&n<u?y.value=n:f>n?y.value=f:y.value=Math.min(Math.max(n,u),f)}};function D(){const $=[{condition:s.document==null,message:"Attachment cannot be blank"}];for(let n of $)if(n.condition)return x.value=n.message,!1;return!0}async function N(){if(D()){h.value=!0;try{const n=await L.patch(`/api/debt/${l.row.id}/document/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});F(),await o.refresh(o.page_index),b({title:n.data.Result,variant:"success"})}catch{b({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{h.value=!1}}}function K(){s.document_url=null}function F(){I.value=!I.value,I.value&&S()}function G($){var f;const n=$.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){b({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){b({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}s.document=u}}return($,n)=>{const f=E("VIcon");return c(),g("div",null,[d("div",null,[e(t(k),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:F},{default:a(()=>[e(f,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),e(t(ve),{class:"my-2",open:I.value,"onUpdate:open":n[2]||(n[2]=u=>I.value=u)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-fit"},{default:a(()=>[e(t(pe),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Attachment Overview")]),_:1})]),_:1}),d("div",null,[s.document_url?s.document_url.endsWith(".pdf")?(c(),g("div",ra,[d("div",da,[e(t(k),{variant:"secondary",onClick:n[0]||(n[0]=u=>_.value=_.value>1?_.value-1:_.value)},{default:a(()=>[e(f,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),d("span",ca,w(_.value)+" / "+w(r.pages),1),e(t(k),{variant:"secondary",onClick:n[1]||(n[1]=u=>_.value=_.value<r.pages?_.value+1:_.value)},{default:a(()=>[e(f,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),e(t(Me),{class:"border border-primary",style:Je([{width:"720px","overflow-y":"auto","overflow-x":"hidden"},{height:y.value+"px"}])},{default:a(()=>[e(t(ut),{pdf:r.pdf,page:_.value,"fit-parent":"",onLoaded:V,"annonation-layer":""},{default:a(()=>[d("div",ua,[e(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(c(),g("img",{key:2,src:s.document_url,alt:"Document preview",class:"object-contain"},null,8,fa)):(c(),g("div",na,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment ")]),_:1}),d("div",oa,[e(t(H),{id:"name",type:"file",onChange:G,class:"col-span-3"})]),ia]))]),e(t(X)),x.value?(c(),g("div",ma,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+w(x.value),1)]),_:1})])):U("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[s.document_url?(c(),v(t(k),{key:0,class:"bg-red-600 text-white",onClick:K,disabled:h.value},{default:a(()=>[m(" Replace")]),_:1},8,["disabled"])):(c(),v(t(k),{key:1,onClick:N,disabled:h.value},{default:a(()=>[h.value?(c(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):U("",!0),m(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),pa={class:"grid gap-4 py-4"},ga={class:"grid grid-cols-4 items-center gap-4"},va=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ha={class:"grid grid-cols-4 items-center gap-4"},ba=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ya={class:"col-span-3"},wa={class:"grid grid-cols-4 items-center gap-4"},xa=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),$a={class:"grid grid-cols-4 items-center gap-4"},ka=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Sa={class:"col-span-3"},Ca={class:"grid grid-cols-4 items-center gap-4"},Va=d("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Da={class:"grid grid-cols-4 items-center gap-4"},Ma={class:"col-span-3"},Ia={key:0,class:"grid grid-cols-4 items-center gap-4"},Pa=j({__name:"DataTableEditModal",props:{row:{}},setup(i){const o=ie("tableStore",ne("debt")),l=i,s=Y({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),r=Y({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),_=Y({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),h=C("");async function I(n){r.is_loading=!0;try{const f=await L.get(`/api/customer/list?search=${n||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{r.is_loading=!1}}async function x(){r.is_loading=!0;try{const n=await L.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});_.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{_.is_loading=!1}}const y=C(!1),b=C(!1),P=C(null),{toast:S}=re();Ve(h,Pe.debounce(async n=>{b.value&&await I(n)},500));async function V(){try{const n=await L.get(`/api/debt/${l.row.id}/`);Object.assign(s,n.data.Result)}catch(n){console.log(n)}finally{y.value=!1}}function D(){var f;const n=[{condition:s.invoice==null,message:"Invoice cannot be blank"},{condition:((f=s.invoice_date)==null?void 0:f.toString)==null,message:"Invoice Date cannot be blank"},{condition:s.status==null,message:"Status cannot be blank"},{condition:s.customer==null,message:"Customer cannot be blank"}];for(let u of n)if(u.condition)return P.value=u.message,!1;return!0}async function N(){if(D()){y.value=!0;try{const f=await L.patch(`/api/debt/${l.row.id}/`,{...s},{headers:{"Content-Type":"multipart/form-data"}});K(),await o.refresh(o.page_index),S({title:f.data.Result,variant:"success"})}catch{S({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function K(){b.value=!b.value,b.value&&(V(),I(h.value),x())}function F(n){s.customer=n.id,r.is_open=!1}function G(n){s.status=n.id,_.is_open=!1}function $(n){const f=new Date(n);s.invoice_date=ze(f,"yyyy-MM-dd")}return(n,f)=>{const u=E("VIcon");return c(),g("div",null,[d("div",null,[e(t(k),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:K},{default:a(()=>[e(u,{name:"fa-pen",class:"size-4"})]),_:1})]),e(t(ve),{open:b.value,"onUpdate:open":f[8]||(f[8]=p=>b.value=p)},{default:a(()=>[e(t(_e),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(pe),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Edit Debt")]),_:1}),e(t(De),null,{default:a(()=>[m(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),d("div",pa,[d("div",ga,[e(t(z),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),va]),_:1}),e(t(H),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":f[0]||(f[0]=p=>s.invoice=p),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),d("div",ha,[e(t(z),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),ba]),_:1}),d("div",ya,[e(t(O),{open:r.is_open,"onUpdate:open":f[2]||(f[2]=p=>r.is_open=p)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:a(()=>{var p;return[m(w(s.customer?(p=r.data.find(de=>de.id===s.customer))==null?void 0:p.label:"Select customer")+" ",1),r.is_loading?(c(),v(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),v(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{class:"h-9",modelValue:h.value,"onUpdate:modelValue":f[1]||(f[1]=p=>h.value=p),placeholder:"Search country..."},null,8,["modelValue"]),e(t(me),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),g(T,null,A(r.data,p=>(c(),v(t(Z),{key:p.id,value:p.value??"",onSelect:()=>F(p)},{default:a(()=>[m(w(p.label)+" ",1),e(u,{name:"fa-check",class:B(["ml-auto h-4 w-4",s.customer===p.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),d("div",wa,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),xa]),_:1}),e(t(H),{id:"amount",modelValue:s.amount===null?"":s.amount,"onUpdate:modelValue":f[3]||(f[3]=p=>s.amount=p===""?null:p),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),d("div",$a,[e(t(z),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),ka]),_:1}),d("div",Sa,[e(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",class:B(t(le)("w-full justify-start text-left font-normal",!s.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(u,{name:"bi-calendar-fill",class:"mr-2 size-4"}),d("span",null,w(s.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(Ie),{modelValue:s.invoice_date,"onUpdate:modelValue":[f[4]||(f[4]=p=>s.invoice_date=p),f[5]||(f[5]=p=>$(p))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}},null,8,["modelValue"])]),_:1})]),_:1})])]),d("div",Ca,[e(t(z),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Va]),_:1}),e(t(H),{id:"amount",modelValue:s.term,"onUpdate:modelValue":f[6]||(f[6]=p=>s.term=p),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),d("div",Da,[e(t(z),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status ")]),_:1}),d("div",Ma,[e(t(O),{open:_.is_open,"onUpdate:open":f[7]||(f[7]=p=>_.is_open=p)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(k),{variant:"outline",role:"combobox","aria-expanded":_.is_open,class:"w-full justify-between px-3",disabled:_.is_loading},{default:a(()=>{var p;return[m(w(s.status?(p=_.data.find(de=>de.id===s.status))==null?void 0:p.label:"Select status")+" ",1),_.is_loading?(c(),v(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(c(),v(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(se),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(c(!0),g(T,null,A(_.data,p=>(c(),v(t(Z),{key:p.id,value:p.value??"",onSelect:()=>G(p)},{default:a(()=>[m(w(p.label)+" ",1),e(u,{name:"fa-check",class:B(["ml-auto h-4 w-4",s.status===p.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),e(X),P.value?(c(),g("div",Ia,[e(t(z),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+w(P.value),1)]),_:1})])):U("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[e(t(k),{type:"submit",onClick:N,disabled:y.value},{default:a(()=>[y.value?(c(),v(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):U("",!0),m(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),za={class:"pr-4"},Fa={class:"flex justify-between mt-2"},Ta={key:0,class:"text-primary font-bold flex place-items-center self-center"},Ua={key:1,class:"text-primary font-bold"},Ra={class:"text-primary"},Aa={class:"text-sm"},ja={class:"text-xs mt-2"},La=j({__name:"DataTableBacklog",props:{row:{}},setup(i){const o=et(),l=i,s=Y({debt:l.row.id,message:""}),r=Y([]),_=C(!1),h=C(!1),I=C(null),{toast:x}=re();async function y(){try{const V=await L.get(`/api/debt/${l.row.id}/backlog/`);r.splice(0,r.length,...V.data.Result),_.value=!1}catch{_.value=!1}}function b(){const V=[{condition:s.message=="",message:"Message cannot be blank"},{condition:s.message.length<5,message:"Maybe a little more context?"}];for(let D of V)if(D.condition)return I.value=D.message,!1;return!0}async function P(){if(b()){_.value=!0;try{const D=await L.post(`/api/debt/${l.row.id}/backlog/`,{...s},{headers:{"Content-Type":"application/json"}});await y(),x({title:D.data.Result,variant:"success"}),s.message="",I.value=""}catch{x({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{_.value=!1}}}function S(){h.value=!h.value,h.value&&y()}return(V,D)=>{const N=E("VIcon"),K=E("Label");return c(),g("div",null,[d("div",null,[e(t(k),{variant:"secondary",size:"sm",class:"hidden h-8 lg:flex border border-primary",onClick:S},{default:a(()=>[e(N,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),e(t(rt),{open:h.value,"onUpdate:open":D[1]||(D[1]=F=>h.value=F)},{default:a(()=>[e(t(nt),{class:"w-[720px]",side:"right"},{default:a(()=>[e(t(ot),null,{default:a(()=>[e(t(it),null,{default:a(()=>[m("Backlog - "+w(l.row.invoice),1)]),_:1})]),_:1}),e(t(X),{class:"mt-2 mb-4"}),e(t(Me),{class:"h-[80vh] flex flex-col"},{default:a(()=>[d("div",za,[(c(!0),g(T,null,A(r,(F,G)=>(c(),g("div",{key:G,class:"ml-2 pr-4"},[d("div",Fa,[F.is_system_generated?(c(),g("div",Ta,[e(N,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),m(" System Generated ")])):(c(),g("div",Ua,w(F.created_by_name),1))]),d("div",null,[d("div",Ra,w(F.created_date),1),e(t(X),{variant:"default"}),d("div",null,w(F.message),1)])]))),128))])]),_:1}),I.value?(c(),v(K,{key:0,for:"error",class:"text-red-600 flex"},{default:a(()=>[e(N,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),d("p",Aa,w(I.value),1)]),_:1})):U("",!0),e(t(mt),{class:"mt-2 justify-between"},{default:a(()=>[e(t(H),{id:"message",modelValue:s.message,"onUpdate:modelValue":D[0]||(D[0]=F=>s.message=F),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),e(t(k),{type:"submit",onClick:P},{default:a(()=>[m(" Save ")]),_:1})]),_:1}),d("p",ja,w(t(o).getUsername),1)]),_:1})]),_:1},8,["open"])])}}}),Na={class:"flex gap-1"},Ha=j({__name:"DataTableRowActions",props:{row:{}},setup(i){const o=i,l=te(()=>la.parse(o.row.original));return(s,r)=>(c(),g("div",Na,[l.value.editable?(c(),v(Pa,{key:0,row:l.value},null,8,["row"])):U("",!0),e(_a,{row:l.value},null,8,["row"]),e(La,{row:l.value},null,8,["row"])]))}}),Ba=[{id:"select",header:({table:i})=>M(we,{checked:i.getIsAllPageRowsSelected()||i.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":o=>i.toggleAllPageRowsSelected(!!o),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:i})=>M(we,{checked:i.getIsSelected(),"onUpdate:checked":o=>i.toggleSelected(!!o),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:i})=>M(W,{column:i,title:"Invoice"}),cell:({row:i})=>M("div",{class:`w-20 font-bold ${i.original.editable?"":"line-through decoration-red-600"}`},i.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(i,o,l)=>{var _;const s=((_=i.getValue(o))==null?void 0:_.toString().toLowerCase())??"",r=l==null?void 0:l.toString().toLowerCase();return s.includes(r)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:i})=>M(W,{column:i,title:"Customer"}),cell:({row:i})=>M("div",{class:"w-fit"},i.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(i,o,l)=>{var _;const s=((_=i.getValue(o))==null?void 0:_.toString().toLowerCase())??"",r=l==null?void 0:l.toString().toLowerCase();return s.includes(r)},meta:{title:"Customer"}},{accessorKey:"invoice_date",header:({column:i})=>M(W,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>{const o=i.getValue("invoice_date");let l="";if(o){const s=new Date(Date.parse(o));isNaN(s.getTime())?l="Not Provided":l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return M("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:i})=>M(W,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>{const o=i.getValue("due_date");let l="";if(o){const s=new Date(o);isNaN(s.getTime())?l="Not Provided":l=s.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return M("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"term",header:({column:i})=>M(W,{column:i,title:"Term"}),cell:({row:i})=>M("div",{class:"w-fit"},i.getValue("term")),enableHiding:!0,meta:{title:"Term"}},{accessorKey:"amount",header:({column:i})=>M(W,{column:i,title:i.columnDef.meta.title}),cell:({row:i})=>M(ee,{variant:"destructive"},"RM "+i.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:i})=>M(W,{column:i,title:"Attachment"}),cell:({row:i})=>{const o=i.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return M(xe,{name:o.icon,class:`${o.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:i})=>M(W,{column:i,title:"Status"}),cell:({row:i})=>{const o=Fe.find(l=>l.value===i.original.status.toString());return o?M(ee,{variant:"secondary",class:"flex w-fit items-center"},[o.icon&&M(xe,{name:o.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),M("span",{},o.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(i,o,l)=>{const s=i.getValue(o);if(!s)return!1;const r=s.toString().toLowerCase();return l.some(h=>r.includes(h.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:i})=>M(Ha,{row:i})}],Ya={class:"p-8 space-y-8 h-full"},Ea=d("div",{class:"flex items-center justify-between space-y-2"},[d("div",null,[d("h2",{class:"text-2xl font-bold tracking-tight"},"Debt"),d("p",{class:"text-muted-foreground"},"Here's a list of your existing debts!")])],-1),Ka={key:0,class:"text-center"},Wa={key:1},Ga="/api/debt",ns=j({__name:"Debt",setup(i){const o=ne("debt"),l=s=>({id:s.id,status:s.status,invoice:s.invoice,customer_name:s.customer_name,invoice_date:new Date(s.invoice_date),due_date:new Date(s.due_date),term:s.term,amount:s.amount,document_url:s.document_url,editable:s.editable});return tt(async()=>{await o.fetch(Ga,0,l)}),st("tableStore",o),at(()=>{o.$reset()}),(s,r)=>{const _=E("VIcon");return c(),g("div",Ya,[Ea,t(o).is_loading?(c(),g("div",Ka,[e(_,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(c(),g("div",Wa,[e(sa,{data:t(o).tasks,columns:t(Ba)},null,8,["data","columns"])]))])}}});export{ns as default};
