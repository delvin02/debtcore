import{_ as Ke,a as We,b as Ye,c as Ge,d as Qe,e as Me,u as fe,f as Xe,g as Ze,h as Je,i as Ce,j as ge,k as et,l as tt,m as at,n as st,o as lt,p as nt,q as ot,r as it,F as Ve,z as j,s as De}from"./Checkbox.vue_vue_type_script_setup_true_lang-eutFf37Q.js";import{e as P,r as E,o as u,c as b,d as c,t as g,a as t,k as o,u as s,F as M,v as A,s as S,b as p,x as G,l as x,Q as ee,m as T,O as oe,X as he,Y as Pe,a0 as be,Z as ze,$ as de,a1 as ue,P as ie,N as re,n as W,g as ye,ao as rt,y as Te,z as Ue,A as je,i as I,az as ct,B as we,C as dt,D as te,E as B,G as xe,H as L,I as ve,J as $e,K as Ae,L as He,M as Le,_ as O,a9 as Ee,am as ut,R as Ne,an as ft,V as mt,W as _t,j as pt,S as D,a5 as Ie,T as gt,aq as vt,U as ht}from"../main.js";import{_ as Z}from"./index-DhdF1qMN.js";import{_ as bt,a as yt,c as wt,b as xt,d as $t}from"./index-DD070ssz.js";import{_ as kt,a as St}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang-vQutYflC.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang-B0xvdIsq.js";import{_ as ae,a as se,b as le}from"./CardDescription.vue_vue_type_script_setup_true_lang-nuAmEoIx.js";import{_ as ne}from"./CardContent.vue_vue_type_script_setup_true_lang-D46BGtUZ.js";import{_ as Oe}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUbi7heN.js";import{_ as Ct}from"./lodash-BtnTHUG3.js";import{l as Vt,f as Dt,_ as It}from"./index-q2fvKXnx.js";import{_ as Rt}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-BxpccqsK.js";import{f as Ft}from"./index-DNZ2qQq3.js";const Mt={class:"flex items-center justify-between px-2 pb-10"},Pt={class:"flex-1 text-sm text-muted-foreground"},zt={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Tt={class:"flex items-center space-x-2"},Ut=c("p",{class:"text-sm font-medium"},"Rows per page",-1),jt={class:"flex w-[100px] items-center justify-center text-sm font-medium"},At={class:"flex items-center space-x-2"},Ht=c("span",{class:"sr-only"},"Go to first page",-1),Lt=c("span",{class:"sr-only"},"Go to previous page",-1),Et=c("span",{class:"sr-only"},"Go to next page",-1),Nt=c("span",{class:"sr-only"},"Go to last page",-1),Ot=P({__name:"DataTablePagination",props:{table:{}},setup(e){return(a,n)=>{const l=E("VIcon");return u(),b("div",Mt,[c("div",Pt,g(a.table.getFilteredSelectedRowModel().rows.length)+" of "+g(a.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),c("div",zt,[c("div",Tt,[Ut,t(s(Ge),{"model-value":`${a.table.getState().pagination.pageSize}`,"onUpdate:modelValue":a.table.setPageSize},{default:o(()=>[t(s(Ke),{class:"h-8 w-[70px]"},{default:o(()=>[t(s(We),{placeholder:`${a.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),t(s(Ye),{side:"top"},{default:o(()=>[(u(),b(M,null,A([10,20,30,40,50],r=>t(s(Qe),{key:r,value:`${r}`},{default:o(()=>[p(g(r),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),c("div",jt," Page "+g(a.table.getState().pagination.pageIndex+1)+" of "+g(a.table.getPageCount()),1),c("div",At,[t(s(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!a.table.getCanPreviousPage(),onClick:n[0]||(n[0]=r=>a.table.setPageIndex(0))},{default:o(()=>[Ht,t(l,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!a.table.getCanPreviousPage(),onClick:n[1]||(n[1]=r=>a.table.previousPage())},{default:o(()=>[Lt,t(l,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!a.table.getCanNextPage(),onClick:n[2]||(n[2]=r=>a.table.nextPage())},{default:o(()=>[Et,t(l,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!a.table.getCanNextPage(),onClick:n[3]||(n[3]=r=>a.table.setPageIndex(a.table.getPageCount()-1))},{default:o(()=>[Nt,t(l,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),ke=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claiming",icon:"fa-circle"},{value:"3",label:"Done",icon:"fa-check-circle"},{value:"4",label:"Canceled",icon:"fa-times-circle"}],Bt={class:"hidden space-x-1 lg:flex"},qt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Kt=P({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(e){const a=e,n=G(()=>{var i;return(i=a.column)==null?void 0:i.getFacetedUniqueValues()}),l=G(()=>{var i;return new Set((i=a.column)==null?void 0:i.getFilterValue())}),r=i=>{var m;l.value.has(i)?l.value.delete(i):l.value.add(i);const h=Array.from(l.value);(m=a.column)==null||m.setFilterValue(h.length?h:void 0)};return(i,d)=>{const h=E("VIcon");return u(),x(s(re),null,{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:o(()=>[t(h,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),p(" "+g(i.title)+" ",1),l.value.size>0?(u(),b(M,{key:0},[t(s(ee),{orientation:"vertical",class:"mx-2 h-4"}),t(s(Z),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:o(()=>[p(g(l.value.size),1)]),_:1}),c("div",Bt,[l.value.size>2?(u(),x(s(Z),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(l.value.size)+" selected ",1)]),_:1})):(u(!0),b(M,{key:1},A(i.options.filter(m=>l.value.has(m.value)),m=>(u(),x(s(Z),{key:m.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(m.label),1)]),_:2},1024))),128))])],64)):T("",!0)]),_:1})]),_:1}),t(s(ie),{class:"w-[200px] p-0",align:"start"},{default:o(()=>[t(s(he),null,{default:o(()=>[t(s(Pe),{placeholder:i.title},null,8,["placeholder"]),t(s(be),null,{default:o(()=>[t(s(ze),null,{default:o(()=>[p("No results found.")]),_:1}),t(s(de),null,{default:o(()=>[(u(!0),b(M,null,A(i.options,m=>(u(),x(s(ue),{key:m.value,value:m,onSelect:()=>r(m.value)},{default:o(()=>{var y;return[c("div",{class:W(s(ye)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",l.value.has(m.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[t(h,{name:"fa-check",class:"h-4 w-4"})],2),m.icon?(u(),x(rt(m.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):T("",!0),c("span",null,g(m.label),1),(y=n.value)!=null&&y.get(m.value)?(u(),b("span",qt,g(n.value.get(m.value)),1)):T("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),l.value.size>0?(u(),b(M,{key:0},[t(s(bt)),t(s(de),null,{default:o(()=>[t(s(ue),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:d[0]||(d[0]=()=>{var m;return(m=a.column)==null?void 0:m.setFilterValue(void 0)})},{default:o(()=>[p(" Clear filters ")]),_:1})]),_:1})],64)):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Wt=P({__name:"DataTableViewOptions",props:{table:{}},setup(e){const a=e,n=G(()=>a.table.getAllColumns().filter(l=>typeof l.accessorFn<"u"&&l.getCanHide()));return(l,r)=>(u(),x(s(je),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:o(()=>[p(" View ")]),_:1})]),_:1}),t(s(Ue),{align:"end",class:"w-[150px]"},{default:o(()=>[t(s(kt),null,{default:o(()=>[p("Toggle columns")]),_:1}),t(s(Me)),(u(!0),b(M,null,A(n.value,i=>(u(),x(s(St),{key:i.id,class:"capitalize",checked:i.getIsVisible(),"onUpdate:checked":d=>i.toggleVisibility(!!d)},{default:o(()=>{var d;return[p(g(((d=i.columnDef.meta)==null?void 0:d.title)||i.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}});var Yt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Gt=`\r
`,Qt="\uFEFF",me=e=>Object.assign({},Yt,e);class Xt extends Error{constructor(a){super(a),this.name="CsvGenerationError"}}class Zt extends Error{constructor(a){super(a),this.name="EmptyHeadersError"}}class Jt extends Error{constructor(a){super(a),this.name="CsvDownloadEnvironmentError"}}class ea extends Error{constructor(a){super(a),this.name="UnsupportedDataFormatError"}}var X=e=>e,U=e=>e,J=X,_e=X,Q=X,Re=X,Fe=X,ta=function(e,a){return a=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},aa=e=>Re(typeof e=="object"?e.key:e),sa=e=>Fe(typeof e=="object"?e.displayLabel:e),la=(e,...a)=>a.reduce((n,l)=>l(n),e),na=e=>a=>e.useBom?_e(U(a)+Qt):a,oa=e=>a=>e.showTitle?Se(_e(U(a)+e.title))(Q("")):a,Se=e=>a=>_e(U(e)+U(a)+Gt),Be=e=>(a,n)=>ia(e)(Q(U(a)+U(n))),ia=e=>a=>X(U(a)+e.fieldSeparator),ra=(e,a)=>n=>{if(!e.showColumnHeaders)return n;if(a.length<1)throw new Zt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let l=Q("");for(let r=0;r<a.length;r++){const i=sa(a[r]);l=Be(e)(l,qe(e,U(i)))}return l=Q(U(l).slice(0,-1)),Se(n)(l)},ca=(e,a,n)=>l=>{let r=l;for(var i=0;i<n.length;i++){let d=Q("");for(let h=0;h<a.length;h++){const m=aa(a[h]),y=n[i][U(m)];d=Be(e)(d,qe(e,y))}d=Q(U(d).slice(0,-1)),r=Se(r)(d)}return r},da=e=>+e===e&&(!isFinite(e)||!!(e%1)),ua=(e,a)=>{if(da(a)){if(e.decimalSeparator==="locale")return J(a.toLocaleString());if(e.decimalSeparator)return J(a.toString().replace(".",e.decimalSeparator))}return J(a.toString())},ce=(e,a)=>{let n=a;return(e.quoteStrings||e.fieldSeparator&&a.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&a.indexOf(e.quoteCharacter)>-1||a.indexOf(`
`)>-1||a.indexOf("\r")>-1)&&(n=e.quoteCharacter+ta(a,e.quoteCharacter)+e.quoteCharacter),J(n)},fa=(e,a)=>{const n=a?"true":"false";return J(e.boolDisplay[n])},ma=(e,a)=>typeof a>"u"&&e.replaceUndefinedWith!==void 0?ce(e,e.replaceUndefinedWith+""):a===null?ce(e,"null"):ce(e,""),qe=(e,a)=>{if(typeof a=="number")return ua(e,a);if(typeof a=="string")return ce(e,a);if(typeof a=="boolean"&&e.boolDisplay)return fa(e,a);if(a===null||typeof a>"u")return ma(e,a);throw new ea(`
    typeof ${typeof a} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},_a=e=>a=>{const n=me(e),l=n.useKeysAsHeaders?Object.keys(a[0]):n.columnHeaders;let r=la(_e(""),na(n),oa(n),ra(n,l),ca(n,l,a));if(U(r).length<1)throw new Xt("Output is empty. Is your data formatted correctly?");return r},pa=e=>a=>{const n=me(e),l=U(a),r=n.useTextFile?"plain":"csv";return new Blob([l],{type:`text/${r};charset=utf8;`})},ga=e=>a=>{if(!window)throw new Jt("Downloading only supported in a browser environment.");const n=pa(e)(a),l=me(e),r=l.useTextFile?"txt":"csv",i=`${l.filename}.${r}`,d=document.createElement("a");d.download=i,d.href=URL.createObjectURL(n),d.setAttribute("visibility","hidden"),document.body.appendChild(d),d.click(),document.body.removeChild(d)};const va=P({__name:"DataTableCreateDebt",props:{table:{}},setup(e){const a=e,n=I(!1),l=me({fieldSeparator:",",filename:"report",decimalSeparator:".",useKeysAsHeaders:!0}),r=d=>d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),i=()=>{n.value=!0;const h=a.table.getFilteredRowModel().rows.map(y=>{var R;const w=y.getValue("invoice"),z=r(y.getValue("invoice_date")),C=r(y.getValue("due_date")),k=y.getValue("overdue")+" day(s)",V="RM "+y.getValue("amount"),H=`=HYPERLINK("${ct}${y.getValue("document_url")}", "Click Link Here")`,N=(R=ke.find(q=>q.value===y.original.status.toString()))==null?void 0:R.label;return{invoice:w,invoice_date:z,due_date:C,overdue:k,amount:V,attachment:H,status:N}}),m=_a(l)(h);ga(l)(m),n.value=!1};return(d,h)=>{const m=E("VIcon");return u(),b("div",null,[t(s(S),{variant:"secondary",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:i},{default:o(()=>[n.value?(u(),x(m,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-4"})):(u(),x(m,{key:1,name:"fa-download",class:"size-4"}))]),_:1})])}}}),ha={class:"flex items-center justify-between"},ba={class:"flex flex-1 items-center space-x-2"},ya=P({__name:"DataTableToolbar",props:{table:{}},setup(e){const a=e,n=G(()=>a.table.getState().columnFilters.length>0);return console.error(a.table.getColumn("status")),(l,r)=>{var i;return u(),b("div",ha,[c("div",ba,[t(s(Y),{placeholder:"Search...","model-value":((i=l.table.getColumn("invoice"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:r[0]||(r[0]=d=>l.table.setGlobalFilter(d.target.value))},null,8,["model-value"]),l.table.getColumn("status")?(u(),x(Kt,{key:0,column:l.table.getColumn("status"),title:"Status",options:s(ke)},null,8,["column","options"])):T("",!0),n.value?(u(),x(s(S),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:r[1]||(r[1]=d=>l.table.resetColumnFilters())},{default:o(()=>[p(" Reset ")]),_:1})):T("",!0)]),t(Wt,{table:l.table},null,8,["table"]),t(va,{table:l.table},null,8,["table"])])}}}),wa={class:"space-y-4 text-muted-foreground"},xa={class:"rounded-md border"},$a=P({__name:"DataTable",props:{columns:{},data:{}},setup(e){const a=we("tableStore",fe("debt")),n=e,l=I([]),r=I([]),i=I({}),d=I({pageIndex:a.page_index,pageSize:a.page_size}),h=I();function m(w,z){let C;typeof w=="function"?C=w(z.value):C=w,z.value=C,a.set_page_index(C.pageIndex),a.set_page_size(C.pageSize)}const y=Xe({get data(){return n.data},get columns(){return n.columns},state:{get sorting(){return l.value},get columnFilters(){return r.value},get columnVisibility(){return i.value},get rowSelection(){return h.value},get pagination(){return d.value}},enableRowSelection:!0,onSortingChange:w=>te(w,l),onPaginationChange:w=>m(w,d),onColumnFiltersChange:w=>te(w,r),onColumnVisibilityChange:w=>te(w,i),onRowSelectionChange:w=>te(w,h),getCoreRowModel:tt(),getFilteredRowModel:at(),getPaginationRowModel:st(),getSortedRowModel:lt(),getFacetedRowModel:nt(),getFacetedUniqueValues:ot()});return dt(()=>{y.setPageIndex(a.page_index),y.setPageSize(a.page_size)}),(w,z)=>(u(),b("div",wa,[t(ya,{table:s(y)},null,8,["table"]),c("div",xa,[t(s(et),{class:"text-xs"},{default:o(()=>[t(s(Ze),null,{default:o(()=>[(u(!0),b(M,null,A(s(y).getHeaderGroups(),C=>(u(),x(s(ge),{key:C.id},{default:o(()=>[(u(!0),b(M,null,A(C.headers,k=>(u(),x(s(it),{key:k.id},{default:o(()=>[k.isPlaceholder?T("",!0):(u(),x(s(Ve),{key:0,render:k.column.columnDef.header,props:k.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(s(Je),{id:"dbTableBody"},{default:o(()=>{var C;return[(C=s(y).getRowModel().rows)!=null&&C.length?(u(!0),b(M,{key:0},A(s(y).getRowModel().rows,k=>(u(),x(s(ge),{key:k.id,"data-state":k.getIsSelected()&&"selected"},{default:o(()=>[(u(!0),b(M,null,A(k.getVisibleCells(),V=>(u(),x(s(Ce),{key:V.id},{default:o(()=>[t(s(Ve),{render:V.column.columnDef.cell,props:V.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),x(s(ge),{key:1},{default:o(()=>[t(s(Ce),{colspan:w.columns.length,class:"h-24 text-center"},{default:o(()=>[p(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),t(Ot,{table:s(y)},null,8,["table"])]))}}),ka={class:"grid grid-cols-4 mb-2 gap-4"},Sa={class:"text-2xl font-bold"},Ca={class:"text-2xl font-bold"},Va={class:"text-2xl font-bold"},Da={class:"text-2xl font-bold"},Ia=P({__name:"CustomerDetailCard",props:{customer_id:{}},setup(e){const a=e,n=B({all_time_revenue:0,outstanding_debt_amount:0,overdue_amount:"0.00",total_invoices:"0.00"}),l=`/api/customer/${a.customer_id}/debt/card`,r=async()=>{try{const i=await L.get(l);Object.assign(n,i.data.Result)}catch(i){console.log(i)}};return xe(()=>{r()}),(i,d)=>(u(),b("div",null,[c("div",ka,[c("div",null,[t(s(le),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("All Time Revenue")]),_:1})]),_:1}),t(s(ne),null,{default:o(()=>[c("div",Sa,[c("h1",null,"RM "+g(n.all_time_revenue),1)])]),_:1})]),_:1})]),c("div",null,[t(s(le),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Outstanding Debt Amount")]),_:1})]),_:1}),t(s(ne),null,{default:o(()=>[c("div",Ca,[c("h1",null,"RM "+g(n.outstanding_debt_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(le),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Overdue Amount")]),_:1})]),_:1}),t(s(ne),null,{default:o(()=>[c("div",Va,[c("h1",null,"RM "+g(n.overdue_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(le),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Total Invoices")]),_:1})]),_:1}),t(s(ne),null,{default:o(()=>[c("div",Da,[c("h1",null,g(n.total_invoices),1)])]),_:1})]),_:1})])])]))}}),Ra={class:"p-4 bg-secondary"},Fa={class:"text-3xl font-bold tracking-tight mt-2 mb-4"},Ma={class:"flex justify-items-center place-items-center items-center"},Pa={class:"text-muted-foreground ml-2 place-self-center"},za={class:"flex justify-items-center place-items-center items-center"},Ta={class:"text-muted-foreground ml-2 place-self-center"},Ua={class:"flex justify-items-center place-items-center items-center"},ja={class:"text-muted-foreground ml-2 place-self-center"},Aa=P({__name:"CustomerDetailInfo",props:{customer_id:{}},setup(e){const a=e,n=B({name:"",whatsapp_phone_number:"",streetAddress:"",city:"",state:"",postcode:"",country_name:""}),l=`/api/customer/${a.customer_id}/`,r=async()=>{try{const d=await L.get(l);Object.assign(n,d.data.Result)}catch(d){console.log(d)}};var i=G(()=>{const h=[n.streetAddress,n.city,n.state,n.postcode].filter(m=>m);return h.length?h.join(", "):""});return xe(()=>{r()}),(d,h)=>{const m=E("VIcon");return u(),b("div",Ra,[c("h2",Fa,g(n.name),1),c("div",Ma,[t(m,{name:"fa-phone-alt",class:"w-4 h-4"}),c("p",Pa,g(n.whatsapp_phone_number.replace(/(\d{3})(\d{4})(\d{4})/,"$1 $2 $3")),1)]),c("div",za,[t(m,{name:"fa-address-book",class:"w-4 h-4"}),c("p",Ta,g(s(i)),1)]),c("div",Ua,[t(m,{name:"fa-map-pin",class:"w-4 h-4"}),c("p",ja,g(n.country_name),1)])])}}}),K=P({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(e){return(a,n)=>{const l=E("VIcon");return a.column.getCanSort()?(u(),b("div",{key:0,class:W(s(ye)("flex items-center space-x-2",a.$attrs.class??""))},[t(s(je),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(S),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[c("span",null,g(a.title),1),a.column.getIsSorted()==="desc"?(u(),x(l,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):a.column.getIsSorted()==="asc"?(u(),x(l,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(u(),x(l,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),t(s(Ue),{align:"start"},{default:o(()=>[t(s(ve),{onClick:n[0]||(n[0]=r=>a.column.toggleSorting(!1))},{default:o(()=>[t(l,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Asc ")]),_:1}),t(s(ve),{onClick:n[1]||(n[1]=r=>a.column.toggleSorting(!0))},{default:o(()=>[t(l,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Desc ")]),_:1}),t(s(Me)),t(s(ve),{onClick:n[2]||(n[2]=r=>a.column.toggleVisibility(!1))},{default:o(()=>[t(l,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(u(),b("div",{key:1,class:W(a.$attrs.class)},g(a.title),3))}}}),Ha=j.object({id:j.number(),invoice:j.string(),invoice_date:j.preprocess(e=>typeof e=="string"?new Date(e):e,j.date()),due_date:j.preprocess(e=>typeof e=="string"?new Date(e):e,j.date()),overdue:j.number(),amount:j.string(),document_url:j.string(),status:j.number(),editable:j.boolean()}),La={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Ea={class:"col-span-3"},Na=c("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[p(" Accepted Type: "),c("b",null,"PDF"),p(" (MAX. 5MB) ")],-1),Oa={key:1},Ba={class:"flex justify-center my-auto items-center place-items-center mb-2"},qa={class:"mx-2"},Ka={class:"flex justify-center my-auto items-center place-items-center"},Wa=["src"],Ya={key:0,class:"grid grid-cols-4 items-center gap-4"},Ga=P({__name:"DataTableCheckAttachment",props:{row:{}},setup(e){const a=we("tableStore",fe("debt")),n=e,l=B({document:null,document_url:n.row.document_url}),r=B({pdf:void 0,pages:void 0,info:void 0}),i=I(1),d=I(!1),h=I(!1),m=I(null),y=I(window.innerHeight-250),{toast:w}=$e();function z(F){w({title:"PDF loading error",variant:"destructive"})}async function C(){try{d.value=!0;const F=await L.get(`/api/debt/${n.row.id}/document/`);l.document_url=F.data.Result.document_url;const f=Dt(l.document_url,{onError:z});ft(()=>{r.pdf=f.pdf,r.pages=f.pages,r.info=f.info})}catch{N(),w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}const k=()=>{const F=document.querySelector("#vp > div > div > div > canvas");if(F){const f=F.offsetHeight,_=window.innerHeight-250,$=680;_>f&&f<$?y.value=f:_>f?y.value=_:y.value=Math.min(Math.max(f,$),_)}};function V(){const F=[{condition:l.document==null,message:"Attachment cannot be blank"}];for(let f of F)if(f.condition)return m.value=f.message,!1;return!0}async function H(){if(V()){d.value=!0;try{const f=await L.patch(`/api/debt/${n.row.id}/document/`,{...l},{headers:{"Content-Type":"multipart/form-data"}});R(),await a.refresh(a.page_index),w({title:f.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}}function N(){l.document_url=null}function R(){h.value=!h.value,h.value&&C()}function q(F){var _;const f=F.target;if((_=f.files)!=null&&_.length){const $=f.files[0];if($.type!=="application/pdf"){w({title:"Please select a PDF file",variant:"destructive"}),f.value="";return}if($.size>5*1024*1024){w({title:"The file size must be under 5MB",variant:"destructive"}),f.value="";return}l.document=$}}return(F,f)=>{const _=E("VIcon");return u(),b("div",null,[c("div",null,[t(s(S),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:R},{default:o(()=>[t(_,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),t(s(Ne),{class:"my-2",open:h.value,"onUpdate:open":f[2]||(f[2]=$=>h.value=$)},{default:o(()=>[t(s(Ae),{isSideBar:!1,class:"sm:max-w-fit"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Le),null,{default:o(()=>[p("Attachment Overview")]),_:1})]),_:1}),c("div",null,[l.document_url?l.document_url.endsWith(".pdf")?(u(),b("div",Oa,[c("div",Ba,[t(s(S),{variant:"secondary",onClick:f[0]||(f[0]=$=>i.value=i.value>1?i.value-1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),c("span",qa,g(i.value)+" / "+g(r.pages),1),t(s(S),{variant:"secondary",onClick:f[1]||(f[1]=$=>i.value=i.value<r.pages?i.value+1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),t(s(Ee),{class:"border border-primary",style:ut([{width:"720px","overflow-y":"auto","overflow-x":"hidden"},{height:y.value+"px"}])},{default:o(()=>[t(s(Vt),{pdf:r.pdf,page:i.value,"fit-parent":"",onLoaded:k,"annonation-layer":""},{default:o(()=>[c("div",Ka,[t(_,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(u(),b("img",{key:2,src:l.document_url,alt:"Document preview",class:"object-contain"},null,8,Wa)):(u(),b("div",La,[t(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Attachment ")]),_:1}),c("div",Ea,[t(s(Y),{id:"name",type:"file",onChange:q,class:"col-span-3"})]),Na]))]),t(s(ee)),m.value?(u(),b("div",Ya,[t(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(m.value),1)]),_:1})])):T("",!0),t(s(Oe),{class:"flex justify-end"},{default:o(()=>[l.document_url?(u(),x(s(S),{key:0,class:"bg-red-600 text-white",onClick:N,disabled:d.value},{default:o(()=>[p(" Replace")]),_:1},8,["disabled"])):(u(),x(s(S),{key:1,onClick:H,disabled:d.value},{default:o(()=>[d.value?(u(),x(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),p(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Qa={class:"grid gap-4 py-4"},Xa={class:"grid grid-cols-4 items-center gap-4"},Za=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ja={class:"grid grid-cols-4 items-center gap-4"},es=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ts={class:"col-span-3"},as={class:"grid grid-cols-4 items-center gap-4"},ss=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ls={class:"grid grid-cols-4 items-center gap-4"},ns=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),os={class:"col-span-3"},is={class:"grid grid-cols-4 items-center gap-4"},rs=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),cs={class:"grid grid-cols-4 items-center gap-4"},ds={class:"col-span-3"},us={key:0,class:"grid grid-cols-4 items-center gap-4"},fs=P({__name:"DataTableEditModal",props:{row:{}},setup(e){const a=we("tableStore",fe("debt")),n=e,l=B({invoice:n.row.id,customer:null,amount:n.row.amount,invoice_date:new Date(n.row.invoice_date),term:n.row.term,status:n.row.status}),r=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),i=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=I("");async function h(f){r.is_loading=!0;try{const _=await L.get(`/api/customer/list?search=${f||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{r.is_loading=!1}}async function m(){r.is_loading=!0;try{const f=await L.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{i.is_loading=!1}}const y=I(!1),w=I(!1),z=I(null),{toast:C}=$e();mt(d,Ct.debounce(async f=>{w.value&&await h(f)},500));async function k(){try{const f=await L.get(`/api/debt/${n.row.id}/`);Object.assign(l,f.data.Result)}catch(f){console.log(f)}finally{y.value=!1}}function V(){var _;const f=[{condition:l.invoice==null,message:"Invoice cannot be blank"},{condition:((_=l.invoice_date)==null?void 0:_.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let $ of f)if($.condition)return z.value=$.message,!1;return!0}async function H(){if(V()){y.value=!0;try{const _=await L.patch(`/api/debt/${n.row.id}/`,{...l},{headers:{"Content-Type":"multipart/form-data"}});N(),await a.refresh(a.page_index),C({title:_.data.Result,variant:"success"})}catch{C({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function N(){w.value=!w.value,w.value&&(k(),h(d.value),m())}function R(f){l.customer=f.id,r.is_open=!1}function q(f){l.status=f.id,i.is_open=!1}function F(f){const _=new Date(f);l.invoice_date=Ft(_,"yyyy-MM-dd")}return(f,_)=>{const $=E("VIcon");return u(),b("div",null,[c("div",null,[t(s(S),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:N},{default:o(()=>[t($,{name:"fa-pen",class:"size-4"})]),_:1})]),t(s(Ne),{open:w.value,"onUpdate:open":_[8]||(_[8]=v=>w.value=v)},{default:o(()=>[t(s(Ae),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Le),null,{default:o(()=>[p("Edit Debt")]),_:1}),t(s(_t),null,{default:o(()=>[p(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),c("div",Qa,[c("div",Xa,[t(s(O),{for:"invoice",class:"text-right"},{default:o(()=>[p(" Invoice "),Za]),_:1}),t(s(Y),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":_[0]||(_[0]=v=>l.invoice=v),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),c("div",Ja,[t(s(O),{for:"customer",class:"text-right leading-normal"},{default:o(()=>[p(" Customer "),es]),_:1}),c("div",ts,[t(s(re),{open:r.is_open,"onUpdate:open":_[2]||(_[2]=v=>r.is_open=v)},{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:o(()=>{var v;return[p(g(l.customer?(v=r.data.find(pe=>pe.id===l.customer))==null?void 0:v.label:"Select customer")+" ",1),r.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[t(s(he),null,{default:o(()=>[t(s(Pe),{class:"h-9",modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=v=>d.value=v),placeholder:"Search country..."},null,8,["modelValue"]),t(s(ze),null,{default:o(()=>[p("No customer found.")]),_:1}),t(s(be),null,{default:o(()=>[t(s(de),null,{default:o(()=>[(u(!0),b(M,null,A(r.data,v=>(u(),x(s(ue),{key:v.id,value:v.value??"",onSelect:()=>R(v)},{default:o(()=>[p(g(v.label)+" ",1),t($,{name:"fa-check",class:W(["ml-auto h-4 w-4",l.customer===v.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),c("div",as,[t(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Amount "),ss]),_:1}),t(s(Y),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":_[3]||(_[3]=v=>l.amount=v===""?null:v),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),c("div",ls,[t(s(O),{for:"email",class:"text-right"},{default:o(()=>[p(" Invoice Date "),ns]),_:1}),c("div",os,[t(s(re),null,{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",class:W(s(ye)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:o(()=>[t($,{name:"bi-calendar-fill",class:"mr-2 size-4"}),c("span",null,g(l.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),t(s(ie),{class:"w-auto p-0"},{default:o(()=>[t(s(Rt),{modelValue:l.invoice_date,"onUpdate:modelValue":[_[4]||(_[4]=v=>l.invoice_date=v),_[5]||(_[5]=v=>F(v))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}},null,8,["modelValue"])]),_:1})]),_:1})])]),c("div",is,[t(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Payment Term "),rs]),_:1}),t(s(Y),{id:"amount",modelValue:l.term,"onUpdate:modelValue":_[6]||(_[6]=v=>l.term=v),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),c("div",cs,[t(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Status ")]),_:1}),c("div",ds,[t(s(re),{open:i.is_open,"onUpdate:open":_[7]||(_[7]=v=>i.is_open=v)},{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(S),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:o(()=>{var v;return[p(g(l.status?(v=i.data.find(pe=>pe.id===l.status))==null?void 0:v.label:"Select status")+" ",1),i.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[t(s(he),null,{default:o(()=>[t(s(be),null,{default:o(()=>[t(s(de),null,{default:o(()=>[(u(!0),b(M,null,A(i.data,v=>(u(),x(s(ue),{key:v.id,value:v.value??"",onSelect:()=>q(v)},{default:o(()=>[p(g(v.label)+" ",1),t($,{name:"fa-check",class:W(["ml-auto h-4 w-4",l.status===v.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),t(ee),z.value?(u(),b("div",us,[t(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t($,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(z.value),1)]),_:1})])):T("",!0),t(s(Oe),{class:"flex justify-end"},{default:o(()=>[t(s(S),{type:"submit",onClick:H,disabled:y.value},{default:o(()=>[y.value?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),p(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ms={class:"pr-4"},_s={class:"flex justify-between mt-2"},ps={key:0,class:"text-primary font-bold flex place-items-center self-center"},gs={key:1,class:"text-primary font-bold"},vs={class:"text-primary"},hs={class:"text-sm"},bs={class:"text-xs mt-2"},ys=P({__name:"DataTableBacklog",props:{row:{}},setup(e){const a=pt(),n=e,l=B({debt:n.row.id,message:""}),r=B([]),i=I(!1),d=I(!1),h=I(null),{toast:m}=$e();async function y(){try{const k=await L.get(`/api/debt/${n.row.id}/backlog/`);r.splice(0,r.length,...k.data.Result),i.value=!1}catch{i.value=!1}}function w(){const k=[{condition:l.message=="",message:"Message cannot be blank"},{condition:l.message.length<5,message:"Maybe a little more context?"}];for(let V of k)if(V.condition)return h.value=V.message,!1;return!0}async function z(){if(w()){i.value=!0;try{const V=await L.post(`/api/debt/${n.row.id}/backlog/`,{...l},{headers:{"Content-Type":"application/json"}});await y(),m({title:V.data.Result,variant:"success"}),l.message="",h.value=""}catch{m({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{i.value=!1}}}function C(){d.value=!d.value,d.value&&y()}return(k,V)=>{const H=E("VIcon"),N=E("Label");return u(),b("div",null,[c("div",null,[t(s(S),{variant:"secondary",size:"sm",class:"hidden h-8 lg:flex border border-primary",onClick:C},{default:o(()=>[t(H,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),t(s($t),{open:d.value,"onUpdate:open":V[1]||(V[1]=R=>d.value=R)},{default:o(()=>[t(s(yt),{class:"w-[720px]",side:"right"},{default:o(()=>[t(s(wt),null,{default:o(()=>[t(s(xt),null,{default:o(()=>[p("Backlog - "+g(n.row.invoice),1)]),_:1})]),_:1}),t(s(ee),{class:"mt-2 mb-4"}),t(s(Ee),{class:"h-[80vh] flex flex-col"},{default:o(()=>[c("div",ms,[(u(!0),b(M,null,A(r,(R,q)=>(u(),b("div",{key:q,class:"ml-2 pr-4"},[c("div",_s,[R.is_system_generated?(u(),b("div",ps,[t(H,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),p(" System Generated ")])):(u(),b("div",gs,g(R.created_by_name),1))]),c("div",null,[c("div",vs,g(R.created_date),1),t(s(ee),{variant:"default"}),c("div",null,g(R.message),1)])]))),128))])]),_:1}),h.value?(u(),x(N,{key:0,for:"error",class:"text-red-600 flex"},{default:o(()=>[t(H,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c("p",hs,g(h.value),1)]),_:1})):T("",!0),t(s(It),{class:"mt-2 justify-between"},{default:o(()=>[t(s(Y),{id:"message",modelValue:l.message,"onUpdate:modelValue":V[0]||(V[0]=R=>l.message=R),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),t(s(S),{type:"submit",onClick:z},{default:o(()=>[p(" Save ")]),_:1})]),_:1}),c("p",bs,g(s(a).getUsername),1)]),_:1})]),_:1},8,["open"])])}}}),ws={class:"flex gap-1"},xs=P({__name:"DataTableRowActions",props:{row:{}},setup(e){const a=e,n=G(()=>Ha.parse(a.row.original));return(l,r)=>(u(),b("div",ws,[n.value.editable?(u(),x(fs,{key:0,row:n.value},null,8,["row"])):T("",!0),t(Ga,{row:n.value},null,8,["row"]),t(ys,{row:n.value},null,8,["row"])]))}}),$s=[{id:"select",header:({table:e})=>D(De,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":a=>e.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:e})=>D(De,{checked:e.getIsSelected(),"onUpdate:checked":a=>e.toggleSelected(!!a),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:e})=>D(K,{column:e,title:"Invoice"}),cell:({row:e})=>D("div",{class:`w-20 font-bold ${e.original.editable?"":"line-through decoration-red-600"}`},e.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(e,a,n)=>{var i;const l=((i=e.getValue(a))==null?void 0:i.toString().toLowerCase())??"",r=n==null?void 0:n.toString().toLowerCase();return l.includes(r)},meta:{title:"Invoice"}},{accessorKey:"invoice_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const a=e.getValue("invoice_date");let n="";if(a){const l=new Date(Date.parse(a));isNaN(l.getTime())?n="Not Provided":n=l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else n="Not provided";return D("div",{class:`w-fit ${n!="Not Provided"?"":"text-red-600 font-bold"}`},n)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const a=e.getValue("due_date");let n="";if(a){const l=new Date(a);isNaN(l.getTime())?n="Not Provided":n=l.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else n="Not provided";return D("div",{class:`w-fit ${n!=="Not Provided"?"":"text-red-600 font-bold"}`},n)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"overdue",header:({column:e})=>D(K,{column:e,title:"Overdue"}),cell:({row:e})=>{const a=e.getValue("overdue");let n;return a==1?n="1 day":a>0?n=`${a} day(s)`:a===0?n="0 day":n="No overdue",D("div",{class:"w-fit text-red-600 font-bold"},n)},enableHiding:!0,meta:{title:"Overdue"}},{accessorKey:"amount",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>D(Z,{variant:"destructive"},"RM "+e.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:e})=>D(K,{column:e,title:"Attachment"}),cell:({row:e})=>{const a=e.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return D(Ie,{name:a.icon,class:`${a.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:e})=>D(K,{column:e,title:"Status"}),cell:({row:e})=>{const a=ke.find(n=>n.value===e.original.status.toString());return a?D(Z,{variant:"secondary",class:"flex w-fit items-center"},[a.icon&&D(Ie,{name:a.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),D("span",{},a.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(e,a,n)=>{const l=e.getValue(a);if(!l)return!1;const r=l.toString().toLowerCase();return n.some(d=>r.includes(d.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:e})=>D(xs,{row:e})}],ks={class:"md:hidden"},Ss={class:"hidden h-full flex-1 flex-col space-y-8 p-8 md:flex"},Cs=c("div",{class:"mb-4"},[c("h2",{class:"text-2xl font-bold tracking-tight"},"Statement")],-1),Ls=P({__name:"CustomerDetail",setup(e){const n=vt().params.customer_id,l=fe("debt"),r=`/api/customer/${n}/debt`,i=d=>({id:d.id,status:d.status,invoice:d.invoice,invoice_date:new Date(d.invoice_date),due_date:new Date(d.due_date),overdue:d.overdue,amount:d.amount,document_url:d.document_url,editable:d.editable});return xe(async()=>{await l.fetch(r,0,i)}),ht("tableStore",l),gt(()=>{l.$reset()}),(d,h)=>{const m=E("VPImage");return u(),b(M,null,[c("div",ks,[t(m,{alt:"Tasks",width:"1280",height:"1214",class:"block",image:{dark:"/examples/tasks-dark.png",light:"/examples/tasks-light.png"}},null,8,["image"])]),c("div",Ss,[t(Aa,{customer_id:s(n)},null,8,["customer_id"]),t(Ia,{customer_id:s(n)},null,8,["customer_id"]),c("div",null,[Cs,t($a,{data:s(l).tasks,columns:s($s)},null,8,["data","columns"])])])],64)}}});export{Ls as default};
