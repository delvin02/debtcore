import{_ as ke,a as Ce,b as Se,c as Ve,d as Re,e as Pe,f as ye,g as Ie,u as Ue,h as De,i as Ne,j as he,k as ie,l as Te,m as Fe,n as je,o as ze,p as Ee,q as Me,r as Ae,s as He,F as we,z as H,t as ve}from"./Checkbox.vue_vue_type_script_setup_true_lang-CNO8bVVw.js";import{e as j,r as K,o as r,c as y,d as p,t as $,a as e,k as s,u as a,F as T,D as F,s as V,b as c,A as de,l as v,P as be,Q as xe,R as $e,ap as le,aq as L,i as P,ar as ce,as as ue,at as pe,au as me,av as fe,_ as S,O as W,G as Q,N as X,H as Y,I as Z,K as ee,J as ae,L as se,E as Le,m as M,aw as _e,ax as D,M as te,n as B,ay as Be,a3 as q,a4 as re,g as Ke,a5 as U,v as Ge,x as Oe,y as qe}from"../main.js";import{u as G,_ as ge}from"./table-B4iqM2ka.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-C1IaJMUJ.js";const Je={class:"flex items-center justify-between px-2 pb-10"},We={class:"flex-1 text-sm text-muted-foreground"},Qe={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Xe={class:"flex items-center space-x-2"},Ye=p("p",{class:"text-sm font-medium"},"Rows per page",-1),Ze={class:"flex w-[100px] items-center justify-center text-sm font-medium"},ea={class:"flex items-center space-x-2"},aa=p("span",{class:"sr-only"},"Go to first page",-1),sa=p("span",{class:"sr-only"},"Go to previous page",-1),ta=p("span",{class:"sr-only"},"Go to next page",-1),la=p("span",{class:"sr-only"},"Go to last page",-1),na=j({__name:"DataTablePagination",props:{table:{}},setup(d){return(o,t)=>{const l=K("VIcon");return r(),y("div",Je,[p("div",We,$(o.table.getFilteredSelectedRowModel().rows.length)+" of "+$(o.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),p("div",Qe,[p("div",Xe,[Ye,e(a(Ve),{"model-value":`${o.table.getState().pagination.pageSize}`,"onUpdate:modelValue":o.table.setPageSize},{default:s(()=>[e(a(ke),{class:"h-8 w-[70px]"},{default:s(()=>[e(a(Ce),{placeholder:`${o.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(a(Se),{side:"top"},{default:s(()=>[(r(),y(T,null,F([10,20,30,40,50],i=>e(a(Re),{key:i,value:`${i}`},{default:s(()=>[c($(i),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),p("div",Ze," Page "+$(o.table.getState().pagination.pageIndex+1)+" of "+$(o.table.getPageCount()),1),p("div",ea,[e(a(V),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanPreviousPage(),onClick:t[0]||(t[0]=i=>o.table.setPageIndex(0))},{default:s(()=>[aa,e(l,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanPreviousPage(),onClick:t[1]||(t[1]=i=>o.table.previousPage())},{default:s(()=>[sa,e(l,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanNextPage(),onClick:t[2]||(t[2]=i=>o.table.nextPage())},{default:s(()=>[ta,e(l,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(a(V),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanNextPage(),onClick:t[3]||(t[3]=i=>o.table.setPageIndex(o.table.getPageCount()-1))},{default:s(()=>[la,e(l,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),oa=j({__name:"DataTableViewOptions",props:{table:{}},setup(d){const o=d,t=de(()=>o.table.getAllColumns().filter(l=>typeof l.accessorFn<"u"&&l.getCanHide()));return(l,i)=>(r(),v(a($e),null,{default:s(()=>[e(a(be),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:s(()=>[c(" View ")]),_:1})]),_:1}),e(a(xe),{align:"end",class:"w-[150px]"},{default:s(()=>[e(a(Pe),null,{default:s(()=>[c("Toggle columns")]),_:1}),e(a(ye)),(r(!0),y(T,null,F(t.value,m=>(r(),v(a(Ie),{key:m.id,class:"capitalize",checked:m.getIsVisible(),"onUpdate:checked":R=>m.toggleVisibility(!!R)},{default:s(()=>{var R;return[c($(((R=m.columnDef.meta)==null?void 0:R.title)||m.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),ia={class:"grid gap-4 py-4"},ra={class:"grid grid-cols-4 items-center gap-4"},da={class:"grid grid-cols-4 items-center gap-4"},ca={class:"grid grid-cols-4 items-center gap-4"},ua={class:"grid grid-cols-4 items-center gap-4"},pa={class:"col-span-3"},ma={class:"grid grid-cols-4 items-center gap-4"},fa={class:"col-span-3"},_a={class:"grid grid-cols-4 items-center gap-4"},ga={class:"grid grid-cols-4 items-center gap-4"},ha={key:0,class:"grid grid-cols-4 items-center gap-4"},wa=j({__name:"DataTableCreateModal",setup(d){const o=le("tableStore",G("user")),t=L({id:void 0,name:"",surname:"",email:"",company:null,role:null,password:"",confirm_password:""}),l=L({is_loading:!0,is_open:!1,data:[{value:"",label:""}]}),i=L({is_loading:!0,is_open:!1,data:[{value:"",label:""}]});async function m(){l.is_loading=!0;try{const C=await D.get("http://127.0.0.1:8000/api/company/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});l.data=C.data.Result.map(g=>({id:g.id,value:g.value,label:g.label}))}catch(C){console.error("There was an error fetching the select list:",C)}finally{l.is_loading=!1}}async function R(){i.is_loading=!0;try{const C=await D.get("http://127.0.0.1:8000/api/role-choices/",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=C.data.data.map(g=>({id:g.id,value:g.value,label:g.label}))}catch(C){console.error("There was an error fetching the select list:",C)}finally{i.is_loading=!1}}const z=async()=>{await m(),await R()},I=P(!1),x=P(!1),_=P(null),{toast:h}=ce();function w(){const C=[{condition:t.name==="",message:"Name cannot be blank"},{condition:t.email==="",message:"Email cannot be blank"},{condition:t.company==null,message:"Company must be selected"},{condition:t.password!=t.confirm_password,message:"Passwords do not match"},{condition:t.password.length<9,message:"Password must consists more than 8 characters"},{condition:t.password=="",message:"Password cannot be blank"}];for(let g of C)if(g.condition)return _.value=g.message,!1;return!0}async function k(){var f;if(!w())return;I.value=!0;const g=JSON.parse(((f=document.getElementById("drf_csrf"))==null?void 0:f.textContent)||"{}");try{const n=await D.post("http://127.0.0.1:8000/api/user",{...t},{headers:{"Content-Type":"application/json",[g.csrfHeaderName]:g.csrfToken}});E(),await o.refresh(o.page_index),h({title:n.data.Result,variant:"success"})}catch(n){let b="An unexpected error occurred.";if(D.isAxiosError(n)&&n.response)if(n.response.data.details&&typeof n.response.data.details=="object"){const u=Object.keys(n.response.data.details);u.length>0&&n.response.data.details[u[0]].length>0&&(b=n.response.data.details[u[0]][0])}else n.response.data.error&&(b=n.response.data.error);h({title:"Whoops, something went wrong",description:b||"",variant:"destructive"})}finally{I.value=!1}}function E(){x.value||z(),x.value=!x.value}function ne(C){t.company=C.id,l.is_open=!1}function O(C){t.role=C.id||0,i.is_open=!1}return(C,g)=>{const f=K("VIcon");return r(),y("div",null,[p("div",null,[e(a(V),{variant:"default",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:E},{default:s(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(a(_e),{open:x.value,"onUpdate:open":g[7]||(g[7]=n=>x.value=n)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(pe),null,{default:s(()=>[e(a(me),null,{default:s(()=>[c("Create User")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the details of the user here. Click create when you're done. ")]),_:1})]),_:1}),p("div",ia,[p("div",ra,[e(a(S),{for:"surname",class:"text-right"},{default:s(()=>[c(" Surname ")]),_:1}),e(a(N),{id:"surname",modelValue:t.surname,"onUpdate:modelValue":g[0]||(g[0]=n=>t.surname=n),placeholder:"Lee",class:"col-span-3"},null,8,["modelValue"])]),p("div",da,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Name ")]),_:1}),e(a(N),{id:"name",modelValue:t.name,"onUpdate:modelValue":g[1]||(g[1]=n=>t.name=n),placeholder:"Susan",class:"col-span-3"},null,8,["modelValue"])]),p("div",ca,[e(a(S),{for:"email",class:"text-right"},{default:s(()=>[c(" Email ")]),_:1}),e(a(N),{id:"email",modelValue:t.email,"onUpdate:modelValue":g[2]||(g[2]=n=>t.email=n),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),p("div",ua,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Country ")]),_:1}),p("div",pa,[e(a(W),{open:l.is_open,"onUpdate:open":g[3]||(g[3]=n=>l.is_open=n)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":l.is_open,class:"w-full justify-between px-3",disabled:l.is_loading},{default:s(()=>{var n;return[c($(t.company?(n=l.data.find(b=>b.id===t.company))==null?void 0:n.label:"Select company")+" ",1),l.is_loading?(r(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),v(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search company..."}),e(a(ee),null,{default:s(()=>[c("No company found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),y(T,null,F(l.data,n=>(r(),v(a(te),{key:n.value,value:n.value??"",onSelect:()=>ne(n)},{default:s(()=>[c($(n.label)+" ",1),e(f,{name:"fa-check",class:B(["ml-auto h-4 w-4",t.company===n.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),p("div",ma,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Role ")]),_:1}),p("div",fa,[e(a(W),{open:i.is_open,"onUpdate:open":g[4]||(g[4]=n=>i.is_open=n)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:s(()=>{var n;return[c($(t.role?(n=i.data.find(b=>b.id===t.role))==null?void 0:n.label:"Select Role")+" ",1),l.is_loading?(r(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),v(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search framework..."}),e(a(ee),null,{default:s(()=>[c("No framework found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),y(T,null,F(i.data,n=>(r(),v(a(te),{key:n.value,value:n.value??"",onSelect:()=>O(n)},{default:s(()=>[c($(n.label)+" ",1),e(f,{name:"fa-check",class:B(["ml-auto h-4 w-4",t.role===n.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(Le),p("div",_a,[e(a(S),{for:"password",class:"text-right"},{default:s(()=>[c(" Password ")]),_:1}),e(a(N),{id:"password",modelValue:t.password,"onUpdate:modelValue":g[5]||(g[5]=n=>t.password=n),placeholder:"***********",class:"col-span-3",type:"password"},null,8,["modelValue"])]),p("div",ga,[e(a(S),{for:"confirm_password",class:"text-right"},{default:s(()=>[c(" Confirm Password ")]),_:1}),e(a(N),{id:"confirm_password",modelValue:t.confirm_password,"onUpdate:modelValue":g[6]||(g[6]=n=>t.confirm_password=n),placeholder:"***********",class:"col-span-3",type:"password"},null,8,["modelValue"])])]),_.value?(r(),y("div",ha,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+$(_.value),1)]),_:1})])):M("",!0),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:k,disabled:I.value},{default:s(()=>[I.value?(r(),v(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):M("",!0),c(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),va={class:"flex items-center justify-between"},ya={class:"flex flex-1 items-center space-x-2"},ba=j({__name:"DataTableToolbar",props:{table:{}},setup(d){const o=d,t=de(()=>o.table.getState().columnFilters.length>0);return(l,i)=>{var m;return r(),y("div",va,[p("div",ya,[e(a(N),{placeholder:"Search...","model-value":((m=l.table.getColumn("name"))==null?void 0:m.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:i[0]||(i[0]=R=>l.table.setGlobalFilter(R.target.value))},null,8,["model-value"]),t.value?(r(),v(a(V),{key:0,variant:"default",class:"h-8 px-2 lg:px-3",onClick:i[1]||(i[1]=R=>l.table.resetColumnFilters())},{default:s(()=>[c(" Reset ")]),_:1})):M("",!0)]),e(oa,{table:l.table},null,8,["table"]),e(wa,{table:l.table},null,8,["table"])])}}}),xa={class:"space-y-4"},$a={class:"rounded-md border"},ka=j({__name:"DataTable",props:{columns:{},data:{}},setup(d){const o=le("tableStore",G("user")),t=d,l=P([]),i=P([]),m=P({}),R=P({pageIndex:o.page_index,pageSize:o.page_size}),z=P({});function I(_,h){let w;typeof _=="function"?w=_(h.value):w=_,h.value=w,o.set_page_index(w.pageIndex),o.set_page_size(w.pageSize)}const x=Ue({get data(){return t.data},get columns(){return t.columns},state:{get sorting(){return l.value},get columnFilters(){return i.value},get columnVisibility(){return m.value},get rowSelection(){return z.value}},enableRowSelection:!0,onSortingChange:_=>q(_,l),onPaginationChange:_=>I(_,R),onColumnFiltersChange:_=>q(_,i),onColumnVisibilityChange:_=>q(_,m),onRowSelectionChange:_=>q(_,z),getCoreRowModel:Fe(),getFilteredRowModel:je(),getPaginationRowModel:ze(),getSortedRowModel:Ee(),getFacetedRowModel:Me(),getFacetedUniqueValues:Ae()});return Be(()=>{x.setPageIndex(o.page_index),x.setPageSize(o.page_size)}),(_,h)=>(r(),y("div",xa,[e(ba,{table:a(x)},null,8,["table"]),p("div",$a,[e(a(Te),null,{default:s(()=>[e(a(De),null,{default:s(()=>[(r(!0),y(T,null,F(a(x).getHeaderGroups(),w=>(r(),v(a(ie),{key:w.id},{default:s(()=>[(r(!0),y(T,null,F(w.headers,k=>(r(),v(a(He),{key:k.id},{default:s(()=>[k.isPlaceholder?M("",!0):(r(),v(a(we),{key:0,render:k.column.columnDef.header,props:k.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(a(Ne),null,{default:s(()=>{var w;return[(w=a(x).getRowModel().rows)!=null&&w.length?(r(!0),y(T,{key:0},F(a(x).getRowModel().rows,k=>(r(),v(a(ie),{key:k.id,"data-state":k.getIsSelected()&&"selected"},{default:s(()=>[(r(!0),y(T,null,F(k.getVisibleCells(),E=>(r(),v(a(he),{key:E.id},{default:s(()=>[e(a(we),{render:E.column.columnDef.cell,props:E.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(r(),v(a(ie),{key:1},{default:s(()=>[e(a(he),{colspan:_.columns.length,class:"h-24 text-center"},{default:s(()=>[c(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(na,{table:a(x)},null,8,["table"])]))}}),J=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(d){return(o,t)=>{const l=K("VIcon");return o.column.getCanSort()?(r(),y("div",{key:0,class:B(a(Ke)("flex items-center space-x-2",o.$attrs.class??""))},[e(a($e),null,{default:s(()=>[e(a(be),{"as-child":""},{default:s(()=>[e(a(V),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:s(()=>[p("span",null,$(o.title),1),o.column.getIsSorted()==="desc"?(r(),v(l,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):o.column.getIsSorted()==="asc"?(r(),v(l,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(r(),v(l,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(a(xe),{align:"start"},{default:s(()=>[e(a(re),{onClick:t[0]||(t[0]=i=>o.column.toggleSorting(!1))},{default:s(()=>[e(l,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Asc ")]),_:1}),e(a(re),{onClick:t[1]||(t[1]=i=>o.column.toggleSorting(!0))},{default:s(()=>[e(l,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Desc ")]),_:1}),e(a(ye)),e(a(re),{onClick:t[2]||(t[2]=i=>o.column.toggleVisibility(!1))},{default:s(()=>[e(l,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(r(),y("div",{key:1,class:B(o.$attrs.class)},$(o.title),3))}}}),Ca=H.object({id:H.string(),name:H.string(),email:H.string(),company_name:H.string().nullable(),last_login:H.preprocess(d=>d instanceof Date?d:typeof d=="string"?new Date(d):d,H.date()).nullable()}),Sa={class:"grid gap-4 py-4"},Va={class:"grid grid-cols-4 items-center gap-4"},Ra={class:"grid grid-cols-4 items-center gap-4"},Pa={class:"grid grid-cols-4 items-center gap-4"},Ia={class:"grid grid-cols-4 items-center gap-4"},Ua={class:"col-span-3"},Da={class:"grid grid-cols-4 items-center gap-4"},Na={class:"col-span-3"},Ta={key:0,class:"grid grid-cols-4 items-center gap-4"},Fa=j({__name:"DataTableEditModal",props:{row:{}},setup(d){const o=le("tableStore",G("user")),t=d,l=L({id:t.row.id,name:"",surname:"",email:"",company:null,role:null}),i=L({is_loading:!0,is_open:!1,data:[{value:"",label:""}]}),m=L({is_loading:!0,is_open:!1,data:[{value:"",label:""}]});async function R(){i.is_loading=!0;try{const f=await D.get("http://127.0.0.1:8000/api/company/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{i.is_loading=!1}}async function z(){m.is_loading=!0;try{const f=await D.get("http://127.0.0.1:8000/api/role-choices/",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});m.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{m.is_loading=!1}}async function I(){try{const f=await D.get(`http://127.0.0.1:8000/api/user/${t.row.id}/`);l.name=f.data.Result.name,l.surname=f.data.Result.surname,l.email=f.data.Result.email,l.company=f.data.Result.company,l.role=f.data.Result.role}catch(f){console.error(f),_.value=!1}}const x=async()=>{await R(),await z(),await I()},_=P(!1),h=P(!1),w=P(null),{toast:k}=ce();function E(){const f=[{condition:l.name==="",message:"Name cannot be blank"},{condition:l.email==="",message:"Email cannot be blank"},{condition:l.company==null,message:"Company must be selected"}];for(let n of f)if(n.condition)return w.value=n.message,!1;return!0}async function ne(){var b;if(!E())return;_.value=!0;const n=JSON.parse(((b=document.getElementById("drf_csrf"))==null?void 0:b.textContent)||"{}");try{const u=await D.patch("http://127.0.0.1:8000/api/user",{...l},{headers:{"Content-Type":"application/json",[n.csrfHeaderName]:n.csrfToken}});O(),await o.refresh(o.page_index),k({title:u.data.Result,variant:"success"})}catch(u){let A="An unexpected error occurred.";if(D.isAxiosError(u)&&u.response)if(u.response.data.details&&typeof u.response.data.details=="object"){const oe=Object.keys(u.response.data.details);oe.length>0&&u.response.data.details[oe[0]].length>0&&(A=u.response.data.details[oe[0]][0])}else u.response.data.error&&(A=u.response.data.error);k({title:"Whoops, something went wrong",description:A||"",variant:"destructive"})}finally{_.value=!1}}function O(){h.value||x(),h.value=!h.value}function C(f){l.company=f.id,i.is_open=!1}function g(f){l.role=f.id||0,m.is_open=!1}return(f,n)=>{const b=K("VIcon");return r(),y("div",null,[p("div",null,[e(a(V),{variant:"default",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:O},{default:s(()=>[e(b,{name:"fa-pen",class:"size-4"})]),_:1})]),e(a(_e),{open:h.value,"onUpdate:open":n[5]||(n[5]=u=>h.value=u)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(pe),null,{default:s(()=>[e(a(me),null,{default:s(()=>[c("Edit User")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the details of the user here. Click edit when you're done. ")]),_:1})]),_:1}),p("div",Sa,[p("div",Va,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Surname ")]),_:1}),e(a(N),{id:"name",modelValue:l.surname,"onUpdate:modelValue":n[0]||(n[0]=u=>l.surname=u),placeholder:"Lee",class:"col-span-3"},null,8,["modelValue"])]),p("div",Ra,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Name ")]),_:1}),e(a(N),{id:"name",modelValue:l.name,"onUpdate:modelValue":n[1]||(n[1]=u=>l.name=u),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),p("div",Pa,[e(a(S),{for:"name",class:"text-right"},{default:s(()=>[c(" Email ")]),_:1}),e(a(N),{id:"name",modelValue:l.email,"onUpdate:modelValue":n[2]||(n[2]=u=>l.email=u),placeholder:"Amalina",class:"col-span-3"},null,8,["modelValue"])]),p("div",Ia,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Company ")]),_:1}),p("div",Ua,[e(a(W),{open:i.is_open,"onUpdate:open":n[3]||(n[3]=u=>i.is_open=u)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:s(()=>{var u;return[c($(l.company?(u=i.data.find(A=>A.id===l.company))==null?void 0:u.label:"Select company")+" ",1),i.is_loading?(r(),v(b,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),v(b,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search company..."}),e(a(ee),null,{default:s(()=>[c("No company found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),y(T,null,F(i.data,u=>(r(),v(a(te),{key:u.value,value:u.value??"",onSelect:()=>C(u)},{default:s(()=>[c($(u.label)+" ",1),e(b,{name:"fa-check",class:B(["ml-auto h-4 w-4",l.company===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),p("div",Da,[e(a(S),{for:"companyname",class:"text-right"},{default:s(()=>[c(" Role ")]),_:1}),p("div",Na,[e(a(W),{open:m.is_open,"onUpdate:open":n[4]||(n[4]=u=>m.is_open=u)},{default:s(()=>[e(a(Q),{"as-child":""},{default:s(()=>[e(a(V),{variant:"outline",role:"combobox","aria-expanded":m.is_open,class:"w-full justify-between px-3",disabled:m.is_loading},{default:s(()=>{var u;return[c($(l.role?(u=m.data.find(A=>A.id===l.role))==null?void 0:u.label:"Select Role")+" ",1),i.is_loading?(r(),v(b,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(r(),v(b,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(X),{class:"w-[500px] p-1"},{default:s(()=>[e(a(Y),null,{default:s(()=>[e(a(Z),{class:"h-9",placeholder:"Search framework..."}),e(a(ee),null,{default:s(()=>[c("No role found.")]),_:1}),e(a(ae),null,{default:s(()=>[e(a(se),null,{default:s(()=>[(r(!0),y(T,null,F(m.data,u=>(r(),v(a(te),{key:u.value,value:u.value??"",onSelect:()=>g(u)},{default:s(()=>[c($(u.label)+" ",1),e(b,{name:"fa-check",class:B(["ml-auto h-4 w-4",l.role===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),w.value?(r(),y("div",Ta,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(b,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+$(w.value),1)]),_:1})])):M("",!0)]),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:ne,disabled:_.value},{default:s(()=>[_.value?(r(),v(b,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):M("",!0),c(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),ja={class:"grid gap-4 py-4"},za={class:"grid grid-cols-4 items-center gap-4"},Ea={class:"grid grid-cols-4 items-center gap-4"},Ma={key:0,class:"grid grid-cols-4 items-center gap-4"},Aa=j({__name:"DataTableEditPasswordModal",props:{row:{}},setup(d){le("tableStore",G("user"));const t=L({id:d.row.id,password:"",confirm_password:""}),l=P(!1),i=P(!1),m=P(null),{toast:R}=ce();async function z(){var _;if(m.value=null,t.password!=t.confirm_password){m.value="Passwords do not match.";return}if(t.password==""||t.confirm_password==""){m.value="Password cannot be blank.";return}if(t.password.length<8){m.value="Passowrd must consists more than 8 characters";return}l.value=!0;const x=JSON.parse(((_=document.getElementById("drf_csrf"))==null?void 0:_.textContent)||"{}");try{const h=await D.post("http://127.0.0.1:8000/api/user/change-password/",{...t},{headers:{"Content-Type":"application/json",[x.csrfHeaderName]:x.csrfToken}});I(),R({title:h.data.Result,variant:"success"}),t.confirm_password="",t.password=""}catch(h){let w="An unexpected error occurred.";if(D.isAxiosError(h)&&h.response)if(h.response.data.details&&typeof h.response.data.details=="object"){const k=Object.keys(h.response.data.details);k.length>0&&h.response.data.details[k[0]].length>0&&(w=h.response.data.details[k[0]][0])}else h.response.data.error&&(w=h.response.data.error);R({title:"Whoops, something went wrong",description:w||"",variant:"destructive"})}finally{l.value=!1}}function I(){i.value=!i.value}return(x,_)=>{const h=K("VIcon");return r(),y("div",null,[p("div",null,[e(a(V),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:I},{default:s(()=>[e(h,{name:"fa-lock",class:"size-4"})]),_:1})]),e(a(_e),{open:i.value,"onUpdate:open":_[2]||(_[2]=w=>i.value=w)},{default:s(()=>[e(a(ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:s(()=>[e(a(pe),null,{default:s(()=>[e(a(me),null,{default:s(()=>[c("Change Password")]),_:1}),e(a(fe),null,{default:s(()=>[c(" Insert the latest password of the user here. Click update when you're done. ")]),_:1})]),_:1}),p("div",ja,[p("div",za,[e(a(S),{for:"password",class:"text-right"},{default:s(()=>[c(" Password ")]),_:1}),e(a(N),{id:"password",modelValue:t.password,"onUpdate:modelValue":_[0]||(_[0]=w=>t.password=w),placeholder:"********",class:"col-span-3",type:"password"},null,8,["modelValue"])]),p("div",Ea,[e(a(S),{for:"confirm_password",class:"text-right"},{default:s(()=>[c(" Confirm Password ")]),_:1}),e(a(N),{id:"confirm_password",modelValue:t.confirm_password,"onUpdate:modelValue":_[1]||(_[1]=w=>t.confirm_password=w),placeholder:"********",class:"col-span-3",type:"password"},null,8,["modelValue"])])]),m.value?(r(),y("div",Ma,[e(a(S),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:s(()=>[e(h,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+$(m.value),1)]),_:1})])):M("",!0),e(a(ge),{class:"flex justify-end"},{default:s(()=>[e(a(V),{type:"submit",onClick:z,disabled:l.value},{default:s(()=>[l.value?(r(),v(h,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):M("",!0),c(" Update")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ha={class:"flex gap-1"},La=j({__name:"DataTableRowActions",props:{row:{}},setup(d){const o=d,t=de(()=>Ca.parse(o.row.original));return(l,i)=>(r(),y("div",Ha,[e(Fa,{row:t.value},null,8,["row"]),e(Aa,{row:t.value},null,8,["row"])]))}}),Ba=[{id:"select",header:({table:d})=>U(ve,{checked:d.getIsAllPageRowsSelected()||d.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":o=>d.toggleAllPageRowsSelected(!!o),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:d})=>U(ve,{checked:d.getIsSelected(),"onUpdate:checked":o=>d.toggleSelected(!!o),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"name",header:({column:d})=>U(J,{column:d,title:"Name"}),cell:({row:d})=>U("div",{class:"w-20"},d.getValue("name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(d,o,t)=>{var m;const l=((m=d.getValue(o))==null?void 0:m.toString().toLowerCase())??"",i=t==null?void 0:t.toString().toLowerCase();return l.includes(i)},meta:{title:"Name"}},{accessorKey:"email",header:({column:d})=>U(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>U("div",{class:"w-20"},d.getValue("email")),enableSorting:!0,enableHiding:!0,meta:{title:"Email"}},{accessorKey:"company_name",header:({column:d})=>U(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>U("div",{class:"w-fit"},d.getValue("company_name")),enableSorting:!0,enableHiding:!0,meta:{title:"Company Name"}},{accessorKey:"last_login",header:({column:d})=>U(J,{column:d,title:d.columnDef.meta.title}),cell:({row:d})=>{const o=d.getValue("last_login");let t="";if(o){const l=new Date(o);!isNaN(l.getTime())&&l.getTime()!==new Date(0).getTime()?t=l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):t="Not provided"}else t="Not provided";return U("div",{class:`w-fit ${t!=="Not provided"?"":"text-red-600 font-bold"}`},t)},enableSorting:!0,enableHiding:!0,meta:{title:"Last Login"}},{id:"actions",cell:({row:d})=>U(La,{row:d})}],Ka={class:"p-8 space-y-8 h-full"},Ga=p("div",{class:"flex items-center justify-between space-y-2"},[p("div",null,[p("h2",{class:"text-2xl font-bold tracking-tight"},"User Management"),p("p",{class:"text-muted-foreground"},"Here's a list of your existing users!")])],-1),Oa={key:0,class:"text-center"},qa={key:1},Ja="http://127.0.0.1:8000/api/user",Za=j({__name:"User",setup(d){const o=G("user"),t=l=>({id:l.id,name:l.name,email:l.email,company_name:l.company_name,last_login:new Date(l.last_login)});return Ge(async()=>{await o.fetch(Ja,0,t)}),qe("tableStore",o),Oe(()=>{o.$reset()}),(l,i)=>{const m=K("VIcon");return r(),y("div",Ka,[Ga,a(o).is_loading?(r(),y("div",Oa,[e(m,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(r(),y("div",qa,[e(ka,{data:a(o).tasks,columns:a(Ba)},null,8,["data","columns"])]))])}}});export{Za as default};
