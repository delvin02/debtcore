import{_ as re,a as de,b as ce,c as ue,d as _e,e as Z,u as O,f as fe,g as me,h as ge,i as Q,j as B,k as pe,l as he,m as we,n as be,o as ve,p as ye,q as $e,r as Se,F as W,z as y,s as X}from"./Checkbox.vue_vue_type_script_setup_true_lang-eutFf37Q.js";import{e as x,r as H,o as d,c as _,d as u,t as w,a,k as o,u as e,F as I,v as R,s as S,b as c,x as J,l as h,y as ee,z as te,A as ae,m as L,B as se,i as V,C as Ce,D as z,E as le,G as ne,H as G,I as E,n as q,g as oe,J as xe,K as Ve,L as ke,M as De,_ as K,N as Ie,O as Re,P as Me,Q as Fe,R as Le,S as m,T as Pe,U as ze}from"../main.js";import{_ as Te,a as Ue}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang-vQutYflC.js";import{_ as ie}from"./Input.vue_vue_type_script_setup_true_lang-B0xvdIsq.js";import"./lodash-BtnTHUG3.js";import{_ as T,a as U,b as N}from"./CardDescription.vue_vue_type_script_setup_true_lang-nuAmEoIx.js";import{_ as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-CooFW0om.js";import{_ as Ne}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUbi7heN.js";import{_ as Ae}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-BxpccqsK.js";import{r as He,t as je,a as Be,f as Y}from"./index-DNZ2qQq3.js";import{p as Ee}from"./index-59fmqmGi.js";const Ke={class:"flex items-center justify-between px-2 pb-10"},Ye={class:"flex-1 text-sm text-muted-foreground"},Ge={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},qe={class:"flex items-center space-x-2"},Oe=u("p",{class:"text-sm font-medium"},"Rows per page",-1),Je={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Qe={class:"flex items-center space-x-2"},We=u("span",{class:"sr-only"},"Go to first page",-1),Xe=u("span",{class:"sr-only"},"Go to previous page",-1),Ze=u("span",{class:"sr-only"},"Go to next page",-1),et=u("span",{class:"sr-only"},"Go to last page",-1),tt=x({__name:"DataTablePagination",props:{table:{}},setup(n){return(t,l)=>{const s=H("VIcon");return d(),_("div",Ke,[u("div",Ye,w(t.table.getFilteredSelectedRowModel().rows.length)+" of "+w(t.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),u("div",Ge,[u("div",qe,[Oe,a(e(ue),{"model-value":`${t.table.getState().pagination.pageSize}`,"onUpdate:modelValue":t.table.setPageSize},{default:o(()=>[a(e(re),{class:"h-8 w-[70px]"},{default:o(()=>[a(e(de),{placeholder:`${t.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),a(e(ce),{side:"top"},{default:o(()=>[(d(),_(I,null,R([10,20,30,40,50],i=>a(e(_e),{key:i,value:`${i}`},{default:o(()=>[c(w(i),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),u("div",Je," Page "+w(t.table.getState().pagination.pageIndex+1)+" of "+w(t.table.getPageCount()),1),u("div",Qe,[a(e(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanPreviousPage(),onClick:l[0]||(l[0]=i=>t.table.setPageIndex(0))},{default:o(()=>[We,a(s,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanPreviousPage(),onClick:l[1]||(l[1]=i=>t.table.previousPage())},{default:o(()=>[Xe,a(s,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanNextPage(),onClick:l[2]||(l[2]=i=>t.table.nextPage())},{default:o(()=>[Ze,a(s,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(e(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanNextPage(),onClick:l[3]||(l[3]=i=>t.table.setPageIndex(t.table.getPageCount()-1))},{default:o(()=>[et,a(s,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),at=x({__name:"DataTableViewOptions",props:{table:{}},setup(n){const t=n;console.log(t.table.getAllColumns());const l=J(()=>t.table.getAllColumns().filter(s=>typeof s.accessorFn<"u"&&s.getCanHide()));return console.log(l),(s,i)=>(d(),h(e(ae),null,{default:o(()=>[a(e(ee),{"as-child":""},{default:o(()=>[a(e(S),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:o(()=>[c(" View ")]),_:1})]),_:1}),a(e(te),{align:"end",class:"w-[150px]"},{default:o(()=>[a(e(Te),null,{default:o(()=>[c("Toggle columns")]),_:1}),a(e(Z)),(d(!0),_(I,null,R(l.value,r=>(d(),h(e(Ue),{key:r.id,class:"capitalize",checked:r.getIsVisible(),"onUpdate:checked":b=>r.toggleVisibility(!!b)},{default:o(()=>{var b;return[c(w(((b=r.columnDef.meta)==null?void 0:b.title)||r.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}});function st(n,t){He(2,arguments);var l=je(n),s=Be(t);return isNaN(s)?new Date(NaN):(s&&l.setDate(l.getDate()+s),l)}const lt={class:"flex items-center justify-between"},nt={class:"flex flex-1 items-center space-x-2"},ot=x({__name:"DataTableToolbar",props:{table:{}},setup(n){const t=n,l=J(()=>t.table.getState().columnFilters.length>0);return(s,i)=>{var r;return d(),_("div",lt,[u("div",nt,[a(e(ie),{placeholder:"Search invoice...","model-value":((r=s.table.getColumn("invoice"))==null?void 0:r.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:i[0]||(i[0]=b=>s.table.setGlobalFilter(b.target.value))},null,8,["model-value"]),l.value?(d(),h(e(S),{key:0,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:i[1]||(i[1]=b=>s.table.resetColumnFilters())},{default:o(()=>[c(" Reset ")]),_:1})):L("",!0)]),a(at,{table:s.table},null,8,["table"])])}}}),it={class:"space-y-4 text-muted-foreground"},rt={class:"rounded-md border"},dt=x({__name:"DataTable",props:{columns:{},data:{}},setup(n){const t=se("tableStore",O("debt")),l=n,s=V([]),i=V([]),r=V({}),b=V({pageIndex:t.page_index,pageSize:t.page_size}),M=V();function j(f,F){let p;typeof f=="function"?p=f(F.value):p=f,F.value=p,t.set_page_index(p.pageIndex),t.set_page_size(p.pageSize)}const C=fe({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return s.value},get columnFilters(){return i.value},get columnVisibility(){return r.value},get rowSelection(){return M.value},get pagination(){return b.value}},enableRowSelection:!0,onSortingChange:f=>z(f,s),onPaginationChange:f=>j(f,b),onColumnFiltersChange:f=>z(f,i),onColumnVisibilityChange:f=>z(f,r),onRowSelectionChange:f=>z(f,M),getCoreRowModel:he(),getFilteredRowModel:we(),getPaginationRowModel:be(),getSortedRowModel:ve(),getFacetedRowModel:ye(),getFacetedUniqueValues:$e()});return Ce(()=>{C.setPageIndex(t.page_index),C.setPageSize(t.page_size)}),(f,F)=>(d(),_("div",it,[a(ot,{table:e(C)},null,8,["table"]),u("div",rt,[a(e(pe),{class:"text-xs"},{default:o(()=>[a(e(me),null,{default:o(()=>[(d(!0),_(I,null,R(e(C).getHeaderGroups(),p=>(d(),h(e(B),{key:p.id},{default:o(()=>[(d(!0),_(I,null,R(p.headers,$=>(d(),h(e(Se),{key:$.id},{default:o(()=>[$.isPlaceholder?L("",!0):(d(),h(e(W),{key:0,render:$.column.columnDef.header,props:$.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(e(ge),{id:"dbTableBody"},{default:o(()=>{var p;return[(p=e(C).getRowModel().rows)!=null&&p.length?(d(!0),_(I,{key:0},R(e(C).getRowModel().rows,$=>(d(),h(e(B),{key:$.id,"data-state":$.getIsSelected()&&"selected"},{default:o(()=>[(d(!0),_(I,null,R($.getVisibleCells(),g=>(d(),h(e(Q),{key:g.id},{default:o(()=>[a(e(W),{render:g.column.columnDef.cell,props:g.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),h(e(B),{key:1},{default:o(()=>[a(e(Q),{colspan:f.columns.length,class:"h-24 text-center"},{default:o(()=>[c(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),a(tt,{table:e(C)},null,8,["table"])]))}}),ct={class:"flex sm:flex-row sm gap-4 flex-col w-full"},ut="/api/session/card",_t=x({__name:"DashboardCard",setup(n){const t=le({scheduled_reminders:0,active_debts:0,active_debts_amount:"0.00",settled_debts_amount:"0.00"}),l=async()=>{try{const s=await G.get(ut);Object.assign(t,s.data.Result)}catch{}};return ne(()=>{l()}),(s,i)=>(d(),_("div",ct,[a(e(N),{class:"w-1/3"},{default:o(()=>[a(e(T),null,{default:o(()=>[a(e(A),null,{default:o(()=>[c(w(t.scheduled_reminders),1)]),_:1}),a(e(U),null,{default:o(()=>[c("Scheduled Reminder(s)")]),_:1})]),_:1})]),_:1}),a(e(N),{class:"w-1/3"},{default:o(()=>[a(e(T),null,{default:o(()=>[a(e(A),null,{default:o(()=>[c(w(t.active_debts),1)]),_:1}),a(e(U),null,{default:o(()=>[c("Active Debt(s)")]),_:1})]),_:1})]),_:1}),a(e(N),{class:"w-1/3"},{default:o(()=>[a(e(T),null,{default:o(()=>[a(e(A),null,{default:o(()=>[c("RM "+w(t.active_debts_amount),1)]),_:1}),a(e(U),null,{default:o(()=>[c("Active Debt Amount")]),_:1})]),_:1})]),_:1}),a(e(N),{class:"w-1/3"},{default:o(()=>[a(e(T),null,{default:o(()=>[a(e(A),null,{default:o(()=>[c("RM "+w(t.settled_debts_amount),1)]),_:1}),a(e(U),null,{default:o(()=>[c("Settled Debt")]),_:1})]),_:1})]),_:1})]))}}),D=x({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(n){return(t,l)=>{const s=H("VIcon");return t.column.getCanSort()?(d(),_("div",{key:0,class:q(e(oe)("flex items-center space-x-2",t.$attrs.class??""))},[a(e(ae),null,{default:o(()=>[a(e(ee),{"as-child":""},{default:o(()=>[a(e(S),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[u("span",null,w(t.title),1),t.column.getIsSorted()==="desc"?(d(),h(s,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):t.column.getIsSorted()==="asc"?(d(),h(s,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(d(),h(s,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),a(e(te),{align:"start"},{default:o(()=>[a(e(E),{onClick:l[0]||(l[0]=i=>t.column.toggleSorting(!1))},{default:o(()=>[a(s,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Asc ")]),_:1}),a(e(E),{onClick:l[1]||(l[1]=i=>t.column.toggleSorting(!0))},{default:o(()=>[a(s,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Desc ")]),_:1}),a(e(Z)),a(e(E),{onClick:l[2]||(l[2]=i=>t.column.toggleVisibility(!1))},{default:o(()=>[a(s,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),c(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(d(),_("div",{key:1,class:q(t.$attrs.class)},w(t.title),3))}}}),ft=y.object({id:y.number(),invoice:y.string(),customer_name:y.string().min(2).max(50),event_display:y.string(),scheduled_date:y.preprocess(n=>typeof n=="string"?new Date(n):n,y.date()),status:y.string(),additional_info:y.string(),change_info:y.string().nullable(),editable:y.boolean()}),mt={class:"grid gap-4 py-4"},gt={class:"grid grid-cols-4 items-center gap-4"},pt={class:"grid grid-cols-4 items-center gap-4"},ht={class:"col-span-3"},wt={key:0,class:"grid grid-cols-4 items-center gap-4"},bt=x({__name:"DataTableEditScheduleModal",props:{row:{}},setup(n){const t=se("dashboardStore",O("dashboard")),l=n,s=le({id:l.row.id,invoice:l.row.invoice,scheduled_date:null}),i=V(!1),r=V(!1),b=V(null),{toast:M}=xe(),j=st(new Date,1),C=Y(j,"yyyy-MM-dd");async function f(){try{const g=await G.get(`/api/session/${l.row.id}/scheduled_date`);if(Object.assign(s,g.data.Result),g.data.Result.scheduled_date){const v=Ee(g.data.Result.scheduled_date);s.scheduled_date=Y(v,"yyyy-MM-dd")}else s.scheduled_date=null;console.log(s.scheduled_date)}catch(g){console.log(g)}finally{i.value=!1}}async function F(){i.value=!0;try{const g=await G.patch(`/api/session/${l.row.id}/scheduled_date`,{...s},{headers:{"Content-Type":"multipart/form-data"}});p(),await t.refresh(t.page_index),M({title:g.data.Result,variant:"success"})}catch{M({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{i.value=!1}}function p(){r.value=!r.value,r.value&&f()}function $(g){const v=new Date(g);s.scheduled_date=Y(v,"yyyy-MM-dd")}return(g,v)=>{const P=H("VIcon");return d(),_("div",null,[u("div",null,[a(e(S),{variant:"default",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:p},{default:o(()=>[a(P,{name:"fa-pen",class:"size-4"})]),_:1})]),a(e(Le),{open:r.value,"onUpdate:open":v[3]||(v[3]=k=>r.value=k)},{default:o(()=>[a(e(Ve),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[a(e(ke),null,{default:o(()=>[a(e(De),null,{default:o(()=>[c("Reschedule Reminder")]),_:1})]),_:1}),u("div",mt,[u("div",gt,[a(e(K),{for:"invoice",class:"text-right"},{default:o(()=>[c(" Invoice ")]),_:1}),a(e(ie),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":v[0]||(v[0]=k=>s.invoice=k),class:"col-span-3",disabled:""},null,8,["modelValue"])]),u("div",pt,[a(e(K),{for:"email",class:"text-right"},{default:o(()=>[c(" Schedule Date ")]),_:1}),u("div",ht,[a(e(Ie),null,{default:o(()=>[a(e(Re),{"as-child":""},{default:o(()=>[a(e(S),{variant:"outline",class:q(e(oe)("w-full justify-start text-left font-normal",!s.scheduled_date&&"text-muted-foreground"))},{default:o(()=>[a(P,{name:"bi-calendar-fill",class:"mr-2 size-4"}),u("span",null,w(s.scheduled_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),a(e(Me),{class:"w-auto p-0"},{default:o(()=>[a(e(Ae),{mode:"date","min-date":e(C),modelValue:s.scheduled_date,"onUpdate:modelValue":[v[1]||(v[1]=k=>s.scheduled_date=k),v[2]||(v[2]=k=>$(k))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"},"is-required":""},null,8,["min-date","modelValue"])]),_:1})]),_:1})])])]),a(Fe),b.value?(d(),_("div",wt,[a(e(K),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[a(P,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c(" "+w(b.value),1)]),_:1})])):L("",!0),a(e(Ne),{class:"flex justify-end"},{default:o(()=>[a(e(S),{type:"submit",onClick:F,disabled:i.value},{default:o(()=>[i.value?(d(),h(P,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):L("",!0),c(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),vt={class:"flex gap-1"},yt=x({__name:"DataTableRowActions",props:{row:{}},setup(n){const t=n,l=J(()=>ft.parse(t.row.original));return(s,i)=>(d(),_("div",vt,[l.value.editable?(d(),h(bt,{key:0,row:l.value},null,8,["row"])):L("",!0)]))}}),$t=[{id:"select",header:({table:n})=>m(X,{checked:n.getIsAllPageRowsSelected()||n.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":t=>n.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:n})=>m(X,{checked:n.getIsSelected(),"onUpdate:checked":t=>n.toggleSelected(!!t),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:n})=>m(D,{column:n,title:"Invoice"}),cell:({row:n})=>m("div",{class:"w-20"},n.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())??"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:n})=>m(D,{column:n,title:"Customer"}),cell:({row:n})=>m("div",{class:"w-fit"},n.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())??"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Customer"}},{accessorKey:"event_display",header:({column:n})=>m(D,{column:n,title:"Event Type"}),cell:({row:n})=>m("div",{class:"w-fit"},n.getValue("event_display")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())??"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Event Type"}},{accessorKey:"scheduled_date",header:({column:n})=>m(D,{column:n,title:n.columnDef.meta.title}),cell:({row:n})=>{const t=n.getValue("scheduled_date");let l="";if(t){const s=new Date(Date.parse(t));isNaN(s.getTime())?l="Not Provided":l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return m("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Scheduled Date"}},{accessorKey:"status",header:({column:n})=>m(D,{column:n,title:"Status"}),cell:({row:n})=>m("div",{class:"w-fit"},n.getValue("status")),enableSorting:!0,enableHiding:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())||"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Status"}},{accessorKey:"additional_info",header:({column:n})=>m(D,{column:n,title:"Additional Info"}),cell:({row:n})=>m("div",{class:"w-fit"},n.getValue("additional_info")),enableSorting:!0,enableHiding:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())||"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Additional Info"}},{accessorKey:"change_info",header:({column:n})=>m(D,{column:n,title:"Change Info"}),cell:({row:n})=>m("div",{class:"w-44"},n.getValue("change_info")),enableSorting:!0,enableHiding:!0,filterFn:(n,t,l)=>{var r;const s=((r=n.getValue(t))==null?void 0:r.toString().toLowerCase())||"",i=l==null?void 0:l.toString().toLowerCase();return s.includes(i)},meta:{title:"Change Info"}},{id:"actions",cell:({row:n})=>m(yt,{row:n})}],St={class:"p-8 space-y-8 h-full"},Ct=u("div",{class:"flex items-center justify-between space-y-2"},[u("div",null,[u("h2",{class:"text-2xl font-bold tracking-tight"},"Dashboard")])],-1),xt={key:0,class:"text-center"},Vt={key:1},kt="/api/session",At=x({__name:"Dashboard",setup(n){const t=O("dashboard"),l=s=>({id:s.id,invoice:s.invoice,customer_name:s.customer_name,event_display:s.event_display,scheduled_date:s.scheduled_date,status:s.status_display,additional_info:s.additional_info,change_info:s.change_info,editable:s.editable});return ne(async()=>{await t.fetch(kt,0,l)}),ze("dashboardStore",t),Pe(()=>{t.$reset()}),(s,i)=>{const r=H("VIcon");return d(),_("div",St,[Ct,a(_t),e(t).is_loading?(d(),_("div",xt,[a(r,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(d(),_("div",Vt,[a(dt,{data:e(t).tasks,columns:e($t)},null,8,["data","columns"])]))])}}});export{At as default};
