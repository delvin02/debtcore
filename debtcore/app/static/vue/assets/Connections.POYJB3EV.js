import{_ as m,a as b,b as d,c as w}from"./CardContent.vue_vue_type_script_setup_true_lang.7hCCP0E-.js";import{e as _,o as i,c as h,f as v,n as $,u as t,g as B,aw as S,L as y,G as W,J as A,a8 as V,r as N,l as u,k as s,d as n,a,b as c,Z as g,s as k,i as z,ax as D}from"../main.js";import{_ as x}from"./index.DhdF1qMN.js";const C=_({__name:"CardTitle",props:{class:{}},setup(l){const e=l;return(o,r)=>(i(),h("h3",{class:$(t(B)("text-2xl font-semibold leading-none tracking-tight",e.class))},[v(o.$slots,"default")],2))}}),E=_({__name:"CardFooter",props:{class:{}},setup(l){const e=l;return(o,r)=>(i(),h("div",{class:$(t(B)("flex items-center p-6 pt-0",e.class))},[v(o.$slots,"default")],2))}}),I=l=>S(l,{state:()=>({is_authenticated:!1,authenticate_url:"",url:"",link:"",is_loading:!1}),actions:{async init(e){this.url=e,this.is_loading=!0;try{const o=await y.get(e,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=o.data.Result.is_authenticated,this.authenticate_url=o.data.Result.authenticate_url}catch(o){console.log("this was an error initializing the connection",o)}finally{this.is_loading=!1}},async disconnect(){this.is_loading=!0;try{const e=await y.put(this.url,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=!1}catch(e){console.log("There was an error disconnecting the connection",e)}finally{this.is_loading=!1}}}})(),O={class:"flex border-t-4 border-green-600/80 rounded"},P={class:"flex items-stretch"},R=n("b",null,"'Connect to WhatsApp'",-1),j=n("b",null,"'Disconnect from WhatsApp'",-1),q=n("b",null,"'Authenticate'",-1),F=n("a",{href:"https://metastatus.com/whatsapp-business-api",class:"text-blue-600 underline"},"Status",-1),M=["href"],U=_({__name:"Whatsapp",setup(l){const e=I("whatsapp"),{toast:o}=W();A(()=>{e.init("/api/connections/facebook")});const r=()=>{e.disconnect(),o({title:"Whatsapp disconnected successfully!",variant:"success"})};return V(()=>{e.$reset()}),(T,f)=>{const p=N("VIcon");return t(e).is_loading?(i(),u(t(w),{key:1},{default:s(()=>[a(p,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})]),_:1})):(i(),u(t(w),{key:0,class:"shadow-none"},{default:s(()=>[n("div",O,[a(t(m),null,{default:s(()=>[a(t(C),null,{default:s(()=>[a(p,{name:"fa-whatsapp",class:"size-24 fill-green-500"})]),_:1})]),_:1}),a(t(m),{class:"flex-1"},{default:s(()=>[a(t(b),{class:"py-2 pl-0"},{default:s(()=>[n("div",P,[a(t(C),null,{default:s(()=>[c("WhatsApp Business")]),_:1}),t(e).is_authenticated?(i(),u(t(x),{key:0,class:"ml-3",variant:"success"},{default:s(()=>[c(" Connected")]),_:1})):(i(),u(t(x),{key:1,class:"ml-3",variant:"destructive"},{default:s(()=>[c(" Not Connected")]),_:1}))])]),_:1}),a(t(g),{class:"w-full"}),a(t(b),{class:"py-2 pl-0"},{default:s(()=>[n("div",null,[a(t(d),null,{default:s(()=>[c("To connect to WhatsApp Business, click the "),R,c(" button. You will be taken to the Meta Business website to allow DebtCore to connect to your Organisation.")]),_:1}),a(t(d),null,{default:s(()=>[c("To disconnect from WhatsApp Business, click the "),j,c(" button. This button will only be displayed when a connection has been established.")]),_:1}),a(t(d),{class:"mt-4"},{default:s(()=>[c("When the connection requires authentication, click the "),q,c(" button. You will be taken to the QBO website to re-establish connection to your Organisation.")]),_:1}),a(t(d),{class:"mt-8"},{default:s(()=>[c("Whatsapp Business API "),F,c(".")]),_:1})])]),_:1})]),_:1})]),a(t(g),{class:"w-full"}),a(t(E),{class:"flex items-end justify-end mt-5"},{default:s(()=>[t(e).is_authenticated?(i(),u(t(k),{key:1,variant:"destructive",onClick:f[0]||(f[0]=()=>r())},{default:s(()=>[c(" Disconnect")]),_:1})):(i(),u(t(k),{key:0,variant:"default"},{default:s(()=>[n("a",{href:t(e).authenticate_url}," Connect to WhatsApp",8,M)]),_:1}))]),_:1})]),_:1}))}}}),Y={class:"p-8 space-y-8"},G=n("div",{class:"flex items-center justify-between space-y-2"},[n("div",null,[n("h2",{class:"text-2xl font-bold tracking-tight"},"Connections"),n("p",{class:"text-muted-foreground"},"Here's a list of your connected apps!")])],-1),Q=_({__name:"Connections",setup(l){const e=D();z("Unknown");const{toast:o}=W();return A(()=>{const r=e.query.error;r&&o({title:"Authentication Failed!",description:r,variant:"destructive"})}),(r,T)=>(i(),h("div",Y,[G,n("div",null,[a(U)])]))}});export{Q as default};
