import{_ as Re,a as Ae,b as je,c as He,d as Le,e as $e,u as ne,f as Ne,g as Ee,h as Be,i as be,j as de,k as Ye,l as Ke,m as Ge,n as We,o as qe,p as Qe,q as Oe,r as Xe,F as ye,z as U,s as we}from"./Checkbox.vue_vue_type_script_setup_true_lang.C3smPaJx.js";import{e as j,r as B,o as d,c as v,d as i,t as x,a as e,k as a,u as t,F,v as R,s as S,b as m,x as te,l as b,Q as X,m as T,O as q,X as ae,Y as fe,a1 as le,Z as me,a0 as J,a2 as Z,P as Q,N as O,n as N,g as se,ap as Je,y as ke,z as Se,A as Ce,B as oe,E,i as k,J as re,V as Ve,H,K as pe,L as _e,M as ge,W as De,_ as P,R as ve,C as Ze,D as ie,I as ue,aa as Me,an as Ie,ao as Pe,j as et,S as D,a6 as xe,G as tt,T as at,U as lt}from"../main.js";import{_ as ee}from"./index.DhdF1qMN.js";import{_ as st,a as nt,c as ot,b as it,d as rt}from"./index.BvSD5qx-.js";import{_ as ct,a as dt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.zHXQIui9.js";import{_ as he}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as L}from"./Input.vue_vue_type_script_setup_true_lang.LM1FtyXv.js";import{_ as ze}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.YkNaXevc.js";import{_ as Fe}from"./lodash.BtnTHUG3.js";import{f as Te}from"./index.DNZ2qQq3.js";import{l as ut,A as ft}from"./index.CXmR0JE6.js";const mt={class:"flex items-center justify-between px-2 pb-10"},pt={class:"flex-1 text-sm text-muted-foreground"},_t={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},gt={class:"flex items-center space-x-2"},vt=i("p",{class:"text-sm font-medium"},"Rows per page",-1),ht={class:"flex w-[100px] items-center justify-center text-sm font-medium"},bt={class:"flex items-center space-x-2"},yt=i("span",{class:"sr-only"},"Go to first page",-1),wt=i("span",{class:"sr-only"},"Go to previous page",-1),xt=i("span",{class:"sr-only"},"Go to next page",-1),$t=i("span",{class:"sr-only"},"Go to last page",-1),kt=j({__name:"DataTablePagination",props:{table:{}},setup(r){return(o,s)=>{const l=B("VIcon");return d(),v("div",mt,[i("div",pt,x(o.table.getFilteredSelectedRowModel().rows.length)+" of "+x(o.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),i("div",_t,[i("div",gt,[vt,e(t(He),{"model-value":`${o.table.getState().pagination.pageSize}`,"onUpdate:modelValue":o.table.setPageSize},{default:a(()=>[e(t(Re),{class:"h-8 w-[70px]"},{default:a(()=>[e(t(Ae),{placeholder:`${o.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),e(t(je),{side:"top"},{default:a(()=>[(d(),v(F,null,R([10,20,30,40,50],c=>e(t(Le),{key:c,value:`${c}`},{default:a(()=>[m(x(c),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),i("div",ht," Page "+x(o.table.getState().pagination.pageIndex+1)+" of "+x(o.table.getPageCount()),1),i("div",bt,[e(t(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanPreviousPage(),onClick:s[0]||(s[0]=c=>o.table.setPageIndex(0))},{default:a(()=>[yt,e(l,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanPreviousPage(),onClick:s[1]||(s[1]=c=>o.table.previousPage())},{default:a(()=>[wt,e(l,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(S),{variant:"outline",class:"h-8 w-8 p-0",disabled:!o.table.getCanNextPage(),onClick:s[2]||(s[2]=c=>o.table.nextPage())},{default:a(()=>[xt,e(l,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),e(t(S),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!o.table.getCanNextPage(),onClick:s[3]||(s[3]=c=>o.table.setPageIndex(o.table.getPageCount()-1))},{default:a(()=>[$t,e(l,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),Ue=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claiming",icon:"fa-circle"},{value:"3",label:"Done",icon:"fa-check-circle"},{value:"4",label:"Canceled",icon:"fa-times-circle"}],St={class:"hidden space-x-1 lg:flex"},Ct={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Vt=j({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(r){const o=r,s=te(()=>{var c;return(c=o.column)==null?void 0:c.getFacetedUniqueValues()}),l=te(()=>{var c;return new Set((c=o.column)==null?void 0:c.getFilterValue())});return(c,p)=>{const y=B("VIcon"),M=B("CheckIcon");return d(),b(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:a(()=>[e(y,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),m(" "+x(c.title)+" ",1),l.value.size>0?(d(),v(F,{key:0},[e(t(X),{orientation:"vertical",class:"mx-2 h-4"}),e(t(ee),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:a(()=>[m(x(l.value.size),1)]),_:1}),i("div",St,[l.value.size>2?(d(),b(t(ee),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x(l.value.size)+" selected ",1)]),_:1})):(d(!0),v(F,{key:1},R(c.options.filter($=>l.value.has($.value)),$=>(d(),b(t(ee),{key:$.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:a(()=>[m(x($.label),1)]),_:2},1024))),128))])],64)):T("",!0)]),_:1})]),_:1}),e(t(Q),{class:"w-[200px] p-0",align:"start"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{placeholder:c.title},null,8,["placeholder"]),e(t(le),null,{default:a(()=>[e(t(me),null,{default:a(()=>[m("No results found.")]),_:1}),e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.options,$=>(d(),b(t(Z),{key:$.value,value:$,onSelect:w=>{var C;l.value.has($.value)?l.value.delete($.value):l.value.add($.value);const V=Array.from(l.value);(C=c.column)==null||C.setFilterValue(V.length?V:void 0)}},{default:a(()=>{var w;return[i("div",{class:N(t(se)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",l.value.has($.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(M,{class:N(t(se)("h-4 w-4"))},null,8,["class"])],2),$.icon?(d(),b(Je($.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):T("",!0),i("span",null,x($.label),1),(w=s.value)!=null&&w.get($.value)?(d(),v("span",Ct,x(s.value.get($.value)),1)):T("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),l.value.size>0?(d(),v(F,{key:0},[e(t(st)),e(t(J),null,{default:a(()=>[e(t(Z),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:p[0]||(p[0]=$=>{var w;return(w=c.column)==null?void 0:w.setFilterValue(void 0)})},{default:a(()=>[m(" Clear filters ")]),_:1})]),_:1})],64)):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Dt=j({__name:"DataTableViewOptions",props:{table:{}},setup(r){const o=r;console.log(o.table.getAllColumns());const s=te(()=>o.table.getAllColumns().filter(l=>typeof l.accessorFn<"u"&&l.getCanHide()));return console.log(s),(l,c)=>(d(),b(t(Ce),null,{default:a(()=>[e(t(ke),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:a(()=>[m(" View ")]),_:1})]),_:1}),e(t(Se),{align:"end",class:"w-[150px]"},{default:a(()=>[e(t(ct),null,{default:a(()=>[m("Toggle columns")]),_:1}),e(t($e)),(d(!0),v(F,null,R(s.value,p=>(d(),b(t(dt),{key:p.id,class:"capitalize",checked:p.getIsVisible(),"onUpdate:checked":y=>p.toggleVisibility(!!y)},{default:a(()=>{var y;return[m(x(((y=p.columnDef.meta)==null?void 0:y.title)||p.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}}),Mt={class:"grid gap-4 py-4"},It={class:"grid grid-cols-4 items-center gap-4"},Pt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),zt={class:"grid grid-cols-4 items-center gap-4"},Ft=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Tt={class:"col-span-3"},Ut={class:"grid grid-cols-4 items-center gap-4"},Rt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),At={class:"grid grid-cols-4 items-center gap-4"},jt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ht={class:"col-span-3"},Lt={class:"grid grid-cols-4 items-center gap-4"},Nt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Et={class:"grid grid-cols-4 items-center gap-4"},Bt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Yt={class:"col-span-3"},Kt={class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Gt=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Wt={class:"col-span-3"},qt=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),Qt={key:0,class:"grid grid-cols-4 items-center gap-4"},Ot=j({__name:"DataTableCreateDebt",setup(r){const o=oe("tableStore",ne("debt")),s=E({invoice:"",customer:null,amount:null,invoice_date:null,term:7,status:null,document:null}),l=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),c=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=k("");async function y(_){l.is_loading=!0;try{const n=await H.get(`/api/customer/list?search=${_||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});l.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{l.is_loading=!1}}async function M(){l.is_loading=!0;try{const _=await H.get("/api/debt/status/create/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=_.data.Result,s.status=1}catch{V({title:"Whoops, something went wrong",description:"There was an error fetching the select list.",variant:"destructive"})}finally{c.is_loading=!1}}const $=k(!1),w=k(!1),h=k(null);k();const{toast:V}=re();Ve(p,Fe.debounce(async _=>{w.value&&await y(_)},500));function C(){var n;const _=[{condition:s.invoice==="",message:"Invoice cannot be blank"},{condition:((n=s.invoice_date)==null?void 0:n.toString)==null,message:"Invoice Date cannot be blank"},{condition:s.status==null,message:"Status cannot be blank"},{condition:s.customer==null,message:"Customer cannot be blank"}];for(let f of _)if(f.condition)return h.value=f.message,!1;return!0}async function I(){if(C()){$.value=!0;try{const n=await H.post("/api/debt",{...s},{headers:{"Content-Type":"multipart/form-data"}});A(),await o.refresh(o.page_index),V({title:n.data.Result,variant:"success"})}catch{V({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{$.value=!1}}}function A(){w.value=!w.value,w.value&&(y(p.value),M())}function W(_){s.customer=_.id,l.is_open=!1}function Y(_){s.status=_.id,c.is_open=!1}function K(_){var f;const n=_.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){V({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){V({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}s.document=u}}function z(_){const n=new Date(_);s.invoice_date=Te(n,"yyyy-MM-dd")}return(_,n)=>{const f=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(S),{variant:"default",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:A},{default:a(()=>[e(f,{name:"fa-plus",class:"size-4"})]),_:1})]),e(t(ve),{open:w.value,"onUpdate:open":n[7]||(n[7]=u=>w.value=u)},{default:a(()=>[e(t(pe),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(_e),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Create Debt")]),_:1}),e(t(De),null,{default:a(()=>[m(" Insert the details of the debt here. Click create when you're done. ")]),_:1})]),_:1}),i("div",Mt,[i("div",It,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),Pt]),_:1}),e(t(L),{id:"invoice",modelValue:s.invoice,"onUpdate:modelValue":n[0]||(n[0]=u=>s.invoice=u),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",zt,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),Ft]),_:1}),i("div",Tt,[e(t(O),{open:l.is_open,"onUpdate:open":n[2]||(n[2]=u=>l.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",role:"combobox","aria-expanded":l.is_open,class:"w-full justify-between px-3",disabled:l.is_loading},{default:a(()=>{var u;return[m(x(s.customer?(u=l.data.find(g=>g.id===s.customer))==null?void 0:u.label:"Select customer")+" ",1),l.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{class:"h-9",modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=u=>p.value=u),placeholder:"Search country..."},null,8,["modelValue"]),e(t(me),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(le),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(l.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>W(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:N(["ml-auto h-4 w-4",s.customer===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",Ut,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),Rt]),_:1}),e(t(L),{id:"amount",modelValue:s.amount===null?"":s.amount,"onUpdate:modelValue":n[3]||(n[3]=u=>s.amount=u===""?null:u),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",At,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),jt]),_:1}),i("div",Ht,[e(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",class:N(t(se)("w-full justify-start text-left font-normal",!s.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(f,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),i("span",null,x(s.invoice_date?s.invoice_date:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(ze),{"onUpdate:modelValue":n[4]||(n[4]=u=>z(u)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Lt,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Nt]),_:1}),e(t(L),{id:"amount",modelValue:s.term,"onUpdate:modelValue":n[5]||(n[5]=u=>s.term=u),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Et,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status "),Bt]),_:1}),i("div",Yt,[e(t(O),{open:c.is_open,"onUpdate:open":n[6]||(n[6]=u=>c.is_open=u)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var u;return[m(x(s.status?(u=c.data.find(g=>g.id===s.status))==null?void 0:u.label:"Select status")+" ",1),c.is_loading?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(f,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.data,u=>(d(),b(t(Z),{key:u.id,value:u.value??"",onSelect:()=>Y(u)},{default:a(()=>[m(x(u.label)+" ",1),e(f,{name:"fa-check",class:N(["ml-auto h-4 w-4",s.status===u.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(X),i("div",Kt,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment "),Gt]),_:1}),i("div",Wt,[e(t(L),{id:"name",type:"file",onChange:K,class:"col-span-3"})]),qt])]),e(X),h.value?(d(),v("div",Qt,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(h.value),1)]),_:1})])):T("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[e(t(S),{type:"submit",onClick:I,disabled:$.value},{default:a(()=>[$.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Create")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Xt={class:"flex items-center justify-between"},Jt={class:"flex flex-1 items-center space-x-2"},Zt=j({__name:"DataTableToolbar",props:{table:{}},setup(r){const o=r,s=te(()=>o.table.getState().columnFilters.length>0);return(l,c)=>{var p;return d(),v("div",Xt,[i("div",Jt,[e(t(L),{placeholder:"Search...","model-value":((p=l.table.getColumn("invoice"))==null?void 0:p.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:c[0]||(c[0]=y=>l.table.setGlobalFilter(y.target.value))},null,8,["model-value"]),l.table.getColumn("status")?(d(),b(Vt,{key:0,column:l.table.getColumn("status"),title:"Status",options:t(Ue)},null,8,["column","options"])):T("",!0),s.value?(d(),b(t(S),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:c[1]||(c[1]=y=>l.table.resetColumnFilters())},{default:a(()=>[m(" Reset ")]),_:1})):T("",!0)]),e(Dt,{table:l.table},null,8,["table"]),e(Ot,{table:l.table},null,8,["table"])])}}}),ea={class:"space-y-4 text-muted-foreground"},ta={class:"rounded-md border"},aa=j({__name:"DataTable",props:{columns:{},data:{}},setup(r){const o=oe("tableStore",ne("debt")),s=r,l=k([]),c=k([]),p=k({}),y=k({pageIndex:o.page_index,pageSize:o.page_size}),M=k();function $(h,V){let C;typeof h=="function"?C=h(V.value):C=h,V.value=C,o.set_page_index(C.pageIndex),o.set_page_size(C.pageSize)}const w=Ne({get data(){return s.data},get columns(){return s.columns},state:{get sorting(){return l.value},get columnFilters(){return c.value},get columnVisibility(){return p.value},get rowSelection(){return M.value},get pagination(){return y.value}},enableRowSelection:!0,onSortingChange:h=>ie(h,l),onPaginationChange:h=>$(h,y),onColumnFiltersChange:h=>ie(h,c),onColumnVisibilityChange:h=>ie(h,p),onRowSelectionChange:h=>ie(h,M),getCoreRowModel:Ke(),getFilteredRowModel:Ge(),getPaginationRowModel:We(),getSortedRowModel:qe(),getFacetedRowModel:Qe(),getFacetedUniqueValues:Oe()});return Ze(()=>{w.setPageIndex(o.page_index),w.setPageSize(o.page_size)}),(h,V)=>(d(),v("div",ea,[e(Zt,{table:t(w)},null,8,["table"]),i("div",ta,[e(t(Ye),{class:"text-xs"},{default:a(()=>[e(t(Ee),null,{default:a(()=>[(d(!0),v(F,null,R(t(w).getHeaderGroups(),C=>(d(),b(t(de),{key:C.id},{default:a(()=>[(d(!0),v(F,null,R(C.headers,I=>(d(),b(t(Xe),{key:I.id},{default:a(()=>[I.isPlaceholder?T("",!0):(d(),b(t(ye),{key:0,render:I.column.columnDef.header,props:I.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(t(Be),{id:"dbTableBody"},{default:a(()=>{var C;return[(C=t(w).getRowModel().rows)!=null&&C.length?(d(!0),v(F,{key:0},R(t(w).getRowModel().rows,I=>(d(),b(t(de),{key:I.id,"data-state":I.getIsSelected()&&"selected"},{default:a(()=>[(d(!0),v(F,null,R(I.getVisibleCells(),A=>(d(),b(t(be),{key:A.id},{default:a(()=>[e(t(ye),{render:A.column.columnDef.cell,props:A.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(d(),b(t(de),{key:1},{default:a(()=>[e(t(be),{colspan:h.columns.length,class:"h-24 text-center"},{default:a(()=>[m(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),e(kt,{table:t(w)},null,8,["table"])]))}}),G=j({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(r){return(o,s)=>{const l=B("VIcon");return o.column.getCanSort()?(d(),v("div",{key:0,class:N(t(se)("flex items-center space-x-2",o.$attrs.class??""))},[e(t(Ce),null,{default:a(()=>[e(t(ke),{"as-child":""},{default:a(()=>[e(t(S),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:a(()=>[i("span",null,x(o.title),1),o.column.getIsSorted()==="desc"?(d(),b(l,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):o.column.getIsSorted()==="asc"?(d(),b(l,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(d(),b(l,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),e(t(Se),{align:"start"},{default:a(()=>[e(t(ue),{onClick:s[0]||(s[0]=c=>o.column.toggleSorting(!1))},{default:a(()=>[e(l,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Asc ")]),_:1}),e(t(ue),{onClick:s[1]||(s[1]=c=>o.column.toggleSorting(!0))},{default:a(()=>[e(l,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Desc ")]),_:1}),e(t($e)),e(t(ue),{onClick:s[2]||(s[2]=c=>o.column.toggleVisibility(!1))},{default:a(()=>[e(l,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),m(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(d(),v("div",{key:1,class:N(o.$attrs.class)},x(o.title),3))}}}),la=U.object({id:U.number(),invoice:U.string(),customer_name:U.string().min(2).max(50),invoice_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),due_date:U.preprocess(r=>typeof r=="string"?new Date(r):r,U.date()),term:U.number(),amount:U.string(),document_url:U.string(),status:U.number(),editable:U.boolean()}),sa={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},na={class:"col-span-3"},oa=i("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[m(" Accepted Type: "),i("b",null,"PDF"),m(" (MAX. 5MB) ")],-1),ia={key:1},ra={class:"flex justify-center my-auto items-center place-items-center mb-2"},ca={class:"mx-2"},da={class:"flex justify-center my-auto items-center place-items-center"},ua=["src"],fa={key:0,class:"grid grid-cols-4 items-center gap-4"},ma=j({__name:"DataTableCheckAttachment",props:{row:{}},setup(r){const o=oe("tableStore",ne("debt")),s=r,l=E({document:null,document_url:s.row.document_url}),c=E({pdf:void 0,pages:void 0,info:void 0}),p=k(1),y=k(!1),M=k(!1),$=k(null),w=k(window.innerHeight-250),{toast:h}=re();function V(_){h({title:"PDF loading error",variant:"destructive"})}async function C(){try{y.value=!0;const _=await H.get(`/api/debt/${s.row.id}/document/`);l.document_url=_.data.Result.document_url;const n=ft(l.document_url,{onError:V});Pe(()=>{c.pdf=n.pdf,c.pages=n.pages,c.info=n.info})}catch{Y(),h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}const I=()=>{const _=document.querySelector("#vp > div > div > div > canvas");if(_){const n=_.offsetHeight,f=window.innerHeight-250,u=680;f>n&&n<u?w.value=n:f>n?w.value=f:w.value=Math.min(Math.max(n,u),f)}};function A(){const _=[{condition:l.document==null,message:"Attachment cannot be blank"}];for(let n of _)if(n.condition)return $.value=n.message,!1;return!0}async function W(){if(A()){y.value=!0;try{const n=await H.patch(`/api/debt/${s.row.id}/document/`,{...l},{headers:{"Content-Type":"multipart/form-data"}});K(),await o.refresh(o.page_index),h({title:n.data.Result,variant:"success"})}catch{h({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{y.value=!1}}}function Y(){l.document_url=null}function K(){M.value=!M.value,M.value&&C()}function z(_){var f;const n=_.target;if((f=n.files)!=null&&f.length){const u=n.files[0];if(u.type!=="application/pdf"){h({title:"Please select a PDF file",variant:"destructive"}),n.value="";return}if(u.size>5*1024*1024){h({title:"The file size must be under 5MB",variant:"destructive"}),n.value="";return}l.document=u}}return(_,n)=>{const f=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(S),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:K},{default:a(()=>[e(f,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),e(t(ve),{class:"my-2",open:M.value,"onUpdate:open":n[2]||(n[2]=u=>M.value=u)},{default:a(()=>[e(t(pe),{isSideBar:!1,class:"sm:max-w-fit"},{default:a(()=>[e(t(_e),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Attachment Overview")]),_:1})]),_:1}),i("div",null,[l.document_url?l.document_url.endsWith(".pdf")?(d(),v("div",ia,[i("div",ra,[e(t(S),{variant:"secondary",onClick:n[0]||(n[0]=u=>p.value=p.value>1?p.value-1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),i("span",ca,x(p.value)+" / "+x(c.pages),1),e(t(S),{variant:"secondary",onClick:n[1]||(n[1]=u=>p.value=p.value<c.pages?p.value+1:p.value)},{default:a(()=>[e(f,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),e(t(Me),{class:"border border-primary",style:Ie([{width:"720px","overflow-y":"auto","overflow-x":"hidden"},{height:w.value+"px"}])},{default:a(()=>[e(t(ut),{pdf:c.pdf,page:p.value,"fit-parent":"",onLoaded:I,"annonation-layer":""},{default:a(()=>[i("div",da,[e(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(d(),v("img",{key:2,src:l.document_url,alt:"Document preview",class:"object-contain"},null,8,ua)):(d(),v("div",sa,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Attachment ")]),_:1}),i("div",na,[e(t(L),{id:"name",type:"file",onChange:z,class:"col-span-3"})]),oa]))]),e(t(X)),$.value?(d(),v("div",fa,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(f,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x($.value),1)]),_:1})])):T("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[l.document_url?(d(),b(t(S),{key:0,class:"bg-red-600 text-white",onClick:Y,disabled:y.value},{default:a(()=>[m(" Replace")]),_:1},8,["disabled"])):(d(),b(t(S),{key:1,onClick:W,disabled:y.value},{default:a(()=>[y.value?(d(),b(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),pa={class:"grid gap-4 py-4"},_a={class:"grid grid-cols-4 items-center gap-4"},ga=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),va={class:"grid grid-cols-4 items-center gap-4"},ha=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ba={class:"col-span-3"},ya={class:"grid grid-cols-4 items-center gap-4"},wa=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),xa={class:"grid grid-cols-4 items-center gap-4"},$a=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ka={class:"col-span-3"},Sa={class:"grid grid-cols-4 items-center gap-4"},Ca=i("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Va={class:"grid grid-cols-4 items-center gap-4"},Da={class:"col-span-3"},Ma={key:0,class:"grid grid-cols-4 items-center gap-4"},Ia=j({__name:"DataTableEditModal",props:{row:{}},setup(r){const o=oe("tableStore",ne("debt")),s=r,l=E({invoice:s.row.id,customer:null,amount:s.row.amount,invoice_date:new Date(s.row.invoice_date),term:s.row.term,status:s.row.status}),c=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),p=E({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),y=k("");async function M(n){c.is_loading=!0;try{const f=await H.get(`/api/customer/list?search=${n||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});c.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{c.is_loading=!1}}async function $(){c.is_loading=!0;try{const n=await H.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});p.data=n.data.Result}catch(n){console.error("There was an error fetching the select list:",n)}finally{p.is_loading=!1}}const w=k(!1),h=k(!1),V=k(null),{toast:C}=re();Ve(y,Fe.debounce(async n=>{h.value&&await M(n)},500));async function I(){try{const n=await H.get(`/api/debt/${s.row.id}/`);Object.assign(l,n.data.Result)}catch(n){console.log(n)}finally{w.value=!1}}function A(){var f;const n=[{condition:l.invoice==null,message:"Invoice cannot be blank"},{condition:((f=l.invoice_date)==null?void 0:f.toString)==null,message:"Invoice Date cannot be blank"},{condition:l.status==null,message:"Status cannot be blank"},{condition:l.customer==null,message:"Customer cannot be blank"}];for(let u of n)if(u.condition)return V.value=u.message,!1;return!0}async function W(){if(A()){w.value=!0;try{const f=await H.patch(`/api/debt/${s.row.id}/`,{...l},{headers:{"Content-Type":"multipart/form-data"}});Y(),await o.refresh(o.page_index),C({title:f.data.Result,variant:"success"})}catch{C({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{w.value=!1}}}function Y(){h.value=!h.value,h.value&&(I(),M(y.value),$())}function K(n){l.customer=n.id,c.is_open=!1}function z(n){l.status=n.id,p.is_open=!1}function _(n){const f=new Date(n);l.invoice_date=Te(f,"yyyy-MM-dd")}return(n,f)=>{const u=B("VIcon");return d(),v("div",null,[i("div",null,[e(t(S),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:Y},{default:a(()=>[e(u,{name:"fa-pen",class:"size-4"})]),_:1})]),e(t(ve),{open:h.value,"onUpdate:open":f[7]||(f[7]=g=>h.value=g)},{default:a(()=>[e(t(pe),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:a(()=>[e(t(_e),null,{default:a(()=>[e(t(ge),null,{default:a(()=>[m("Edit Debt")]),_:1}),e(t(De),null,{default:a(()=>[m(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),i("div",pa,[i("div",_a,[e(t(P),{for:"invoice",class:"text-right"},{default:a(()=>[m(" Invoice "),ga]),_:1}),e(t(L),{id:"invoice",modelValue:l.invoice,"onUpdate:modelValue":f[0]||(f[0]=g=>l.invoice=g),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),i("div",va,[e(t(P),{for:"customer",class:"text-right leading-normal"},{default:a(()=>[m(" Customer "),ha]),_:1}),i("div",ba,[e(t(O),{open:c.is_open,"onUpdate:open":f[2]||(f[2]=g=>c.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",role:"combobox","aria-expanded":c.is_open,class:"w-full justify-between px-3",disabled:c.is_loading},{default:a(()=>{var g;return[m(x(l.customer?(g=c.data.find(ce=>ce.id===l.customer))==null?void 0:g.label:"Select customer")+" ",1),c.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(fe),{class:"h-9",modelValue:y.value,"onUpdate:modelValue":f[1]||(f[1]=g=>y.value=g),placeholder:"Search country..."},null,8,["modelValue"]),e(t(me),null,{default:a(()=>[m("No customer found.")]),_:1}),e(t(le),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(c.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>K(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:N(["ml-auto h-4 w-4",l.customer===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),i("div",ya,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Amount "),wa]),_:1}),e(t(L),{id:"amount",modelValue:l.amount===null?"":l.amount,"onUpdate:modelValue":f[3]||(f[3]=g=>l.amount=g===""?null:g),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),i("div",xa,[e(t(P),{for:"email",class:"text-right"},{default:a(()=>[m(" Invoice Date "),$a]),_:1}),i("div",ka,[e(t(O),null,{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",class:N(t(se)("w-full justify-start text-left font-normal",!l.invoice_date&&"text-muted-foreground"))},{default:a(()=>[e(u,{name:"bi-calendar-fill",class:"mr-2 size-4"}),i("span",null,x(l.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),e(t(Q),{class:"w-auto p-0"},{default:a(()=>[e(t(ze),{"onUpdate:modelValue":f[4]||(f[4]=g=>_(g)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),i("div",Sa,[e(t(P),{for:"amount",class:"text-right"},{default:a(()=>[m(" Payment Term "),Ca]),_:1}),e(t(L),{id:"amount",modelValue:l.term,"onUpdate:modelValue":f[5]||(f[5]=g=>l.term=g),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),i("div",Va,[e(t(P),{for:"mobile",class:"text-right"},{default:a(()=>[m(" Status ")]),_:1}),i("div",Da,[e(t(O),{open:p.is_open,"onUpdate:open":f[6]||(f[6]=g=>p.is_open=g)},{default:a(()=>[e(t(q),{"as-child":""},{default:a(()=>[e(t(S),{variant:"outline",role:"combobox","aria-expanded":p.is_open,class:"w-full justify-between px-3",disabled:p.is_loading},{default:a(()=>{var g;return[m(x(l.status?(g=p.data.find(ce=>ce.id===l.status))==null?void 0:g.label:"Select status")+" ",1),p.is_loading?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(d(),b(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(t(Q),{class:"w-[500px] p-1"},{default:a(()=>[e(t(ae),null,{default:a(()=>[e(t(le),null,{default:a(()=>[e(t(J),null,{default:a(()=>[(d(!0),v(F,null,R(p.data,g=>(d(),b(t(Z),{key:g.id,value:g.value??"",onSelect:()=>z(g)},{default:a(()=>[m(x(g.label)+" ",1),e(u,{name:"fa-check",class:N(["ml-auto h-4 w-4",l.status===g.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),e(X),V.value?(d(),v("div",Ma,[e(t(P),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:a(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),m(" "+x(V.value),1)]),_:1})])):T("",!0),e(t(he),{class:"flex justify-end"},{default:a(()=>[e(t(S),{type:"submit",onClick:W,disabled:w.value},{default:a(()=>[w.value?(d(),b(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):T("",!0),m(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Pa={class:"pr-4"},za={class:"flex justify-between"},Fa={key:0,class:"text-primary font-bold flex place-items-center self-center"},Ta={key:1,class:"text-primary font-bold"},Ua={class:"text-primary"},Ra={class:"text-sm"},Aa={class:"flex mt-2 gap-2"},ja={class:"text-xs mt-2"},Ha=j({__name:"DataTableBacklog",props:{row:{}},setup(r){const o=et(),s=r,l=E({debt:s.row.id,message:""}),c=E([]),p=k(!1),y=k(!1),M=k(null),{toast:$}=re();var w=k(null),h=k(null),V=k(0),C=oe("height");async function I(){try{const z=await H.get(`/api/debt/${s.row.id}/backlog/`);c.splice(0,c.length,...z.data.Result),p.value=!1}catch{p.value=!1}}function A(){const z=[{condition:l.message=="",message:"Message cannot be blank"},{condition:l.message.length<5,message:"Maybe a little more context?"}];for(let _ of z)if(_.condition)return M.value=_.message,!1;return!0}async function W(){if(A()){p.value=!0;try{const _=await H.post(`/api/debt/${s.row.id}/backlog/`,{...l},{headers:{"Content-Type":"application/json"}});await I(),$({title:_.data.Result,variant:"success"}),l.message="",M.value=""}catch{$({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{p.value=!1}}}const Y=()=>{Pe().then(()=>{var z,_;C&&(V.value=C.value-((((z=w.value)==null?void 0:z.clientHeight)||0)+(((_=h.value)==null?void 0:_.clientHeight)||0))-25)})};function K(){y.value=!y.value,y.value&&(I(),Y())}return(z,_)=>{const n=B("VIcon"),f=B("Label");return d(),v("div",null,[i("div",null,[e(t(S),{variant:"secondary",size:"sm",class:"hidden h-8 lg:flex border border-primary",onClick:K},{default:a(()=>[e(n,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),e(t(rt),{open:y.value,"onUpdate:open":_[1]||(_[1]=u=>y.value=u)},{default:a(()=>[e(t(nt),{class:"h-screen",side:"right"},{default:a(()=>[i("div",{ref_key:"headerElement",ref:w},[e(t(ot),null,{default:a(()=>[e(t(it),null,{default:a(()=>[m("Backlog - "+x(s.row.invoice),1)]),_:1})]),_:1})],512),e(t(X),{class:"mt-2 mb-4 border-primary border"}),e(t(Me),{class:"flex flex-col",style:Ie({height:t(V)+"px"})},{default:a(()=>[i("div",Pa,[(d(!0),v(F,null,R(c,(u,g)=>(d(),v("div",{key:g,class:"pr-4 my-2"},[i("div",za,[u.is_system_generated?(d(),v("div",Fa,[e(n,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),m(" System Generated ")])):(d(),v("div",Ta,x(u.created_by_name),1))]),i("div",null,[i("div",Ua,x(u.created_date),1),e(t(X),{variant:"default"}),i("div",null,x(u.message),1)])]))),128))])]),_:1},8,["style"]),i("div",{class:"flex flex-col",ref_key:"footerElement",ref:h},[M.value?(d(),b(f,{key:0,for:"error",class:"text-red-600 flex"},{default:a(()=>[e(n,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),i("p",Ra,x(M.value),1)]),_:1})):T("",!0),i("div",Aa,[e(t(L),{id:"message",modelValue:l.message,"onUpdate:modelValue":_[0]||(_[0]=u=>l.message=u),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),e(t(S),{type:"submit",onClick:W},{default:a(()=>[m(" Save ")]),_:1})]),i("p",ja,x(t(o).getUsername),1)],512)]),_:1})]),_:1},8,["open"])])}}}),La={class:"flex gap-1"},Na=j({__name:"DataTableRowActions",props:{row:{}},setup(r){const o=r,s=te(()=>la.parse(o.row.original));return(l,c)=>(d(),v("div",La,[s.value.editable?(d(),b(Ia,{key:0,row:s.value},null,8,["row"])):T("",!0),e(ma,{row:s.value},null,8,["row"]),e(Ha,{row:s.value},null,8,["row"])]))}}),Ea=[{id:"select",header:({table:r})=>D(we,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":o=>r.toggleAllPageRowsSelected(!!o),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:r})=>D(we,{checked:r.getIsSelected(),"onUpdate:checked":o=>r.toggleSelected(!!o),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:r})=>D(G,{column:r,title:"Invoice"}),cell:({row:r})=>D("div",{class:`w-20 font-bold ${r.original.editable?"":"line-through decoration-red-600"}`},r.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(r,o,s)=>{var p;const l=((p=r.getValue(o))==null?void 0:p.toString().toLowerCase())??"",c=s==null?void 0:s.toString().toLowerCase();return l.includes(c)},meta:{title:"Invoice"}},{accessorKey:"customer_name",header:({column:r})=>D(G,{column:r,title:"Customer"}),cell:({row:r})=>D("div",{class:"w-fit"},r.getValue("customer_name")),enableSorting:!0,enableHiding:!0,enableColumnFilter:!0,filterFn:(r,o,s)=>{var p;const l=((p=r.getValue(o))==null?void 0:p.toString().toLowerCase())??"",c=s==null?void 0:s.toString().toLowerCase();return l.includes(c)},meta:{title:"Customer"}},{accessorKey:"invoice_date",header:({column:r})=>D(G,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const o=r.getValue("invoice_date");let s="";if(o){const l=new Date(Date.parse(o));isNaN(l.getTime())?s="Not Provided":s=l.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else s="Not provided";return D("div",{class:`w-fit ${s!="Not Provided"?"":"text-red-600 font-bold"}`},s)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:r})=>D(G,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>{const o=r.getValue("due_date");let s="";if(o){const l=new Date(o);isNaN(l.getTime())?s="Not Provided":s=l.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else s="Not provided";return D("div",{class:`w-fit ${s!=="Not Provided"?"":"text-red-600 font-bold"}`},s)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"term",header:({column:r})=>D(G,{column:r,title:"Term"}),cell:({row:r})=>D("div",{class:"w-fit"},r.getValue("term")),enableHiding:!0,meta:{title:"Term"}},{accessorKey:"amount",header:({column:r})=>D(G,{column:r,title:r.columnDef.meta.title}),cell:({row:r})=>D(ee,{variant:"destructive"},"RM "+r.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:r})=>D(G,{column:r,title:"Attachment"}),cell:({row:r})=>{const o=r.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return D(xe,{name:o.icon,class:`${o.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:r})=>D(G,{column:r,title:"Status"}),cell:({row:r})=>{const o=Ue.find(s=>s.value===r.original.status.toString());return o?D(ee,{variant:"secondary",class:"flex w-fit items-center"},[o.icon&&D(xe,{name:o.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),D("span",{},o.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(r,o,s)=>{const l=r.getValue(o);if(!l)return!1;const c=l.toString().toLowerCase();return s.some(y=>c.includes(y.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:r})=>D(Na,{row:r})}],Ba={class:"p-8 space-y-8 h-full"},Ya=i("div",{class:"flex items-center justify-between space-y-2"},[i("div",null,[i("h2",{class:"text-2xl font-bold tracking-tight"},"Debt"),i("p",{class:"text-muted-foreground"},"Here's a list of your existing debts!")])],-1),Ka={key:0,class:"text-center"},Ga={key:1},Wa="/api/debt",nl=j({__name:"Debt",setup(r){const o=ne("debt"),s=l=>({id:l.id,status:l.status,invoice:l.invoice,customer_name:l.customer_name,invoice_date:new Date(l.invoice_date),due_date:new Date(l.due_date),term:l.term,amount:l.amount,document_url:l.document_url,editable:l.editable});return tt(async()=>{await o.fetch(Wa,0,s)}),lt("tableStore",o),at(()=>{o.$reset()}),(l,c)=>{const p=B("VIcon");return d(),v("div",Ba,[Ya,t(o).is_loading?(d(),v("div",Ka,[e(p,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-10 h-10"})])):(d(),v("div",Ga,[e(aa,{data:t(o).tasks,columns:t(Ea)},null,8,["data","columns"])]))])}}});export{nl as default};
