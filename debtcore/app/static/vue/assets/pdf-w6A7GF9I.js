var ts=Object.defineProperty;var es=(mt,d,ot)=>d in mt?ts(mt,d,{enumerable:!0,configurable:!0,writable:!0,value:ot}):mt[d]=ot;var ie=(mt,d,ot)=>(es(mt,typeof d!="symbol"?d+"":d,ot),ot),Be=(mt,d,ot)=>{if(!d.has(mt))throw TypeError("Cannot "+ot)};var t=(mt,d,ot)=>(Be(mt,d,"read from private field"),ot?ot.call(mt):d.get(mt)),I=(mt,d,ot)=>{if(d.has(mt))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(mt):d.set(mt,ot)},tt=(mt,d,ot,h)=>(Be(mt,d,"write to private field"),h?h.call(mt,ot):d.set(mt,ot),ot);var me=(mt,d,ot,h)=>({set _(P){tt(mt,d,P,ot)},get _(){return t(mt,d,h)}}),W=(mt,d,ot)=>(Be(mt,d,"access private method"),ot);import{u as useVModel}from"./Input.vue_vue_type_script_setup_true_lang-BaBacWsD.js";import{z as createLucideIcon,e as defineComponent,i as ref,A as computed,v as onMounted,ag as nextTick,aL as useSlots,o as openBlock,c as createElementBlock,d as createBaseVNode,a as createVNode,u as unref,n as normalizeClass,g as cn,aM as buttonVariants,m as createCommentVNode,aN as createSlots,D as renderList,k as withCtx,B as mergeProps,aA as isRef,aO as DatePicker,f as renderSlot,S as normalizeProps,T as guardReactiveProps}from"../main.js";import{z}from"./Checkbox.vue_vue_type_script_setup_true_lang-Di5NrHb0.js";import{g as getAugmentedNamespace}from"./lodash-BtnTHUG3.js";/**
 * @license lucide-vue-next v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.359.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),_hoisted_1={class:"relative"},_hoisted_2={key:0,class:"absolute flex justify-between w-full px-4 top-3 z-[1]"},_sfc_main=defineComponent({inheritAttrs:!1,__name:"Calendar",props:{modelValue:{},modelModifiers:{},columns:{default:1},type:{default:"single"}},emits:["update:modelValue"],setup(mt,{emit:d}){const P=useVModel(mt,"modelValue",d,{passive:!0}),rt=ref(),X=computed(()=>rt.value.calendarRef);function pt(f){X.value&&(f==="prev"?X.value.movePrev():X.value.moveNext())}onMounted(async()=>{await nextTick(),P.value instanceof Date&&X.value&&X.value.focusDate(P.value)});const B=useSlots(),F=computed(()=>Object.keys(B).filter(f=>isVCalendarSlot(f)).reduce((f,L)=>(f[L]=B[L],f),{}));return(f,L)=>(openBlock(),createElementBlock("div",_hoisted_1,[f.$attrs.mode!=="time"?(openBlock(),createElementBlock("div",_hoisted_2,[createBaseVNode("button",{class:normalizeClass(unref(cn)(unref(buttonVariants)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100")),onClick:L[0]||(L[0]=O=>pt("prev"))},[createVNode(unref(ChevronLeft),{class:"w-4 h-4"})],2),createBaseVNode("button",{class:normalizeClass(unref(cn)(unref(buttonVariants)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100")),onClick:L[1]||(L[1]=O=>pt("next"))},[createVNode(unref(ChevronRight),{class:"w-4 h-4"})],2)])):createCommentVNode("",!0),createVNode(unref(DatePicker),mergeProps({ref_key:"datePicker",ref:rt},f.$attrs,{modelValue:unref(P),"onUpdate:modelValue":L[2]||(L[2]=O=>isRef(P)?P.value=O:null),"model-modifiers":f.modelModifiers,class:"calendar","trim-weeks":"",transition:"none",columns:f.columns}),createSlots({"nav-prev-button":withCtx(()=>[createVNode(unref(ChevronLeft))]),"nav-next-button":withCtx(()=>[createVNode(unref(ChevronRight))]),_:2},[renderList(F.value,(O,x)=>({name:x,fn:withCtx(v=>[renderSlot(f.$slots,x,normalizeProps(guardReactiveProps(v)))])}))]),1040,["modelValue","model-modifiers","columns"])]))}});function isVCalendarSlot(mt){return["day-content","day-popover","dp-footer","footer","header-title-wrapper","header-title","header-prev-button","header-next-button","nav","nav-prev-button","nav-next-button","page","time-header"].includes(mt)}const taskSchema=z.object({id:z.number(),invoice:z.string(),customer_name:z.string().min(2).max(50),due_date:z.preprocess(mt=>typeof mt=="string"?new Date(mt):mt,z.date()),amount:z.string(),document_url:z.string().url(),status:z.number()});function commonjsRequire(mt){throw new Error('Could not dynamically require "'+mt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(d,ot){module.exports=d.pdfjsLib=ot()})(globalThis,()=>(()=>{var __webpack_modules__=[,(mt,d)=>{var Yt;Object.defineProperty(d,"__esModule",{value:!0}),d.VerbosityLevel=d.Util=d.UnknownErrorException=d.UnexpectedResponseException=d.TextRenderingMode=d.RenderingIntentFlag=d.PromiseCapability=d.PermissionFlag=d.PasswordResponses=d.PasswordException=d.PageActionEventType=d.OPS=d.MissingPDFException=d.MAX_IMAGE_SIZE_TO_CACHE=d.LINE_FACTOR=d.LINE_DESCENT_FACTOR=d.InvalidPDFException=d.ImageKind=d.IDENTITY_MATRIX=d.FormatError=d.FeatureTest=d.FONT_IDENTITY_MATRIX=d.DocumentActionEventType=d.CMapCompressionType=d.BaseException=d.BASELINE_FACTOR=d.AnnotationType=d.AnnotationReplyType=d.AnnotationPrefix=d.AnnotationMode=d.AnnotationFlag=d.AnnotationFieldFlag=d.AnnotationEditorType=d.AnnotationEditorPrefix=d.AnnotationEditorParamsType=d.AnnotationBorderStyleType=d.AnnotationActionEventType=d.AbortException=void 0,d.assert=ct,d.bytesToString=N,d.createValidAbsoluteUrl=Ct,d.getModificationDate=Tt,d.getUuid=$t,d.getVerbosityLevel=$,d.info=st,d.isArrayBuffer=dt,d.isArrayEqual=wt,d.isNodeJS=void 0,d.normalizeUnicode=Xt,d.objectFromMap=ht,d.objectSize=nt,d.setVerbosityLevel=E,d.shadow=kt,d.string32=Z,d.stringToBytes=et,d.stringToPDFString=ft,d.stringToUTF8String=J,d.unreachable=H,d.utf8StringToString=Q,d.warn=at;const ot=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");d.isNodeJS=ot;const h=[1,0,0,1,0,0];d.IDENTITY_MATRIX=h;const P=[.001,0,0,.001,0,0];d.FONT_IDENTITY_MATRIX=P;const rt=1e7;d.MAX_IMAGE_SIZE_TO_CACHE=rt;const X=1.35;d.LINE_FACTOR=X;const pt=.35;d.LINE_DESCENT_FACTOR=pt;const B=pt/X;d.BASELINE_FACTOR=B;const F={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};d.RenderingIntentFlag=F;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};d.AnnotationMode=f;const L="pdfjs_internal_editor_";d.AnnotationEditorPrefix=L;const O={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};d.AnnotationEditorType=O;const x={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};d.AnnotationEditorParamsType=x;const v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};d.PermissionFlag=v;const y={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};d.TextRenderingMode=y;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};d.ImageKind=u;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};d.AnnotationType=_;const w={GROUP:"Group",REPLY:"R"};d.AnnotationReplyType=w;const C={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};d.AnnotationFlag=C;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};d.AnnotationFieldFlag=A;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};d.AnnotationBorderStyleType=a;const l={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};d.AnnotationActionEventType=l;const k={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};d.DocumentActionEventType=k;const g={O:"PageOpen",C:"PageClose"};d.PageActionEventType=g;const r={ERRORS:0,WARNINGS:1,INFOS:5};d.VerbosityLevel=r;const T={NONE:0,BINARY:1};d.CMapCompressionType=T;const m={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};d.OPS=m;const U={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};d.PasswordResponses=U;let V=r.WARNINGS;function E(lt){Number.isInteger(lt)&&(V=lt)}function $(){return V}function st(lt){V>=r.INFOS&&console.log(`Info: ${lt}`)}function at(lt){V>=r.WARNINGS&&console.log(`Warning: ${lt}`)}function H(lt){throw new Error(lt)}function ct(lt,K){lt||H(K)}function gt(lt){switch(lt==null?void 0:lt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ct(lt,K=null,G=null){if(!lt)return null;try{if(G&&typeof lt=="string"){if(G.addDefaultProtocol&&lt.startsWith("www.")){const yt=lt.match(/\./g);(yt==null?void 0:yt.length)>=2&&(lt=`http://${lt}`)}if(G.tryConvertEncoding)try{lt=J(lt)}catch{}}const _t=K?new URL(lt,K):new URL(lt);if(gt(_t))return _t}catch{}return null}function kt(lt,K,G,_t=!1){return Object.defineProperty(lt,K,{value:G,enumerable:!_t,configurable:!0,writable:!1}),G}const S=function(){function K(G,_t){this.constructor===K&&H("Cannot initialize BaseException."),this.message=G,this.name=_t}return K.prototype=new Error,K.constructor=K,K}();d.BaseException=S;class i extends S{constructor(K,G){super(K,"PasswordException"),this.code=G}}d.PasswordException=i;class n extends S{constructor(K,G){super(K,"UnknownErrorException"),this.details=G}}d.UnknownErrorException=n;class s extends S{constructor(K){super(K,"InvalidPDFException")}}d.InvalidPDFException=s;class o extends S{constructor(K){super(K,"MissingPDFException")}}d.MissingPDFException=o;class c extends S{constructor(K,G){super(K,"UnexpectedResponseException"),this.status=G}}d.UnexpectedResponseException=c;class b extends S{constructor(K){super(K,"FormatError")}}d.FormatError=b;class M extends S{constructor(K){super(K,"AbortException")}}d.AbortException=M;function N(lt){(typeof lt!="object"||(lt==null?void 0:lt.length)===void 0)&&H("Invalid argument for bytesToString");const K=lt.length,G=8192;if(K<G)return String.fromCharCode.apply(null,lt);const _t=[];for(let yt=0;yt<K;yt+=G){const ee=Math.min(yt+G,K),te=lt.subarray(yt,ee);_t.push(String.fromCharCode.apply(null,te))}return _t.join("")}function et(lt){typeof lt!="string"&&H("Invalid argument for stringToBytes");const K=lt.length,G=new Uint8Array(K);for(let _t=0;_t<K;++_t)G[_t]=lt.charCodeAt(_t)&255;return G}function Z(lt){return String.fromCharCode(lt>>24&255,lt>>16&255,lt>>8&255,lt&255)}function nt(lt){return Object.keys(lt).length}function ht(lt){const K=Object.create(null);for(const[G,_t]of lt)K[G]=_t;return K}function vt(){const lt=new Uint8Array(4);return lt[0]=1,new Uint32Array(lt.buffer,0,1)[0]===1}function ut(){try{return new Function(""),!0}catch{return!1}}class Mt{static get isLittleEndian(){return kt(this,"isLittleEndian",vt())}static get isEvalSupported(){return kt(this,"isEvalSupported",ut())}static get isOffscreenCanvasSupported(){return kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?kt(this,"platform",{isWin:!1,isMac:!1}):kt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var K,G;return kt(this,"isCSSRoundSupported",(G=(K=globalThis.CSS)==null?void 0:K.supports)==null?void 0:G.call(K,"width: round(1.5px, 1px)"))}}d.FeatureTest=Mt;const Ut=[...Array(256).keys()].map(lt=>lt.toString(16).padStart(2,"0"));class Et{static makeHexColor(K,G,_t){return`#${Ut[K]}${Ut[G]}${Ut[_t]}`}static scaleMinMax(K,G){let _t;K[0]?(K[0]<0&&(_t=G[0],G[0]=G[1],G[1]=_t),G[0]*=K[0],G[1]*=K[0],K[3]<0&&(_t=G[2],G[2]=G[3],G[3]=_t),G[2]*=K[3],G[3]*=K[3]):(_t=G[0],G[0]=G[2],G[2]=_t,_t=G[1],G[1]=G[3],G[3]=_t,K[1]<0&&(_t=G[2],G[2]=G[3],G[3]=_t),G[2]*=K[1],G[3]*=K[1],K[2]<0&&(_t=G[0],G[0]=G[1],G[1]=_t),G[0]*=K[2],G[1]*=K[2]),G[0]+=K[4],G[1]+=K[4],G[2]+=K[5],G[3]+=K[5]}static transform(K,G){return[K[0]*G[0]+K[2]*G[1],K[1]*G[0]+K[3]*G[1],K[0]*G[2]+K[2]*G[3],K[1]*G[2]+K[3]*G[3],K[0]*G[4]+K[2]*G[5]+K[4],K[1]*G[4]+K[3]*G[5]+K[5]]}static applyTransform(K,G){const _t=K[0]*G[0]+K[1]*G[2]+G[4],yt=K[0]*G[1]+K[1]*G[3]+G[5];return[_t,yt]}static applyInverseTransform(K,G){const _t=G[0]*G[3]-G[1]*G[2],yt=(K[0]*G[3]-K[1]*G[2]+G[2]*G[5]-G[4]*G[3])/_t,ee=(-K[0]*G[1]+K[1]*G[0]+G[4]*G[1]-G[5]*G[0])/_t;return[yt,ee]}static getAxialAlignedBoundingBox(K,G){const _t=this.applyTransform(K,G),yt=this.applyTransform(K.slice(2,4),G),ee=this.applyTransform([K[0],K[3]],G),te=this.applyTransform([K[2],K[1]],G);return[Math.min(_t[0],yt[0],ee[0],te[0]),Math.min(_t[1],yt[1],ee[1],te[1]),Math.max(_t[0],yt[0],ee[0],te[0]),Math.max(_t[1],yt[1],ee[1],te[1])]}static inverseTransform(K){const G=K[0]*K[3]-K[1]*K[2];return[K[3]/G,-K[1]/G,-K[2]/G,K[0]/G,(K[2]*K[5]-K[4]*K[3])/G,(K[4]*K[1]-K[5]*K[0])/G]}static singularValueDecompose2dScale(K){const G=[K[0],K[2],K[1],K[3]],_t=K[0]*G[0]+K[1]*G[2],yt=K[0]*G[1]+K[1]*G[3],ee=K[2]*G[0]+K[3]*G[2],te=K[2]*G[1]+K[3]*G[3],Y=(_t+te)/2,St=Math.sqrt((_t+te)**2-4*(_t*te-ee*yt))/2,Ot=Y+St||1,xt=Y-St||1;return[Math.sqrt(Ot),Math.sqrt(xt)]}static normalizeRect(K){const G=K.slice(0);return K[0]>K[2]&&(G[0]=K[2],G[2]=K[0]),K[1]>K[3]&&(G[1]=K[3],G[3]=K[1]),G}static intersect(K,G){const _t=Math.max(Math.min(K[0],K[2]),Math.min(G[0],G[2])),yt=Math.min(Math.max(K[0],K[2]),Math.max(G[0],G[2]));if(_t>yt)return null;const ee=Math.max(Math.min(K[1],K[3]),Math.min(G[1],G[3])),te=Math.min(Math.max(K[1],K[3]),Math.max(G[1],G[3]));return ee>te?null:[_t,ee,yt,te]}static bezierBoundingBox(K,G,_t,yt,ee,te,Y,St){const Ot=[],xt=[[],[]];let Nt,Bt,Qt,At,Kt,Lt,R,e;for(let q=0;q<2;++q){if(q===0?(Bt=6*K-12*_t+6*ee,Nt=-3*K+9*_t-9*ee+3*Y,Qt=3*_t-3*K):(Bt=6*G-12*yt+6*te,Nt=-3*G+9*yt-9*te+3*St,Qt=3*yt-3*G),Math.abs(Nt)<1e-12){if(Math.abs(Bt)<1e-12)continue;At=-Qt/Bt,0<At&&At<1&&Ot.push(At);continue}R=Bt*Bt-4*Qt*Nt,e=Math.sqrt(R),!(R<0)&&(Kt=(-Bt+e)/(2*Nt),0<Kt&&Kt<1&&Ot.push(Kt),Lt=(-Bt-e)/(2*Nt),0<Lt&&Lt<1&&Ot.push(Lt))}let p=Ot.length,D;const j=p;for(;p--;)At=Ot[p],D=1-At,xt[0][p]=D*D*D*K+3*D*D*At*_t+3*D*At*At*ee+At*At*At*Y,xt[1][p]=D*D*D*G+3*D*D*At*yt+3*D*At*At*te+At*At*At*St;return xt[0][j]=K,xt[1][j]=G,xt[0][j+1]=Y,xt[1][j+1]=St,xt[0].length=xt[1].length=j+2,[Math.min(...xt[0]),Math.min(...xt[1]),Math.max(...xt[0]),Math.max(...xt[1])]}}d.Util=Et;const It=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ft(lt){if(lt[0]>="ï"){let G;if(lt[0]==="þ"&&lt[1]==="ÿ"?G="utf-16be":lt[0]==="ÿ"&&lt[1]==="þ"?G="utf-16le":lt[0]==="ï"&&lt[1]==="»"&&lt[2]==="¿"&&(G="utf-8"),G)try{const _t=new TextDecoder(G,{fatal:!0}),yt=et(lt);return _t.decode(yt)}catch(_t){at(`stringToPDFString: "${_t}".`)}}const K=[];for(let G=0,_t=lt.length;G<_t;G++){const yt=It[lt.charCodeAt(G)];K.push(yt?String.fromCharCode(yt):lt.charAt(G))}return K.join("")}function J(lt){return decodeURIComponent(escape(lt))}function Q(lt){return unescape(encodeURIComponent(lt))}function dt(lt){return typeof lt=="object"&&(lt==null?void 0:lt.byteLength)!==void 0}function wt(lt,K){if(lt.length!==K.length)return!1;for(let G=0,_t=lt.length;G<_t;G++)if(lt[G]!==K[G])return!1;return!0}function Tt(lt=new Date){return[lt.getUTCFullYear().toString(),(lt.getUTCMonth()+1).toString().padStart(2,"0"),lt.getUTCDate().toString().padStart(2,"0"),lt.getUTCHours().toString().padStart(2,"0"),lt.getUTCMinutes().toString().padStart(2,"0"),lt.getUTCSeconds().toString().padStart(2,"0")].join("")}class jt{constructor(){I(this,Yt,!1);this.promise=new Promise((K,G)=>{this.resolve=_t=>{tt(this,Yt,!0),K(_t)},this.reject=_t=>{tt(this,Yt,!0),G(_t)}})}get settled(){return t(this,Yt)}}Yt=new WeakMap,d.PromiseCapability=jt;let Gt=null,Wt=null;function Xt(lt){return Gt||(Gt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),lt.replaceAll(Gt,(K,G,_t)=>G?G.normalize("NFKC"):Wt.get(_t))}function $t(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const lt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(lt);else for(let K=0;K<32;K++)lt[K]=Math.floor(Math.random()*255);return N(lt)}const zt="pdfjs_internal_id_";d.AnnotationPrefix=zt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var mt,ot,h,P,de,X,we,B,F,f,L,O,x,v,y,u,Ce,w,C,Ue,a,l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(g){if(typeof g=="string"||g instanceof URL?g={url:g}:(0,_util.isArrayBuffer)(g)&&(g={data:g}),typeof g!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!g.url&&!g.data&&!g.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const r=new PDFDocumentLoadingTask,{docId:T}=r,m=g.url?getUrlProp(g.url):null,U=g.data?getDataProp(g.data):null,V=g.httpHeaders||null,E=g.withCredentials===!0,$=g.password??null,st=g.range instanceof PDFDataRangeTransport?g.range:null,at=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let H=g.worker instanceof PDFWorker?g.worker:null;const ct=g.verbosity,gt=typeof g.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(g.docBaseUrl)?g.docBaseUrl:null,Ct=typeof g.cMapUrl=="string"?g.cMapUrl:null,kt=g.cMapPacked!==!1,S=g.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof g.standardFontDataUrl=="string"?g.standardFontDataUrl:null,n=g.StandardFontDataFactory||DefaultStandardFontDataFactory,s=g.stopAtErrors!==!0,o=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,c=g.isEvalSupported!==!1,b=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!_util.isNodeJS,M=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,N=typeof g.disableFontFace=="boolean"?g.disableFontFace:_util.isNodeJS,et=g.fontExtraProperties===!0,Z=g.enableXfa===!0,nt=g.ownerDocument||globalThis.document,ht=g.disableRange===!0,vt=g.disableStream===!0,ut=g.disableAutoFetch===!0,Mt=g.pdfBug===!0,Ut=st?st.length:g.length??NaN,Et=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!_util.isNodeJS&&!N,It=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:S===_display_utils.DOMCMapReaderFactory&&n===_display_utils.DOMStandardFontDataFactory&&Ct&&i&&(0,_display_utils.isValidFetchUrl)(Ct,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),ft=g.canvasFactory||new DefaultCanvasFactory({ownerDocument:nt}),J=g.filterFactory||new DefaultFilterFactory({docId:T,ownerDocument:nt}),Q=null;(0,_util.setVerbosityLevel)(ct);const dt={canvasFactory:ft,filterFactory:J};if(It||(dt.cMapReaderFactory=new S({baseUrl:Ct,isCompressed:kt}),dt.standardFontDataFactory=new n({baseUrl:i})),!H){const jt={verbosity:ct,port:_worker_options.GlobalWorkerOptions.workerPort};H=jt.port?PDFWorker.fromPort(jt):new PDFWorker(jt),r._worker=H}const wt={docId:T,apiVersion:"3.11.174",data:U,password:$,disableAutoFetch:ut,rangeChunkSize:at,length:Ut,docBaseUrl:gt,enableXfa:Z,evaluatorOptions:{maxImageSize:o,disableFontFace:N,ignoreErrors:s,isEvalSupported:c,isOffscreenCanvasSupported:b,canvasMaxAreaInBytes:M,fontExtraProperties:et,useSystemFonts:Et,cMapUrl:It?Ct:null,standardFontDataUrl:It?i:null}},Tt={ignoreErrors:s,isEvalSupported:c,disableFontFace:N,fontExtraProperties:et,enableXfa:Z,ownerDocument:nt,disableAutoFetch:ut,pdfBug:Mt,styleElement:Q};return H.promise.then(function(){if(r.destroyed)throw new Error("Loading aborted");const jt=_fetchDocument(H,wt),Gt=new Promise(function(Wt){let Xt;st?Xt=new _transport_stream.PDFDataTransportStream({length:Ut,initialData:st.initialData,progressiveDone:st.progressiveDone,contentDispositionFilename:st.contentDispositionFilename,disableRange:ht,disableStream:vt},st):U||(Xt=(zt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(zt):(0,_display_utils.isValidFetchUrl)(zt.url)?new _displayFetch_stream.PDFFetchStream(zt):new _displayNetwork.PDFNetworkStream(zt))({url:m,length:Ut,httpHeaders:V,withCredentials:E,rangeChunkSize:at,disableRange:ht,disableStream:vt})),Wt(Xt)});return Promise.all([jt,Gt]).then(function([Wt,Xt]){if(r.destroyed)throw new Error("Loading aborted");const $t=new _message_handler.MessageHandler(T,Wt,H.port),zt=new WorkerTransport($t,r,Xt,Tt,dt);r._transport=zt,$t.send("Ready",null)})}).catch(r._capability.reject),r}async function _fetchDocument(g,r){if(g.destroyed)throw new Error("Worker was destroyed");const T=await g.messageHandler.sendWithPromise("GetDocRequest",r,r.data?[r.data.buffer]:null);if(g.destroyed)throw new Error("Worker was destroyed");return T}function getUrlProp(g){if(g instanceof URL)return g.href;try{return new URL(g,window.location).href}catch{if(_util.isNodeJS&&typeof g=="string")return g}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(g){if(_util.isNodeJS&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return(0,_util.stringToBytes)(g);if(typeof g=="object"&&!isNaN(g==null?void 0:g.length)||(0,_util.isArrayBuffer)(g))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const d=class d{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${me(d,mt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var r,T,m;this.destroyed=!0;try{(r=this._worker)!=null&&r.port&&(this._worker._pendingDestroy=!0),await((T=this._transport)==null?void 0:T.destroy())}catch(U){throw(m=this._worker)!=null&&m.port&&delete this._worker._pendingDestroy,U}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};mt=new WeakMap,I(d,mt,0);let PDFDocumentLoadingTask=d;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(r,T,m=!1,U=null){this.length=r,this.initialData=T,this.progressiveDone=m,this.contentDispositionFilename=U,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(r){this._rangeListeners.push(r)}addProgressListener(r){this._progressListeners.push(r)}addProgressiveReadListener(r){this._progressiveReadListeners.push(r)}addProgressiveDoneListener(r){this._progressiveDoneListeners.push(r)}onDataRange(r,T){for(const m of this._rangeListeners)m(r,T)}onDataProgress(r,T){this._readyCapability.promise.then(()=>{for(const m of this._progressListeners)m(r,T)})}onDataProgressiveRead(r){this._readyCapability.promise.then(()=>{for(const T of this._progressiveReadListeners)T(r)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const r of this._progressiveDoneListeners)r()})}transportReady(){this._readyCapability.resolve()}requestDataRange(r,T){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(r,T){this._pdfInfo=r,this._transport=T,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(m=>{if(!m)return m;const U=[];for(const V in m)U.push(...m[V]);return U}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(r){return this._transport.getPage(r)}getPageIndex(r){return this._transport.getPageIndex(r)}getDestinations(){return this._transport.getDestinations()}getDestination(r){return this._transport.getDestination(r)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(r=!1){return this._transport.startCleanup(r||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(r,T,m,U=!1){I(this,P);I(this,X);I(this,ot,null);I(this,h,!1);this._pageIndex=r,this._pageInfo=T,this._transport=m,this._stats=U?new _display_utils.StatTimer:null,this._pdfBug=U,this.commonObjs=m.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:r,rotation:T=this.rotate,offsetX:m=0,offsetY:U=0,dontFlip:V=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:r,rotation:T,offsetX:m,offsetY:U,dontFlip:V})}getAnnotations({intent:r="display"}={}){const T=this._transport.getRenderingIntent(r);return this._transport.getAnnotations(this._pageIndex,T.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var r;return((r=this._transport._htmlForXfa)==null?void 0:r.children[this._pageIndex])||null}render({canvasContext:r,viewport:T,intent:m="display",annotationMode:U=_util.AnnotationMode.ENABLE,transform:V=null,background:E=null,optionalContentConfigPromise:$=null,annotationCanvasMap:st=null,pageColors:at=null,printAnnotationStorage:H=null}){var n,s;(n=this._stats)==null||n.time("Overall");const ct=this._transport.getRenderingIntent(m,U,H);tt(this,h,!1),W(this,X,we).call(this),$||($=this._transport.getOptionalContentConfig());let gt=this._intentStates.get(ct.cacheKey);gt||(gt=Object.create(null),this._intentStates.set(ct.cacheKey,gt)),gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null);const Ct=!!(ct.renderingIntent&_util.RenderingIntentFlag.PRINT);gt.displayReadyCapability||(gt.displayReadyCapability=new _util.PromiseCapability,gt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(s=this._stats)==null||s.time("Page Request"),this._pumpOperatorList(ct));const kt=o=>{var c,b;gt.renderTasks.delete(S),(this._maybeCleanupAfterRender||Ct)&&tt(this,h,!0),W(this,P,de).call(this,!Ct),o?(S.capability.reject(o),this._abortOperatorList({intentState:gt,reason:o instanceof Error?o:new Error(o)})):S.capability.resolve(),(c=this._stats)==null||c.timeEnd("Rendering"),(b=this._stats)==null||b.timeEnd("Overall")},S=new InternalRenderTask({callback:kt,params:{canvasContext:r,viewport:T,transform:V,background:E},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:st,operatorList:gt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Ct,pdfBug:this._pdfBug,pageColors:at});(gt.renderTasks||(gt.renderTasks=new Set)).add(S);const i=S.task;return Promise.all([gt.displayReadyCapability.promise,$]).then(([o,c])=>{var b;if(this.destroyed){kt();return}(b=this._stats)==null||b.time("Rendering"),S.initializeGraphics({transparency:o,optionalContentConfig:c}),S.operatorListChanged()}).catch(kt),i}getOperatorList({intent:r="display",annotationMode:T=_util.AnnotationMode.ENABLE,printAnnotationStorage:m=null}={}){var st;function U(){E.operatorList.lastChunk&&(E.opListReadCapability.resolve(E.operatorList),E.renderTasks.delete($))}const V=this._transport.getRenderingIntent(r,T,m,!0);let E=this._intentStates.get(V.cacheKey);E||(E=Object.create(null),this._intentStates.set(V.cacheKey,E));let $;return E.opListReadCapability||($=Object.create(null),$.operatorListChanged=U,E.opListReadCapability=new _util.PromiseCapability,(E.renderTasks||(E.renderTasks=new Set)).add($),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(st=this._stats)==null||st.time("Page Request"),this._pumpOperatorList(V)),E.opListReadCapability.promise}streamTextContent({includeMarkedContent:r=!1,disableNormalization:T=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:r===!0,disableNormalization:T===!0},{highWaterMark:100,size(U){return U.items.length}})}getTextContent(r={}){if(this._transport._htmlForXfa)return this.getXfa().then(m=>_xfa_text.XfaText.textContent(m));const T=this.streamTextContent(r);return new Promise(function(m,U){function V(){E.read().then(function({value:st,done:at}){if(at){m($);return}Object.assign($.styles,st.styles),$.items.push(...st.items),V()},U)}const E=T.getReader(),$={items:[],styles:Object.create(null)};V()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const r=[];for(const T of this._intentStates.values())if(this._abortOperatorList({intentState:T,reason:new Error("Page was destroyed."),force:!0}),!T.opListReadCapability)for(const m of T.renderTasks)r.push(m.completed),m.cancel();return this.objs.clear(),tt(this,h,!1),W(this,X,we).call(this),Promise.all(r)}cleanup(r=!1){tt(this,h,!0);const T=W(this,P,de).call(this,!1);return r&&T&&this._stats&&(this._stats=new _display_utils.StatTimer),T}_startRenderPage(r,T){var U,V;const m=this._intentStates.get(T);m&&((U=this._stats)==null||U.timeEnd("Page Request"),(V=m.displayReadyCapability)==null||V.resolve(r))}_renderPageChunk(r,T){for(let m=0,U=r.length;m<U;m++)T.operatorList.fnArray.push(r.fnArray[m]),T.operatorList.argsArray.push(r.argsArray[m]);T.operatorList.lastChunk=r.lastChunk,T.operatorList.separateAnnots=r.separateAnnots;for(const m of T.renderTasks)m.operatorListChanged();r.lastChunk&&W(this,P,de).call(this,!0)}_pumpOperatorList({renderingIntent:r,cacheKey:T,annotationStorageSerializable:m}){const{map:U,transfers:V}=m,$=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:r,cacheKey:T,annotationStorage:U},V).getReader(),st=this._intentStates.get(T);st.streamReader=$;const at=()=>{$.read().then(({value:H,done:ct})=>{if(ct){st.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(H,st),at())},H=>{if(st.streamReader=null,!this._transport.destroyed){if(st.operatorList){st.operatorList.lastChunk=!0;for(const ct of st.renderTasks)ct.operatorListChanged();W(this,P,de).call(this,!0)}if(st.displayReadyCapability)st.displayReadyCapability.reject(H);else if(st.opListReadCapability)st.opListReadCapability.reject(H);else throw H}})};at()}_abortOperatorList({intentState:r,reason:T,force:m=!1}){if(r.streamReader){if(r.streamReaderCancelTimeout&&(clearTimeout(r.streamReaderCancelTimeout),r.streamReaderCancelTimeout=null),!m){if(r.renderTasks.size>0)return;if(T instanceof _display_utils.RenderingCancelledException){let U=RENDERING_CANCELLED_TIMEOUT;T.extraDelay>0&&T.extraDelay<1e3&&(U+=T.extraDelay),r.streamReaderCancelTimeout=setTimeout(()=>{r.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:r,reason:T,force:!0})},U);return}}if(r.streamReader.cancel(new _util.AbortException(T.message)).catch(()=>{}),r.streamReader=null,!this._transport.destroyed){for(const[U,V]of this._intentStates)if(V===r){this._intentStates.delete(U);break}this.cleanup()}}}get stats(){return this._stats}}ot=new WeakMap,h=new WeakMap,P=new WeakSet,de=function(r=!1){if(W(this,X,we).call(this),!t(this,h)||this.destroyed)return!1;if(r)return tt(this,ot,setTimeout(()=>{tt(this,ot,null),W(this,P,de).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:T,operatorList:m}of this._intentStates.values())if(T.size>0||!m.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),tt(this,h,!1),!0},X=new WeakSet,we=function(){t(this,ot)&&(clearTimeout(t(this,ot)),tt(this,ot,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){I(this,B,new Set);I(this,F,Promise.resolve())}postMessage(r,T){const m={data:structuredClone(r,T?{transfer:T}:null)};t(this,F).then(()=>{for(const U of t(this,B))U.call(this,m)})}addEventListener(r,T){t(this,B).add(T)}removeEventListener(r,T){t(this,B).delete(T)}terminate(){t(this,B).clear()}}B=new WeakMap,F=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const g=(f=document==null?void 0:document.currentScript)==null?void 0:f.src;g&&(PDFWorkerUtil.fallbackWorkerSrc=g.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(g,r){let T;try{if(T=new URL(g),!T.origin||T.origin==="null")return!1}catch{return!1}const m=new URL(r,T);return T.origin===m.origin},PDFWorkerUtil.createCDNWrapper=function(g){const r=`importScripts("${g}");`;return URL.createObjectURL(new Blob([r]))}}const _PDFWorker=class _PDFWorker{constructor({name:g=null,port:r=null,verbosity:T=(0,_util.getVerbosityLevel)()}={}){var m;if(this.name=g,this.destroyed=!1,this.verbosity=T,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,r){if((m=t(_PDFWorker,L))!=null&&m.has(r))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,L)||tt(_PDFWorker,L,new WeakMap)).set(r,this),this._initializeFromPort(r);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(g){this._port=g,this._messageHandler=new _message_handler.MessageHandler("main","worker",g),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:g}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,g)||(g=PDFWorkerUtil.createCDNWrapper(new URL(g,window.location).href));const r=new Worker(g),T=new _message_handler.MessageHandler("main","worker",r),m=()=>{r.removeEventListener("error",U),T.destroy(),r.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},U=()=>{this._webWorker||m()};r.addEventListener("error",U),T.on("test",E=>{if(r.removeEventListener("error",U),this.destroyed){m();return}E?(this._messageHandler=T,this._port=r,this._webWorker=r,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),T.destroy(),r.terminate())}),T.on("ready",E=>{if(r.removeEventListener("error",U),this.destroyed){m();return}try{V()}catch{this._setupFakeWorker()}});const V=()=>{const E=new Uint8Array;T.send("test",E,[E.buffer])};V();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(g=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const r=new LoopbackPort;this._port=r;const T=`fake${PDFWorkerUtil.fakeWorkerId++}`,m=new _message_handler.MessageHandler(T+"_worker",T,r);g.setup(m,r);const U=new _message_handler.MessageHandler(T,T+"_worker",r);this._messageHandler=U,this._readyCapability.resolve(),U.send("configure",{verbosity:this.verbosity})}).catch(g=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${g.message}".`))})}destroy(){var g;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(g=t(_PDFWorker,L))==null||g.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(g){var T;if(!(g!=null&&g.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const r=(T=t(this,L))==null?void 0:T.get(g.port);if(r){if(r._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return r}return new _PDFWorker(g)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var g;try{return((g=globalThis.pdfjsWorker)==null?void 0:g.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};L=new WeakMap,I(_PDFWorker,L,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(r,T,m,U,V){I(this,u);I(this,O,new Map);I(this,x,new Map);I(this,v,new Map);I(this,y,null);this.messageHandler=r,this.loadingTask=T,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:U.ownerDocument,styleElement:U.styleElement}),this._params=U,this.canvasFactory=V.canvasFactory,this.filterFactory=V.filterFactory,this.cMapReaderFactory=V.cMapReaderFactory,this.standardFontDataFactory=V.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=m,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(r,T=_util.AnnotationMode.ENABLE,m=null,U=!1){let V=_util.RenderingIntentFlag.DISPLAY,E=_annotation_storage.SerializableEmpty;switch(r){case"any":V=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":V=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${r}`)}switch(T){case _util.AnnotationMode.DISABLE:V+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:V+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:V+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,E=(V&_util.RenderingIntentFlag.PRINT&&m instanceof _annotation_storage.PrintAnnotationStorage?m:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${T}`)}return U&&(V+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:V,cacheKey:`${V}_${E.hash}`,annotationStorageSerializable:E}}destroy(){var m;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(m=t(this,y))==null||m.reject(new Error("Worker was destroyed during onPassword callback"));const r=[];for(const U of t(this,x).values())r.push(U._destroy());t(this,x).clear(),t(this,v).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const T=this.messageHandler.sendWithPromise("Terminate",null);return r.push(T),Promise.all(r).then(()=>{var U;this.commonObjs.clear(),this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(),(U=this._networkStream)==null||U.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:r,loadingTask:T}=this;r.on("GetReader",(m,U)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=V=>{this._lastProgress={loaded:V.loaded,total:V.total}},U.onPull=()=>{this._fullReader.read().then(function({value:V,done:E}){if(E){U.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),U.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{U.error(V)})},U.onCancel=V=>{this._fullReader.cancel(V),U.ready.catch(E=>{if(!this.destroyed)throw E})}}),r.on("ReaderHeadersReady",m=>{const U=new _util.PromiseCapability,V=this._fullReader;return V.headersReady.then(()=>{var E;(!V.isStreamingSupported||!V.isRangeSupported)&&(this._lastProgress&&((E=T.onProgress)==null||E.call(T,this._lastProgress)),V.onProgress=$=>{var st;(st=T.onProgress)==null||st.call(T,{loaded:$.loaded,total:$.total})}),U.resolve({isStreamingSupported:V.isStreamingSupported,isRangeSupported:V.isRangeSupported,contentLength:V.contentLength})},U.reject),U.promise}),r.on("GetRangeReader",(m,U)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const V=this._networkStream.getRangeReader(m.begin,m.end);if(!V){U.close();return}U.onPull=()=>{V.read().then(function({value:E,done:$}){if($){U.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),U.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{U.error(E)})},U.onCancel=E=>{V.cancel(E),U.ready.catch($=>{if(!this.destroyed)throw $})}}),r.on("GetDoc",({pdfInfo:m})=>{this._numPages=m.numPages,this._htmlForXfa=m.htmlForXfa,delete m.htmlForXfa,T._capability.resolve(new PDFDocumentProxy(m,this))}),r.on("DocException",function(m){let U;switch(m.name){case"PasswordException":U=new _util.PasswordException(m.message,m.code);break;case"InvalidPDFException":U=new _util.InvalidPDFException(m.message);break;case"MissingPDFException":U=new _util.MissingPDFException(m.message);break;case"UnexpectedResponseException":U=new _util.UnexpectedResponseException(m.message,m.status);break;case"UnknownErrorException":U=new _util.UnknownErrorException(m.message,m.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}T._capability.reject(U)}),r.on("PasswordRequest",m=>{if(tt(this,y,new _util.PromiseCapability),T.onPassword){const U=V=>{V instanceof Error?t(this,y).reject(V):t(this,y).resolve({password:V})};try{T.onPassword(U,m.code)}catch(V){t(this,y).reject(V)}}else t(this,y).reject(new _util.PasswordException(m.message,m.code));return t(this,y).promise}),r.on("DataLoaded",m=>{var U;(U=T.onProgress)==null||U.call(T,{loaded:m.length,total:m.length}),this.downloadInfoCapability.resolve(m)}),r.on("StartRenderPage",m=>{if(this.destroyed)return;t(this,x).get(m.pageIndex)._startRenderPage(m.transparency,m.cacheKey)}),r.on("commonobj",([m,U,V])=>{var E;if(!this.destroyed&&!this.commonObjs.has(m))switch(U){case"Font":const $=this._params;if("error"in V){const H=V.error;(0,_util.warn)(`Error during font loading: ${H}`),this.commonObjs.resolve(m,H);break}const st=$.pdfBug&&((E=globalThis.FontInspector)!=null&&E.enabled)?(H,ct)=>globalThis.FontInspector.fontAdded(H,ct):null,at=new _font_loader.FontFaceObject(V,{isEvalSupported:$.isEvalSupported,disableFontFace:$.disableFontFace,ignoreErrors:$.ignoreErrors,inspectFont:st});this.fontLoader.bind(at).catch(H=>r.sendWithPromise("FontFallback",{id:m})).finally(()=>{!$.fontExtraProperties&&at.data&&(at.data=null),this.commonObjs.resolve(m,at)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(m,V);break;default:throw new Error(`Got unknown common object type ${U}`)}}),r.on("obj",([m,U,V,E])=>{var st;if(this.destroyed)return;const $=t(this,x).get(U);if(!$.objs.has(m))switch(V){case"Image":if($.objs.resolve(m,E),E){let at;if(E.bitmap){const{width:H,height:ct}=E;at=H*ct*4}else at=((st=E.data)==null?void 0:st.length)||0;at>_util.MAX_IMAGE_SIZE_TO_CACHE&&($._maybeCleanupAfterRender=!0)}break;case"Pattern":$.objs.resolve(m,E);break;default:throw new Error(`Got unknown object type ${V}`)}}),r.on("DocProgress",m=>{var U;this.destroyed||(U=T.onProgress)==null||U.call(T,{loaded:m.loaded,total:m.total})}),r.on("FetchBuiltInCMap",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(m):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),r.on("FetchStandardFontData",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(m):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var m;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:r,transfers:T}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:r,filename:((m=this._fullReader)==null?void 0:m.filename)??null},T).finally(()=>{this.annotationStorage.resetModified()})}getPage(r){if(!Number.isInteger(r)||r<=0||r>this._numPages)return Promise.reject(new Error("Invalid page request."));const T=r-1,m=t(this,v).get(T);if(m)return m;const U=this.messageHandler.sendWithPromise("GetPage",{pageIndex:T}).then(V=>{if(this.destroyed)throw new Error("Transport destroyed");const E=new PDFPageProxy(T,V,this,this._params.pdfBug);return t(this,x).set(T,E),E});return t(this,v).set(T,U),U}getPageIndex(r){return typeof r!="object"||r===null||!Number.isInteger(r.num)||r.num<0||!Number.isInteger(r.gen)||r.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:r.num,gen:r.gen})}getAnnotations(r,T){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:r,intent:T})}getFieldObjects(){return W(this,u,Ce).call(this,"GetFieldObjects")}hasJSActions(){return W(this,u,Ce).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(r){return typeof r!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:r})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return W(this,u,Ce).call(this,"GetDocJSActions")}getPageJSActions(r){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:r})}getStructTree(r){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:r})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(r=>new _optional_content_config.OptionalContentConfig(r))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const r="GetMetadata",T=t(this,O).get(r);if(T)return T;const m=this.messageHandler.sendWithPromise(r,null).then(U=>{var V,E;return{info:U[0],metadata:U[1]?new _metadata.Metadata(U[1]):null,contentDispositionFilename:((V=this._fullReader)==null?void 0:V.filename)??null,contentLength:((E=this._fullReader)==null?void 0:E.contentLength)??null}});return t(this,O).set(r,m),m}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(r=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const T of t(this,x).values())if(!T.cleanup())throw new Error(`startCleanup: Page ${T.pageNumber} is currently rendering.`);this.commonObjs.clear(),r||this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:r,enableXfa:T}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:r,enableXfa:T})}}O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakSet,Ce=function(r,T=null){const m=t(this,O).get(r);if(m)return m;const U=this.messageHandler.sendWithPromise(r,T);return t(this,O).set(r,U),U};class PDFObjects{constructor(){I(this,C);I(this,w,Object.create(null))}get(r,T=null){if(T){const U=W(this,C,Ue).call(this,r);return U.capability.promise.then(()=>T(U.data)),null}const m=t(this,w)[r];if(!(m!=null&&m.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${r}.`);return m.data}has(r){const T=t(this,w)[r];return(T==null?void 0:T.capability.settled)||!1}resolve(r,T=null){const m=W(this,C,Ue).call(this,r);m.data=T,m.capability.resolve()}clear(){var r;for(const T in t(this,w)){const{data:m}=t(this,w)[T];(r=m==null?void 0:m.bitmap)==null||r.close()}tt(this,w,Object.create(null))}}w=new WeakMap,C=new WeakSet,Ue=function(r){var T;return(T=t(this,w))[r]||(T[r]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(r){I(this,a,null);tt(this,a,r),this.onContinue=null}get promise(){return t(this,a).capability.promise}cancel(r=0){t(this,a).cancel(null,r)}get separateAnnots(){const{separateAnnots:r}=t(this,a).operatorList;if(!r)return!1;const{annotationCanvasMap:T}=t(this,a);return r.form||r.canvas&&(T==null?void 0:T.size)>0}}a=new WeakMap,exports.RenderTask=RenderTask;const k=class k{constructor({callback:r,params:T,objs:m,commonObjs:U,annotationCanvasMap:V,operatorList:E,pageIndex:$,canvasFactory:st,filterFactory:at,useRequestAnimationFrame:H=!1,pdfBug:ct=!1,pageColors:gt=null}){this.callback=r,this.params=T,this.objs=m,this.commonObjs=U,this.annotationCanvasMap=V,this.operatorListIdx=null,this.operatorList=E,this._pageIndex=$,this.canvasFactory=st,this.filterFactory=at,this._pdfBug=ct,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=H===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=T.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:r=!1,optionalContentConfig:T}){var $,st;if(this.cancelled)return;if(this._canvas){if(t(k,l).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(k,l).add(this._canvas)}this._pdfBug&&(($=globalThis.StepperManager)!=null&&$.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:m,viewport:U,transform:V,background:E}=this.params;this.gfx=new _canvas.CanvasGraphics(m,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:T},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:V,viewport:U,transparency:r,background:E}),this.operatorListIdx=0,this.graphicsReady=!0,(st=this.graphicsReadyCallback)==null||st.call(this)}cancel(r=null,T=0){var m;this.running=!1,this.cancelled=!0,(m=this.gfx)==null||m.endDrawing(),t(k,l).delete(this._canvas),this.callback(r||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,T))}operatorListChanged(){var r;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(r=this.stepper)==null||r.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(k,l).delete(this._canvas),this.callback())))}};l=new WeakMap,I(k,l,new WeakSet);let InternalRenderTask=k;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(mt,d,ot)=>{var F,f,L,yi,x;Object.defineProperty(d,"__esModule",{value:!0}),d.SerializableEmpty=d.PrintAnnotationStorage=d.AnnotationStorage=void 0;var h=ot(1),P=ot(4),rt=ot(8);const X=Object.freeze({map:null,hash:"",transfers:void 0});d.SerializableEmpty=X;class pt{constructor(){I(this,L);I(this,F,!1);I(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(y,u){const _=t(this,f).get(y);return _===void 0?u:Object.assign(u,_)}getRawValue(y){return t(this,f).get(y)}remove(y){if(t(this,f).delete(y),t(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const u of t(this,f).values())if(u instanceof P.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(y,u){const _=t(this,f).get(y);let w=!1;if(_!==void 0)for(const[C,A]of Object.entries(u))_[C]!==A&&(w=!0,_[C]=A);else w=!0,t(this,f).set(y,u);w&&W(this,L,yi).call(this),u instanceof P.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(u.constructor._type)}has(y){return t(this,f).has(y)}getAll(){return t(this,f).size>0?(0,h.objectFromMap)(t(this,f)):null}setAll(y){for(const[u,_]of Object.entries(y))this.setValue(u,_)}get size(){return t(this,f).size}resetModified(){t(this,F)&&(tt(this,F,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new B(this)}get serializable(){if(t(this,f).size===0)return X;const y=new Map,u=new rt.MurmurHash3_64,_=[],w=Object.create(null);let C=!1;for(const[A,a]of t(this,f)){const l=a instanceof P.AnnotationEditor?a.serialize(!1,w):a;l&&(y.set(A,l),u.update(`${A}:${JSON.stringify(l)}`),C||(C=!!l.bitmap))}if(C)for(const A of y.values())A.bitmap&&_.push(A.bitmap);return y.size>0?{map:y,hash:u.hexdigest(),transfers:_}:X}}F=new WeakMap,f=new WeakMap,L=new WeakSet,yi=function(){t(this,F)||(tt(this,F,!0),typeof this.onSetModified=="function"&&this.onSetModified())},d.AnnotationStorage=pt;class B extends pt{constructor(u){super();I(this,x,void 0);const{map:_,hash:w,transfers:C}=u.serializable,A=structuredClone(_,C?{transfer:C}:null);tt(this,x,{map:A,hash:w,transfers:C})}get print(){(0,h.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,x)}}x=new WeakMap,d.PrintAnnotationStorage=B},(mt,d,ot)=>{var B,F,f,L,O,x,v,y,u,_,w,C,A,a,l,je,g,He,T,We,U,ze,E,vi,st,Si,H,Ei,gt,Ge,kt,wi;Object.defineProperty(d,"__esModule",{value:!0}),d.AnnotationEditor=void 0;var h=ot(5),P=ot(1),rt=ot(6);const i=class i{constructor(s){I(this,l);I(this,g);I(this,U);I(this,E);I(this,st);I(this,H);I(this,gt);I(this,kt);I(this,B,"");I(this,F,!1);I(this,f,null);I(this,L,null);I(this,O,null);I(this,x,!1);I(this,v,null);I(this,y,this.focusin.bind(this));I(this,u,this.focusout.bind(this));I(this,_,!1);I(this,w,!1);I(this,C,!1);ie(this,"_initialOptions",Object.create(null));ie(this,"_uiManager",null);ie(this,"_focusEventsAllowed",!0);ie(this,"_l10nPromise",null);I(this,A,!1);I(this,a,i._zIndex++);this.constructor===i&&(0,P.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:o,rawDims:{pageWidth:c,pageHeight:b,pageX:M,pageY:N}}=this.parent.viewport;this.rotation=o,this.pageRotation=(360+o-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[c,b],this.pageTranslation=[M,N];const[et,Z]=this.parentDimensions;this.x=s.x/et,this.y=s.y/Z,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,P.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const o=new pt({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});o.annotationElementId=s.annotationElementId,o.deleted=!0,o._uiManager.addToAnnotationStorage(o)}static initialize(s,o=null){if(i._l10nPromise||(i._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(b=>[b,s.get(b)]))),o!=null&&o.strings)for(const b of o.strings)i._l10nPromise.set(b,s.get(b));if(i._borderLineWidth!==-1)return;const c=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(c.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,o){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,o){(0,P.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(s){var o;tt(this,A,s),(o=this.div)==null||o.classList.toggle("draggable",s)}center(){const[s,o]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*o/(s*2),this.y+=this.width*s/(o*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*o/(s*2),this.y-=this.width*s/(o*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,a)}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(t(this,_)?tt(this,_,!1):this.parent.setSelected(this))}focusout(s){var c;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const o=s.relatedTarget;o!=null&&o.closest(`#${this.id}`)||(s.preventDefault(),(c=this.parent)!=null&&c.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,o,c,b){const[M,N]=this.parentDimensions;[c,b]=this.screenToPageTranslation(c,b),this.x=(s+c)/M,this.y=(o+b)/N,this.fixAndSetPosition()}translate(s,o){W(this,l,je).call(this,this.parentDimensions,s,o)}translateInPage(s,o){W(this,l,je).call(this,this.pageDimensions,s,o),this.div.scrollIntoView({block:"nearest"})}drag(s,o){const[c,b]=this.parentDimensions;if(this.x+=s/c,this.y+=o/b,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:nt,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,nt,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:M,y:N}=this;const[et,Z]=W(this,g,He).call(this);M+=et,N+=Z,this.div.style.left=`${(100*M).toFixed(2)}%`,this.div.style.top=`${(100*N).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[s,o]=this.pageDimensions;let{x:c,y:b,width:M,height:N}=this;switch(M*=s,N*=o,c*=s,b*=o,this.rotation){case 0:c=Math.max(0,Math.min(s-M,c)),b=Math.max(0,Math.min(o-N,b));break;case 90:c=Math.max(0,Math.min(s-N,c)),b=Math.min(o,Math.max(M,b));break;case 180:c=Math.min(s,Math.max(M,c)),b=Math.min(o,Math.max(N,b));break;case 270:c=Math.min(s,Math.max(N,c)),b=Math.max(0,Math.min(o-M,b));break}this.x=c/=s,this.y=b/=o;const[et,Z]=W(this,g,He).call(this);c+=et,b+=Z;const{style:nt}=this.div;nt.left=`${(100*c).toFixed(2)}%`,nt.top=`${(100*b).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(s,o){var c;return W(c=i,T,We).call(c,s,o,this.parentRotation)}pageTranslationToScreen(s,o){var c;return W(c=i,T,We).call(c,s,o,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[o,c]}=this,b=o*s,M=c*s;return P.FeatureTest.isCSSRoundSupported?[Math.round(b),Math.round(M)]:[b,M]}setDims(s,o){var M;const[c,b]=this.parentDimensions;this.div.style.width=`${(100*s/c).toFixed(2)}%`,t(this,x)||(this.div.style.height=`${(100*o/b).toFixed(2)}%`),(M=t(this,f))==null||M.classList.toggle("small",s<i.SMALL_EDITOR_SIZE||o<i.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:o,width:c}=s,b=c.endsWith("%"),M=!t(this,x)&&o.endsWith("%");if(b&&M)return;const[N,et]=this.parentDimensions;b||(s.width=`${(100*parseFloat(c)/N).toFixed(2)}%`),!t(this,x)&&!M&&(s.height=`${(100*parseFloat(o)/et).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,f))return;const s=tt(this,f,document.createElement("button"));s.className="altText";const o=await i._l10nPromise.get("editor_alt_text_button_label");s.textContent=o,s.setAttribute("aria-label",o),s.tabIndex="0",s.addEventListener("contextmenu",rt.noContextMenu),s.addEventListener("pointerdown",c=>c.stopPropagation()),s.addEventListener("click",c=>{c.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",c=>{c.target===s&&c.key==="Enter"&&(c.preventDefault(),this._uiManager.editAltText(this))}),W(this,gt,Ge).call(this),this.div.append(s),i.SMALL_EDITOR_SIZE||(i.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,B),decorative:t(this,F)}}set altTextData({altText:s,decorative:o}){t(this,B)===s&&t(this,F)===o||(tt(this,B,s),tt(this,F,o),W(this,gt,Ge).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,y)),this.div.addEventListener("focusout",t(this,u));const[s,o]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*o/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/o).toFixed(2)}%`);const[c,b]=this.getInitialTranslation();return this.translate(c,b),(0,h.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:o}=P.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&o){s.preventDefault();return}tt(this,_,!0),W(this,kt,wi).call(this,s)}moveInDOM(){var s;(s=this.parent)==null||s.moveEditorInDOM(this)}_setParentAndPosition(s,o,c){s.changeParent(this),this.x=o,this.y=c,this.fixAndSetPosition()}getRect(s,o){const c=this.parentScale,[b,M]=this.pageDimensions,[N,et]=this.pageTranslation,Z=s/c,nt=o/c,ht=this.x*b,vt=this.y*M,ut=this.width*b,Mt=this.height*M;switch(this.rotation){case 0:return[ht+Z+N,M-vt-nt-Mt+et,ht+Z+ut+N,M-vt-nt+et];case 90:return[ht+nt+N,M-vt+Z+et,ht+nt+Mt+N,M-vt+Z+ut+et];case 180:return[ht-Z-ut+N,M-vt+nt+et,ht-Z+N,M-vt+nt+Mt+et];case 270:return[ht-nt-Mt+N,M-vt-Z-ut+et,ht-nt+N,M-vt-Z+et];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,o){const[c,b,M,N]=s,et=M-c,Z=N-b;switch(this.rotation){case 0:return[c,o-N,et,Z];case 90:return[c,o-b,Z,et];case 180:return[M,o-b,et,Z];case 270:return[M,o-N,Z,et];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){tt(this,C,!0)}disableEditMode(){tt(this,C,!1)}isInEditMode(){return t(this,C)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var s,o;(s=this.div)==null||s.addEventListener("focusin",t(this,y)),(o=this.div)==null||o.addEventListener("focusout",t(this,u))}serialize(s=!1,o=null){(0,P.unreachable)("An editor must be serializable")}static deserialize(s,o,c){const b=new this.prototype.constructor({parent:o,id:o.getNextId(),uiManager:c});b.rotation=s.rotation;const[M,N]=b.pageDimensions,[et,Z,nt,ht]=b.getRectInCurrentCoords(s.rect,N);return b.x=et/M,b.y=Z/N,b.width=nt/M,b.height=ht/N,b}remove(){var s;this.div.removeEventListener("focusin",t(this,y)),this.div.removeEventListener("focusout",t(this,u)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(s=t(this,f))==null||s.remove(),tt(this,f,null),tt(this,L,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(W(this,E,vi).call(this),t(this,v).classList.remove("hidden"))}select(){var s;this.makeResizable(),(s=this.div)==null||s.classList.add("selectedEditor")}unselect(){var s,o,c;(s=t(this,v))==null||s.classList.add("hidden"),(o=this.div)==null||o.classList.remove("selectedEditor"),(c=this.div)!=null&&c.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,o){}disableEditing(){t(this,f)&&(t(this,f).hidden=!0)}enableEditing(){t(this,f)&&(t(this,f).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,w)}set isEditing(s){tt(this,w,s),this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,o){tt(this,x,!0);const c=s/o,{style:b}=this.div;b.aspectRatio=c,b.height="auto"}static get MIN_SIZE(){return 16}};B=new WeakMap,F=new WeakMap,f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakMap,a=new WeakMap,l=new WeakSet,je=function([s,o],c,b){[c,b]=this.screenToPageTranslation(c,b),this.x+=c/s,this.y+=b/o,this.fixAndSetPosition()},g=new WeakSet,He=function(){const[s,o]=this.parentDimensions,{_borderLineWidth:c}=i,b=c/s,M=c/o;switch(this.rotation){case 90:return[-b,M];case 180:return[b,M];case 270:return[b,-M];default:return[-b,-M]}},T=new WeakSet,We=function(s,o,c){switch(c){case 90:return[o,-s];case 180:return[-s,-o];case 270:return[-o,s];default:return[s,o]}},U=new WeakSet,ze=function(s){switch(s){case 90:{const[o,c]=this.pageDimensions;return[0,-o/c,c/o,0]}case 180:return[-1,0,0,-1];case 270:{const[o,c]=this.pageDimensions;return[0,o/c,-c/o,0]}default:return[1,0,0,1]}},E=new WeakSet,vi=function(){if(t(this,v))return;tt(this,v,document.createElement("div")),t(this,v).classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const o of s){const c=document.createElement("div");t(this,v).append(c),c.classList.add("resizer",o),c.addEventListener("pointerdown",W(this,st,Si).bind(this,o)),c.addEventListener("contextmenu",rt.noContextMenu)}this.div.prepend(t(this,v))},st=new WeakSet,Si=function(s,o){o.preventDefault();const{isMac:c}=P.FeatureTest.platform;if(o.button!==0||o.ctrlKey&&c)return;const b=W(this,H,Ei).bind(this,s),M=this._isDraggable;this._isDraggable=!1;const N={passive:!0,capture:!0};window.addEventListener("pointermove",b,N);const et=this.x,Z=this.y,nt=this.width,ht=this.height,vt=this.parent.div.style.cursor,ut=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(o.target).cursor;const Mt=()=>{this._isDraggable=M,window.removeEventListener("pointerup",Mt),window.removeEventListener("blur",Mt),window.removeEventListener("pointermove",b,N),this.parent.div.style.cursor=vt,this.div.style.cursor=ut;const Ut=this.x,Et=this.y,It=this.width,ft=this.height;Ut===et&&Et===Z&&It===nt&&ft===ht||this.addCommands({cmd:()=>{this.width=It,this.height=ft,this.x=Ut,this.y=Et;const[J,Q]=this.parentDimensions;this.setDims(J*It,Q*ft),this.fixAndSetPosition()},undo:()=>{this.width=nt,this.height=ht,this.x=et,this.y=Z;const[J,Q]=this.parentDimensions;this.setDims(J*nt,Q*ht),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Mt),window.addEventListener("blur",Mt)},H=new WeakSet,Ei=function(s,o){const[c,b]=this.parentDimensions,M=this.x,N=this.y,et=this.width,Z=this.height,nt=i.MIN_SIZE/c,ht=i.MIN_SIZE/b,vt=_t=>Math.round(_t*1e4)/1e4,ut=W(this,U,ze).call(this,this.rotation),Mt=(_t,yt)=>[ut[0]*_t+ut[2]*yt,ut[1]*_t+ut[3]*yt],Ut=W(this,U,ze).call(this,360-this.rotation),Et=(_t,yt)=>[Ut[0]*_t+Ut[2]*yt,Ut[1]*_t+Ut[3]*yt];let It,ft,J=!1,Q=!1;switch(s){case"topLeft":J=!0,It=(_t,yt)=>[0,0],ft=(_t,yt)=>[_t,yt];break;case"topMiddle":It=(_t,yt)=>[_t/2,0],ft=(_t,yt)=>[_t/2,yt];break;case"topRight":J=!0,It=(_t,yt)=>[_t,0],ft=(_t,yt)=>[0,yt];break;case"middleRight":Q=!0,It=(_t,yt)=>[_t,yt/2],ft=(_t,yt)=>[0,yt/2];break;case"bottomRight":J=!0,It=(_t,yt)=>[_t,yt],ft=(_t,yt)=>[0,0];break;case"bottomMiddle":It=(_t,yt)=>[_t/2,yt],ft=(_t,yt)=>[_t/2,0];break;case"bottomLeft":J=!0,It=(_t,yt)=>[0,yt],ft=(_t,yt)=>[_t,0];break;case"middleLeft":Q=!0,It=(_t,yt)=>[0,yt/2],ft=(_t,yt)=>[_t,yt/2];break}const dt=It(et,Z),wt=ft(et,Z);let Tt=Mt(...wt);const jt=vt(M+Tt[0]),Gt=vt(N+Tt[1]);let Wt=1,Xt=1,[$t,zt]=this.screenToPageTranslation(o.movementX,o.movementY);if([$t,zt]=Et($t/c,zt/b),J){const _t=Math.hypot(et,Z);Wt=Xt=Math.max(Math.min(Math.hypot(wt[0]-dt[0]-$t,wt[1]-dt[1]-zt)/_t,1/et,1/Z),nt/et,ht/Z)}else Q?Wt=Math.max(nt,Math.min(1,Math.abs(wt[0]-dt[0]-$t)))/et:Xt=Math.max(ht,Math.min(1,Math.abs(wt[1]-dt[1]-zt)))/Z;const Yt=vt(et*Wt),lt=vt(Z*Xt);Tt=Mt(...ft(Yt,lt));const K=jt-Tt[0],G=Gt-Tt[1];this.width=Yt,this.height=lt,this.x=K,this.y=G,this.setDims(c*Yt,b*lt),this.fixAndSetPosition()},gt=new WeakSet,Ge=async function(){var c;const s=t(this,f);if(!s)return;if(!t(this,B)&&!t(this,F)){s.classList.remove("done"),(c=t(this,L))==null||c.remove();return}i._l10nPromise.get("editor_alt_text_edit_button_label").then(b=>{s.setAttribute("aria-label",b)});let o=t(this,L);if(!o){tt(this,L,o=document.createElement("span")),o.className="tooltip",o.setAttribute("role","tooltip");const b=o.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",b);const M=100;s.addEventListener("mouseenter",()=>{tt(this,O,setTimeout(()=>{tt(this,O,null),t(this,L).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},M))}),s.addEventListener("mouseleave",()=>{var N;clearTimeout(t(this,O)),tt(this,O,null),(N=t(this,L))==null||N.classList.remove("show")})}s.classList.add("done"),o.innerText=t(this,F)?await i._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,B),o.parentNode||s.append(o)},kt=new WeakSet,wi=function(s){if(!this._isDraggable)return;const o=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let c,b;o&&(c={passive:!0,capture:!0},b=N=>{const[et,Z]=this.screenToPageTranslation(N.movementX,N.movementY);this._uiManager.dragSelectedEditors(et,Z)},window.addEventListener("pointermove",b,c));const M=()=>{if(window.removeEventListener("pointerup",M),window.removeEventListener("blur",M),o&&window.removeEventListener("pointermove",b,c),tt(this,_,!1),!this._uiManager.endDragSession()){const{isMac:N}=P.FeatureTest.platform;s.ctrlKey&&!N||s.shiftKey||s.metaKey&&N?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",M),window.addEventListener("blur",M)},I(i,T),ie(i,"_borderLineWidth",-1),ie(i,"_colorManager",new h.ColorManager),ie(i,"_zIndex",1),ie(i,"SMALL_EDITOR_SIZE",0);let X=i;d.AnnotationEditor=X;class pt extends X{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(mt,d,ot)=>{var x,v,y,u,_,Ve,A,a,l,k,g,Ci,m,U,V,E,$,st,at,H,ct,gt,Ct,kt,S,i,n,s,o,c,b,M,N,et,Z,nt,ht,vt,ut,Mt,Ut,Et,It,ft,J,Q,dt,Ti,Tt,Xe,Gt,$e,Xt,Te,zt,qe,lt,Ye,G,ae,yt,be,te,xi,St,Pi,xt,Ke,Bt,_e,At,Je;Object.defineProperty(d,"__esModule",{value:!0}),d.KeyboardManager=d.CommandManager=d.ColorManager=d.AnnotationEditorUIManager=void 0,d.bindEvents=rt,d.opacityToHex=X;var h=ot(1),P=ot(6);function rt(R,e,p){for(const D of p)e.addEventListener(D,R[D].bind(R))}function X(R){return Math.round(Math.min(255,Math.max(1,255*R))).toString(16).padStart(2,"0")}class pt{constructor(){I(this,x,0)}getId(){return`${h.AnnotationEditorPrefix}${me(this,x)._++}`}}x=new WeakMap;const C=class C{constructor(){I(this,_);I(this,v,(0,h.getUuid)());I(this,y,0);I(this,u,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',D=new OffscreenCanvas(1,3).getContext("2d"),j=new Image;j.src=e;const q=j.decode().then(()=>(D.drawImage(j,0,0,1,1,0,0,1,3),new Uint32Array(D.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,h.shadow)(this,"_isSVGFittingCanvas",q)}async getFromFile(e){const{lastModified:p,name:D,size:j,type:q}=e;return W(this,_,Ve).call(this,`${p}_${D}_${j}_${q}`,e)}async getFromUrl(e){return W(this,_,Ve).call(this,e,e)}async getFromId(e){t(this,u)||tt(this,u,new Map);const p=t(this,u).get(e);return p?p.bitmap?(p.refCounter+=1,p):p.file?this.getFromFile(p.file):this.getFromUrl(p.url):null}getSvgUrl(e){const p=t(this,u).get(e);return p!=null&&p.isSvg?p.svgUrl:null}deleteId(e){t(this,u)||tt(this,u,new Map);const p=t(this,u).get(e);p&&(p.refCounter-=1,p.refCounter===0&&(p.bitmap=null))}isValidId(e){return e.startsWith(`image_${t(this,v)}_`)}};v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakSet,Ve=async function(e,p){t(this,u)||tt(this,u,new Map);let D=t(this,u).get(e);if(D===null)return null;if(D!=null&&D.bitmap)return D.refCounter+=1,D;try{D||(D={bitmap:null,id:`image_${t(this,v)}_${me(this,y)._++}`,refCounter:0,isSvg:!1});let j;if(typeof p=="string"){D.url=p;const q=await fetch(p);if(!q.ok)throw new Error(q.statusText);j=await q.blob()}else j=D.file=p;if(j.type==="image/svg+xml"){const q=C._isSVGFittingCanvas,it=new FileReader,bt=new Image,Ft=new Promise((Pt,Vt)=>{bt.onload=()=>{D.bitmap=bt,D.isSvg=!0,Pt()},it.onload=async()=>{const Rt=D.svgUrl=it.result;bt.src=await q?`${Rt}#svgView(preserveAspectRatio(none))`:Rt},bt.onerror=it.onerror=Vt});it.readAsDataURL(j),await Ft}else D.bitmap=await createImageBitmap(j);D.refCounter=1}catch(j){console.error(j),D=null}return t(this,u).set(e,D),D&&t(this,u).set(D.id,D),D};let B=C;class F{constructor(e=128){I(this,A,[]);I(this,a,!1);I(this,l,void 0);I(this,k,-1);tt(this,l,e)}add({cmd:e,undo:p,mustExec:D,type:j=NaN,overwriteIfSameType:q=!1,keepUndo:it=!1}){if(D&&e(),t(this,a))return;const bt={cmd:e,undo:p,type:j};if(t(this,k)===-1){t(this,A).length>0&&(t(this,A).length=0),tt(this,k,0),t(this,A).push(bt);return}if(q&&t(this,A)[t(this,k)].type===j){it&&(bt.undo=t(this,A)[t(this,k)].undo),t(this,A)[t(this,k)]=bt;return}const Ft=t(this,k)+1;Ft===t(this,l)?t(this,A).splice(0,1):(tt(this,k,Ft),Ft<t(this,A).length&&t(this,A).splice(Ft)),t(this,A).push(bt)}undo(){t(this,k)!==-1&&(tt(this,a,!0),t(this,A)[t(this,k)].undo(),tt(this,a,!1),tt(this,k,t(this,k)-1))}redo(){t(this,k)<t(this,A).length-1&&(tt(this,k,t(this,k)+1),tt(this,a,!0),t(this,A)[t(this,k)].cmd(),tt(this,a,!1))}hasSomethingToUndo(){return t(this,k)!==-1}hasSomethingToRedo(){return t(this,k)<t(this,A).length-1}destroy(){tt(this,A,null)}}A=new WeakMap,a=new WeakMap,l=new WeakMap,k=new WeakMap,d.CommandManager=F;class f{constructor(e){I(this,g);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:p}=h.FeatureTest.platform;for(const[D,j,q={}]of e)for(const it of D){const bt=it.startsWith("mac+");p&&bt?(this.callbacks.set(it.slice(4),{callback:j,options:q}),this.allKeys.add(it.split("+").at(-1))):!p&&!bt&&(this.callbacks.set(it,{callback:j,options:q}),this.allKeys.add(it.split("+").at(-1)))}}exec(e,p){if(!this.allKeys.has(p.key))return;const D=this.callbacks.get(W(this,g,Ci).call(this,p));if(!D)return;const{callback:j,options:{bubbles:q=!1,args:it=[],checker:bt=null}}=D;bt&&!bt(e,p)||(j.bind(e,...it)(),q||(p.stopPropagation(),p.preventDefault()))}}g=new WeakSet,Ci=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const p=this.buffer.join("+");return this.buffer.length=0,p},d.KeyboardManager=f;const T=class T{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,P.getColorValues)(e),(0,h.shadow)(this,"_colors",e)}convert(e){const p=(0,P.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return p;for(const[D,j]of this._colors)if(j.every((q,it)=>q===p[it]))return T._colorsMapping.get(D);return p}getHexCode(e){const p=this._colors.get(e);return p?h.Util.makeHexColor(...p):e}};ie(T,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=T;d.ColorManager=L;const Lt=class Lt{constructor(e,p,D,j,q,it){I(this,dt);I(this,Tt);I(this,Gt);I(this,Xt);I(this,zt);I(this,lt);I(this,G);I(this,yt);I(this,te);I(this,St);I(this,xt);I(this,Bt);I(this,At);I(this,m,null);I(this,U,new Map);I(this,V,new Map);I(this,E,null);I(this,$,null);I(this,st,new F);I(this,at,0);I(this,H,new Set);I(this,ct,null);I(this,gt,null);I(this,Ct,new Set);I(this,kt,null);I(this,S,new pt);I(this,i,!1);I(this,n,!1);I(this,s,null);I(this,o,h.AnnotationEditorType.NONE);I(this,c,new Set);I(this,b,null);I(this,M,this.blur.bind(this));I(this,N,this.focus.bind(this));I(this,et,this.copy.bind(this));I(this,Z,this.cut.bind(this));I(this,nt,this.paste.bind(this));I(this,ht,this.keydown.bind(this));I(this,vt,this.onEditingAction.bind(this));I(this,ut,this.onPageChanging.bind(this));I(this,Mt,this.onScaleChanging.bind(this));I(this,Ut,this.onRotationChanging.bind(this));I(this,Et,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});I(this,It,[0,0]);I(this,ft,null);I(this,J,null);I(this,Q,null);tt(this,J,e),tt(this,Q,p),tt(this,E,D),this._eventBus=j,this._eventBus._on("editingaction",t(this,vt)),this._eventBus._on("pagechanging",t(this,ut)),this._eventBus._on("scalechanging",t(this,Mt)),this._eventBus._on("rotationchanging",t(this,Ut)),tt(this,$,q.annotationStorage),tt(this,kt,q.filterFactory),tt(this,b,it),this.viewParameters={realScale:P.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const e=Lt.prototype,p=q=>{const{activeElement:it}=document;return it&&t(q,J).contains(it)&&q.hasSomethingToControl()},D=this.TRANSLATE_SMALL,j=this.TRANSLATE_BIG;return(0,h.shadow)(this,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-D,0],checker:p}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-j,0],checker:p}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[D,0],checker:p}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[j,0],checker:p}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-D],checker:p}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-j],checker:p}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,D],checker:p}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,j],checker:p}]]))}destroy(){W(this,Xt,Te).call(this),W(this,Tt,Xe).call(this),this._eventBus._off("editingaction",t(this,vt)),this._eventBus._off("pagechanging",t(this,ut)),this._eventBus._off("scalechanging",t(this,Mt)),this._eventBus._off("rotationchanging",t(this,Ut));for(const e of t(this,V).values())e.destroy();t(this,V).clear(),t(this,U).clear(),t(this,Ct).clear(),tt(this,m,null),t(this,c).clear(),t(this,st).destroy(),t(this,E).destroy()}get hcmFilter(){return(0,h.shadow)(this,"hcmFilter",t(this,b)?t(this,kt).addHCMFilter(t(this,b).foreground,t(this,b).background):"none")}get direction(){return(0,h.shadow)(this,"direction",getComputedStyle(t(this,J)).direction)}editAltText(e){var p;(p=t(this,E))==null||p.editAltText(this,e)}onPageChanging({pageNumber:e}){tt(this,at,e-1)}focusMainContainer(){t(this,J).focus()}findParent(e,p){for(const D of t(this,V).values()){const{x:j,y:q,width:it,height:bt}=D.div.getBoundingClientRect();if(e>=j&&e<=j+it&&p>=q&&p<=q+bt)return D}return null}disableUserSelect(e=!1){t(this,Q).classList.toggle("noUserSelect",e)}addShouldRescale(e){t(this,Ct).add(e)}removeShouldRescale(e){t(this,Ct).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*P.PixelsPerInch.PDF_TO_CSS_UNITS;for(const p of t(this,Ct))p.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&t(this,$)&&!t(this,$).has(e.id)&&t(this,$).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const p of t(this,c))if(p.div.contains(e)){tt(this,s,[p,e]),p._focusEventsAllowed=!1;break}}focus(){if(!t(this,s))return;const[e,p]=t(this,s);tt(this,s,null),p.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),p.focus()}addEditListeners(){W(this,Gt,$e).call(this),W(this,zt,qe).call(this)}removeEditListeners(){W(this,Xt,Te).call(this),W(this,lt,Ye).call(this)}copy(e){var D;if(e.preventDefault(),(D=t(this,m))==null||D.commitOrRemove(),!this.hasSelection)return;const p=[];for(const j of t(this,c)){const q=j.serialize(!0);q&&p.push(q)}p.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(p))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:p}=e;for(const q of p.items)for(const it of t(this,gt))if(it.isHandlingMimeForPasting(q.type)){it.paste(q,this.currentLayer);return}let D=p.getData("application/pdfjs");if(!D)return;try{D=JSON.parse(D)}catch(q){(0,h.warn)(`paste: "${q.message}".`);return}if(!Array.isArray(D))return;this.unselectAll();const j=this.currentLayer;try{const q=[];for(const Ft of D){const Pt=j.deserialize(Ft);if(!Pt)return;q.push(Pt)}const it=()=>{for(const Ft of q)W(this,xt,Ke).call(this,Ft);W(this,At,Je).call(this,q)},bt=()=>{for(const Ft of q)Ft.remove()};this.addCommands({cmd:it,undo:bt,mustExec:!0})}catch(q){(0,h.warn)(`paste: "${q.message}".`)}}keydown(e){var p;(p=this.getActive())!=null&&p.shouldGetKeyboardEvents()||Lt._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(W(this,dt,Ti).call(this),W(this,Gt,$e).call(this),W(this,zt,qe).call(this),W(this,G,ae).call(this,{isEditing:t(this,o)!==h.AnnotationEditorType.NONE,isEmpty:W(this,Bt,_e).call(this),hasSomethingToUndo:t(this,st).hasSomethingToUndo(),hasSomethingToRedo:t(this,st).hasSomethingToRedo(),hasSelectedEditor:!1})):(W(this,Tt,Xe).call(this),W(this,Xt,Te).call(this),W(this,lt,Ye).call(this),W(this,G,ae).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!t(this,gt)){tt(this,gt,e);for(const p of t(this,gt))W(this,yt,be).call(this,p.defaultPropertiesToUpdate)}}getId(){return t(this,S).getId()}get currentLayer(){return t(this,V).get(t(this,at))}getLayer(e){return t(this,V).get(e)}get currentPageIndex(){return t(this,at)}addLayer(e){t(this,V).set(e.pageIndex,e),t(this,i)?e.enable():e.disable()}removeLayer(e){t(this,V).delete(e.pageIndex)}updateMode(e,p=null){if(t(this,o)!==e){if(tt(this,o,e),e===h.AnnotationEditorType.NONE){this.setEditingState(!1),W(this,St,Pi).call(this);return}this.setEditingState(!0),W(this,te,xi).call(this),this.unselectAll();for(const D of t(this,V).values())D.updateMode(e);if(p){for(const D of t(this,U).values())if(D.annotationElementId===p){this.setSelected(D),D.enterInEditMode();break}}}}updateToolbar(e){e!==t(this,o)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,p){if(t(this,gt)){if(e===h.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const D of t(this,c))D.updateParams(e,p);for(const D of t(this,gt))D.updateDefaultParams(e,p)}}enableWaiting(e=!1){if(t(this,n)!==e){tt(this,n,e);for(const p of t(this,V).values())e?p.disableClick():p.enableClick(),p.div.classList.toggle("waiting",e)}}getEditors(e){const p=[];for(const D of t(this,U).values())D.pageIndex===e&&p.push(D);return p}getEditor(e){return t(this,U).get(e)}addEditor(e){t(this,U).set(e.id,e)}removeEditor(e){var p;t(this,U).delete(e.id),this.unselect(e),(!e.annotationElementId||!t(this,H).has(e.annotationElementId))&&((p=t(this,$))==null||p.remove(e.id))}addDeletedAnnotationElement(e){t(this,H).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return t(this,H).has(e)}removeDeletedAnnotationElement(e){t(this,H).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){t(this,m)!==e&&(tt(this,m,e),e&&W(this,yt,be).call(this,e.propertiesToUpdate))}toggleSelected(e){if(t(this,c).has(e)){t(this,c).delete(e),e.unselect(),W(this,G,ae).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,c).add(e),e.select(),W(this,yt,be).call(this,e.propertiesToUpdate),W(this,G,ae).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const p of t(this,c))p!==e&&p.unselect();t(this,c).clear(),t(this,c).add(e),e.select(),W(this,yt,be).call(this,e.propertiesToUpdate),W(this,G,ae).call(this,{hasSelectedEditor:!0})}isSelected(e){return t(this,c).has(e)}unselect(e){e.unselect(),t(this,c).delete(e),W(this,G,ae).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,c).size!==0}undo(){t(this,st).undo(),W(this,G,ae).call(this,{hasSomethingToUndo:t(this,st).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:W(this,Bt,_e).call(this)})}redo(){t(this,st).redo(),W(this,G,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,st).hasSomethingToRedo(),isEmpty:W(this,Bt,_e).call(this)})}addCommands(e){t(this,st).add(e),W(this,G,ae).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:W(this,Bt,_e).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...t(this,c)],p=()=>{for(const j of e)j.remove()},D=()=>{for(const j of e)W(this,xt,Ke).call(this,j)};this.addCommands({cmd:p,undo:D,mustExec:!0})}commitOrRemove(){var e;(e=t(this,m))==null||e.commitOrRemove()}hasSomethingToControl(){return t(this,m)||this.hasSelection}selectAll(){for(const e of t(this,c))e.commit();W(this,At,Je).call(this,t(this,U).values())}unselectAll(){if(t(this,m)){t(this,m).commitOrRemove();return}if(this.hasSelection){for(const e of t(this,c))e.unselect();t(this,c).clear(),W(this,G,ae).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,p,D=!1){if(D||this.commitOrRemove(),!this.hasSelection)return;t(this,It)[0]+=e,t(this,It)[1]+=p;const[j,q]=t(this,It),it=[...t(this,c)],bt=1e3;t(this,ft)&&clearTimeout(t(this,ft)),tt(this,ft,setTimeout(()=>{tt(this,ft,null),t(this,It)[0]=t(this,It)[1]=0,this.addCommands({cmd:()=>{for(const Ft of it)t(this,U).has(Ft.id)&&Ft.translateInPage(j,q)},undo:()=>{for(const Ft of it)t(this,U).has(Ft.id)&&Ft.translateInPage(-j,-q)},mustExec:!1})},bt));for(const Ft of it)Ft.translateInPage(e,p)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),tt(this,ct,new Map);for(const e of t(this,c))t(this,ct).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ct))return!1;this.disableUserSelect(!1);const e=t(this,ct);tt(this,ct,null);let p=!1;for(const[{x:j,y:q,pageIndex:it},bt]of e)bt.newX=j,bt.newY=q,bt.newPageIndex=it,p||(p=j!==bt.savedX||q!==bt.savedY||it!==bt.savedPageIndex);if(!p)return!1;const D=(j,q,it,bt)=>{if(t(this,U).has(j.id)){const Ft=t(this,V).get(bt);Ft?j._setParentAndPosition(Ft,q,it):(j.pageIndex=bt,j.x=q,j.y=it)}};return this.addCommands({cmd:()=>{for(const[j,{newX:q,newY:it,newPageIndex:bt}]of e)D(j,q,it,bt)},undo:()=>{for(const[j,{savedX:q,savedY:it,savedPageIndex:bt}]of e)D(j,q,it,bt)},mustExec:!0}),!0}dragSelectedEditors(e,p){if(t(this,ct))for(const D of t(this,ct).keys())D.drag(e,p)}rebuild(e){if(e.parent===null){const p=this.getLayer(e.pageIndex);p?(p.changeParent(e),p.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return t(this,m)===e}getActive(){return t(this,m)}getMode(){return t(this,o)}get imageManager(){return(0,h.shadow)(this,"imageManager",new B)}};m=new WeakMap,U=new WeakMap,V=new WeakMap,E=new WeakMap,$=new WeakMap,st=new WeakMap,at=new WeakMap,H=new WeakMap,ct=new WeakMap,gt=new WeakMap,Ct=new WeakMap,kt=new WeakMap,S=new WeakMap,i=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,c=new WeakMap,b=new WeakMap,M=new WeakMap,N=new WeakMap,et=new WeakMap,Z=new WeakMap,nt=new WeakMap,ht=new WeakMap,vt=new WeakMap,ut=new WeakMap,Mt=new WeakMap,Ut=new WeakMap,Et=new WeakMap,It=new WeakMap,ft=new WeakMap,J=new WeakMap,Q=new WeakMap,dt=new WeakSet,Ti=function(){window.addEventListener("focus",t(this,N)),window.addEventListener("blur",t(this,M))},Tt=new WeakSet,Xe=function(){window.removeEventListener("focus",t(this,N)),window.removeEventListener("blur",t(this,M))},Gt=new WeakSet,$e=function(){window.addEventListener("keydown",t(this,ht),{capture:!0})},Xt=new WeakSet,Te=function(){window.removeEventListener("keydown",t(this,ht),{capture:!0})},zt=new WeakSet,qe=function(){document.addEventListener("copy",t(this,et)),document.addEventListener("cut",t(this,Z)),document.addEventListener("paste",t(this,nt))},lt=new WeakSet,Ye=function(){document.removeEventListener("copy",t(this,et)),document.removeEventListener("cut",t(this,Z)),document.removeEventListener("paste",t(this,nt))},G=new WeakSet,ae=function(e){Object.entries(e).some(([D,j])=>t(this,Et)[D]!==j)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Et),e)})},yt=new WeakSet,be=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},te=new WeakSet,xi=function(){if(!t(this,i)){tt(this,i,!0);for(const e of t(this,V).values())e.enable()}},St=new WeakSet,Pi=function(){if(this.unselectAll(),t(this,i)){tt(this,i,!1);for(const e of t(this,V).values())e.disable()}},xt=new WeakSet,Ke=function(e){const p=t(this,V).get(e.pageIndex);p?p.addOrRebuild(e):this.addEditor(e)},Bt=new WeakSet,_e=function(){if(t(this,U).size===0)return!0;if(t(this,U).size===1)for(const e of t(this,U).values())return e.isEmpty();return!1},At=new WeakSet,Je=function(e){t(this,c).clear();for(const p of e)p.isEmpty()||(t(this,c).add(p),p.select());W(this,G,ae).call(this,{hasSelectedEditor:!0})},ie(Lt,"TRANSLATE_SMALL",1),ie(Lt,"TRANSLATE_BIG",10);let O=Lt;d.AnnotationEditorUIManager=O},(mt,d,ot)=>{var at,H,ct,gt,Ct,kt,S,i,n,s,o,c,ue,M,fe,et,Qe,nt,xe,vt,Pe,Mt,Ae,Et,ye;Object.defineProperty(d,"__esModule",{value:!0}),d.StatTimer=d.RenderingCancelledException=d.PixelsPerInch=d.PageViewport=d.PDFDateString=d.DOMStandardFontDataFactory=d.DOMSVGFactory=d.DOMFilterFactory=d.DOMCanvasFactory=d.DOMCMapReaderFactory=void 0,d.deprecated=k,d.getColorValues=U,d.getCurrentTransform=V,d.getCurrentTransformInverse=E,d.getFilenameFromUrl=_,d.getPdfFilenameFromUrl=w,d.getRGB=m,d.getXfaPageViewport=T,d.isDataScheme=y,d.isPdfFile=u,d.isValidFetchUrl=A,d.loadScript=l,d.noContextMenu=a,d.setLayerDimensions=$;var h=ot(7),P=ot(1);const rt="http://www.w3.org/2000/svg",st=class st{};ie(st,"CSS",96),ie(st,"PDF",72),ie(st,"PDF_TO_CSS_UNITS",st.CSS/st.PDF);let X=st;d.PixelsPerInch=X;class pt extends h.BaseFilterFactory{constructor({docId:Q,ownerDocument:dt=globalThis.document}={}){super();I(this,c);I(this,M);I(this,et);I(this,nt);I(this,vt);I(this,Mt);I(this,Et);I(this,at,void 0);I(this,H,void 0);I(this,ct,void 0);I(this,gt,void 0);I(this,Ct,void 0);I(this,kt,void 0);I(this,S,void 0);I(this,i,void 0);I(this,n,void 0);I(this,s,void 0);I(this,o,0);tt(this,ct,Q),tt(this,gt,dt)}addFilter(Q){if(!Q)return"none";let dt=t(this,c,ue).get(Q);if(dt)return dt;let wt,Tt,jt,Gt;if(Q.length===1){const zt=Q[0],Yt=new Array(256);for(let lt=0;lt<256;lt++)Yt[lt]=zt[lt]/255;Gt=wt=Tt=jt=Yt.join(",")}else{const[zt,Yt,lt]=Q,K=new Array(256),G=new Array(256),_t=new Array(256);for(let yt=0;yt<256;yt++)K[yt]=zt[yt]/255,G[yt]=Yt[yt]/255,_t[yt]=lt[yt]/255;wt=K.join(","),Tt=G.join(","),jt=_t.join(","),Gt=`${wt}${Tt}${jt}`}if(dt=t(this,c,ue).get(Gt),dt)return t(this,c,ue).set(Q,dt),dt;const Wt=`g_${t(this,ct)}_transfer_map_${me(this,o)._++}`,Xt=`url(#${Wt})`;t(this,c,ue).set(Q,Xt),t(this,c,ue).set(Gt,Xt);const $t=W(this,nt,xe).call(this,Wt);return W(this,Mt,Ae).call(this,wt,Tt,jt,$t),Xt}addHCMFilter(Q,dt){var Yt;const wt=`${Q}-${dt}`;if(t(this,kt)===wt)return t(this,S);if(tt(this,kt,wt),tt(this,S,"none"),(Yt=t(this,Ct))==null||Yt.remove(),!Q||!dt)return t(this,S);const Tt=W(this,Et,ye).call(this,Q);Q=P.Util.makeHexColor(...Tt);const jt=W(this,Et,ye).call(this,dt);if(dt=P.Util.makeHexColor(...jt),t(this,M,fe).style.color="",Q==="#000000"&&dt==="#ffffff"||Q===dt)return t(this,S);const Gt=new Array(256);for(let lt=0;lt<=255;lt++){const K=lt/255;Gt[lt]=K<=.03928?K/12.92:((K+.055)/1.055)**2.4}const Wt=Gt.join(","),Xt=`g_${t(this,ct)}_hcm_filter`,$t=tt(this,i,W(this,nt,xe).call(this,Xt));W(this,Mt,Ae).call(this,Wt,Wt,Wt,$t),W(this,et,Qe).call(this,$t);const zt=(lt,K)=>{const G=Tt[lt]/255,_t=jt[lt]/255,yt=new Array(K+1);for(let ee=0;ee<=K;ee++)yt[ee]=G+ee/K*(_t-G);return yt.join(",")};return W(this,Mt,Ae).call(this,zt(0,5),zt(1,5),zt(2,5),$t),tt(this,S,`url(#${Xt})`),t(this,S)}addHighlightHCMFilter(Q,dt,wt,Tt){var _t;const jt=`${Q}-${dt}-${wt}-${Tt}`;if(t(this,n)===jt)return t(this,s);if(tt(this,n,jt),tt(this,s,"none"),(_t=t(this,i))==null||_t.remove(),!Q||!dt)return t(this,s);const[Gt,Wt]=[Q,dt].map(W(this,Et,ye).bind(this));let Xt=Math.round(.2126*Gt[0]+.7152*Gt[1]+.0722*Gt[2]),$t=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),[zt,Yt]=[wt,Tt].map(W(this,Et,ye).bind(this));$t<Xt&&([Xt,$t,zt,Yt]=[$t,Xt,Yt,zt]),t(this,M,fe).style.color="";const lt=(yt,ee,te)=>{const Y=new Array(256),St=($t-Xt)/te,Ot=yt/255,xt=(ee-yt)/(255*te);let Nt=0;for(let Bt=0;Bt<=te;Bt++){const Qt=Math.round(Xt+Bt*St),At=Ot+Bt*xt;for(let Kt=Nt;Kt<=Qt;Kt++)Y[Kt]=At;Nt=Qt+1}for(let Bt=Nt;Bt<256;Bt++)Y[Bt]=Y[Nt-1];return Y.join(",")},K=`g_${t(this,ct)}_hcm_highlight_filter`,G=tt(this,i,W(this,nt,xe).call(this,K));return W(this,et,Qe).call(this,G),W(this,Mt,Ae).call(this,lt(zt[0],Yt[0],5),lt(zt[1],Yt[1],5),lt(zt[2],Yt[2],5),G),tt(this,s,`url(#${K})`),t(this,s)}destroy(Q=!1){Q&&(t(this,S)||t(this,s))||(t(this,H)&&(t(this,H).parentNode.parentNode.remove(),tt(this,H,null)),t(this,at)&&(t(this,at).clear(),tt(this,at,null)),tt(this,o,0))}}at=new WeakMap,H=new WeakMap,ct=new WeakMap,gt=new WeakMap,Ct=new WeakMap,kt=new WeakMap,S=new WeakMap,i=new WeakMap,n=new WeakMap,s=new WeakMap,o=new WeakMap,c=new WeakSet,ue=function(){return t(this,at)||tt(this,at,new Map)},M=new WeakSet,fe=function(){if(!t(this,H)){const Q=t(this,gt).createElement("div"),{style:dt}=Q;dt.visibility="hidden",dt.contain="strict",dt.width=dt.height=0,dt.position="absolute",dt.top=dt.left=0,dt.zIndex=-1;const wt=t(this,gt).createElementNS(rt,"svg");wt.setAttribute("width",0),wt.setAttribute("height",0),tt(this,H,t(this,gt).createElementNS(rt,"defs")),Q.append(wt),wt.append(t(this,H)),t(this,gt).body.append(Q)}return t(this,H)},et=new WeakSet,Qe=function(Q){const dt=t(this,gt).createElementNS(rt,"feColorMatrix");dt.setAttribute("type","matrix"),dt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Q.append(dt)},nt=new WeakSet,xe=function(Q){const dt=t(this,gt).createElementNS(rt,"filter");return dt.setAttribute("color-interpolation-filters","sRGB"),dt.setAttribute("id",Q),t(this,M,fe).append(dt),dt},vt=new WeakSet,Pe=function(Q,dt,wt){const Tt=t(this,gt).createElementNS(rt,dt);Tt.setAttribute("type","discrete"),Tt.setAttribute("tableValues",wt),Q.append(Tt)},Mt=new WeakSet,Ae=function(Q,dt,wt,Tt){const jt=t(this,gt).createElementNS(rt,"feComponentTransfer");Tt.append(jt),W(this,vt,Pe).call(this,jt,"feFuncR",Q),W(this,vt,Pe).call(this,jt,"feFuncG",dt),W(this,vt,Pe).call(this,jt,"feFuncB",wt)},Et=new WeakSet,ye=function(Q){return t(this,M,fe).style.color=Q,m(getComputedStyle(t(this,M,fe)).getPropertyValue("color"))},d.DOMFilterFactory=pt;class B extends h.BaseCanvasFactory{constructor({ownerDocument:J=globalThis.document}={}){super(),this._document=J}_createCanvas(J,Q){const dt=this._document.createElement("canvas");return dt.width=J,dt.height=Q,dt}}d.DOMCanvasFactory=B;async function F(ft,J=!1){if(A(ft,document.baseURI)){const Q=await fetch(ft);if(!Q.ok)throw new Error(Q.statusText);return J?new Uint8Array(await Q.arrayBuffer()):(0,P.stringToBytes)(await Q.text())}return new Promise((Q,dt)=>{const wt=new XMLHttpRequest;wt.open("GET",ft,!0),J&&(wt.responseType="arraybuffer"),wt.onreadystatechange=()=>{if(wt.readyState===XMLHttpRequest.DONE){if(wt.status===200||wt.status===0){let Tt;if(J&&wt.response?Tt=new Uint8Array(wt.response):!J&&wt.responseText&&(Tt=(0,P.stringToBytes)(wt.responseText)),Tt){Q(Tt);return}}dt(new Error(wt.statusText))}},wt.send(null)})}class f extends h.BaseCMapReaderFactory{_fetchData(J,Q){return F(J,this.isCompressed).then(dt=>({cMapData:dt,compressionType:Q}))}}d.DOMCMapReaderFactory=f;class L extends h.BaseStandardFontDataFactory{_fetchData(J){return F(J,!0)}}d.DOMStandardFontDataFactory=L;class O extends h.BaseSVGFactory{_createSVG(J){return document.createElementNS(rt,J)}}d.DOMSVGFactory=O;class x{constructor({viewBox:J,scale:Q,rotation:dt,offsetX:wt=0,offsetY:Tt=0,dontFlip:jt=!1}){this.viewBox=J,this.scale=Q,this.rotation=dt,this.offsetX=wt,this.offsetY=Tt;const Gt=(J[2]+J[0])/2,Wt=(J[3]+J[1])/2;let Xt,$t,zt,Yt;switch(dt%=360,dt<0&&(dt+=360),dt){case 180:Xt=-1,$t=0,zt=0,Yt=1;break;case 90:Xt=0,$t=1,zt=1,Yt=0;break;case 270:Xt=0,$t=-1,zt=-1,Yt=0;break;case 0:Xt=1,$t=0,zt=0,Yt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}jt&&(zt=-zt,Yt=-Yt);let lt,K,G,_t;Xt===0?(lt=Math.abs(Wt-J[1])*Q+wt,K=Math.abs(Gt-J[0])*Q+Tt,G=(J[3]-J[1])*Q,_t=(J[2]-J[0])*Q):(lt=Math.abs(Gt-J[0])*Q+wt,K=Math.abs(Wt-J[1])*Q+Tt,G=(J[2]-J[0])*Q,_t=(J[3]-J[1])*Q),this.transform=[Xt*Q,$t*Q,zt*Q,Yt*Q,lt-Xt*Q*Gt-zt*Q*Wt,K-$t*Q*Gt-Yt*Q*Wt],this.width=G,this.height=_t}get rawDims(){const{viewBox:J}=this;return(0,P.shadow)(this,"rawDims",{pageWidth:J[2]-J[0],pageHeight:J[3]-J[1],pageX:J[0],pageY:J[1]})}clone({scale:J=this.scale,rotation:Q=this.rotation,offsetX:dt=this.offsetX,offsetY:wt=this.offsetY,dontFlip:Tt=!1}={}){return new x({viewBox:this.viewBox.slice(),scale:J,rotation:Q,offsetX:dt,offsetY:wt,dontFlip:Tt})}convertToViewportPoint(J,Q){return P.Util.applyTransform([J,Q],this.transform)}convertToViewportRectangle(J){const Q=P.Util.applyTransform([J[0],J[1]],this.transform),dt=P.Util.applyTransform([J[2],J[3]],this.transform);return[Q[0],Q[1],dt[0],dt[1]]}convertToPdfPoint(J,Q){return P.Util.applyInverseTransform([J,Q],this.transform)}}d.PageViewport=x;class v extends P.BaseException{constructor(J,Q=0){super(J,"RenderingCancelledException"),this.extraDelay=Q}}d.RenderingCancelledException=v;function y(ft){const J=ft.length;let Q=0;for(;Q<J&&ft[Q].trim()==="";)Q++;return ft.substring(Q,Q+5).toLowerCase()==="data:"}function u(ft){return typeof ft=="string"&&/\.pdf$/i.test(ft)}function _(ft,J=!1){return J||([ft]=ft.split(/[#?]/,1)),ft.substring(ft.lastIndexOf("/")+1)}function w(ft,J="document.pdf"){if(typeof ft!="string")return J;if(y(ft))return(0,P.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),J;const Q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,dt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,wt=Q.exec(ft);let Tt=dt.exec(wt[1])||dt.exec(wt[2])||dt.exec(wt[3]);if(Tt&&(Tt=Tt[0],Tt.includes("%")))try{Tt=dt.exec(decodeURIComponent(Tt))[0]}catch{}return Tt||J}class C{constructor(){ie(this,"started",Object.create(null));ie(this,"times",[])}time(J){J in this.started&&(0,P.warn)(`Timer is already running for ${J}`),this.started[J]=Date.now()}timeEnd(J){J in this.started||(0,P.warn)(`Timer has not been started for ${J}`),this.times.push({name:J,start:this.started[J],end:Date.now()}),delete this.started[J]}toString(){const J=[];let Q=0;for(const{name:dt}of this.times)Q=Math.max(dt.length,Q);for(const{name:dt,start:wt,end:Tt}of this.times)J.push(`${dt.padEnd(Q)} ${Tt-wt}ms
`);return J.join("")}}d.StatTimer=C;function A(ft,J){try{const{protocol:Q}=J?new URL(ft,J):new URL(ft);return Q==="http:"||Q==="https:"}catch{return!1}}function a(ft){ft.preventDefault()}function l(ft,J=!1){return new Promise((Q,dt)=>{const wt=document.createElement("script");wt.src=ft,wt.onload=function(Tt){J&&wt.remove(),Q(Tt)},wt.onerror=function(){dt(new Error(`Cannot load script at: ${wt.src}`))},(document.head||document.documentElement).append(wt)})}function k(ft){console.log("Deprecated API usage: "+ft)}let g;class r{static toDateObject(J){if(!J||typeof J!="string")return null;g||(g=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Q=g.exec(J);if(!Q)return null;const dt=parseInt(Q[1],10);let wt=parseInt(Q[2],10);wt=wt>=1&&wt<=12?wt-1:0;let Tt=parseInt(Q[3],10);Tt=Tt>=1&&Tt<=31?Tt:1;let jt=parseInt(Q[4],10);jt=jt>=0&&jt<=23?jt:0;let Gt=parseInt(Q[5],10);Gt=Gt>=0&&Gt<=59?Gt:0;let Wt=parseInt(Q[6],10);Wt=Wt>=0&&Wt<=59?Wt:0;const Xt=Q[7]||"Z";let $t=parseInt(Q[8],10);$t=$t>=0&&$t<=23?$t:0;let zt=parseInt(Q[9],10)||0;return zt=zt>=0&&zt<=59?zt:0,Xt==="-"?(jt+=$t,Gt+=zt):Xt==="+"&&(jt-=$t,Gt-=zt),new Date(Date.UTC(dt,wt,Tt,jt,Gt,Wt))}}d.PDFDateString=r;function T(ft,{scale:J=1,rotation:Q=0}){const{width:dt,height:wt}=ft.attributes.style,Tt=[0,0,parseInt(dt),parseInt(wt)];return new x({viewBox:Tt,scale:J,rotation:Q})}function m(ft){if(ft.startsWith("#")){const J=parseInt(ft.slice(1),16);return[(J&16711680)>>16,(J&65280)>>8,J&255]}return ft.startsWith("rgb(")?ft.slice(4,-1).split(",").map(J=>parseInt(J)):ft.startsWith("rgba(")?ft.slice(5,-1).split(",").map(J=>parseInt(J)).slice(0,3):((0,P.warn)(`Not a valid color format: "${ft}"`),[0,0,0])}function U(ft){const J=document.createElement("span");J.style.visibility="hidden",document.body.append(J);for(const Q of ft.keys()){J.style.color=Q;const dt=window.getComputedStyle(J).color;ft.set(Q,m(dt))}J.remove()}function V(ft){const{a:J,b:Q,c:dt,d:wt,e:Tt,f:jt}=ft.getTransform();return[J,Q,dt,wt,Tt,jt]}function E(ft){const{a:J,b:Q,c:dt,d:wt,e:Tt,f:jt}=ft.getTransform().invertSelf();return[J,Q,dt,wt,Tt,jt]}function $(ft,J,Q=!1,dt=!0){if(J instanceof x){const{pageWidth:wt,pageHeight:Tt}=J.rawDims,{style:jt}=ft,Gt=P.FeatureTest.isCSSRoundSupported,Wt=`var(--scale-factor) * ${wt}px`,Xt=`var(--scale-factor) * ${Tt}px`,$t=Gt?`round(${Wt}, 1px)`:`calc(${Wt})`,zt=Gt?`round(${Xt}, 1px)`:`calc(${Xt})`;!Q||J.rotation%180===0?(jt.width=$t,jt.height=zt):(jt.width=zt,jt.height=$t)}dt&&ft.setAttribute("data-main-rotation",J.rotation)}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.BaseStandardFontDataFactory=d.BaseSVGFactory=d.BaseFilterFactory=d.BaseCanvasFactory=d.BaseCMapReaderFactory=void 0;var h=ot(1);class P{constructor(){this.constructor===P&&(0,h.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,L){return"none"}addHighlightHCMFilter(f,L,O,x){return"none"}destroy(f=!1){}}d.BaseFilterFactory=P;class rt{constructor(){this.constructor===rt&&(0,h.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,L){if(f<=0||L<=0)throw new Error("Invalid canvas size");const O=this._createCanvas(f,L);return{canvas:O,context:O.getContext("2d")}}reset(f,L,O){if(!f.canvas)throw new Error("Canvas is not specified");if(L<=0||O<=0)throw new Error("Invalid canvas size");f.canvas.width=L,f.canvas.height=O}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,L){(0,h.unreachable)("Abstract method `_createCanvas` called.")}}d.BaseCanvasFactory=rt;class X{constructor({baseUrl:f=null,isCompressed:L=!0}){this.constructor===X&&(0,h.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=L}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const L=this.baseUrl+f+(this.isCompressed?".bcmap":""),O=this.isCompressed?h.CMapCompressionType.BINARY:h.CMapCompressionType.NONE;return this._fetchData(L,O).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${L}`)})}_fetchData(f,L){(0,h.unreachable)("Abstract method `_fetchData` called.")}}d.BaseCMapReaderFactory=X;class pt{constructor({baseUrl:f=null}){this.constructor===pt&&(0,h.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const L=`${this.baseUrl}${f}`;return this._fetchData(L).catch(O=>{throw new Error(`Unable to load font data at: ${L}`)})}_fetchData(f){(0,h.unreachable)("Abstract method `_fetchData` called.")}}d.BaseStandardFontDataFactory=pt;class B{constructor(){this.constructor===B&&(0,h.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,L,O=!1){if(f<=0||L<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),O||(x.setAttribute("width",`${f}px`),x.setAttribute("height",`${L}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${f} ${L}`),x}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,h.unreachable)("Abstract method `_createSVG` called.")}}d.BaseSVGFactory=B},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.MurmurHash3_64=void 0;var h=ot(1);const P=3285377520,rt=4294901760,X=65535;class pt{constructor(F){this.h1=F?F&4294967295:P,this.h2=F?F&4294967295:P}update(F){let f,L;if(typeof F=="string"){f=new Uint8Array(F.length*2),L=0;for(let k=0,g=F.length;k<g;k++){const r=F.charCodeAt(k);r<=255?f[L++]=r:(f[L++]=r>>>8,f[L++]=r&255)}}else if((0,h.isArrayBuffer)(F))f=F.slice(),L=f.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const O=L>>2,x=L-O*4,v=new Uint32Array(f.buffer,0,O);let y=0,u=0,_=this.h1,w=this.h2;const C=3432918353,A=461845907,a=C&X,l=A&X;for(let k=0;k<O;k++)k&1?(y=v[k],y=y*C&rt|y*a&X,y=y<<15|y>>>17,y=y*A&rt|y*l&X,_^=y,_=_<<13|_>>>19,_=_*5+3864292196):(u=v[k],u=u*C&rt|u*a&X,u=u<<15|u>>>17,u=u*A&rt|u*l&X,w^=u,w=w<<13|w>>>19,w=w*5+3864292196);switch(y=0,x){case 3:y^=f[O*4+2]<<16;case 2:y^=f[O*4+1]<<8;case 1:y^=f[O*4],y=y*C&rt|y*a&X,y=y<<15|y>>>17,y=y*A&rt|y*l&X,O&1?_^=y:w^=y}this.h1=_,this.h2=w}hexdigest(){let F=this.h1,f=this.h2;return F^=f>>>1,F=F*3981806797&rt|F*36045&X,f=f*4283543511&rt|((f<<16|F>>>16)*2950163797&rt)>>>16,F^=f>>>1,F=F*444984403&rt|F*60499&X,f=f*3301882366&rt|((f<<16|F>>>16)*3120437893&rt)>>>16,F^=f>>>1,(F>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}d.MurmurHash3_64=pt},(mt,d,ot)=>{var X;Object.defineProperty(d,"__esModule",{value:!0}),d.FontLoader=d.FontFaceObject=void 0;var h=ot(1);class P{constructor({ownerDocument:B=globalThis.document,styleElement:F=null}){I(this,X,new Set);this._document=B,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(B){this.nativeFontFaces.add(B),this._document.fonts.add(B)}removeNativeFontFace(B){this.nativeFontFaces.delete(B),this._document.fonts.delete(B)}insertRule(B){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const F=this.styleElement.sheet;F.insertRule(B,F.cssRules.length)}clear(){for(const B of this.nativeFontFaces)this._document.fonts.delete(B);this.nativeFontFaces.clear(),t(this,X).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(B){if(!(!B||t(this,X).has(B.loadedName))){if((0,h.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:F,src:f,style:L}=B,O=new FontFace(F,f,L);this.addNativeFontFace(O);try{await O.load(),t(this,X).add(F)}catch{(0,h.warn)(`Cannot load system font: ${B.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(O)}return}(0,h.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(B){if(B.attached||B.missingFile&&!B.systemFontInfo)return;if(B.attached=!0,B.systemFontInfo){await this.loadSystemFont(B.systemFontInfo);return}if(this.isFontLoadingAPISupported){const f=B.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(L){throw(0,h.warn)(`Failed to load font '${f.family}': '${L}'.`),B.disableFontFace=!0,L}}return}const F=B.createFontFaceRule();if(F){if(this.insertRule(F),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const L=this._queueLoadingCallback(f);this._prepareFontLoadEvent(B,L)})}}get isFontLoadingAPISupported(){var F;const B=!!((F=this._document)!=null&&F.fonts);return(0,h.shadow)(this,"isFontLoadingAPISupported",B)}get isSyncFontLoadingSupported(){let B=!1;return(h.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(B=!0),(0,h.shadow)(this,"isSyncFontLoadingSupported",B)}_queueLoadingCallback(B){function F(){for((0,h.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;f.length>0&&f[0].done;){const O=f.shift();setTimeout(O.callback,0)}}const{loadingRequests:f}=this,L={done:!1,complete:F,callback:B};return f.push(L),L}get _loadTestFont(){const B=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,h.shadow)(this,"_loadTestFont",B)}_prepareFontLoadEvent(B,F){function f(m,U){return m.charCodeAt(U)<<24|m.charCodeAt(U+1)<<16|m.charCodeAt(U+2)<<8|m.charCodeAt(U+3)&255}function L(m,U,V,E){const $=m.substring(0,U),st=m.substring(U+V);return $+E+st}let O,x;const v=this._document.createElement("canvas");v.width=1,v.height=1;const y=v.getContext("2d");let u=0;function _(m,U){if(++u>30){(0,h.warn)("Load test font never loaded."),U();return}if(y.font="30px "+m,y.fillText(".",0,20),y.getImageData(0,0,1,1).data[3]>0){U();return}setTimeout(_.bind(null,m,U))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=L(C,976,w.length,w);const a=16,l=1482184792;let k=f(C,a);for(O=0,x=w.length-3;O<x;O+=4)k=k-l+f(w,O)|0;O<w.length&&(k=k-l+f(w+"XXX",O)|0),C=L(C,a,4,(0,h.string32)(k));const g=`url(data:font/opentype;base64,${btoa(C)});`,r=`@font-face {font-family:"${w}";src:${g}}`;this.insertRule(r);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const m of[B.loadedName,w]){const U=this._document.createElement("span");U.textContent="Hi",U.style.fontFamily=m,T.append(U)}this._document.body.append(T),_(w,()=>{T.remove(),F.complete()})}}X=new WeakMap,d.FontLoader=P;class rt{constructor(B,{isEvalSupported:F=!0,disableFontFace:f=!1,ignoreErrors:L=!1,inspectFont:O=null}){this.compiledGlyphs=Object.create(null);for(const x in B)this[x]=B[x];this.isEvalSupported=F!==!1,this.disableFontFace=f===!0,this.ignoreErrors=L===!0,this._inspectFont=O}createNativeFontFace(){var F;if(!this.data||this.disableFontFace)return null;let B;if(!this.cssFontInfo)B=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),B=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return(F=this._inspectFont)==null||F.call(this,this),B}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const B=(0,h.bytesToString)(this.data),F=`url(data:${this.mimetype};base64,${btoa(B)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${F}}`;else{let O=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(O+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${O}src:${F}}`}return(L=this._inspectFont)==null||L.call(this,this,F),f}getPathGenerator(B,F){if(this.compiledGlyphs[F]!==void 0)return this.compiledGlyphs[F];let f;try{f=B.get(this.loadedName+"_path_"+F)}catch(L){if(!this.ignoreErrors)throw L;return(0,h.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[F]=function(O,x){}}if(this.isEvalSupported&&h.FeatureTest.isEvalSupported){const L=[];for(const O of f){const x=O.args!==void 0?O.args.join(","):"";L.push("c.",O.cmd,"(",x,`);
`)}return this.compiledGlyphs[F]=new Function("c","size",L.join(""))}return this.compiledGlyphs[F]=function(L,O){for(const x of f)x.cmd==="scale"&&(x.args=[O,-O]),L[x.cmd].apply(L,x.args)}}}d.FontFaceObject=rt},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NodeStandardFontDataFactory=d.NodeFilterFactory=d.NodeCanvasFactory=d.NodeCMapReaderFactory=void 0;var h=ot(7);ot(1);const P=function(F){return new Promise((f,L)=>{require$$5.readFile(F,(x,v)=>{if(x||!v){L(new Error(x));return}f(new Uint8Array(v))})})};class rt extends h.BaseFilterFactory{}d.NodeFilterFactory=rt;class X extends h.BaseCanvasFactory{_createCanvas(f,L){return require$$5.createCanvas(f,L)}}d.NodeCanvasFactory=X;class pt extends h.BaseCMapReaderFactory{_fetchData(f,L){return P(f).then(O=>({cMapData:O,compressionType:L}))}}d.NodeCMapReaderFactory=pt;class B extends h.BaseStandardFontDataFactory{_fetchData(f){return P(f)}}d.NodeStandardFontDataFactory=B},(mt,d,ot)=>{var H,Ze,gt,ti;Object.defineProperty(d,"__esModule",{value:!0}),d.CanvasGraphics=void 0;var h=ot(1),P=ot(6),rt=ot(12),X=ot(13);const pt=16,B=100,F=4096,f=15,L=10,O=1e3,x=16;function v(S,i){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){i.save(),this.__originalSave()},S.restore=function(){i.restore(),this.__originalRestore()},S.translate=function(s,o){i.translate(s,o),this.__originalTranslate(s,o)},S.scale=function(s,o){i.scale(s,o),this.__originalScale(s,o)},S.transform=function(s,o,c,b,M,N){i.transform(s,o,c,b,M,N),this.__originalTransform(s,o,c,b,M,N)},S.setTransform=function(s,o,c,b,M,N){i.setTransform(s,o,c,b,M,N),this.__originalSetTransform(s,o,c,b,M,N)},S.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},S.rotate=function(s){i.rotate(s),this.__originalRotate(s)},S.clip=function(s){i.clip(s),this.__originalClip(s)},S.moveTo=function(n,s){i.moveTo(n,s),this.__originalMoveTo(n,s)},S.lineTo=function(n,s){i.lineTo(n,s),this.__originalLineTo(n,s)},S.bezierCurveTo=function(n,s,o,c,b,M){i.bezierCurveTo(n,s,o,c,b,M),this.__originalBezierCurveTo(n,s,o,c,b,M)},S.rect=function(n,s,o,c){i.rect(n,s,o,c),this.__originalRect(n,s,o,c)},S.closePath=function(){i.closePath(),this.__originalClosePath()},S.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class y{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,n,s){let o;return this.cache[i]!==void 0?(o=this.cache[i],this.canvasFactory.reset(o,n,s)):(o=this.canvasFactory.create(n,s),this.cache[i]=o),o}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const n=this.cache[i];this.canvasFactory.destroy(n),delete this.cache[i]}}}function u(S,i,n,s,o,c,b,M,N,et){const[Z,nt,ht,vt,ut,Mt]=(0,P.getCurrentTransform)(S);if(nt===0&&ht===0){const It=b*Z+ut,ft=Math.round(It),J=M*vt+Mt,Q=Math.round(J),dt=(b+N)*Z+ut,wt=Math.abs(Math.round(dt)-ft)||1,Tt=(M+et)*vt+Mt,jt=Math.abs(Math.round(Tt)-Q)||1;return S.setTransform(Math.sign(Z),0,0,Math.sign(vt),ft,Q),S.drawImage(i,n,s,o,c,0,0,wt,jt),S.setTransform(Z,nt,ht,vt,ut,Mt),[wt,jt]}if(Z===0&&vt===0){const It=M*ht+ut,ft=Math.round(It),J=b*nt+Mt,Q=Math.round(J),dt=(M+et)*ht+ut,wt=Math.abs(Math.round(dt)-ft)||1,Tt=(b+N)*nt+Mt,jt=Math.abs(Math.round(Tt)-Q)||1;return S.setTransform(0,Math.sign(nt),Math.sign(ht),0,ft,Q),S.drawImage(i,n,s,o,c,0,0,jt,wt),S.setTransform(Z,nt,ht,vt,ut,Mt),[jt,wt]}S.drawImage(i,n,s,o,c,b,M,N,et);const Ut=Math.hypot(Z,nt),Et=Math.hypot(ht,vt);return[Ut*N,Et*et]}function _(S){const{width:i,height:n}=S;if(i>O||n>O)return null;const s=1e3,o=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),c=i+1;let b=new Uint8Array(c*(n+1)),M,N,et;const Z=i+7&-8;let nt=new Uint8Array(Z*n),ht=0;for(const Et of S.data){let It=128;for(;It>0;)nt[ht++]=Et&It?0:255,It>>=1}let vt=0;for(ht=0,nt[ht]!==0&&(b[0]=1,++vt),N=1;N<i;N++)nt[ht]!==nt[ht+1]&&(b[N]=nt[ht]?2:1,++vt),ht++;for(nt[ht]!==0&&(b[N]=2,++vt),M=1;M<n;M++){ht=M*Z,et=M*c,nt[ht-Z]!==nt[ht]&&(b[et]=nt[ht]?1:8,++vt);let Et=(nt[ht]?4:0)+(nt[ht-Z]?8:0);for(N=1;N<i;N++)Et=(Et>>2)+(nt[ht+1]?4:0)+(nt[ht-Z+1]?8:0),o[Et]&&(b[et+N]=o[Et],++vt),ht++;if(nt[ht-Z]!==nt[ht]&&(b[et+N]=nt[ht]?2:4,++vt),vt>s)return null}for(ht=Z*(n-1),et=M*c,nt[ht]!==0&&(b[et]=8,++vt),N=1;N<i;N++)nt[ht]!==nt[ht+1]&&(b[et+N]=nt[ht]?4:8,++vt),ht++;if(nt[ht]!==0&&(b[et+N]=4,++vt),vt>s)return null;const ut=new Int32Array([0,c,-1,0,-c,0,0,0,1]),Mt=new Path2D;for(M=0;vt&&M<=n;M++){let Et=M*c;const It=Et+i;for(;Et<It&&!b[Et];)Et++;if(Et===It)continue;Mt.moveTo(Et%c,M);const ft=Et;let J=b[Et];do{const Q=ut[J];do Et+=Q;while(!b[Et]);const dt=b[Et];dt!==5&&dt!==10?(J=dt,b[Et]=0):(J=dt&51*J>>4,b[Et]&=J>>2|J<<2),Mt.lineTo(Et%c,Et/c|0),b[Et]||--vt}while(ft!==Et);--M}return nt=null,b=null,function(Et){Et.save(),Et.scale(1/i,-1/n),Et.translate(0,-n),Et.fill(Mt),Et.beginPath(),Et.restore()}}class w{constructor(i,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=h.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=h.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=h.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,n])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,n){this.x=i,this.y=n}updatePathMinMax(i,n,s){[n,s]=h.Util.applyTransform([n,s],i),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(i,n){const s=h.Util.applyTransform(n,i),o=h.Util.applyTransform(n.slice(2),i);this.minX=Math.min(this.minX,s[0],o[0]),this.minY=Math.min(this.minY,s[1],o[1]),this.maxX=Math.max(this.maxX,s[0],o[0]),this.maxY=Math.max(this.maxY,s[1],o[1])}updateScalingPathMinMax(i,n){h.Util.scaleMinMax(i,n),this.minX=Math.min(this.minX,n[0]),this.maxX=Math.max(this.maxX,n[1]),this.minY=Math.min(this.minY,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(i,n,s,o,c,b,M,N,et,Z){const nt=h.Util.bezierBoundingBox(n,s,o,c,b,M,N,et);if(Z){Z[0]=Math.min(Z[0],nt[0],nt[2]),Z[1]=Math.max(Z[1],nt[0],nt[2]),Z[2]=Math.min(Z[2],nt[1],nt[3]),Z[3]=Math.max(Z[3],nt[1],nt[3]);return}this.updateRectMinMax(i,nt)}getPathBoundingBox(i=rt.PathType.FILL,n=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(i===rt.PathType.STROKE){n||(0,h.unreachable)("Stroke bounding box must include transform.");const o=h.Util.singularValueDecompose2dScale(n),c=o[0]*this.lineWidth/2,b=o[1]*this.lineWidth/2;s[0]-=c,s[1]-=b,s[2]+=c,s[3]+=b}return s}updateClipFromPath(){const i=h.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=rt.PathType.FILL,n=null){return h.Util.intersect(this.clipBox,this.getPathBoundingBox(i,n))}}function C(S,i){if(typeof ImageData<"u"&&i instanceof ImageData){S.putImageData(i,0,0);return}const n=i.height,s=i.width,o=n%x,c=(n-o)/x,b=o===0?c:c+1,M=S.createImageData(s,x);let N=0,et;const Z=i.data,nt=M.data;let ht,vt,ut,Mt;if(i.kind===h.ImageKind.GRAYSCALE_1BPP){const Ut=Z.byteLength,Et=new Uint32Array(nt.buffer,0,nt.byteLength>>2),It=Et.length,ft=s+7>>3,J=4294967295,Q=h.FeatureTest.isLittleEndian?4278190080:255;for(ht=0;ht<b;ht++){for(ut=ht<c?x:o,et=0,vt=0;vt<ut;vt++){const dt=Ut-N;let wt=0;const Tt=dt>ft?s:dt*8-7,jt=Tt&-8;let Gt=0,Wt=0;for(;wt<jt;wt+=8)Wt=Z[N++],Et[et++]=Wt&128?J:Q,Et[et++]=Wt&64?J:Q,Et[et++]=Wt&32?J:Q,Et[et++]=Wt&16?J:Q,Et[et++]=Wt&8?J:Q,Et[et++]=Wt&4?J:Q,Et[et++]=Wt&2?J:Q,Et[et++]=Wt&1?J:Q;for(;wt<Tt;wt++)Gt===0&&(Wt=Z[N++],Gt=128),Et[et++]=Wt&Gt?J:Q,Gt>>=1}for(;et<It;)Et[et++]=0;S.putImageData(M,0,ht*x)}}else if(i.kind===h.ImageKind.RGBA_32BPP){for(vt=0,Mt=s*x*4,ht=0;ht<c;ht++)nt.set(Z.subarray(N,N+Mt)),N+=Mt,S.putImageData(M,0,vt),vt+=x;ht<b&&(Mt=s*o*4,nt.set(Z.subarray(N,N+Mt)),S.putImageData(M,0,vt))}else if(i.kind===h.ImageKind.RGB_24BPP)for(ut=x,Mt=s*ut,ht=0;ht<b;ht++){for(ht>=c&&(ut=o,Mt=s*ut),et=0,vt=Mt;vt--;)nt[et++]=Z[N++],nt[et++]=Z[N++],nt[et++]=Z[N++],nt[et++]=255;S.putImageData(M,0,ht*x)}else throw new Error(`bad image kind: ${i.kind}`)}function A(S,i){if(i.bitmap){S.drawImage(i.bitmap,0,0);return}const n=i.height,s=i.width,o=n%x,c=(n-o)/x,b=o===0?c:c+1,M=S.createImageData(s,x);let N=0;const et=i.data,Z=M.data;for(let nt=0;nt<b;nt++){const ht=nt<c?x:o;({srcPos:N}=(0,X.convertBlackAndWhiteToRGBA)({src:et,srcPos:N,dest:Z,width:s,height:ht,nonBlackColor:0})),S.putImageData(M,0,nt*x)}}function a(S,i){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of n)S[s]!==void 0&&(i[s]=S[s]);S.setLineDash!==void 0&&(i.setLineDash(S.getLineDash()),i.lineDashOffset=S.lineDashOffset)}function l(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!h.isNodeJS){const{filter:i}=S;i!=="none"&&i!==""&&(S.filter="none")}}function k(S,i,n,s){const o=S.length;for(let c=3;c<o;c+=4){const b=S[c];if(b===0)S[c-3]=i,S[c-2]=n,S[c-1]=s;else if(b<255){const M=255-b;S[c-3]=S[c-3]*b+i*M>>8,S[c-2]=S[c-2]*b+n*M>>8,S[c-1]=S[c-1]*b+s*M>>8}}}function g(S,i,n){const s=S.length,o=1/255;for(let c=3;c<s;c+=4){const b=n?n[S[c]]:S[c];i[c]=i[c]*b*o|0}}function r(S,i,n){const s=S.length;for(let o=3;o<s;o+=4){const c=S[o-3]*77+S[o-2]*152+S[o-1]*28;i[o]=n?i[o]*n[c>>8]>>8:i[o]*c>>16}}function T(S,i,n,s,o,c,b,M,N,et,Z){const nt=!!c,ht=nt?c[0]:0,vt=nt?c[1]:0,ut=nt?c[2]:0,Mt=o==="Luminosity"?r:g,Et=Math.min(s,Math.ceil(1048576/n));for(let It=0;It<s;It+=Et){const ft=Math.min(Et,s-It),J=S.getImageData(M-et,It+(N-Z),n,ft),Q=i.getImageData(M,It+N,n,ft);nt&&k(J.data,ht,vt,ut),Mt(J.data,Q.data,b),i.putImageData(Q,M,It+N)}}function m(S,i,n,s){const o=s[0],c=s[1],b=s[2]-o,M=s[3]-c;b===0||M===0||(T(i.context,n,b,M,i.subtype,i.backdrop,i.transferMap,o,c,i.offsetX,i.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(n.canvas,0,0),S.restore())}function U(S,i){const n=h.Util.singularValueDecompose2dScale(S);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*P.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:n[0]<=s||n[1]<=s}const V=["butt","round","square"],E=["miter","round","bevel"],$={},st={},kt=class kt{constructor(i,n,s,o,c,{optionalContentConfig:b,markedContentStack:M=null},N,et){I(this,H);I(this,gt);this.ctx=i,this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=s,this.canvasFactory=o,this.filterFactory=c,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=M||[],this.optionalContentConfig=b,this.cachedCanvases=new y(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=N,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=et,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,n=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):n}beginDrawing({transform:i,viewport:n,transparency:s=!1,background:o=null}){const c=this.ctx.canvas.width,b=this.ctx.canvas.height,M=this.ctx.fillStyle;if(this.ctx.fillStyle=o||"#ffffff",this.ctx.fillRect(0,0,c,b),this.ctx.fillStyle=M,s){const N=this.cachedCanvases.getCanvas("transparent",c,b);this.compositeCtx=this.ctx,this.transparentCanvas=N.canvas,this.ctx=N.context,this.ctx.save(),this.ctx.transform(...(0,P.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),l(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=(0,P.getCurrentTransform)(this.ctx)}executeOperatorList(i,n,s,o){const c=i.argsArray,b=i.fnArray;let M=n||0;const N=c.length;if(N===M)return M;const et=N-M>L&&typeof s=="function",Z=et?Date.now()+f:0;let nt=0;const ht=this.commonObjs,vt=this.objs;let ut;for(;;){if(o!==void 0&&M===o.nextBreakPoint)return o.breakIt(M,s),M;if(ut=b[M],ut!==h.OPS.dependency)this[ut].apply(this,c[M]);else for(const Mt of c[M]){const Ut=Mt.startsWith("g_")?ht:vt;if(!Ut.has(Mt))return Ut.get(Mt,s),M}if(M++,M===N)return M;if(et&&++nt>L){if(Date.now()>Z)return s(),M;nt=0}}}endDrawing(){W(this,H,Ze).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const n of i.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);i.clear()}this._cachedBitmapsMap.clear(),W(this,gt,ti).call(this)}_scaleImage(i,n){const s=i.width,o=i.height;let c=Math.max(Math.hypot(n[0],n[1]),1),b=Math.max(Math.hypot(n[2],n[3]),1),M=s,N=o,et="prescale1",Z,nt;for(;c>2&&M>1||b>2&&N>1;){let ht=M,vt=N;c>2&&M>1&&(ht=M>=16384?Math.floor(M/2)-1||1:Math.ceil(M/2),c/=M/ht),b>2&&N>1&&(vt=N>=16384?Math.floor(N/2)-1||1:Math.ceil(N)/2,b/=N/vt),Z=this.cachedCanvases.getCanvas(et,ht,vt),nt=Z.context,nt.clearRect(0,0,ht,vt),nt.drawImage(i,0,0,M,N,0,0,ht,vt),i=Z.canvas,M=ht,N=vt,et=et==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:M,paintHeight:N}}_createMaskCanvas(i){const n=this.ctx,{width:s,height:o}=i,c=this.current.fillColor,b=this.current.patternFill,M=(0,P.getCurrentTransform)(n);let N,et,Z,nt;if((i.bitmap||i.data)&&i.count>1){const wt=i.bitmap||i.data.buffer;et=JSON.stringify(b?M:[M.slice(0,4),c]),N=this._cachedBitmapsMap.get(wt),N||(N=new Map,this._cachedBitmapsMap.set(wt,N));const Tt=N.get(et);if(Tt&&!b){const jt=Math.round(Math.min(M[0],M[2])+M[4]),Gt=Math.round(Math.min(M[1],M[3])+M[5]);return{canvas:Tt,offsetX:jt,offsetY:Gt}}Z=Tt}Z||(nt=this.cachedCanvases.getCanvas("maskCanvas",s,o),A(nt.context,i));let ht=h.Util.transform(M,[1/s,0,0,-1/o,0,0]);ht=h.Util.transform(ht,[1,0,0,1,0,-o]);const vt=h.Util.applyTransform([0,0],ht),ut=h.Util.applyTransform([s,o],ht),Mt=h.Util.normalizeRect([vt[0],vt[1],ut[0],ut[1]]),Ut=Math.round(Mt[2]-Mt[0])||1,Et=Math.round(Mt[3]-Mt[1])||1,It=this.cachedCanvases.getCanvas("fillCanvas",Ut,Et),ft=It.context,J=Math.min(vt[0],ut[0]),Q=Math.min(vt[1],ut[1]);ft.translate(-J,-Q),ft.transform(...ht),Z||(Z=this._scaleImage(nt.canvas,(0,P.getCurrentTransformInverse)(ft)),Z=Z.img,N&&b&&N.set(et,Z)),ft.imageSmoothingEnabled=U((0,P.getCurrentTransform)(ft),i.interpolate),u(ft,Z,0,0,Z.width,Z.height,0,0,s,o),ft.globalCompositeOperation="source-in";const dt=h.Util.transform((0,P.getCurrentTransformInverse)(ft),[1,0,0,1,-J,-Q]);return ft.fillStyle=b?c.getPattern(n,this,dt,rt.PathType.FILL):c,ft.fillRect(0,0,s,o),N&&!b&&(this.cachedCanvases.delete("fillCanvas"),N.set(et,It.canvas)),{canvas:It.canvas,offsetX:Math.round(J),offsetY:Math.round(Q)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=V[i]}setLineJoin(i){this.ctx.lineJoin=E[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,n){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(i),s.lineDashOffset=n)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[n,s]of i)switch(n){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,i,n);this.suspendedCtx=this.ctx,this.ctx=o.context;const c=this.ctx;c.setTransform(...(0,P.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,c),v(c,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,s=this.suspendedCtx;m(s,n,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,n,s,o,c,b){this.ctx.transform(i,n,s,o,c,b),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,n,s){const o=this.ctx,c=this.current;let b=c.x,M=c.y,N,et;const Z=(0,P.getCurrentTransform)(o),nt=Z[0]===0&&Z[3]===0||Z[1]===0&&Z[2]===0,ht=nt?s.slice(0):null;for(let vt=0,ut=0,Mt=i.length;vt<Mt;vt++)switch(i[vt]|0){case h.OPS.rectangle:b=n[ut++],M=n[ut++];const Ut=n[ut++],Et=n[ut++],It=b+Ut,ft=M+Et;o.moveTo(b,M),Ut===0||Et===0?o.lineTo(It,ft):(o.lineTo(It,M),o.lineTo(It,ft),o.lineTo(b,ft)),nt||c.updateRectMinMax(Z,[b,M,It,ft]),o.closePath();break;case h.OPS.moveTo:b=n[ut++],M=n[ut++],o.moveTo(b,M),nt||c.updatePathMinMax(Z,b,M);break;case h.OPS.lineTo:b=n[ut++],M=n[ut++],o.lineTo(b,M),nt||c.updatePathMinMax(Z,b,M);break;case h.OPS.curveTo:N=b,et=M,b=n[ut+4],M=n[ut+5],o.bezierCurveTo(n[ut],n[ut+1],n[ut+2],n[ut+3],b,M),c.updateCurvePathMinMax(Z,N,et,n[ut],n[ut+1],n[ut+2],n[ut+3],b,M,ht),ut+=6;break;case h.OPS.curveTo2:N=b,et=M,o.bezierCurveTo(b,M,n[ut],n[ut+1],n[ut+2],n[ut+3]),c.updateCurvePathMinMax(Z,N,et,b,M,n[ut],n[ut+1],n[ut+2],n[ut+3],ht),b=n[ut+2],M=n[ut+3],ut+=4;break;case h.OPS.curveTo3:N=b,et=M,b=n[ut+2],M=n[ut+3],o.bezierCurveTo(n[ut],n[ut+1],b,M,b,M),c.updateCurvePathMinMax(Z,N,et,n[ut],n[ut+1],b,M,b,M,ht),ut+=4;break;case h.OPS.closePath:o.closePath();break}nt&&c.updateScalingPathMinMax(Z,ht),c.setCurrentPoint(b,M)}closePath(){this.ctx.closePath()}stroke(i=!0){const n=this.ctx,s=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(n.save(),n.strokeStyle=s.getPattern(n,this,(0,P.getCurrentTransformInverse)(n),rt.PathType.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let c=!1;o&&(n.save(),n.fillStyle=s.getPattern(n,this,(0,P.getCurrentTransformInverse)(n),rt.PathType.FILL),c=!0);const b=this.current.getClippedPathBoundingBox();this.contentVisible&&b!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),c&&n.restore(),i&&this.consumePath(b)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$}eoClip(){this.pendingClip=st}beginText(){this.current.textMatrix=h.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,n=this.ctx;if(i===void 0){n.beginPath();return}n.save(),n.beginPath();for(const s of i)n.setTransform(...s.transform),n.translate(s.x,s.y),s.addToPath(n,s.fontSize);n.restore(),n.clip(),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,n){var Z;const s=this.commonObjs.get(i),o=this.current;if(!s)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=s.fontMatrix||h.FONT_IDENTITY_MATRIX,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&(0,h.warn)("Invalid font matrix for font "+i),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const c=s.loadedName||"sans-serif",b=((Z=s.systemFontInfo)==null?void 0:Z.css)||`"${c}", ${s.fallbackName}`;let M="normal";s.black?M="900":s.bold&&(M="bold");const N=s.italic?"italic":"normal";let et=n;n<pt?et=pt:n>B&&(et=B),this.current.fontSizeScale=n/et,this.ctx.font=`${N} ${M} ${et}px ${b}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,n){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=n}setLeadingMoveText(i,n){this.setLeading(-n),this.moveText(i,n)}setTextMatrix(i,n,s,o,c,b){this.current.textMatrix=[i,n,s,o,c,b],this.current.textMatrixScale=Math.hypot(i,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,n,s,o){const c=this.ctx,b=this.current,M=b.font,N=b.textRenderingMode,et=b.fontSize/b.fontSizeScale,Z=N&h.TextRenderingMode.FILL_STROKE_MASK,nt=!!(N&h.TextRenderingMode.ADD_TO_PATH_FLAG),ht=b.patternFill&&!M.missingFile;let vt;(M.disableFontFace||nt||ht)&&(vt=M.getPathGenerator(this.commonObjs,i)),M.disableFontFace||ht?(c.save(),c.translate(n,s),c.beginPath(),vt(c,et),o&&c.setTransform(...o),(Z===h.TextRenderingMode.FILL||Z===h.TextRenderingMode.FILL_STROKE)&&c.fill(),(Z===h.TextRenderingMode.STROKE||Z===h.TextRenderingMode.FILL_STROKE)&&c.stroke(),c.restore()):((Z===h.TextRenderingMode.FILL||Z===h.TextRenderingMode.FILL_STROKE)&&c.fillText(i,n,s),(Z===h.TextRenderingMode.STROKE||Z===h.TextRenderingMode.FILL_STROKE)&&c.strokeText(i,n,s)),nt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,P.getCurrentTransform)(c),x:n,y:s,fontSize:et,addToPath:vt})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const n=i.getImageData(0,0,10,10).data;let s=!1;for(let o=3;o<n.length;o+=4)if(n[o]>0&&n[o]<255){s=!0;break}return(0,h.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(i){const n=this.current,s=n.font;if(s.isType3Font)return this.showType3Text(i);const o=n.fontSize;if(o===0)return;const c=this.ctx,b=n.fontSizeScale,M=n.charSpacing,N=n.wordSpacing,et=n.fontDirection,Z=n.textHScale*et,nt=i.length,ht=s.vertical,vt=ht?1:-1,ut=s.defaultVMetrics,Mt=o*n.fontMatrix[0],Ut=n.textRenderingMode===h.TextRenderingMode.FILL&&!s.disableFontFace&&!n.patternFill;c.save(),c.transform(...n.textMatrix),c.translate(n.x,n.y+n.textRise),et>0?c.scale(Z,-1):c.scale(Z,1);let Et;if(n.patternFill){c.save();const dt=n.fillColor.getPattern(c,this,(0,P.getCurrentTransformInverse)(c),rt.PathType.FILL);Et=(0,P.getCurrentTransform)(c),c.restore(),c.fillStyle=dt}let It=n.lineWidth;const ft=n.textMatrixScale;if(ft===0||It===0){const dt=n.textRenderingMode&h.TextRenderingMode.FILL_STROKE_MASK;(dt===h.TextRenderingMode.STROKE||dt===h.TextRenderingMode.FILL_STROKE)&&(It=this.getSinglePixelWidth())}else It/=ft;if(b!==1&&(c.scale(b,b),It/=b),c.lineWidth=It,s.isInvalidPDFjsFont){const dt=[];let wt=0;for(const Tt of i)dt.push(Tt.unicode),wt+=Tt.width;c.fillText(dt.join(""),0,0),n.x+=wt*Mt*Z,c.restore(),this.compose();return}let J=0,Q;for(Q=0;Q<nt;++Q){const dt=i[Q];if(typeof dt=="number"){J+=vt*dt*o/1e3;continue}let wt=!1;const Tt=(dt.isSpace?N:0)+M,jt=dt.fontChar,Gt=dt.accent;let Wt,Xt,$t=dt.width;if(ht){const Yt=dt.vmetric||ut,lt=-(dt.vmetric?Yt[1]:$t*.5)*Mt,K=Yt[2]*Mt;$t=Yt?-Yt[0]:$t,Wt=lt/b,Xt=(J+K)/b}else Wt=J/b,Xt=0;if(s.remeasure&&$t>0){const Yt=c.measureText(jt).width*1e3/o*b;if($t<Yt&&this.isFontSubpixelAAEnabled){const lt=$t/Yt;wt=!0,c.save(),c.scale(lt,1),Wt/=lt}else $t!==Yt&&(Wt+=($t-Yt)/2e3*o/b)}if(this.contentVisible&&(dt.isInFont||s.missingFile)){if(Ut&&!Gt)c.fillText(jt,Wt,Xt);else if(this.paintChar(jt,Wt,Xt,Et),Gt){const Yt=Wt+o*Gt.offset.x/b,lt=Xt-o*Gt.offset.y/b;this.paintChar(Gt.fontChar,Yt,lt,Et)}}const zt=ht?$t*Mt-Tt*et:$t*Mt+Tt*et;J+=zt,wt&&c.restore()}ht?n.y-=J:n.x+=J*Z,c.restore(),this.compose()}showType3Text(i){const n=this.ctx,s=this.current,o=s.font,c=s.fontSize,b=s.fontDirection,M=o.vertical?1:-1,N=s.charSpacing,et=s.wordSpacing,Z=s.textHScale*b,nt=s.fontMatrix||h.FONT_IDENTITY_MATRIX,ht=i.length,vt=s.textRenderingMode===h.TextRenderingMode.INVISIBLE;let ut,Mt,Ut,Et;if(!(vt||c===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...s.textMatrix),n.translate(s.x,s.y),n.scale(Z,b),ut=0;ut<ht;++ut){if(Mt=i[ut],typeof Mt=="number"){Et=M*Mt*c/1e3,this.ctx.translate(Et,0),s.x+=Et*Z;continue}const It=(Mt.isSpace?et:0)+N,ft=o.charProcOperatorList[Mt.operatorListId];if(!ft){(0,h.warn)(`Type3 character "${Mt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Mt,this.save(),n.scale(c,c),n.transform(...nt),this.executeOperatorList(ft),this.restore()),Ut=h.Util.applyTransform([Mt.width,0],nt)[0]*c+It,n.translate(Ut,0),s.x+=Ut*Z}n.restore(),this.processingType3=null}}setCharWidth(i,n){}setCharWidthAndBounds(i,n,s,o,c,b){this.ctx.rect(s,o,c-s,b-o),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let n;if(i[0]==="TilingPattern"){const s=i[1],o=this.baseTransform||(0,P.getCurrentTransform)(this.ctx),c={createCanvasGraphics:b=>new kt(b,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new rt.TilingPattern(i,s,this.ctx,c,o)}else n=this._getPattern(i[1],i[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,n,s){const o=h.Util.makeHexColor(i,n,s);this.ctx.strokeStyle=o,this.current.strokeColor=o}setFillRGBColor(i,n,s){const o=h.Util.makeHexColor(i,n,s);this.ctx.fillStyle=o,this.current.fillColor=o,this.current.patternFill=!1}_getPattern(i,n=null){let s;return this.cachedPatterns.has(i)?s=this.cachedPatterns.get(i):(s=(0,rt.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,s)),n&&(s.matrix=n),s}shadingFill(i){if(!this.contentVisible)return;const n=this.ctx;this.save();const s=this._getPattern(i);n.fillStyle=s.getPattern(n,this,(0,P.getCurrentTransformInverse)(n),rt.PathType.SHADING);const o=(0,P.getCurrentTransformInverse)(n);if(o){const{width:c,height:b}=n.canvas,[M,N,et,Z]=h.Util.getAxialAlignedBoundingBox([0,0,c,b],o);this.ctx.fillRect(M,N,et-M,Z-N)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,h.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,h.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,P.getCurrentTransform)(this.ctx),n)){const s=n[2]-n[0],o=n[3]-n[1];this.ctx.rect(n[0],n[1],s,o),this.current.updateRectMinMax((0,P.getCurrentTransform)(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;i.isolated||(0,h.info)("TODO: Support non-isolated groups."),i.knockout&&(0,h.warn)("Knockout groups not supported.");const s=(0,P.getCurrentTransform)(n);if(i.matrix&&n.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=h.Util.getAxialAlignedBoundingBox(i.bbox,(0,P.getCurrentTransform)(n));const c=[0,0,n.canvas.width,n.canvas.height];o=h.Util.intersect(o,c)||[0,0,0,0];const b=Math.floor(o[0]),M=Math.floor(o[1]);let N=Math.max(Math.ceil(o[2])-b,1),et=Math.max(Math.ceil(o[3])-M,1),Z=1,nt=1;N>F&&(Z=N/F,N=F),et>F&&(nt=et/F,et=F),this.current.startNewPathAndClipBox([0,0,N,et]);let ht="groupAt"+this.groupLevel;i.smask&&(ht+="_smask_"+this.smaskCounter++%2);const vt=this.cachedCanvases.getCanvas(ht,N,et),ut=vt.context;ut.scale(1/Z,1/nt),ut.translate(-b,-M),ut.transform(...s),i.smask?this.smaskStack.push({canvas:vt.canvas,context:ut,offsetX:b,offsetY:M,scaleX:Z,scaleY:nt,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(b,M),n.scale(Z,nt),n.save()),a(n,ut),this.ctx=ut,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const o=(0,P.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);const c=h.Util.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(i,n,s,o,c){if(W(this,H,Ze).call(this),l(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(n)&&n.length===4){const b=n[2]-n[0],M=n[3]-n[1];if(c&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=b,n[3]=M;const[N,et]=h.Util.singularValueDecompose2dScale((0,P.getCurrentTransform)(this.ctx)),{viewportScale:Z}=this,nt=Math.ceil(b*this.outputScaleX*Z),ht=Math.ceil(M*this.outputScaleY*Z);this.annotationCanvas=this.canvasFactory.create(nt,ht);const{canvas:vt,context:ut}=this.annotationCanvas;this.annotationCanvasMap.set(i,vt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ut,this.ctx.save(),this.ctx.setTransform(N,0,0,-et,0,M*et),l(this.ctx)}else l(this.ctx),this.ctx.rect(n[0],n[1],b,M),this.ctx.clip(),this.endPath()}this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...o)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),W(this,gt,ti).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const n=i.count;i=this.getObject(i.data,i),i.count=n;const s=this.ctx,o=this.processingType3;if(o&&(o.compiled===void 0&&(o.compiled=_(i)),o.compiled)){o.compiled(s);return}const c=this._createMaskCanvas(i),b=c.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(b,c.offsetX,c.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(i,n,s=0,o=0,c,b){if(!this.contentVisible)return;i=this.getObject(i.data,i);const M=this.ctx;M.save();const N=(0,P.getCurrentTransform)(M);M.transform(n,s,o,c,0,0);const et=this._createMaskCanvas(i);M.setTransform(1,0,0,1,et.offsetX-N[4],et.offsetY-N[5]);for(let Z=0,nt=b.length;Z<nt;Z+=2){const ht=h.Util.transform(N,[n,s,o,c,b[Z],b[Z+1]]),[vt,ut]=h.Util.applyTransform([0,0],ht);M.drawImage(et.canvas,vt,ut)}M.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;for(const c of i){const{data:b,width:M,height:N,transform:et}=c,Z=this.cachedCanvases.getCanvas("maskCanvas",M,N),nt=Z.context;nt.save();const ht=this.getObject(b,c);A(nt,ht),nt.globalCompositeOperation="source-in",nt.fillStyle=o?s.getPattern(nt,this,(0,P.getCurrentTransformInverse)(n),rt.PathType.FILL):s,nt.fillRect(0,0,M,N),nt.restore(),n.save(),n.transform(...et),n.scale(1,-1),u(n,Z.canvas,0,0,M,N,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const n=this.getObject(i);if(!n){(0,h.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(i,n,s,o){if(!this.contentVisible)return;const c=this.getObject(i);if(!c){(0,h.warn)("Dependent image isn't ready yet");return}const b=c.width,M=c.height,N=[];for(let et=0,Z=o.length;et<Z;et+=2)N.push({transform:[n,0,0,s,o[et],o[et+1]],x:0,y:0,w:b,h:M});this.paintInlineImageXObjectGroup(c,N)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:n,width:s,height:o}=i,c=this.cachedCanvases.getCanvas("inlineImage",s,o),b=c.context;return b.filter=this.current.transferMaps,b.drawImage(n,0,0),b.filter="none",c.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const n=i.width,s=i.height,o=this.ctx;if(this.save(),!h.isNodeJS){const{filter:M}=o;M!=="none"&&M!==""&&(o.filter="none")}o.scale(1/n,-1/s);let c;if(i.bitmap)c=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)c=i;else{const N=this.cachedCanvases.getCanvas("inlineImage",n,s).context;C(N,i),c=this.applyTransferMapsToCanvas(N)}const b=this._scaleImage(c,(0,P.getCurrentTransformInverse)(o));o.imageSmoothingEnabled=U((0,P.getCurrentTransform)(o),i.interpolate),u(o,b.img,0,0,b.paintWidth,b.paintHeight,0,-s,n,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,n){if(!this.contentVisible)return;const s=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const c=i.width,b=i.height,N=this.cachedCanvases.getCanvas("inlineImage",c,b).context;C(N,i),o=this.applyTransferMapsToCanvas(N)}for(const c of n)s.save(),s.transform(...c.transform),s.scale(1,-1),u(s,o,c.x,c.y,c.w,c.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,n){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,n){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const s=this.ctx;this.pendingClip&&(n||(this.pendingClip===st?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,P.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const n=Math.abs(i[0]*i[3]-i[2]*i[1]),s=Math.hypot(i[0],i[2]),o=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(s,o)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:n,b:s,c:o,d:c}=this.ctx.getTransform();let b,M;if(s===0&&o===0){const N=Math.abs(n),et=Math.abs(c);if(N===et)if(i===0)b=M=1/N;else{const Z=N*i;b=M=Z<1?1/Z:1}else if(i===0)b=1/N,M=1/et;else{const Z=N*i,nt=et*i;b=Z<1?1/Z:1,M=nt<1?1/nt:1}}else{const N=Math.abs(n*c-s*o),et=Math.hypot(n,s),Z=Math.hypot(o,c);if(i===0)b=Z/N,M=et/N;else{const nt=i*N;b=Z>nt?Z/nt:1,M=et>nt?et/nt:1}}this._cachedScaleForStroking[0]=b,this._cachedScaleForStroking[1]=M}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:n}=this,{lineWidth:s}=this.current,[o,c]=this.getScaleForStroking();if(n.lineWidth=s||1,o===1&&c===1){n.stroke();return}const b=n.getLineDash();if(i&&n.save(),n.scale(o,c),b.length>0){const M=Math.max(o,c);n.setLineDash(b.map(N=>N/M)),n.lineDashOffset/=M}n.stroke(),i&&n.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};H=new WeakSet,Ze=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gt=new WeakSet,ti=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const n=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}};let at=kt;d.CanvasGraphics=at;for(const S in h.OPS)at.prototype[S]!==void 0&&(at.prototype[h.OPS[S]]=at.prototype[S])},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TilingPattern=d.PathType=void 0,d.getShadingPattern=x;var h=ot(1),P=ot(6);const rt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};d.PathType=rt;function X(_,w){if(!w)return;const C=w[2]-w[0],A=w[3]-w[1],a=new Path2D;a.rect(w[0],w[1],C,A),_.clip(a)}class pt{constructor(){this.constructor===pt&&(0,h.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,h.unreachable)("Abstract method `getPattern` called.")}}class B extends pt{constructor(w){super(),this._type=w[1],this._bbox=w[2],this._colorStops=w[3],this._p0=w[4],this._p1=w[5],this._r0=w[6],this._r1=w[7],this.matrix=null}_createGradient(w){let C;this._type==="axial"?C=w.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=w.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)C.addColorStop(A[0],A[1]);return C}getPattern(w,C,A,a){let l;if(a===rt.STROKE||a===rt.FILL){const k=C.current.getClippedPathBoundingBox(a,(0,P.getCurrentTransform)(w))||[0,0,0,0],g=Math.ceil(k[2]-k[0])||1,r=Math.ceil(k[3]-k[1])||1,T=C.cachedCanvases.getCanvas("pattern",g,r,!0),m=T.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-k[0],-k[1]),A=h.Util.transform(A,[1,0,0,1,k[0],k[1]]),m.transform(...C.baseTransform),this.matrix&&m.transform(...this.matrix),X(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=w.createPattern(T.canvas,"no-repeat");const U=new DOMMatrix(A);l.setTransform(U)}else X(w,this._bbox),l=this._createGradient(w);return l}}function F(_,w,C,A,a,l,k,g){const r=w.coords,T=w.colors,m=_.data,U=_.width*4;let V;r[C+1]>r[A+1]&&(V=C,C=A,A=V,V=l,l=k,k=V),r[A+1]>r[a+1]&&(V=A,A=a,a=V,V=k,k=g,g=V),r[C+1]>r[A+1]&&(V=C,C=A,A=V,V=l,l=k,k=V);const E=(r[C]+w.offsetX)*w.scaleX,$=(r[C+1]+w.offsetY)*w.scaleY,st=(r[A]+w.offsetX)*w.scaleX,at=(r[A+1]+w.offsetY)*w.scaleY,H=(r[a]+w.offsetX)*w.scaleX,ct=(r[a+1]+w.offsetY)*w.scaleY;if($>=ct)return;const gt=T[l],Ct=T[l+1],kt=T[l+2],S=T[k],i=T[k+1],n=T[k+2],s=T[g],o=T[g+1],c=T[g+2],b=Math.round($),M=Math.round(ct);let N,et,Z,nt,ht,vt,ut,Mt;for(let Ut=b;Ut<=M;Ut++){if(Ut<at){const Q=Ut<$?0:($-Ut)/($-at);N=E-(E-st)*Q,et=gt-(gt-S)*Q,Z=Ct-(Ct-i)*Q,nt=kt-(kt-n)*Q}else{let Q;Ut>ct?Q=1:at===ct?Q=0:Q=(at-Ut)/(at-ct),N=st-(st-H)*Q,et=S-(S-s)*Q,Z=i-(i-o)*Q,nt=n-(n-c)*Q}let Et;Ut<$?Et=0:Ut>ct?Et=1:Et=($-Ut)/($-ct),ht=E-(E-H)*Et,vt=gt-(gt-s)*Et,ut=Ct-(Ct-o)*Et,Mt=kt-(kt-c)*Et;const It=Math.round(Math.min(N,ht)),ft=Math.round(Math.max(N,ht));let J=U*Ut+It*4;for(let Q=It;Q<=ft;Q++)Et=(N-Q)/(N-ht),Et<0?Et=0:Et>1&&(Et=1),m[J++]=et-(et-vt)*Et|0,m[J++]=Z-(Z-ut)*Et|0,m[J++]=nt-(nt-Mt)*Et|0,m[J++]=255}}function f(_,w,C){const A=w.coords,a=w.colors;let l,k;switch(w.type){case"lattice":const g=w.verticesPerRow,r=Math.floor(A.length/g)-1,T=g-1;for(l=0;l<r;l++){let m=l*g;for(let U=0;U<T;U++,m++)F(_,C,A[m],A[m+1],A[m+g],a[m],a[m+1],a[m+g]),F(_,C,A[m+g+1],A[m+1],A[m+g],a[m+g+1],a[m+1],a[m+g])}break;case"triangles":for(l=0,k=A.length;l<k;l+=3)F(_,C,A[l],A[l+1],A[l+2],a[l],a[l+1],a[l+2]);break;default:throw new Error("illegal figure")}}class L extends pt{constructor(w){super(),this._coords=w[2],this._colors=w[3],this._figures=w[4],this._bounds=w[5],this._bbox=w[7],this._background=w[8],this.matrix=null}_createMeshCanvas(w,C,A){const g=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-g,m=Math.ceil(this._bounds[3])-r,U=Math.min(Math.ceil(Math.abs(T*w[0]*1.1)),3e3),V=Math.min(Math.ceil(Math.abs(m*w[1]*1.1)),3e3),E=T/U,$=m/V,st={coords:this._coords,colors:this._colors,offsetX:-g,offsetY:-r,scaleX:1/E,scaleY:1/$},at=U+2*2,H=V+2*2,ct=A.getCanvas("mesh",at,H,!1),gt=ct.context,Ct=gt.createImageData(U,V);if(C){const S=Ct.data;for(let i=0,n=S.length;i<n;i+=4)S[i]=C[0],S[i+1]=C[1],S[i+2]=C[2],S[i+3]=255}for(const S of this._figures)f(Ct,S,st);return gt.putImageData(Ct,2,2),{canvas:ct.canvas,offsetX:g-2*E,offsetY:r-2*$,scaleX:E,scaleY:$}}getPattern(w,C,A,a){X(w,this._bbox);let l;if(a===rt.SHADING)l=h.Util.singularValueDecompose2dScale((0,P.getCurrentTransform)(w));else if(l=h.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const g=h.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*g[0],l[1]*g[1]]}const k=this._createMeshCanvas(l,a===rt.SHADING?null:this._background,C.cachedCanvases);return a!==rt.SHADING&&(w.setTransform(...C.baseTransform),this.matrix&&w.transform(...this.matrix)),w.translate(k.offsetX,k.offsetY),w.scale(k.scaleX,k.scaleY),w.createPattern(k.canvas,"no-repeat")}}class O extends pt{getPattern(){return"hotpink"}}function x(_){switch(_[0]){case"RadialAxial":return new B(_);case"Mesh":return new L(_);case"Dummy":return new O}throw new Error(`Unknown IR type: ${_[0]}`)}const v={COLORED:1,UNCOLORED:2},u=class u{constructor(w,C,A,a,l){this.operatorList=w[2],this.matrix=w[3]||[1,0,0,1,0,0],this.bbox=w[4],this.xstep=w[5],this.ystep=w[6],this.paintType=w[7],this.tilingType=w[8],this.color=C,this.ctx=A,this.canvasGraphicsFactory=a,this.baseTransform=l}createPatternCanvas(w){const C=this.operatorList,A=this.bbox,a=this.xstep,l=this.ystep,k=this.paintType,g=this.tilingType,r=this.color,T=this.canvasGraphicsFactory;(0,h.info)("TilingType: "+g);const m=A[0],U=A[1],V=A[2],E=A[3],$=h.Util.singularValueDecompose2dScale(this.matrix),st=h.Util.singularValueDecompose2dScale(this.baseTransform),at=[$[0]*st[0],$[1]*st[1]],H=this.getSizeAndScale(a,this.ctx.canvas.width,at[0]),ct=this.getSizeAndScale(l,this.ctx.canvas.height,at[1]),gt=w.cachedCanvases.getCanvas("pattern",H.size,ct.size,!0),Ct=gt.context,kt=T.createCanvasGraphics(Ct);kt.groupLevel=w.groupLevel,this.setFillAndStrokeStyleToContext(kt,k,r);let S=m,i=U,n=V,s=E;return m<0&&(S=0,n+=Math.abs(m)),U<0&&(i=0,s+=Math.abs(U)),Ct.translate(-(H.scale*S),-(ct.scale*i)),kt.transform(H.scale,0,0,ct.scale,0,0),Ct.save(),this.clipBbox(kt,S,i,n,s),kt.baseTransform=(0,P.getCurrentTransform)(kt.ctx),kt.executeOperatorList(C),kt.endDrawing(),{canvas:gt.canvas,scaleX:H.scale,scaleY:ct.scale,offsetX:S,offsetY:i}}getSizeAndScale(w,C,A){w=Math.abs(w);const a=Math.max(u.MAX_PATTERN_SIZE,C);let l=Math.ceil(w*A);return l>=a?l=a:A=l/w,{scale:A,size:l}}clipBbox(w,C,A,a,l){const k=a-C,g=l-A;w.ctx.rect(C,A,k,g),w.current.updateRectMinMax((0,P.getCurrentTransform)(w.ctx),[C,A,a,l]),w.clip(),w.endPath()}setFillAndStrokeStyleToContext(w,C,A){const a=w.ctx,l=w.current;switch(C){case v.COLORED:const k=this.ctx;a.fillStyle=k.fillStyle,a.strokeStyle=k.strokeStyle,l.fillColor=k.fillStyle,l.strokeColor=k.strokeStyle;break;case v.UNCOLORED:const g=h.Util.makeHexColor(A[0],A[1],A[2]);a.fillStyle=g,a.strokeStyle=g,l.fillColor=g,l.strokeColor=g;break;default:throw new h.FormatError(`Unsupported paint type: ${C}`)}}getPattern(w,C,A,a){let l=A;a!==rt.SHADING&&(l=h.Util.transform(l,C.baseTransform),this.matrix&&(l=h.Util.transform(l,this.matrix)));const k=this.createPatternCanvas(C);let g=new DOMMatrix(l);g=g.translate(k.offsetX,k.offsetY),g=g.scale(1/k.scaleX,1/k.scaleY);const r=w.createPattern(k.canvas,"repeat");return r.setTransform(g),r}};ie(u,"MAX_PATTERN_SIZE",3e3);let y=u;d.TilingPattern=y},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.convertBlackAndWhiteToRGBA=rt,d.convertToRGBA=P,d.grayToRGBA=pt;var h=ot(1);function P(B){switch(B.kind){case h.ImageKind.GRAYSCALE_1BPP:return rt(B);case h.ImageKind.RGB_24BPP:return X(B)}return null}function rt({src:B,srcPos:F=0,dest:f,width:L,height:O,nonBlackColor:x=4294967295,inverseDecode:v=!1}){const y=h.FeatureTest.isLittleEndian?4278190080:255,[u,_]=v?[x,y]:[y,x],w=L>>3,C=L&7,A=B.length;f=new Uint32Array(f.buffer);let a=0;for(let l=0;l<O;l++){for(const g=F+w;F<g;F++){const r=F<A?B[F]:255;f[a++]=r&128?_:u,f[a++]=r&64?_:u,f[a++]=r&32?_:u,f[a++]=r&16?_:u,f[a++]=r&8?_:u,f[a++]=r&4?_:u,f[a++]=r&2?_:u,f[a++]=r&1?_:u}if(C===0)continue;const k=F<A?B[F++]:255;for(let g=0;g<C;g++)f[a++]=k&1<<7-g?_:u}return{srcPos:F,destPos:a}}function X({src:B,srcPos:F=0,dest:f,destPos:L=0,width:O,height:x}){let v=0;const y=B.length>>2,u=new Uint32Array(B.buffer,F,y);if(h.FeatureTest.isLittleEndian){for(;v<y-2;v+=3,L+=4){const _=u[v],w=u[v+1],C=u[v+2];f[L]=_|4278190080,f[L+1]=_>>>24|w<<8|4278190080,f[L+2]=w>>>16|C<<16|4278190080,f[L+3]=C>>>8|4278190080}for(let _=v*4,w=B.length;_<w;_+=3)f[L++]=B[_]|B[_+1]<<8|B[_+2]<<16|4278190080}else{for(;v<y-2;v+=3,L+=4){const _=u[v],w=u[v+1],C=u[v+2];f[L]=_|255,f[L+1]=_<<24|w>>>8|255,f[L+2]=w<<16|C>>>16|255,f[L+3]=C<<8|255}for(let _=v*4,w=B.length;_<w;_+=3)f[L++]=B[_]<<24|B[_+1]<<16|B[_+2]<<8|255}return{srcPos:F,destPos:L}}function pt(B,F){if(h.FeatureTest.isLittleEndian)for(let f=0,L=B.length;f<L;f++)F[f]=B[f]*65793|4278190080;else for(let f=0,L=B.length;f<L;f++)F[f]=B[f]*16843008|255}},(mt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.GlobalWorkerOptions=void 0;const ot=Object.create(null);d.GlobalWorkerOptions=ot,ot.workerPort=null,ot.workerSrc=""},(mt,d,ot)=>{var B,ki,f,Fi,O,ke;Object.defineProperty(d,"__esModule",{value:!0}),d.MessageHandler=void 0;var h=ot(1);const P={UNKNOWN:0,DATA:1,ERROR:2},rt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function X(v){switch(v instanceof Error||typeof v=="object"&&v!==null||(0,h.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),v.name){case"AbortException":return new h.AbortException(v.message);case"MissingPDFException":return new h.MissingPDFException(v.message);case"PasswordException":return new h.PasswordException(v.message,v.code);case"UnexpectedResponseException":return new h.UnexpectedResponseException(v.message,v.status);case"UnknownErrorException":return new h.UnknownErrorException(v.message,v.details);default:return new h.UnknownErrorException(v.message,v.toString())}}class pt{constructor(y,u,_){I(this,B);I(this,f);I(this,O);this.sourceName=y,this.targetName=u,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=w=>{const C=w.data;if(C.targetName!==this.sourceName)return;if(C.stream){W(this,f,Fi).call(this,C);return}if(C.callback){const a=C.callbackId,l=this.callbackCapabilities[a];if(!l)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],C.callback===P.DATA)l.resolve(C.data);else if(C.callback===P.ERROR)l.reject(X(C.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[C.action];if(!A)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const a=this.sourceName,l=C.sourceName;new Promise(function(k){k(A(C.data))}).then(function(k){_.postMessage({sourceName:a,targetName:l,callback:P.DATA,callbackId:C.callbackId,data:k})},function(k){_.postMessage({sourceName:a,targetName:l,callback:P.ERROR,callbackId:C.callbackId,reason:X(k)})});return}if(C.streamId){W(this,B,ki).call(this,C);return}A(C.data)},_.addEventListener("message",this._onComObjOnMessage)}on(y,u){const _=this.actionHandler;if(_[y])throw new Error(`There is already an actionName called "${y}"`);_[y]=u}send(y,u,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,data:u},_)}sendWithPromise(y,u,_){const w=this.callbackId++,C=new h.PromiseCapability;this.callbackCapabilities[w]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,callbackId:w,data:u},_)}catch(A){C.reject(A)}return C.promise}sendWithStream(y,u,_,w){const C=this.streamId++,A=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:k=>{const g=new h.PromiseCapability;return this.streamControllers[C]={controller:k,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:A,targetName:a,action:y,streamId:C,data:u,desiredSize:k.desiredSize},w),g.promise},pull:k=>{const g=new h.PromiseCapability;return this.streamControllers[C].pullCall=g,l.postMessage({sourceName:A,targetName:a,stream:rt.PULL,streamId:C,desiredSize:k.desiredSize}),g.promise},cancel:k=>{(0,h.assert)(k instanceof Error,"cancel must have a valid reason");const g=new h.PromiseCapability;return this.streamControllers[C].cancelCall=g,this.streamControllers[C].isClosed=!0,l.postMessage({sourceName:A,targetName:a,stream:rt.CANCEL,streamId:C,reason:X(k)}),g.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}B=new WeakSet,ki=function(y){const u=y.streamId,_=this.sourceName,w=y.sourceName,C=this.comObj,A=this,a=this.actionHandler[y.action],l={enqueue(k,g=1,r){if(this.isCancelled)return;const T=this.desiredSize;this.desiredSize-=g,T>0&&this.desiredSize<=0&&(this.sinkCapability=new h.PromiseCapability,this.ready=this.sinkCapability.promise),C.postMessage({sourceName:_,targetName:w,stream:rt.ENQUEUE,streamId:u,chunk:k},r)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:_,targetName:w,stream:rt.CLOSE,streamId:u}),delete A.streamSinks[u])},error(k){(0,h.assert)(k instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:_,targetName:w,stream:rt.ERROR,streamId:u,reason:X(k)}))},sinkCapability:new h.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:y.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[u]=l,new Promise(function(k){k(a(y.data,l))}).then(function(){C.postMessage({sourceName:_,targetName:w,stream:rt.START_COMPLETE,streamId:u,success:!0})},function(k){C.postMessage({sourceName:_,targetName:w,stream:rt.START_COMPLETE,streamId:u,reason:X(k)})})},f=new WeakSet,Fi=function(y){const u=y.streamId,_=this.sourceName,w=y.sourceName,C=this.comObj,A=this.streamControllers[u],a=this.streamSinks[u];switch(y.stream){case rt.START_COMPLETE:y.success?A.startCall.resolve():A.startCall.reject(X(y.reason));break;case rt.PULL_COMPLETE:y.success?A.pullCall.resolve():A.pullCall.reject(X(y.reason));break;case rt.PULL:if(!a){C.postMessage({sourceName:_,targetName:w,stream:rt.PULL_COMPLETE,streamId:u,success:!0});break}a.desiredSize<=0&&y.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=y.desiredSize,new Promise(function(l){var k;l((k=a.onPull)==null?void 0:k.call(a))}).then(function(){C.postMessage({sourceName:_,targetName:w,stream:rt.PULL_COMPLETE,streamId:u,success:!0})},function(l){C.postMessage({sourceName:_,targetName:w,stream:rt.PULL_COMPLETE,streamId:u,reason:X(l)})});break;case rt.ENQUEUE:if((0,h.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(y.chunk);break;case rt.CLOSE:if((0,h.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),W(this,O,ke).call(this,A,u);break;case rt.ERROR:(0,h.assert)(A,"error should have stream controller"),A.controller.error(X(y.reason)),W(this,O,ke).call(this,A,u);break;case rt.CANCEL_COMPLETE:y.success?A.cancelCall.resolve():A.cancelCall.reject(X(y.reason)),W(this,O,ke).call(this,A,u);break;case rt.CANCEL:if(!a)break;new Promise(function(l){var k;l((k=a.onCancel)==null?void 0:k.call(a,X(y.reason)))}).then(function(){C.postMessage({sourceName:_,targetName:w,stream:rt.CANCEL_COMPLETE,streamId:u,success:!0})},function(l){C.postMessage({sourceName:_,targetName:w,stream:rt.CANCEL_COMPLETE,streamId:u,reason:X(l)})}),a.sinkCapability.reject(X(y.reason)),a.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}},O=new WeakSet,ke=async function(y,u){var _,w,C;await Promise.allSettled([(_=y.startCall)==null?void 0:_.promise,(w=y.pullCall)==null?void 0:w.promise,(C=y.cancelCall)==null?void 0:C.promise]),delete this.streamControllers[u]},d.MessageHandler=pt},(mt,d,ot)=>{var rt,X;Object.defineProperty(d,"__esModule",{value:!0}),d.Metadata=void 0;var h=ot(1);class P{constructor({parsedData:B,rawData:F}){I(this,rt,void 0);I(this,X,void 0);tt(this,rt,B),tt(this,X,F)}getRaw(){return t(this,X)}get(B){return t(this,rt).get(B)??null}getAll(){return(0,h.objectFromMap)(t(this,rt))}has(B){return t(this,rt).has(B)}}rt=new WeakMap,X=new WeakMap,d.Metadata=P},(mt,d,ot)=>{var B,F,f,L,O,x,ei;Object.defineProperty(d,"__esModule",{value:!0}),d.OptionalContentConfig=void 0;var h=ot(1),P=ot(8);const rt=Symbol("INTERNAL");class X{constructor(u,_){I(this,B,!0);this.name=u,this.intent=_}get visible(){return t(this,B)}_setVisible(u,_){u!==rt&&(0,h.unreachable)("Internal method `_setVisible` called."),tt(this,B,_)}}B=new WeakMap;class pt{constructor(u){I(this,x);I(this,F,null);I(this,f,new Map);I(this,L,null);I(this,O,null);if(this.name=null,this.creator=null,u!==null){this.name=u.name,this.creator=u.creator,tt(this,O,u.order);for(const _ of u.groups)t(this,f).set(_.id,new X(_.name,_.intent));if(u.baseState==="OFF")for(const _ of t(this,f).values())_._setVisible(rt,!1);for(const _ of u.on)t(this,f).get(_)._setVisible(rt,!0);for(const _ of u.off)t(this,f).get(_)._setVisible(rt,!1);tt(this,L,this.getHash())}}isVisible(u){if(t(this,f).size===0)return!0;if(!u)return(0,h.warn)("Optional content group not defined."),!0;if(u.type==="OCG")return t(this,f).has(u.id)?t(this,f).get(u.id).visible:((0,h.warn)(`Optional content group not found: ${u.id}`),!0);if(u.type==="OCMD"){if(u.expression)return W(this,x,ei).call(this,u.expression);if(!u.policy||u.policy==="AnyOn"){for(const _ of u.ids){if(!t(this,f).has(_))return(0,h.warn)(`Optional content group not found: ${_}`),!0;if(t(this,f).get(_).visible)return!0}return!1}else if(u.policy==="AllOn"){for(const _ of u.ids){if(!t(this,f).has(_))return(0,h.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,f).get(_).visible)return!1}return!0}else if(u.policy==="AnyOff"){for(const _ of u.ids){if(!t(this,f).has(_))return(0,h.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,f).get(_).visible)return!0}return!1}else if(u.policy==="AllOff"){for(const _ of u.ids){if(!t(this,f).has(_))return(0,h.warn)(`Optional content group not found: ${_}`),!0;if(t(this,f).get(_).visible)return!1}return!0}return(0,h.warn)(`Unknown optional content policy ${u.policy}.`),!0}return(0,h.warn)(`Unknown group type ${u.type}.`),!0}setVisibility(u,_=!0){if(!t(this,f).has(u)){(0,h.warn)(`Optional content group not found: ${u}`);return}t(this,f).get(u)._setVisible(rt,!!_),tt(this,F,null)}get hasInitialVisibility(){return t(this,L)===null||this.getHash()===t(this,L)}getOrder(){return t(this,f).size?t(this,O)?t(this,O).slice():[...t(this,f).keys()]:null}getGroups(){return t(this,f).size>0?(0,h.objectFromMap)(t(this,f)):null}getGroup(u){return t(this,f).get(u)||null}getHash(){if(t(this,F)!==null)return t(this,F);const u=new P.MurmurHash3_64;for(const[_,w]of t(this,f))u.update(`${_}:${w.visible}`);return tt(this,F,u.hexdigest())}}F=new WeakMap,f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakSet,ei=function(u){const _=u.length;if(_<2)return!0;const w=u[0];for(let C=1;C<_;C++){const A=u[C];let a;if(Array.isArray(A))a=W(this,x,ei).call(this,A);else if(t(this,f).has(A))a=t(this,f).get(A).visible;else return(0,h.warn)(`Optional content group not found: ${A}`),!0;switch(w){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return w==="And"},d.OptionalContentConfig=pt},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFDataTransportStream=void 0;var h=ot(1),P=ot(6);class rt{constructor({length:F,initialData:f,progressiveDone:L=!1,contentDispositionFilename:O=null,disableRange:x=!1,disableStream:v=!1},y){if((0,h.assert)(y,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=O,(f==null?void 0:f.length)>0){const u=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=y,this._isStreamingSupported=!v,this._isRangeSupported=!x,this._contentLength=F,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,_)=>{this._onReceiveData({begin:u,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((u,_)=>{this._onProgress({loaded:u,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:F,chunk:f}){const L=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(F===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const O=this._rangeReaders.some(function(x){return x._begin!==F?!1:(x._enqueue(L),!0)});(0,h.assert)(O,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var F;return((F=this._fullRequestReader)==null?void 0:F._loaded)??0}_onProgress(F){var f,L,O,x;F.total===void 0?(L=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||L.call(f,{loaded:F.loaded}):(x=(O=this._fullRequestReader)==null?void 0:O.onProgress)==null||x.call(O,{loaded:F.loaded,total:F.total})}_onProgressiveDone(){var F;(F=this._fullRequestReader)==null||F.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(F){const f=this._rangeReaders.indexOf(F);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,h.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const F=this._queuedChunks;return this._queuedChunks=null,new X(this,F,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(F,f){if(f<=this._progressiveDataLength)return null;const L=new pt(this,F,f);return this._pdfDataRangeTransport.requestDataRange(F,f),this._rangeReaders.push(L),L}cancelAllRequests(F){var f;(f=this._fullRequestReader)==null||f.cancel(F);for(const L of this._rangeReaders.slice(0))L.cancel(F);this._pdfDataRangeTransport.abort()}}d.PDFDataTransportStream=rt;class X{constructor(F,f,L=!1,O=null){this._stream=F,this._done=L||!1,this._filename=(0,P.isPdfFile)(O)?O:null,this._queuedChunks=f||[],this._loaded=0;for(const x of this._queuedChunks)this._loaded+=x.byteLength;this._requests=[],this._headersReady=Promise.resolve(),F._fullRequestReader=this,this.onProgress=null}_enqueue(F){this._done||(this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunks.push(F),this._loaded+=F.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const F=new h.PromiseCapability;return this._requests.push(F),F.promise}cancel(F){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class pt{constructor(F,f,L){this._stream=F,this._begin=f,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(F){if(!this._done){if(this._requests.length===0)this._queuedChunk=F;else{this._requests.shift().resolve({value:F,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const F=new h.PromiseCapability;return this._requests.push(F),F.promise}cancel(F){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFFetchStream=void 0;var h=ot(1),P=ot(20);function rt(L,O,x){return{method:"GET",headers:L,signal:x.signal,mode:"cors",credentials:O?"include":"same-origin",redirect:"follow"}}function X(L){const O=new Headers;for(const x in L){const v=L[x];v!==void 0&&O.append(x,v)}return O}function pt(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,h.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class B{constructor(O){this.source=O,this.isHttp=/^https?:/i.test(O.url),this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new F(this),this._fullRequestReader}getRangeReader(O,x){if(x<=this._progressiveDataLength)return null;const v=new f(this,O,x);return this._rangeRequestReaders.push(v),v}cancelAllRequests(O){var x;(x=this._fullRequestReader)==null||x.cancel(O);for(const v of this._rangeRequestReaders.slice(0))v.cancel(O)}}d.PDFFetchStream=B;class F{constructor(O){this._stream=O,this._reader=null,this._loaded=0,this._filename=null;const x=O.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=new h.PromiseCapability,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=X(this._stream.httpHeaders);const v=x.url;fetch(v,rt(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,P.validateResponseStatus)(y.status))throw(0,P.createResponseStatusError)(y.status,v);this._reader=y.body.getReader(),this._headersCapability.resolve();const u=C=>y.headers.get(C),{allowRangeRequests:_,suggestedLength:w}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=w||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new h.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._headersCapability.promise;const{value:O,done:x}=await this._reader.read();return x?{value:O,done:x}:(this._loaded+=O.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded,total:this._contentLength}),{value:pt(O),done:!1})}cancel(O){var x;(x=this._reader)==null||x.cancel(O),this._abortController.abort()}}class f{constructor(O,x,v){this._stream=O,this._reader=null,this._loaded=0;const y=O.source;this._withCredentials=y.withCredentials||!1,this._readCapability=new h.PromiseCapability,this._isStreamingSupported=!y.disableStream,this._abortController=new AbortController,this._headers=X(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${v-1}`);const u=y.url;fetch(u,rt(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,P.validateResponseStatus)(_.status))throw(0,P.createResponseStatusError)(_.status,u);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._readCapability.promise;const{value:O,done:x}=await this._reader.read();return x?{value:O,done:x}:(this._loaded+=O.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded}),{value:pt(O),done:!1})}cancel(O){var x;(x=this._reader)==null||x.cancel(O),this._abortController.abort()}}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createResponseStatusError=B,d.extractFilenameFromHeader=pt,d.validateRangeRequestCapabilities=X,d.validateResponseStatus=F;var h=ot(1),P=ot(21),rt=ot(6);function X({getResponseHeader:f,isHttp:L,rangeChunkSize:O,disableRange:x}){const v={allowRangeRequests:!1,suggestedLength:void 0},y=parseInt(f("Content-Length"),10);return!Number.isInteger(y)||(v.suggestedLength=y,y<=2*O)||x||!L||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(v.allowRangeRequests=!0),v}function pt(f){const L=f("Content-Disposition");if(L){let O=(0,P.getFilenameFromContentDispositionHeader)(L);if(O.includes("%"))try{O=decodeURIComponent(O)}catch{}if((0,rt.isPdfFile)(O))return O}return null}function B(f,L){return f===404||f===0&&L.startsWith("file:")?new h.MissingPDFException('Missing PDF "'+L+'".'):new h.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${L}".`,f)}function F(f){return f===200||f===206}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.getFilenameFromContentDispositionHeader=P;var h=ot(1);function P(rt){let X=!0,pt=B("filename\\*","i").exec(rt);if(pt){pt=pt[1];let y=O(pt);return y=unescape(y),y=x(y),y=v(y),f(y)}if(pt=L(rt),pt){const y=v(pt);return f(y)}if(pt=B("filename","i").exec(rt),pt){pt=pt[1];let y=O(pt);return y=v(y),f(y)}function B(y,u){return new RegExp("(?:^|;)\\s*"+y+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function F(y,u){if(y){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const _=new TextDecoder(y,{fatal:!0}),w=(0,h.stringToBytes)(u);u=_.decode(w),X=!1}catch{}}return u}function f(y){return X&&/[\x80-\xff]/.test(y)&&(y=F("utf-8",y),X&&(y=F("iso-8859-1",y))),y}function L(y){const u=[];let _;const w=B("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=w.exec(y))!==null;){let[,A,a,l]=_;if(A=parseInt(A,10),A in u){if(A===0)break;continue}u[A]=[a,l]}const C=[];for(let A=0;A<u.length&&A in u;++A){let[a,l]=u[A];l=O(l),a&&(l=unescape(l),A===0&&(l=x(l))),C.push(l)}return C.join("")}function O(y){if(y.startsWith('"')){const u=y.slice(1).split('\\"');for(let _=0;_<u.length;++_){const w=u[_].indexOf('"');w!==-1&&(u[_]=u[_].slice(0,w),u.length=_+1),u[_]=u[_].replaceAll(/\\(.)/g,"$1")}y=u.join('"')}return y}function x(y){const u=y.indexOf("'");if(u===-1)return y;const _=y.slice(0,u),C=y.slice(u+1).replace(/^[^']*'/,"");return F(_,C)}function v(y){return!y.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(y)?y:y.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,_,w,C){if(w==="q"||w==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,a){return String.fromCharCode(parseInt(a,16))}),F(_,C);try{C=atob(C)}catch{}return F(_,C)})}return""}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFNetworkStream=void 0;var h=ot(1),P=ot(20);const rt=200,X=206;function pt(O){const x=O.response;return typeof x!="string"?x:(0,h.stringToBytes)(x).buffer}class B{constructor(x,v={}){this.url=x,this.isHttp=/^https?:/i.test(x),this.httpHeaders=this.isHttp&&v.httpHeaders||Object.create(null),this.withCredentials=v.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(x,v,y){const u={begin:x,end:v};for(const _ in y)u[_]=y[_];return this.request(u)}requestFull(x){return this.request(x)}request(x){const v=new XMLHttpRequest,y=this.currXhrId++,u=this.pendingRequests[y]={xhr:v};v.open("GET",this.url),v.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const w=this.httpHeaders[_];w!==void 0&&v.setRequestHeader(_,w)}return this.isHttp&&"begin"in x&&"end"in x?(v.setRequestHeader("Range",`bytes=${x.begin}-${x.end-1}`),u.expectedStatus=X):u.expectedStatus=rt,v.responseType="arraybuffer",x.onError&&(v.onerror=function(_){x.onError(v.status)}),v.onreadystatechange=this.onStateChange.bind(this,y),v.onprogress=this.onProgress.bind(this,y),u.onHeadersReceived=x.onHeadersReceived,u.onDone=x.onDone,u.onError=x.onError,u.onProgress=x.onProgress,v.send(null),y}onProgress(x,v){var u;const y=this.pendingRequests[x];y&&((u=y.onProgress)==null||u.call(y,v))}onStateChange(x,v){var A,a,l;const y=this.pendingRequests[x];if(!y)return;const u=y.xhr;if(u.readyState>=2&&y.onHeadersReceived&&(y.onHeadersReceived(),delete y.onHeadersReceived),u.readyState!==4||!(x in this.pendingRequests))return;if(delete this.pendingRequests[x],u.status===0&&this.isHttp){(A=y.onError)==null||A.call(y,u.status);return}const _=u.status||rt;if(!(_===rt&&y.expectedStatus===X)&&_!==y.expectedStatus){(a=y.onError)==null||a.call(y,u.status);return}const C=pt(u);if(_===X){const k=u.getResponseHeader("Content-Range"),g=/bytes (\d+)-(\d+)\/(\d+)/.exec(k);y.onDone({begin:parseInt(g[1],10),chunk:C})}else C?y.onDone({begin:0,chunk:C}):(l=y.onError)==null||l.call(y,u.status)}getRequestXhr(x){return this.pendingRequests[x].xhr}isPendingRequest(x){return x in this.pendingRequests}abortRequest(x){const v=this.pendingRequests[x].xhr;delete this.pendingRequests[x],v.abort()}}class F{constructor(x){this._source=x,this._manager=new B(x.url,{httpHeaders:x.httpHeaders,withCredentials:x.withCredentials}),this._rangeChunkSize=x.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(x){const v=this._rangeRequestReaders.indexOf(x);v>=0&&this._rangeRequestReaders.splice(v,1)}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(x,v){const y=new L(this._manager,x,v);return y.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(y),y}cancelAllRequests(x){var v;(v=this._fullRequestReader)==null||v.cancel(x);for(const y of this._rangeRequestReaders.slice(0))y.cancel(x)}}d.PDFNetworkStream=F;class f{constructor(x,v){this._manager=x;const y={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._fullRequestId=x.requestFull(y),this._headersReceivedCapability=new h.PromiseCapability,this._disableRange=v.disableRange||!1,this._contentLength=v.length,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const x=this._fullRequestId,v=this._manager.getRequestXhr(x),y=w=>v.getResponseHeader(w),{allowRangeRequests:u,suggestedLength:_}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(y),this._isRangeSupported&&this._manager.abortRequest(x),this._headersReceivedCapability.resolve()}_onDone(x){if(x&&(this._requests.length>0?this._requests.shift().resolve({value:x.chunk,done:!1}):this._cachedChunks.push(x.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(x){this._storedError=(0,P.createResponseStatusError)(x,this._url),this._headersReceivedCapability.reject(this._storedError);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(x){var v;(v=this.onProgress)==null||v.call(this,{loaded:x.loaded,total:x.lengthComputable?x.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new h.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0,this._headersReceivedCapability.reject(x);for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(x,v,y){this._manager=x;const u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._requestId=x.requestRange(v,y,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var x;(x=this.onClosed)==null||x.call(this,this)}_onDone(x){const v=x.chunk;this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunk=v,this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(x){this._storedError=(0,P.createResponseStatusError)(x,this._url);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(x){var v;this.isStreamingSupported||(v=this.onProgress)==null||v.call(this,{loaded:x.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new h.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFNodeStream=void 0;var h=ot(1),P=ot(20);const rt=/^file:\/\/\/[a-zA-Z]:\//;function X(y){const u=require$$5,_=u.parse(y);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(y)?u.parse(`file:///${y}`):(_.host||(_.protocol="file:"),_)}class pt{constructor(u){this.source=u,this.url=X(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}getFullReader(){return(0,h.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new x(this):new L(this),this._fullRequestReader}getRangeReader(u,_){if(_<=this._progressiveDataLength)return null;const w=this.isFsUrl?new v(this,u,_):new O(this,u,_);return this._rangeRequestReaders.push(w),w}cancelAllRequests(u){var _;(_=this._fullRequestReader)==null||_.cancel(u);for(const w of this._rangeRequestReaders.slice(0))w.cancel(u)}}d.PDFNodeStream=pt;class B{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;const _=u.source;this._contentLength=_.length,this._loaded=0,this._filename=null,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._readableStream=null,this._readCapability=new h.PromiseCapability,this._headersCapability=new h.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new h.PromiseCapability,this.read()):(this._loaded+=u.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new h.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class F{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new h.PromiseCapability;const _=u.source;this._isStreamingSupported=!_.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var w;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new h.PromiseCapability,this.read()):(this._loaded+=u.length,(w=this.onProgress)==null||w.call(this,{loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(y,u){return{protocol:y.protocol,auth:y.auth,host:y.hostname,port:y.port,path:y.path,method:"GET",headers:u}}class L extends B{constructor(u){super(u);const _=w=>{if(w.statusCode===404){const l=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(w);const C=l=>this._readableStream.headers[l.toLowerCase()],{allowRangeRequests:A,suggestedLength:a}=(0,P.validateRangeRequestCapabilities)({getResponseHeader:C,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=a||this._contentLength,this._filename=(0,P.extractFilenameFromHeader)(C)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(f(this._url,u.httpHeaders),_)}else{const w=require$$5;this._request=w.request(f(this._url,u.httpHeaders),_)}this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class O extends F{constructor(u,_,w){super(u),this._httpHeaders={};for(const A in u.httpHeaders){const a=u.httpHeaders[A];a!==void 0&&(this._httpHeaders[A]=a)}this._httpHeaders.Range=`bytes=${_}-${w-1}`;const C=A=>{if(A.statusCode===404){const a=new h.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(f(this._url,this._httpHeaders),C)}else{const A=require$$5;this._request=A.request(f(this._url,this._httpHeaders),C)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class x extends B{constructor(u){super(u);let _=decodeURIComponent(this._url.path);rt.test(this._url.href)&&(_=_.replace(/^\//,""));const w=require$$5;w.lstat(_,(C,A)=>{if(C){C.code==="ENOENT"&&(C=new h.MissingPDFException(`Missing PDF "${_}".`)),this._storedError=C,this._headersCapability.reject(C);return}this._contentLength=A.size,this._setReadableStream(w.createReadStream(_)),this._headersCapability.resolve()})}}class v extends F{constructor(u,_,w){super(u);let C=decodeURIComponent(this._url.path);rt.test(this._url.href)&&(C=C.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(C,{start:_,end:w-1}))}}},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.SVGGraphics=void 0;var h=ot(6),P=ot(1);const rt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},X="http://www.w3.org/XML/1998/namespace",pt="http://www.w3.org/1999/xlink",B=["butt","round","square"],F=["miter","round","bevel"],f=function(A,a="",l=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!l)return URL.createObjectURL(new Blob([A],{type:a}));const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let g=`data:${a};base64,`;for(let r=0,T=A.length;r<T;r+=3){const m=A[r]&255,U=A[r+1]&255,V=A[r+2]&255,E=m>>2,$=(m&3)<<4|U>>4,st=r+1<T?(U&15)<<2|V>>6:64,at=r+2<T?V&63:64;g+=k[E]+k[$]+k[st]+k[at]}return g},L=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,l=new Int32Array(256);for(let V=0;V<256;V++){let E=V;for(let $=0;$<8;$++)E=E&1?3988292384^E>>1&2147483647:E>>1&2147483647;l[V]=E}function k(V,E,$){let st=-1;for(let at=E;at<$;at++){const H=(st^V[at])&255,ct=l[H];st=st>>>8^ct}return st^-1}function g(V,E,$,st){let at=st;const H=E.length;$[at]=H>>24&255,$[at+1]=H>>16&255,$[at+2]=H>>8&255,$[at+3]=H&255,at+=4,$[at]=V.charCodeAt(0)&255,$[at+1]=V.charCodeAt(1)&255,$[at+2]=V.charCodeAt(2)&255,$[at+3]=V.charCodeAt(3)&255,at+=4,$.set(E,at),at+=E.length;const ct=k($,st+4,at);$[at]=ct>>24&255,$[at+1]=ct>>16&255,$[at+2]=ct>>8&255,$[at+3]=ct&255}function r(V,E,$){let st=1,at=0;for(let H=E;H<$;++H)st=(st+(V[H]&255))%65521,at=(at+st)%65521;return at<<16|st}function T(V){if(!P.isNodeJS)return m(V);try{const E=parseInt(process.versions.node)>=8?V:Buffer.from(V),$=require$$5.deflateSync(E,{level:9});return $ instanceof Uint8Array?$:new Uint8Array($)}catch(E){(0,P.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+E)}return m(V)}function m(V){let E=V.length;const $=65535,st=Math.ceil(E/$),at=new Uint8Array(2+E+st*5+4);let H=0;at[H++]=120,at[H++]=156;let ct=0;for(;E>$;)at[H++]=0,at[H++]=255,at[H++]=255,at[H++]=0,at[H++]=0,at.set(V.subarray(ct,ct+$),H),H+=$,ct+=$,E-=$;at[H++]=1,at[H++]=E&255,at[H++]=E>>8&255,at[H++]=~E&65535&255,at[H++]=(~E&65535)>>8&255,at.set(V.subarray(ct),H),H+=V.length-ct;const gt=r(V,0,V.length);return at[H++]=gt>>24&255,at[H++]=gt>>16&255,at[H++]=gt>>8&255,at[H++]=gt&255,at}function U(V,E,$,st){const at=V.width,H=V.height;let ct,gt,Ct;const kt=V.data;switch(E){case P.ImageKind.GRAYSCALE_1BPP:gt=0,ct=1,Ct=at+7>>3;break;case P.ImageKind.RGB_24BPP:gt=2,ct=8,Ct=at*3;break;case P.ImageKind.RGBA_32BPP:gt=6,ct=8,Ct=at*4;break;default:throw new Error("invalid format")}const S=new Uint8Array((1+Ct)*H);let i=0,n=0;for(let N=0;N<H;++N)S[i++]=0,S.set(kt.subarray(n,n+Ct),i),n+=Ct,i+=Ct;if(E===P.ImageKind.GRAYSCALE_1BPP&&st){i=0;for(let N=0;N<H;N++){i++;for(let et=0;et<Ct;et++)S[i++]^=255}}const s=new Uint8Array([at>>24&255,at>>16&255,at>>8&255,at&255,H>>24&255,H>>16&255,H>>8&255,H&255,ct,gt,0,0,0]),o=T(S),c=A.length+a*3+s.length+o.length,b=new Uint8Array(c);let M=0;return b.set(A,M),M+=A.length,g("IHDR",s,b,M),M+=a+s.length,g("IDATA",o,b,M),M+=a+o.length,g("IEND",new Uint8Array(0),b,M),f(b,"image/png",$)}return function(E,$,st){const at=E.kind===void 0?P.ImageKind.GRAYSCALE_1BPP:E.kind;return U(E,at,$,st)}}();class O{constructor(){this.fontSizeScale=1,this.fontWeight=rt.fontWeight,this.fontSize=0,this.textMatrix=P.IDENTITY_MATRIX,this.fontMatrix=P.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=P.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=rt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,l){this.x=a,this.y=l}}function x(A){let a=[];const l=[];for(const k of A){if(k.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),l.push(a),a=a.at(-1).items;continue}k.fn==="restore"?a=l.pop():a.push(k)}return a}function v(A){if(Number.isInteger(A))return A.toString();const a=A.toFixed(10);let l=a.length-1;if(a[l]!=="0")return a;do l--;while(a[l]==="0");return a.substring(0,a[l]==="."?l:l+1)}function y(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${v(A[0])} ${v(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const a=Math.acos(A[0])*180/Math.PI;return`rotate(${v(a)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${v(A[4])} ${v(A[5])})`;return`matrix(${v(A[0])} ${v(A[1])} ${v(A[2])} ${v(A[3])} ${v(A[4])} ${v(A[5])})`}let u=0,_=0,w=0;class C{constructor(a,l,k=!1){(0,h.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new h.DOMSVGFactory,this.current=new O,this.transformMatrix=P.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=l,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(const g in P.OPS)this._operatorIdMapping[P.OPS[g]]=g}getObject(a,l=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):l}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const l=a.fnArray,k=a.argsArray;for(let g=0,r=l.length;g<r;g++)if(l[g]===P.OPS.dependency)for(const T of k[g]){const m=T.startsWith("g_")?this.commonObjs:this.objs,U=new Promise(V=>{m.get(T,V)});this.current.dependencies.push(U)}return Promise.all(this.current.dependencies)}transform(a,l,k,g,r,T){const m=[a,l,k,g,r,T];this.transformMatrix=P.Util.transform(this.transformMatrix,m),this.tgrp=null}getSVG(a,l){this.viewport=l;const k=this._initialize(l);return this.loadDependencies(a).then(()=>(this.transformMatrix=P.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),k))}convertOpList(a){const l=this._operatorIdMapping,k=a.argsArray,g=a.fnArray,r=[];for(let T=0,m=g.length;T<m;T++){const U=g[T];r.push({fnId:U,fn:l[U],args:k[T]})}return x(r)}executeOpTree(a){for(const l of a){const k=l.fn,g=l.fnId,r=l.args;switch(g|0){case P.OPS.beginText:this.beginText();break;case P.OPS.dependency:break;case P.OPS.setLeading:this.setLeading(r);break;case P.OPS.setLeadingMoveText:this.setLeadingMoveText(r[0],r[1]);break;case P.OPS.setFont:this.setFont(r);break;case P.OPS.showText:this.showText(r[0]);break;case P.OPS.showSpacedText:this.showText(r[0]);break;case P.OPS.endText:this.endText();break;case P.OPS.moveText:this.moveText(r[0],r[1]);break;case P.OPS.setCharSpacing:this.setCharSpacing(r[0]);break;case P.OPS.setWordSpacing:this.setWordSpacing(r[0]);break;case P.OPS.setHScale:this.setHScale(r[0]);break;case P.OPS.setTextMatrix:this.setTextMatrix(r[0],r[1],r[2],r[3],r[4],r[5]);break;case P.OPS.setTextRise:this.setTextRise(r[0]);break;case P.OPS.setTextRenderingMode:this.setTextRenderingMode(r[0]);break;case P.OPS.setLineWidth:this.setLineWidth(r[0]);break;case P.OPS.setLineJoin:this.setLineJoin(r[0]);break;case P.OPS.setLineCap:this.setLineCap(r[0]);break;case P.OPS.setMiterLimit:this.setMiterLimit(r[0]);break;case P.OPS.setFillRGBColor:this.setFillRGBColor(r[0],r[1],r[2]);break;case P.OPS.setStrokeRGBColor:this.setStrokeRGBColor(r[0],r[1],r[2]);break;case P.OPS.setStrokeColorN:this.setStrokeColorN(r);break;case P.OPS.setFillColorN:this.setFillColorN(r);break;case P.OPS.shadingFill:this.shadingFill(r[0]);break;case P.OPS.setDash:this.setDash(r[0],r[1]);break;case P.OPS.setRenderingIntent:this.setRenderingIntent(r[0]);break;case P.OPS.setFlatness:this.setFlatness(r[0]);break;case P.OPS.setGState:this.setGState(r[0]);break;case P.OPS.fill:this.fill();break;case P.OPS.eoFill:this.eoFill();break;case P.OPS.stroke:this.stroke();break;case P.OPS.fillStroke:this.fillStroke();break;case P.OPS.eoFillStroke:this.eoFillStroke();break;case P.OPS.clip:this.clip("nonzero");break;case P.OPS.eoClip:this.clip("evenodd");break;case P.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case P.OPS.paintImageXObject:this.paintImageXObject(r[0]);break;case P.OPS.paintInlineImageXObject:this.paintInlineImageXObject(r[0]);break;case P.OPS.paintImageMaskXObject:this.paintImageMaskXObject(r[0]);break;case P.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(r[0],r[1]);break;case P.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case P.OPS.closePath:this.closePath();break;case P.OPS.closeStroke:this.closeStroke();break;case P.OPS.closeFillStroke:this.closeFillStroke();break;case P.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case P.OPS.nextLine:this.nextLine();break;case P.OPS.transform:this.transform(r[0],r[1],r[2],r[3],r[4],r[5]);break;case P.OPS.constructPath:this.constructPath(r[0],r[1]);break;case P.OPS.endPath:this.endPath();break;case 92:this.group(l.items);break;default:(0,P.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,l,k,g,r,T){const m=this.current;m.textMatrix=m.lineMatrix=[a,l,k,g,r,T],m.textMatrixScale=Math.hypot(a,l),m.x=m.lineX=0,m.y=m.lineY=0,m.xcoords=[],m.ycoords=[],m.tspan=this.svgFactory.createElement("svg:tspan"),m.tspan.setAttributeNS(null,"font-family",m.fontFamily),m.tspan.setAttributeNS(null,"font-size",`${v(m.fontSize)}px`),m.tspan.setAttributeNS(null,"y",v(-m.y)),m.txtElement=this.svgFactory.createElement("svg:text"),m.txtElement.append(m.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=P.IDENTITY_MATRIX,a.lineMatrix=P.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,l){const k=this.current;k.x=k.lineX+=a,k.y=k.lineY+=l,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${v(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",v(-k.y))}showText(a){const l=this.current,k=l.font,g=l.fontSize;if(g===0)return;const r=l.fontSizeScale,T=l.charSpacing,m=l.wordSpacing,U=l.fontDirection,V=l.textHScale*U,E=k.vertical,$=E?1:-1,st=k.defaultVMetrics,at=g*l.fontMatrix[0];let H=0;for(const Ct of a){if(Ct===null){H+=U*m;continue}else if(typeof Ct=="number"){H+=$*Ct*g/1e3;continue}const kt=(Ct.isSpace?m:0)+T,S=Ct.fontChar;let i,n,s=Ct.width;if(E){let c;const b=Ct.vmetric||st;c=Ct.vmetric?b[1]:s*.5,c=-c*at;const M=b[2]*at;s=b?-b[0]:s,i=c/r,n=(H+M)/r}else i=H/r,n=0;(Ct.isInFont||k.missingFile)&&(l.xcoords.push(l.x+i),E&&l.ycoords.push(-l.y+n),l.tspan.textContent+=S);const o=E?s*at-kt*U:s*at+kt*U;H+=o}l.tspan.setAttributeNS(null,"x",l.xcoords.map(v).join(" ")),E?l.tspan.setAttributeNS(null,"y",l.ycoords.map(v).join(" ")):l.tspan.setAttributeNS(null,"y",v(-l.y)),E?l.y-=H:l.x+=H*V,l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${v(l.fontSize)}px`),l.fontStyle!==rt.fontStyle&&l.tspan.setAttributeNS(null,"font-style",l.fontStyle),l.fontWeight!==rt.fontWeight&&l.tspan.setAttributeNS(null,"font-weight",l.fontWeight);const ct=l.textRenderingMode&P.TextRenderingMode.FILL_STROKE_MASK;if(ct===P.TextRenderingMode.FILL||ct===P.TextRenderingMode.FILL_STROKE?(l.fillColor!==rt.fillColor&&l.tspan.setAttributeNS(null,"fill",l.fillColor),l.fillAlpha<1&&l.tspan.setAttributeNS(null,"fill-opacity",l.fillAlpha)):l.textRenderingMode===P.TextRenderingMode.ADD_TO_PATH?l.tspan.setAttributeNS(null,"fill","transparent"):l.tspan.setAttributeNS(null,"fill","none"),ct===P.TextRenderingMode.STROKE||ct===P.TextRenderingMode.FILL_STROKE){const Ct=1/(l.textMatrixScale||1);this._setStrokeAttributes(l.tspan,Ct)}let gt=l.textMatrix;l.textRise!==0&&(gt=gt.slice(),gt[5]+=l.textRise),l.txtElement.setAttributeNS(null,"transform",`${y(gt)} scale(${v(V)}, -1)`),l.txtElement.setAttributeNS(X,"xml:space","preserve"),l.txtElement.append(l.tspan),l.txtgrp.append(l.txtElement),this._ensureTransformGroup().append(l.txtElement)}setLeadingMoveText(a,l){this.setLeading(-l),this.moveText(a,l)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const l=f(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${l}); }
`}setFont(a){const l=this.current,k=this.commonObjs.get(a[0]);let g=a[1];l.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),l.fontMatrix=k.fontMatrix||P.FONT_IDENTITY_MATRIX;let r="normal";k.black?r="900":k.bold&&(r="bold");const T=k.italic?"italic":"normal";g<0?(g=-g,l.fontDirection=-1):l.fontDirection=1,l.fontSize=g,l.fontFamily=k.loadedName,l.fontWeight=r,l.fontStyle=T,l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"y",v(-l.y)),l.xcoords=[],l.ycoords=[]}endText(){var l;const a=this.current;a.textRenderingMode&P.TextRenderingMode.ADD_TO_PATH_FLAG&&((l=a.txtElement)!=null&&l.hasChildNodes())&&(a.element=a.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=B[a]}setLineJoin(a){this.current.lineJoin=F[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,l,k){this.current.strokeColor=P.Util.makeHexColor(a,l,k)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,l,k){this.current.fillColor=P.Util.makeHexColor(a,l,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const{width:l,height:k}=this.viewport,g=P.Util.inverseTransform(this.transformMatrix),[r,T,m,U]=P.Util.getAxialAlignedBoundingBox([0,0,l,k],g),V=this.svgFactory.createElement("svg:rect");V.setAttributeNS(null,"x",r),V.setAttributeNS(null,"y",T),V.setAttributeNS(null,"width",m-r),V.setAttributeNS(null,"height",U-T),V.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&V.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(V)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const l=a[1],k=a[2],g=a[3]||P.IDENTITY_MATRIX,[r,T,m,U]=a[4],V=a[5],E=a[6],$=a[7],st=`shading${w++}`,[at,H,ct,gt]=P.Util.normalizeRect([...P.Util.applyTransform([r,T],g),...P.Util.applyTransform([m,U],g)]),[Ct,kt]=P.Util.singularValueDecompose2dScale(g),S=V*Ct,i=E*kt,n=this.svgFactory.createElement("svg:pattern");n.setAttributeNS(null,"id",st),n.setAttributeNS(null,"patternUnits","userSpaceOnUse"),n.setAttributeNS(null,"width",S),n.setAttributeNS(null,"height",i),n.setAttributeNS(null,"x",`${at}`),n.setAttributeNS(null,"y",`${H}`);const s=this.svg,o=this.transformMatrix,c=this.current.fillColor,b=this.current.strokeColor,M=this.svgFactory.create(ct-at,gt-H);if(this.svg=M,this.transformMatrix=g,$===2){const N=P.Util.makeHexColor(...l);this.current.fillColor=N,this.current.strokeColor=N}return this.executeOpTree(this.convertOpList(k)),this.svg=s,this.transformMatrix=o,this.current.fillColor=c,this.current.strokeColor=b,n.append(M.childNodes[0]),this.defs.append(n),`url(#${st})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const l=`shading${w++}`,k=a[3];let g;switch(a[1]){case"axial":const r=a[4],T=a[5];g=this.svgFactory.createElement("svg:linearGradient"),g.setAttributeNS(null,"id",l),g.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),g.setAttributeNS(null,"x1",r[0]),g.setAttributeNS(null,"y1",r[1]),g.setAttributeNS(null,"x2",T[0]),g.setAttributeNS(null,"y2",T[1]);break;case"radial":const m=a[4],U=a[5],V=a[6],E=a[7];g=this.svgFactory.createElement("svg:radialGradient"),g.setAttributeNS(null,"id",l),g.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),g.setAttributeNS(null,"cx",U[0]),g.setAttributeNS(null,"cy",U[1]),g.setAttributeNS(null,"r",E),g.setAttributeNS(null,"fx",m[0]),g.setAttributeNS(null,"fy",m[1]),g.setAttributeNS(null,"fr",V);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const r of k){const T=this.svgFactory.createElement("svg:stop");T.setAttributeNS(null,"offset",r[0]),T.setAttributeNS(null,"stop-color",r[1]),g.append(T)}return this.defs.append(g),`url(#${l})`;case"Mesh":return(0,P.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,l){this.current.dashArray=a,this.current.dashPhase=l}constructPath(a,l){const k=this.current;let g=k.x,r=k.y,T=[],m=0;for(const U of a)switch(U|0){case P.OPS.rectangle:g=l[m++],r=l[m++];const V=l[m++],E=l[m++],$=g+V,st=r+E;T.push("M",v(g),v(r),"L",v($),v(r),"L",v($),v(st),"L",v(g),v(st),"Z");break;case P.OPS.moveTo:g=l[m++],r=l[m++],T.push("M",v(g),v(r));break;case P.OPS.lineTo:g=l[m++],r=l[m++],T.push("L",v(g),v(r));break;case P.OPS.curveTo:g=l[m+4],r=l[m+5],T.push("C",v(l[m]),v(l[m+1]),v(l[m+2]),v(l[m+3]),v(g),v(r)),m+=6;break;case P.OPS.curveTo2:T.push("C",v(g),v(r),v(l[m]),v(l[m+1]),v(l[m+2]),v(l[m+3])),g=l[m+2],r=l[m+3],m+=4;break;case P.OPS.curveTo3:g=l[m+2],r=l[m+3],T.push("C",v(l[m]),v(l[m+1]),v(g),v(r),v(g),v(r)),m+=4;break;case P.OPS.closePath:T.push("Z");break}T=T.join(" "),k.path&&a.length>0&&a[0]!==P.OPS.rectangle&&a[0]!==P.OPS.moveTo?T=k.path.getAttributeNS(null,"d")+T:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(k.path)),k.path.setAttributeNS(null,"d",T),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(g,r)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const l=`clippath${u++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",l),k.setAttributeNS(null,"transform",y(this.transformMatrix));const g=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?g.setAttributeNS(null,"clip-rule","evenodd"):g.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.append(g),this.defs.append(k),a.activeClipUrl){a.clipGroup=null;for(const r of this.extraStack)r.clipGroup=null;k.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${l})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const l=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",l)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[l,k]of a)switch(l){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,P.warn)(`Unimplemented graphic state operator ${l}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a,l=1){const k=this.current;let g=k.dashArray;l!==1&&g.length>0&&(g=g.map(function(r){return l*r})),a.setAttributeNS(null,"stroke",k.strokeColor),a.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",v(k.miterLimit)),a.setAttributeNS(null,"stroke-linecap",k.lineCap),a.setAttributeNS(null,"stroke-linejoin",k.lineJoin),a.setAttributeNS(null,"stroke-width",v(l*k.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",g.map(v).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",v(l*k.dashPhase)+"px")}eoFill(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const l=this.getObject(a);if(!l){(0,P.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(l)}paintInlineImageXObject(a,l){const k=a.width,g=a.height,r=L(a,this.forceDataSchema,!!l),T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",v(k)),T.setAttributeNS(null,"height",v(g)),this.current.element=T,this.clip("nonzero");const m=this.svgFactory.createElement("svg:image");m.setAttributeNS(pt,"xlink:href",r),m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y",v(-g)),m.setAttributeNS(null,"width",v(k)+"px"),m.setAttributeNS(null,"height",v(g)+"px"),m.setAttributeNS(null,"transform",`scale(${v(1/k)} ${v(-1/g)})`),l?l.append(m):this._ensureTransformGroup().append(m)}paintImageMaskXObject(a){const l=this.getObject(a.data,a);if(l.bitmap){(0,P.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const k=this.current,g=l.width,r=l.height,T=k.fillColor;k.maskId=`mask${_++}`;const m=this.svgFactory.createElement("svg:mask");m.setAttributeNS(null,"id",k.maskId);const U=this.svgFactory.createElement("svg:rect");U.setAttributeNS(null,"x","0"),U.setAttributeNS(null,"y","0"),U.setAttributeNS(null,"width",v(g)),U.setAttributeNS(null,"height",v(r)),U.setAttributeNS(null,"fill",T),U.setAttributeNS(null,"mask",`url(#${k.maskId})`),this.defs.append(m),this._ensureTransformGroup().append(U),this.paintInlineImageXObject(l,m)}paintFormXObjectBegin(a,l){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),l){const k=l[2]-l[0],g=l[3]-l[1],r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x",l[0]),r.setAttributeNS(null,"y",l[1]),r.setAttributeNS(null,"width",v(k)),r.setAttributeNS(null,"height",v(g)),this.current.element=r,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const l=this.svgFactory.create(a.width,a.height),k=this.svgFactory.createElement("svg:defs");l.append(k),this.defs=k;const g=this.svgFactory.createElement("svg:g");return g.setAttributeNS(null,"transform",y(a.transform)),l.append(g),this.svg=g,l}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",y(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}d.SVGGraphics=C},(mt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.XfaText=void 0;class ot{static textContent(P){const rt=[],X={items:rt,styles:Object.create(null)};function pt(B){var L;if(!B)return;let F=null;const f=B.name;if(f==="#text")F=B.value;else if(ot.shouldBuildText(f))(L=B==null?void 0:B.attributes)!=null&&L.textContent?F=B.attributes.textContent:B.value&&(F=B.value);else return;if(F!==null&&rt.push({str:F}),!!B.children)for(const O of B.children)pt(O)}return pt(P),X}static shouldBuildText(P){return!(P==="textarea"||P==="input"||P==="option"||P==="select")}}d.XfaText=ot},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TextLayerRenderTask=void 0,d.renderTextLayer=y,d.updateTextLayer=u;var h=ot(1),P=ot(6);const rt=1e5,X=30,pt=.8,B=new Map;function F(_,w){let C;if(w&&h.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=_,C=A.getContext("2d",{alpha:!1})}return C}function f(_,w){const C=B.get(_);if(C)return C;const A=F(X,w);A.font=`${X}px ${_}`;const a=A.measureText("");let l=a.fontBoundingBoxAscent,k=Math.abs(a.fontBoundingBoxDescent);if(l){const r=l/(l+k);return B.set(_,r),A.canvas.width=A.canvas.height=0,r}A.strokeStyle="red",A.clearRect(0,0,X,X),A.strokeText("g",0,0);let g=A.getImageData(0,0,X,X).data;k=0;for(let r=g.length-1-3;r>=0;r-=4)if(g[r]>0){k=Math.ceil(r/4/X);break}A.clearRect(0,0,X,X),A.strokeText("A",0,X),g=A.getImageData(0,0,X,X).data,l=0;for(let r=0,T=g.length;r<T;r+=4)if(g[r]>0){l=X-Math.floor(r/4/X);break}if(A.canvas.width=A.canvas.height=0,l){const r=l/(l+k);return B.set(_,r),r}return B.set(_,pt),pt}function L(_,w,C){const A=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};_._textDivs.push(A);const l=h.Util.transform(_._transform,w.transform);let k=Math.atan2(l[1],l[0]);const g=C[w.fontName];g.vertical&&(k+=Math.PI/2);const r=Math.hypot(l[2],l[3]),T=r*f(g.fontFamily,_._isOffscreenCanvasSupported);let m,U;k===0?(m=l[4],U=l[5]-T):(m=l[4]+T*Math.sin(k),U=l[5]-T*Math.cos(k));const V="calc(var(--scale-factor)*",E=A.style;_._container===_._rootContainer?(E.left=`${(100*m/_._pageWidth).toFixed(2)}%`,E.top=`${(100*U/_._pageHeight).toFixed(2)}%`):(E.left=`${V}${m.toFixed(2)}px)`,E.top=`${V}${U.toFixed(2)}px)`),E.fontSize=`${V}${r.toFixed(2)}px)`,E.fontFamily=g.fontFamily,a.fontSize=r,A.setAttribute("role","presentation"),A.textContent=w.str,A.dir=w.dir,_._fontInspectorEnabled&&(A.dataset.fontName=w.fontName),k!==0&&(a.angle=k*(180/Math.PI));let $=!1;if(w.str.length>1)$=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const st=Math.abs(w.transform[0]),at=Math.abs(w.transform[3]);st!==at&&Math.max(st,at)/Math.min(st,at)>1.5&&($=!0)}$&&(a.canvasWidth=g.vertical?w.height:w.width),_._textDivProperties.set(A,a),_._isReadableStream&&_._layoutText(A)}function O(_){const{div:w,scale:C,properties:A,ctx:a,prevFontSize:l,prevFontFamily:k}=_,{style:g}=w;let r="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:T}=g,{canvasWidth:m,fontSize:U}=A;(l!==U||k!==T)&&(a.font=`${U*C}px ${T}`,_.prevFontSize=U,_.prevFontFamily=T);const{width:V}=a.measureText(w.textContent);V>0&&(r=`scaleX(${m*C/V})`)}A.angle!==0&&(r=`rotate(${A.angle}deg) ${r}`),r.length>0&&(g.transform=r)}function x(_){if(_._canceled)return;const w=_._textDivs,C=_._capability;if(w.length>rt){C.resolve();return}if(!_._isReadableStream)for(const a of w)_._layoutText(a);C.resolve()}class v{constructor({textContentSource:w,container:C,viewport:A,textDivs:a,textDivProperties:l,textContentItemsStr:k,isOffscreenCanvasSupported:g}){var V;this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=a||[],this._textContentItemsStr=k||[],this._isOffscreenCanvasSupported=g,this._fontInspectorEnabled=!!((V=globalThis.FontInspector)!=null&&V.enabled),this._reader=null,this._textDivProperties=l||new WeakMap,this._canceled=!1,this._capability=new h.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:F(0,g)};const{pageWidth:r,pageHeight:T,pageX:m,pageY:U}=A.rawDims;this._transform=[1,0,0,-1,-m,U+T],this._pageWidth=r,this._pageHeight=T,(0,P.setLayerDimensions)(C,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new h.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new h.AbortException("TextLayer task cancelled."))}_processItems(w,C){for(const A of w){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const a=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),a.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),L(this,A,C)}}_layoutText(w){const C=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,O(this._layoutTextParams),C.hasText&&this._container.append(w),C.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const w=new h.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:a,done:l})=>{if(l){w.resolve();return}Object.assign(C,a.styles),this._processItems(a.items,C),A()},w.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:a}=this._textContentSource;this._processItems(A,a),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{C=null,x(this)},this._capability.reject)}}d.TextLayerRenderTask=v;function y(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,P.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:w,viewport:C}=_,A=getComputedStyle(w),a=A.getPropertyValue("visibility"),l=parseFloat(A.getPropertyValue("--scale-factor"));a==="visible"&&(!l||Math.abs(l-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const k=new v(_);return k._render(),k}function u({container:_,viewport:w,textDivs:C,textDivProperties:A,isOffscreenCanvasSupported:a,mustRotate:l=!0,mustRescale:k=!0}){if(l&&(0,P.setLayerDimensions)(_,{rotation:w.rotation}),k){const g=F(0,a),T={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:g};for(const m of C)T.properties=A.get(m),T.div=m,O(T)}}},(mt,d,ot)=>{var f,L,O,x,v,y,u,_,w,C,A,ii,l,Fe,g,si,T,ni;Object.defineProperty(d,"__esModule",{value:!0}),d.AnnotationEditorLayer=void 0;var h=ot(1),P=ot(4),rt=ot(28),X=ot(33),pt=ot(6),B=ot(34);const U=class U{constructor({uiManager:E,pageIndex:$,div:st,accessibilityManager:at,annotationLayer:H,viewport:ct,l10n:gt}){I(this,A);I(this,l);I(this,g);I(this,T);I(this,f,void 0);I(this,L,!1);I(this,O,null);I(this,x,this.pointerup.bind(this));I(this,v,this.pointerdown.bind(this));I(this,y,new Map);I(this,u,!1);I(this,_,!1);I(this,w,!1);I(this,C,void 0);const Ct=[rt.FreeTextEditor,X.InkEditor,B.StampEditor];if(!U._initialized){U._initialized=!0;for(const kt of Ct)kt.initialize(gt)}E.registerEditorTypes(Ct),tt(this,C,E),this.pageIndex=$,this.div=st,tt(this,f,at),tt(this,O,H),this.viewport=ct,t(this,C).addLayer(this)}get isEmpty(){return t(this,y).size===0}updateToolbar(E){t(this,C).updateToolbar(E)}updateMode(E=t(this,C).getMode()){W(this,T,ni).call(this),E===h.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),E!==h.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",E===h.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",E===h.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",E===h.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(E){if(!E&&t(this,C).getMode()!==h.AnnotationEditorType.INK)return;if(!E){for(const st of t(this,y).values())if(st.isEmpty()){st.setInBackground();return}}W(this,l,Fe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(E){t(this,C).setEditingState(E)}addCommands(E){t(this,C).addCommands(E)}enable(){this.div.style.pointerEvents="auto";const E=new Set;for(const st of t(this,y).values())st.enableEditing(),st.annotationElementId&&E.add(st.annotationElementId);if(!t(this,O))return;const $=t(this,O).getEditableAnnotations();for(const st of $){if(st.hide(),t(this,C).isDeletedAnnotationElement(st.data.id)||E.has(st.data.id))continue;const at=this.deserialize(st);at&&(this.addOrRebuild(at),at.enableEditing())}}disable(){var $;tt(this,w,!0),this.div.style.pointerEvents="none";const E=new Set;for(const st of t(this,y).values()){if(st.disableEditing(),!st.annotationElementId||st.serialize()!==null){E.add(st.annotationElementId);continue}($=this.getEditableAnnotation(st.annotationElementId))==null||$.show(),st.remove()}if(t(this,O)){const st=t(this,O).getEditableAnnotations();for(const at of st){const{id:H}=at.data;E.has(H)||t(this,C).isDeletedAnnotationElement(H)||at.show()}}W(this,T,ni).call(this),this.isEmpty&&(this.div.hidden=!0),tt(this,w,!1)}getEditableAnnotation(E){var $;return(($=t(this,O))==null?void 0:$.getEditableAnnotation(E))||null}setActiveEditor(E){t(this,C).getActive()!==E&&t(this,C).setActiveEditor(E)}enableClick(){this.div.addEventListener("pointerdown",t(this,v)),this.div.addEventListener("pointerup",t(this,x))}disableClick(){this.div.removeEventListener("pointerdown",t(this,v)),this.div.removeEventListener("pointerup",t(this,x))}attach(E){t(this,y).set(E.id,E);const{annotationElementId:$}=E;$&&t(this,C).isDeletedAnnotationElement($)&&t(this,C).removeDeletedAnnotationElement(E)}detach(E){var $;t(this,y).delete(E.id),($=t(this,f))==null||$.removePointerInTextLayer(E.contentDiv),!t(this,w)&&E.annotationElementId&&t(this,C).addDeletedAnnotationElement(E)}remove(E){this.detach(E),t(this,C).removeEditor(E),E.div.contains(document.activeElement)&&setTimeout(()=>{t(this,C).focusMainContainer()},0),E.div.remove(),E.isAttachedToDOM=!1,t(this,_)||this.addInkEditorIfNeeded(!1)}changeParent(E){var $;E.parent!==this&&(E.annotationElementId&&(t(this,C).addDeletedAnnotationElement(E.annotationElementId),P.AnnotationEditor.deleteAnnotationElement(E),E.annotationElementId=null),this.attach(E),($=E.parent)==null||$.detach(E),E.setParent(this),E.div&&E.isAttachedToDOM&&(E.div.remove(),this.div.append(E.div)))}add(E){if(this.changeParent(E),t(this,C).addEditor(E),this.attach(E),!E.isAttachedToDOM){const $=E.render();this.div.append($),E.isAttachedToDOM=!0}E.fixAndSetPosition(),E.onceAdded(),t(this,C).addToAnnotationStorage(E)}moveEditorInDOM(E){var st;if(!E.isAttachedToDOM)return;const{activeElement:$}=document;E.div.contains($)&&(E._focusEventsAllowed=!1,setTimeout(()=>{E.div.contains(document.activeElement)?E._focusEventsAllowed=!0:(E.div.addEventListener("focusin",()=>{E._focusEventsAllowed=!0},{once:!0}),$.focus())},0)),E._structTreeParentId=(st=t(this,f))==null?void 0:st.moveElementInDOM(this.div,E.div,E.contentDiv,!0)}addOrRebuild(E){E.needsToBeRebuilt()?E.rebuild():this.add(E)}addUndoableEditor(E){const $=()=>E._uiManager.rebuild(E),st=()=>{E.remove()};this.addCommands({cmd:$,undo:st,mustExec:!1})}getNextId(){return t(this,C).getId()}pasteEditor(E,$){t(this,C).updateToolbar(E),t(this,C).updateMode(E);const{offsetX:st,offsetY:at}=W(this,g,si).call(this),H=this.getNextId(),ct=W(this,A,ii).call(this,{parent:this,id:H,x:st,y:at,uiManager:t(this,C),isCentered:!0,...$});ct&&this.add(ct)}deserialize(E){switch(E.annotationType??E.annotationEditorType){case h.AnnotationEditorType.FREETEXT:return rt.FreeTextEditor.deserialize(E,this,t(this,C));case h.AnnotationEditorType.INK:return X.InkEditor.deserialize(E,this,t(this,C));case h.AnnotationEditorType.STAMP:return B.StampEditor.deserialize(E,this,t(this,C))}return null}addNewEditor(){W(this,l,Fe).call(this,W(this,g,si).call(this),!0)}setSelected(E){t(this,C).setSelected(E)}toggleSelected(E){t(this,C).toggleSelected(E)}isSelected(E){return t(this,C).isSelected(E)}unselect(E){t(this,C).unselect(E)}pointerup(E){const{isMac:$}=h.FeatureTest.platform;if(!(E.button!==0||E.ctrlKey&&$)&&E.target===this.div&&t(this,u)){if(tt(this,u,!1),!t(this,L)){tt(this,L,!0);return}if(t(this,C).getMode()===h.AnnotationEditorType.STAMP){t(this,C).unselectAll();return}W(this,l,Fe).call(this,E,!1)}}pointerdown(E){if(t(this,u)){tt(this,u,!1);return}const{isMac:$}=h.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&$||E.target!==this.div)return;tt(this,u,!0);const st=t(this,C).getActive();tt(this,L,!st||st.isEmpty())}findNewParent(E,$,st){const at=t(this,C).findParent($,st);return at===null||at===this?!1:(at.changeParent(E),!0)}destroy(){var E,$;((E=t(this,C).getActive())==null?void 0:E.parent)===this&&(t(this,C).commitOrRemove(),t(this,C).setActiveEditor(null));for(const st of t(this,y).values())($=t(this,f))==null||$.removePointerInTextLayer(st.contentDiv),st.setParent(null),st.isAttachedToDOM=!1,st.div.remove();this.div=null,t(this,y).clear(),t(this,C).removeLayer(this)}render({viewport:E}){this.viewport=E,(0,pt.setLayerDimensions)(this.div,E);for(const $ of t(this,C).getEditors(this.pageIndex))this.add($);this.updateMode()}update({viewport:E}){t(this,C).commitOrRemove(),this.viewport=E,(0,pt.setLayerDimensions)(this.div,{rotation:E.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:E,pageHeight:$}=this.viewport.rawDims;return[E,$]}};f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakSet,ii=function(E){switch(t(this,C).getMode()){case h.AnnotationEditorType.FREETEXT:return new rt.FreeTextEditor(E);case h.AnnotationEditorType.INK:return new X.InkEditor(E);case h.AnnotationEditorType.STAMP:return new B.StampEditor(E)}return null},l=new WeakSet,Fe=function(E,$){const st=this.getNextId(),at=W(this,A,ii).call(this,{parent:this,id:st,x:E.offsetX,y:E.offsetY,uiManager:t(this,C),isCentered:$});return at&&this.add(at),at},g=new WeakSet,si=function(){const{x:E,y:$,width:st,height:at}=this.div.getBoundingClientRect(),H=Math.max(0,E),ct=Math.max(0,$),gt=Math.min(window.innerWidth,E+st),Ct=Math.min(window.innerHeight,$+at),kt=(H+gt)/2-E,S=(ct+Ct)/2-$,[i,n]=this.viewport.rotation%180===0?[kt,S]:[S,kt];return{offsetX:i,offsetY:n}},T=new WeakSet,ni=function(){tt(this,_,!0);for(const E of t(this,y).values())E.isEmpty()&&E.remove();tt(this,_,!1)},ie(U,"_initialized",!1);let F=U;d.AnnotationEditorLayer=F},(mt,d,ot)=>{var B,F,f,L,O,x,v,y,u,_,Mi,C,Ri,a,Di,k,ve,r,ri,m,Ii,V,ai;Object.defineProperty(d,"__esModule",{value:!0}),d.FreeTextEditor=void 0;var h=ot(1),P=ot(5),rt=ot(4),X=ot(29);const $=class $ extends rt.AnnotationEditor{constructor(H){super({...H,name:"freeTextEditor"});I(this,_);I(this,C);I(this,a);I(this,k);I(this,r);I(this,m);I(this,V);I(this,B,this.editorDivBlur.bind(this));I(this,F,this.editorDivFocus.bind(this));I(this,f,this.editorDivInput.bind(this));I(this,L,this.editorDivKeydown.bind(this));I(this,O,void 0);I(this,x,"");I(this,v,`${this.id}-editor`);I(this,y,void 0);I(this,u,null);tt(this,O,H.color||$._defaultColor||rt.AnnotationEditor._defaultLineColor),tt(this,y,H.fontSize||$._defaultFontSize)}static get _keyboardManager(){const H=$.prototype,ct=kt=>kt.isEmpty(),gt=P.AnnotationEditorUIManager.TRANSLATE_SMALL,Ct=P.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,h.shadow)(this,"_keyboardManager",new P.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],H.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],H.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],H._translateEmpty,{args:[-gt,0],checker:ct}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],H._translateEmpty,{args:[-Ct,0],checker:ct}],[["ArrowRight","mac+ArrowRight"],H._translateEmpty,{args:[gt,0],checker:ct}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],H._translateEmpty,{args:[Ct,0],checker:ct}],[["ArrowUp","mac+ArrowUp"],H._translateEmpty,{args:[0,-gt],checker:ct}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],H._translateEmpty,{args:[0,-Ct],checker:ct}],[["ArrowDown","mac+ArrowDown"],H._translateEmpty,{args:[0,gt],checker:ct}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],H._translateEmpty,{args:[0,Ct],checker:ct}]]))}static initialize(H){rt.AnnotationEditor.initialize(H,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ct=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ct.getPropertyValue("--freetext-padding"))}static updateDefaultParams(H,ct){switch(H){case h.AnnotationEditorParamsType.FREETEXT_SIZE:$._defaultFontSize=ct;break;case h.AnnotationEditorParamsType.FREETEXT_COLOR:$._defaultColor=ct;break}}updateParams(H,ct){switch(H){case h.AnnotationEditorParamsType.FREETEXT_SIZE:W(this,_,Mi).call(this,ct);break;case h.AnnotationEditorParamsType.FREETEXT_COLOR:W(this,C,Ri).call(this,ct);break}}static get defaultPropertiesToUpdate(){return[[h.AnnotationEditorParamsType.FREETEXT_SIZE,$._defaultFontSize],[h.AnnotationEditorParamsType.FREETEXT_COLOR,$._defaultColor||rt.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[h.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,y)],[h.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,O)]]}_translateEmpty(H,ct){this._uiManager.translateSelectedEditors(H,ct,!0)}getInitialTranslation(){const H=this.parentScale;return[-$._internalPadding*H,-($._internalPadding+t(this,y))*H]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(h.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,F)),this.editorDiv.addEventListener("blur",t(this,B)),this.editorDiv.addEventListener("input",t(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,v)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,F)),this.editorDiv.removeEventListener("blur",t(this,B)),this.editorDiv.removeEventListener("input",t(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(H){this._focusEventsAllowed&&(super.focusin(H),H.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var H;if(this.width){W(this,V,ai).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(H=this._initialOptions)!=null&&H.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const H=t(this,x),ct=tt(this,x,W(this,a,Di).call(this).trimEnd());if(H===ct)return;const gt=Ct=>{if(tt(this,x,Ct),!Ct){this.remove();return}W(this,r,ri).call(this),this._uiManager.rebuild(this),W(this,k,ve).call(this)};this.addCommands({cmd:()=>{gt(ct)},undo:()=>{gt(H)},mustExec:!1}),W(this,k,ve).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(H){this.enterInEditMode()}keydown(H){H.target===this.div&&H.key==="Enter"&&(this.enterInEditMode(),H.preventDefault())}editorDivKeydown(H){$._keyboardManager.exec(this,H)}editorDivFocus(H){this.isEditing=!0}editorDivBlur(H){this.isEditing=!1}editorDivInput(H){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let H,ct;this.width&&(H=this.x,ct=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,v)),this.enableEditing(),rt.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Ct=>{var kt;return(kt=this.editorDiv)==null?void 0:kt.setAttribute("aria-label",Ct)}),rt.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Ct=>{var kt;return(kt=this.editorDiv)==null?void 0:kt.setAttribute("default-content",Ct)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${t(this,y)}px * var(--scale-factor))`,gt.color=t(this,O),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,P.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Ct,kt]=this.parentDimensions;if(this.annotationElementId){const{position:S}=t(this,u);let[i,n]=this.getInitialTranslation();[i,n]=this.pageTranslationToScreen(i,n);const[s,o]=this.pageDimensions,[c,b]=this.pageTranslation;let M,N;switch(this.rotation){case 0:M=H+(S[0]-c)/s,N=ct+this.height-(S[1]-b)/o;break;case 90:M=H+(S[0]-c)/s,N=ct-(S[1]-b)/o,[i,n]=[n,-i];break;case 180:M=H-this.width+(S[0]-c)/s,N=ct-(S[1]-b)/o,[i,n]=[-i,-n];break;case 270:M=H+(S[0]-c-this.height*o)/s,N=ct+(S[1]-b-this.width*s)/o,[i,n]=[-n,i];break}this.setAt(M*Ct,N*kt,i,n)}else this.setAt(H*Ct,ct*kt,this.width*Ct,this.height*kt);W(this,r,ri).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(H,ct,gt){let Ct=null;if(H instanceof X.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:S,fontColor:i},rect:n,rotation:s,id:o},textContent:c,textPosition:b,parent:{page:{pageNumber:M}}}=H;if(!c||c.length===0)return null;Ct=H={annotationType:h.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:S,value:c.join(`
`),position:b,pageIndex:M-1,rect:n,rotation:s,id:o,deleted:!1}}const kt=super.deserialize(H,ct,gt);return tt(kt,y,H.fontSize),tt(kt,O,h.Util.makeHexColor(...H.color)),tt(kt,x,H.value),kt.annotationElementId=H.id||null,tt(kt,u,Ct),kt}serialize(H=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ct=$._internalPadding*this.parentScale,gt=this.getRect(ct,ct),Ct=rt.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,O)),kt={annotationType:h.AnnotationEditorType.FREETEXT,color:Ct,fontSize:t(this,y),value:t(this,x),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return H?kt:this.annotationElementId&&!W(this,m,Ii).call(this,kt)?null:(kt.id=this.annotationElementId,kt)}};B=new WeakMap,F=new WeakMap,f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakSet,Mi=function(H){const ct=Ct=>{this.editorDiv.style.fontSize=`calc(${Ct}px * var(--scale-factor))`,this.translate(0,-(Ct-t(this,y))*this.parentScale),tt(this,y,Ct),W(this,k,ve).call(this)},gt=t(this,y);this.addCommands({cmd:()=>{ct(H)},undo:()=>{ct(gt)},mustExec:!0,type:h.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},C=new WeakSet,Ri=function(H){const ct=t(this,O);this.addCommands({cmd:()=>{tt(this,O,this.editorDiv.style.color=H)},undo:()=>{tt(this,O,this.editorDiv.style.color=ct)},mustExec:!0,type:h.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},a=new WeakSet,Di=function(){const H=this.editorDiv.getElementsByTagName("div");if(H.length===0)return this.editorDiv.innerText;const ct=[];for(const gt of H)ct.push(gt.innerText.replace(/\r\n?|\n/,""));return ct.join(`
`)},k=new WeakSet,ve=function(){const[H,ct]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:Ct,div:kt}=this,S=kt.style.display;kt.style.display="hidden",Ct.div.append(this.div),gt=kt.getBoundingClientRect(),kt.remove(),kt.style.display=S}this.rotation%180===this.parentRotation%180?(this.width=gt.width/H,this.height=gt.height/ct):(this.width=gt.height/H,this.height=gt.width/ct),this.fixAndSetPosition()},r=new WeakSet,ri=function(){if(this.editorDiv.replaceChildren(),!!t(this,x))for(const H of t(this,x).split(`
`)){const ct=document.createElement("div");ct.append(H?document.createTextNode(H):document.createElement("br")),this.editorDiv.append(ct)}},m=new WeakSet,Ii=function(H){const{value:ct,fontSize:gt,color:Ct,rect:kt,pageIndex:S}=t(this,u);return H.value!==ct||H.fontSize!==gt||H.rect.some((i,n)=>Math.abs(i-kt[n])>=1)||H.color.some((i,n)=>i!==Ct[n])||H.pageIndex!==S},V=new WeakSet,ai=function(H=!1){if(!this.annotationElementId)return;if(W(this,k,ve).call(this),!H&&(this.width===0||this.height===0)){setTimeout(()=>W(this,V,ai).call(this,!0),0);return}const ct=$._internalPadding*this.parentScale;t(this,u).rect=this.getRect(ct,ct)},ie($,"_freeTextDefaultContent",""),ie($,"_internalPadding",0),ie($,"_defaultColor",null),ie($,"_defaultFontSize",10),ie($,"_type","freetext");let pt=$;d.FreeTextEditor=pt},(mt,d,ot)=>{var n,o,he,b,Li,N,et,Z,nt,ht,vt,ut,Mt,Ut,Et,It,ft,J,Q,dt,wt,Tt,jt,Oi,Wt,Me,$t,oi,Yt,li,K,G,_t,yt,ee,te,Y,ci,Ot,xt,Nt,Bt,Ni,At,hi;Object.defineProperty(d,"__esModule",{value:!0}),d.StampAnnotationElement=d.InkAnnotationElement=d.FreeTextAnnotationElement=d.AnnotationLayer=void 0;var h=ot(1),P=ot(6),rt=ot(3),X=ot(30),pt=ot(31),B=ot(32);const F=1e3,f=9,L=new WeakSet;function O(Lt){return{width:Lt[2]-Lt[0],height:Lt[3]-Lt[1]}}class x{static create(R){switch(R.data.annotationType){case h.AnnotationType.LINK:return new y(R);case h.AnnotationType.TEXT:return new u(R);case h.AnnotationType.WIDGET:switch(R.data.fieldType){case"Tx":return new w(R);case"Btn":return R.data.radioButton?new a(R):R.data.checkBox?new A(R):new l(R);case"Ch":return new k(R);case"Sig":return new C(R)}return new _(R);case h.AnnotationType.POPUP:return new g(R);case h.AnnotationType.FREETEXT:return new T(R);case h.AnnotationType.LINE:return new m(R);case h.AnnotationType.SQUARE:return new U(R);case h.AnnotationType.CIRCLE:return new V(R);case h.AnnotationType.POLYLINE:return new E(R);case h.AnnotationType.CARET:return new st(R);case h.AnnotationType.INK:return new at(R);case h.AnnotationType.POLYGON:return new $(R);case h.AnnotationType.HIGHLIGHT:return new H(R);case h.AnnotationType.UNDERLINE:return new ct(R);case h.AnnotationType.SQUIGGLY:return new gt(R);case h.AnnotationType.STRIKEOUT:return new Ct(R);case h.AnnotationType.STAMP:return new kt(R);case h.AnnotationType.FILEATTACHMENT:return new S(R);default:return new v(R)}}}const s=class s{constructor(R,{isRenderable:e=!1,ignoreBorder:p=!1,createQuadrilaterals:D=!1}={}){I(this,n,!1);this.isRenderable=e,this.data=R.data,this.layer=R.layer,this.linkService=R.linkService,this.downloadManager=R.downloadManager,this.imageResourcesPath=R.imageResourcesPath,this.renderForms=R.renderForms,this.svgFactory=R.svgFactory,this.annotationStorage=R.annotationStorage,this.enableScripting=R.enableScripting,this.hasJSActions=R.hasJSActions,this._fieldObjects=R.fieldObjects,this.parent=R.parent,e&&(this.container=this._createContainer(p)),D&&this._createQuadrilaterals()}static _hasPopupData({titleObj:R,contentsObj:e,richText:p}){return!!(R!=null&&R.str||e!=null&&e.str||p!=null&&p.str)}get hasPopupData(){return s._hasPopupData(this.data)}_createContainer(R){const{data:e,parent:{page:p,viewport:D}}=this,j=document.createElement("section");j.setAttribute("data-annotation-id",e.id),this instanceof _||(j.tabIndex=F),j.style.zIndex=this.parent.zIndex++,this.data.popupRef&&j.setAttribute("aria-haspopup","dialog"),e.noRotate&&j.classList.add("norotate");const{pageWidth:q,pageHeight:it,pageX:bt,pageY:Ft}=D.rawDims;if(!e.rect||this instanceof g){const{rotation:Ht}=e;return!e.hasOwnCanvas&&Ht!==0&&this.setRotation(Ht,j),j}const{width:Pt,height:Vt}=O(e.rect),Rt=h.Util.normalizeRect([e.rect[0],p.view[3]-e.rect[1]+p.view[1],e.rect[2],p.view[3]-e.rect[3]+p.view[1]]);if(!R&&e.borderStyle.width>0){j.style.borderWidth=`${e.borderStyle.width}px`;const Ht=e.borderStyle.horizontalCornerRadius,qt=e.borderStyle.verticalCornerRadius;if(Ht>0||qt>0){const Zt=`calc(${Ht}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;j.style.borderRadius=Zt}else if(this instanceof a){const Zt=`calc(${Pt}px * var(--scale-factor)) / calc(${Vt}px * var(--scale-factor))`;j.style.borderRadius=Zt}switch(e.borderStyle.style){case h.AnnotationBorderStyleType.SOLID:j.style.borderStyle="solid";break;case h.AnnotationBorderStyleType.DASHED:j.style.borderStyle="dashed";break;case h.AnnotationBorderStyleType.BEVELED:(0,h.warn)("Unimplemented border style: beveled");break;case h.AnnotationBorderStyleType.INSET:(0,h.warn)("Unimplemented border style: inset");break;case h.AnnotationBorderStyleType.UNDERLINE:j.style.borderBottomStyle="solid";break}const Jt=e.borderColor||null;Jt?(tt(this,n,!0),j.style.borderColor=h.Util.makeHexColor(Jt[0]|0,Jt[1]|0,Jt[2]|0)):j.style.borderWidth=0}j.style.left=`${100*(Rt[0]-bt)/q}%`,j.style.top=`${100*(Rt[1]-Ft)/it}%`;const{rotation:Dt}=e;return e.hasOwnCanvas||Dt===0?(j.style.width=`${100*Pt/q}%`,j.style.height=`${100*Vt/it}%`):this.setRotation(Dt,j),j}setRotation(R,e=this.container){if(!this.data.rect)return;const{pageWidth:p,pageHeight:D}=this.parent.viewport.rawDims,{width:j,height:q}=O(this.data.rect);let it,bt;R%180===0?(it=100*j/p,bt=100*q/D):(it=100*q/p,bt=100*j/D),e.style.width=`${it}%`,e.style.height=`${bt}%`,e.setAttribute("data-main-rotation",(360-R)%360)}get _commonActions(){const R=(e,p,D)=>{const j=D.detail[e],q=j[0],it=j.slice(1);D.target.style[p]=X.ColorConverters[`${q}_HTML`](it),this.annotationStorage.setValue(this.data.id,{[p]:X.ColorConverters[`${q}_rgb`](it)})};return(0,h.shadow)(this,"_commonActions",{display:e=>{const{display:p}=e.detail,D=p%2===1;this.container.style.visibility=D?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:D,noPrint:p===1||p===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:p}=e.detail;this.container.style.visibility=p?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:p,noView:p})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{R("bgColor","backgroundColor",e)},fillColor:e=>{R("fillColor","backgroundColor",e)},fgColor:e=>{R("fgColor","color",e)},textColor:e=>{R("textColor","color",e)},borderColor:e=>{R("borderColor","borderColor",e)},strokeColor:e=>{R("strokeColor","borderColor",e)},rotation:e=>{const p=e.detail.rotation;this.setRotation(p),this.annotationStorage.setValue(this.data.id,{rotation:p})}})}_dispatchEventFromSandbox(R,e){const p=this._commonActions;for(const D of Object.keys(e.detail)){const j=R[D]||p[D];j==null||j(e)}}_setDefaultPropertiesFromJS(R){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const p=this._commonActions;for(const[D,j]of Object.entries(e)){const q=p[D];if(q){const it={detail:{[D]:j},target:R};q(it),delete e[D]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:R}=this.data;if(!R)return;const[e,p,D,j]=this.data.rect;if(R.length===1){const[,{x:qt,y:Jt},{x:Zt,y:ne}]=R[0];if(D===qt&&j===Jt&&e===Zt&&p===ne)return}const{style:q}=this.container;let it;if(t(this,n)){const{borderColor:qt,borderWidth:Jt}=q;q.borderWidth=0,it=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${qt}" stroke-width="${Jt}">`],this.container.classList.add("hasBorder")}const bt=D-e,Ft=j-p,{svgFactory:Pt}=this,Vt=Pt.createElement("svg");Vt.classList.add("quadrilateralsContainer"),Vt.setAttribute("width",0),Vt.setAttribute("height",0);const Rt=Pt.createElement("defs");Vt.append(Rt);const Dt=Pt.createElement("clipPath"),Ht=`clippath_${this.data.id}`;Dt.setAttribute("id",Ht),Dt.setAttribute("clipPathUnits","objectBoundingBox"),Rt.append(Dt);for(const[,{x:qt,y:Jt},{x:Zt,y:ne}]of R){const se=Pt.createElement("rect"),re=(Zt-e)/bt,le=(j-Jt)/Ft,ce=(qt-Zt)/bt,Ai=(Jt-ne)/Ft;se.setAttribute("x",re),se.setAttribute("y",le),se.setAttribute("width",ce),se.setAttribute("height",Ai),Dt.append(se),it==null||it.push(`<rect vector-effect="non-scaling-stroke" x="${re}" y="${le}" width="${ce}" height="${Ai}"/>`)}t(this,n)&&(it.push("</g></svg>')"),q.backgroundImage=it.join("")),this.container.append(Vt),this.container.style.clipPath=`url(#${Ht})`}_createPopup(){const{container:R,data:e}=this;R.setAttribute("aria-haspopup","dialog");const p=new g({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(p.render())}render(){(0,h.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(R,e=null){const p=[];if(this._fieldObjects){const D=this._fieldObjects[R];if(D)for(const{page:j,id:q,exportValues:it}of D){if(j===-1||q===e)continue;const bt=typeof it=="string"?it:null,Ft=document.querySelector(`[data-element-id="${q}"]`);if(Ft&&!L.has(Ft)){(0,h.warn)(`_getElementsByName - element not allowed: ${q}`);continue}p.push({id:q,exportValue:bt,domElement:Ft})}return p}for(const D of document.getElementsByName(R)){const{exportValue:j}=D,q=D.getAttribute("data-element-id");q!==e&&L.has(D)&&p.push({id:q,exportValue:j,domElement:D})}return p}show(){var R;this.container&&(this.container.hidden=!1),(R=this.popup)==null||R.maybeShow()}hide(){var R;this.container&&(this.container.hidden=!0),(R=this.popup)==null||R.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const R=this.getElementsToTriggerPopup();if(Array.isArray(R))for(const e of R)e.classList.add("highlightArea");else R.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:R,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var p;(p=this.linkService.eventBus)==null||p.dispatch("switchannotationeditormode",{source:this,mode:R,editId:e})})}};n=new WeakMap;let v=s;class y extends v{constructor(e,p=null){super(e,{isRenderable:!0,ignoreBorder:!!(p!=null&&p.ignoreBorder),createQuadrilaterals:!0});I(this,o);I(this,b);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:p}=this,D=document.createElement("a");D.setAttribute("data-element-id",e.id);let j=!1;return e.url?(p.addLinkAttributes(D,e.url,e.newWindow),j=!0):e.action?(this._bindNamedAction(D,e.action),j=!0):e.attachment?(this._bindAttachment(D,e.attachment),j=!0):e.setOCGState?(W(this,b,Li).call(this,D,e.setOCGState),j=!0):e.dest?(this._bindLink(D,e.dest),j=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(D,e),j=!0),e.resetForm?(this._bindResetFormAction(D,e.resetForm),j=!0):this.isTooltipOnly&&!j&&(this._bindLink(D,""),j=!0)),this.container.classList.add("linkAnnotation"),j&&this.container.append(D),this.container}_bindLink(e,p){e.href=this.linkService.getDestinationHash(p),e.onclick=()=>(p&&this.linkService.goToDestination(p),!1),(p||p==="")&&W(this,o,he).call(this)}_bindNamedAction(e,p){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(p),!1),W(this,o,he).call(this)}_bindAttachment(e,p){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var D;return(D=this.downloadManager)==null||D.openOrDownloadData(this.container,p.content,p.filename),!1},W(this,o,he).call(this)}_bindJSAction(e,p){e.href=this.linkService.getAnchorUrl("");const D=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const j of Object.keys(p.actions)){const q=D.get(j);q&&(e[q]=()=>{var it;return(it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p.id,name:j}}),!1})}e.onclick||(e.onclick=()=>!1),W(this,o,he).call(this)}_bindResetFormAction(e,p){const D=e.onclick;if(D||(e.href=this.linkService.getAnchorUrl("")),W(this,o,he).call(this),!this._fieldObjects){(0,h.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),D||(e.onclick=()=>!1);return}e.onclick=()=>{var Vt;D==null||D();const{fields:j,refs:q,include:it}=p,bt=[];if(j.length!==0||q.length!==0){const Rt=new Set(q);for(const Dt of j){const Ht=this._fieldObjects[Dt]||[];for(const{id:qt}of Ht)Rt.add(qt)}for(const Dt of Object.values(this._fieldObjects))for(const Ht of Dt)Rt.has(Ht.id)===it&&bt.push(Ht)}else for(const Rt of Object.values(this._fieldObjects))bt.push(...Rt);const Ft=this.annotationStorage,Pt=[];for(const Rt of bt){const{id:Dt}=Rt;switch(Pt.push(Dt),Rt.type){case"text":{const qt=Rt.defaultValue||"";Ft.setValue(Dt,{value:qt});break}case"checkbox":case"radiobutton":{const qt=Rt.defaultValue===Rt.exportValues;Ft.setValue(Dt,{value:qt});break}case"combobox":case"listbox":{const qt=Rt.defaultValue||"";Ft.setValue(Dt,{value:qt});break}default:continue}const Ht=document.querySelector(`[data-element-id="${Dt}"]`);if(Ht){if(!L.has(Ht)){(0,h.warn)(`_bindResetFormAction - element not allowed: ${Dt}`);continue}}else continue;Ht.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Vt=this.linkService.eventBus)==null||Vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Pt,name:"ResetForm"}})),!1}}}o=new WeakSet,he=function(){this.container.setAttribute("data-internal-link","")},b=new WeakSet,Li=function(e,p){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(p),!1),W(this,o,he).call(this)};class u extends v{constructor(R){super(R,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const R=document.createElement("img");return R.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",R.alt="[{{type}} Annotation]",R.dataset.l10nId="text_annotation_type",R.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(R),this.container}}class _ extends v{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(R){var e;this.data.hasOwnCanvas&&(((e=R.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(R.previousSibling.hidden=!0),R.hidden=!1)}_getKeyModifier(R){const{isWin:e,isMac:p}=h.FeatureTest.platform;return e&&R.ctrlKey||p&&R.metaKey}_setEventListener(R,e,p,D,j){p.includes("mouse")?R.addEventListener(p,q=>{var it;(it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:j(q),shift:q.shiftKey,modifier:this._getKeyModifier(q)}})}):R.addEventListener(p,q=>{var it;if(p==="blur"){if(!e.focused||!q.relatedTarget)return;e.focused=!1}else if(p==="focus"){if(e.focused)return;e.focused=!0}j&&((it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:j(q)}}))})}_setEventListeners(R,e,p,D){var j,q,it;for(const[bt,Ft]of p)(Ft==="Action"||(j=this.data.actions)!=null&&j[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(e||(e={focused:!1})),this._setEventListener(R,e,bt,Ft,D),Ft==="Focus"&&!((q=this.data.actions)!=null&&q.Blur)?this._setEventListener(R,e,"blur","Blur",null):Ft==="Blur"&&!((it=this.data.actions)!=null&&it.Focus)&&this._setEventListener(R,e,"focus","Focus",null))}_setBackgroundColor(R){const e=this.data.backgroundColor||null;R.style.backgroundColor=e===null?"transparent":h.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(R){const e=["left","center","right"],{fontColor:p}=this.data.defaultAppearanceData,D=this.data.defaultAppearanceData.fontSize||f,j=R.style;let q;const it=2,bt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-it),Pt=Math.round(Ft/(h.LINE_FACTOR*D))||1,Vt=Ft/Pt;q=Math.min(D,bt(Vt/h.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-it);q=Math.min(D,bt(Ft/h.LINE_FACTOR))}j.fontSize=`calc(${q}px * var(--scale-factor))`,j.color=h.Util.makeHexColor(p[0],p[1],p[2]),this.data.textAlignment!==null&&(j.textAlign=e[this.data.textAlignment])}_setRequired(R,e){e?R.setAttribute("required",!0):R.removeAttribute("required"),R.setAttribute("aria-required",e)}}class w extends _{constructor(R){const e=R.renderForms||!R.data.hasAppearance&&!!R.data.fieldValue;super(R,{isRenderable:e})}setPropertyOnSiblings(R,e,p,D){const j=this.annotationStorage;for(const q of this._getElementsByName(R.name,R.id))q.domElement&&(q.domElement[e]=p),j.setValue(q.id,{[D]:p})}render(){var D,j;const R=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let p=null;if(this.renderForms){const q=R.getValue(e,{value:this.data.fieldValue});let it=q.value||"";const bt=R.getValue(e,{charLimit:this.data.maxLen}).charLimit;bt&&it.length>bt&&(it=it.slice(0,bt));let Ft=q.formattedValue||((D=this.data.textContent)==null?void 0:D.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const Pt={userValue:it,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(p=document.createElement("textarea"),p.textContent=Ft??it,this.data.doNotScroll&&(p.style.overflowY="hidden")):(p=document.createElement("input"),p.type="text",p.setAttribute("value",Ft??it),this.data.doNotScroll&&(p.style.overflowX="hidden")),this.data.hasOwnCanvas&&(p.hidden=!0),L.add(p),p.setAttribute("data-element-id",e),p.disabled=this.data.readOnly,p.name=this.data.fieldName,p.tabIndex=F,this._setRequired(p,this.data.required),bt&&(p.maxLength=bt),p.addEventListener("input",Rt=>{R.setValue(e,{value:Rt.target.value}),this.setPropertyOnSiblings(p,"value",Rt.target.value,"value"),Pt.formattedValue=null}),p.addEventListener("resetform",Rt=>{const Dt=this.data.defaultFieldValue??"";p.value=Pt.userValue=Dt,Pt.formattedValue=null});let Vt=Rt=>{const{formattedValue:Dt}=Pt;Dt!=null&&(Rt.target.value=Dt),Rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){p.addEventListener("focus",Dt=>{if(Pt.focused)return;const{target:Ht}=Dt;Pt.userValue&&(Ht.value=Pt.userValue),Pt.lastCommittedValue=Ht.value,Pt.commitKey=1,Pt.focused=!0}),p.addEventListener("updatefromsandbox",Dt=>{this.showElementAndHideCanvas(Dt.target);const Ht={value(qt){Pt.userValue=qt.detail.value??"",R.setValue(e,{value:Pt.userValue.toString()}),qt.target.value=Pt.userValue},formattedValue(qt){const{formattedValue:Jt}=qt.detail;Pt.formattedValue=Jt,Jt!=null&&qt.target!==document.activeElement&&(qt.target.value=Jt),R.setValue(e,{formattedValue:Jt})},selRange(qt){qt.target.setSelectionRange(...qt.detail.selRange)},charLimit:qt=>{var se;const{charLimit:Jt}=qt.detail,{target:Zt}=qt;if(Jt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Jt);let ne=Pt.userValue;!ne||ne.length<=Jt||(ne=ne.slice(0,Jt),Zt.value=Pt.userValue=ne,R.setValue(e,{value:ne}),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:ne,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ht,Dt)}),p.addEventListener("keydown",Dt=>{var Jt;Pt.commitKey=1;let Ht=-1;if(Dt.key==="Escape"?Ht=0:Dt.key==="Enter"&&!this.data.multiLine?Ht=2:Dt.key==="Tab"&&(Pt.commitKey=3),Ht===-1)return;const{value:qt}=Dt.target;Pt.lastCommittedValue!==qt&&(Pt.lastCommittedValue=qt,Pt.userValue=qt,(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:qt,willCommit:!0,commitKey:Ht,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}}))});const Rt=Vt;Vt=null,p.addEventListener("blur",Dt=>{var qt;if(!Pt.focused||!Dt.relatedTarget)return;Pt.focused=!1;const{value:Ht}=Dt.target;Pt.userValue=Ht,Pt.lastCommittedValue!==Ht&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Ht,willCommit:!0,commitKey:Pt.commitKey,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}})),Rt(Dt)}),(j=this.data.actions)!=null&&j.Keystroke&&p.addEventListener("beforeinput",Dt=>{var le;Pt.lastCommittedValue=null;const{data:Ht,target:qt}=Dt,{value:Jt,selectionStart:Zt,selectionEnd:ne}=qt;let se=Zt,re=ne;switch(Dt.inputType){case"deleteWordBackward":{const ce=Jt.substring(0,Zt).match(/\w*[^\w]*$/);ce&&(se-=ce[0].length);break}case"deleteWordForward":{const ce=Jt.substring(Zt).match(/^[^\w]*\w*/);ce&&(re+=ce[0].length);break}case"deleteContentBackward":Zt===ne&&(se-=1);break;case"deleteContentForward":Zt===ne&&(re+=1);break}Dt.preventDefault(),(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Jt,change:Ht||"",willCommit:!1,selStart:se,selEnd:re}})}),this._setEventListeners(p,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Dt=>Dt.target.value)}if(Vt&&p.addEventListener("blur",Vt),this.data.comb){const Dt=(this.data.rect[2]-this.data.rect[0])/bt;p.classList.add("comb"),p.style.letterSpacing=`calc(${Dt}px * var(--scale-factor) - 1ch)`}}else p=document.createElement("div"),p.textContent=this.data.fieldValue,p.style.verticalAlign="middle",p.style.display="table-cell";return this._setTextStyle(p),this._setBackgroundColor(p),this._setDefaultPropertiesFromJS(p),this.container.append(p),this.container}}class C extends _{constructor(R){super(R,{isRenderable:!!R.data.hasOwnCanvas})}}class A extends _{constructor(R){super(R,{isRenderable:R.renderForms})}render(){const R=this.annotationStorage,e=this.data,p=e.id;let D=R.getValue(p,{value:e.exportValue===e.fieldValue}).value;typeof D=="string"&&(D=D!=="Off",R.setValue(p,{value:D})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const j=document.createElement("input");return L.add(j),j.setAttribute("data-element-id",p),j.disabled=e.readOnly,this._setRequired(j,this.data.required),j.type="checkbox",j.name=e.fieldName,D&&j.setAttribute("checked",!0),j.setAttribute("exportValue",e.exportValue),j.tabIndex=F,j.addEventListener("change",q=>{const{name:it,checked:bt}=q.target;for(const Ft of this._getElementsByName(it,p)){const Pt=bt&&Ft.exportValue===e.exportValue;Ft.domElement&&(Ft.domElement.checked=Pt),R.setValue(Ft.id,{value:Pt})}R.setValue(p,{value:bt})}),j.addEventListener("resetform",q=>{const it=e.defaultFieldValue||"Off";q.target.checked=it===e.exportValue}),this.enableScripting&&this.hasJSActions&&(j.addEventListener("updatefromsandbox",q=>{const it={value(bt){bt.target.checked=bt.detail.value!=="Off",R.setValue(p,{value:bt.target.checked})}};this._dispatchEventFromSandbox(it,q)}),this._setEventListeners(j,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],q=>q.target.checked)),this._setBackgroundColor(j),this._setDefaultPropertiesFromJS(j),this.container.append(j),this.container}}class a extends _{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const R=this.annotationStorage,e=this.data,p=e.id;let D=R.getValue(p,{value:e.fieldValue===e.buttonValue}).value;typeof D=="string"&&(D=D!==e.buttonValue,R.setValue(p,{value:D}));const j=document.createElement("input");if(L.add(j),j.setAttribute("data-element-id",p),j.disabled=e.readOnly,this._setRequired(j,this.data.required),j.type="radio",j.name=e.fieldName,D&&j.setAttribute("checked",!0),j.tabIndex=F,j.addEventListener("change",q=>{const{name:it,checked:bt}=q.target;for(const Ft of this._getElementsByName(it,p))R.setValue(Ft.id,{value:!1});R.setValue(p,{value:bt})}),j.addEventListener("resetform",q=>{const it=e.defaultFieldValue;q.target.checked=it!=null&&it===e.buttonValue}),this.enableScripting&&this.hasJSActions){const q=e.buttonValue;j.addEventListener("updatefromsandbox",it=>{const bt={value:Ft=>{const Pt=q===Ft.detail.value;for(const Vt of this._getElementsByName(Ft.target.name)){const Rt=Pt&&Vt.id===p;Vt.domElement&&(Vt.domElement.checked=Rt),R.setValue(Vt.id,{value:Rt})}}};this._dispatchEventFromSandbox(bt,it)}),this._setEventListeners(j,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],it=>it.target.checked)}return this._setBackgroundColor(j),this._setDefaultPropertiesFromJS(j),this.container.append(j),this.container}}class l extends y{constructor(R){super(R,{ignoreBorder:R.data.hasAppearance})}render(){const R=super.render();R.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(R.title=this.data.alternativeText);const e=R.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",p=>{this._dispatchEventFromSandbox({},p)})),R}}class k extends _{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const R=this.annotationStorage,e=this.data.id,p=R.getValue(e,{value:this.data.fieldValue}),D=document.createElement("select");L.add(D),D.setAttribute("data-element-id",e),D.disabled=this.data.readOnly,this._setRequired(D,this.data.required),D.name=this.data.fieldName,D.tabIndex=F;let j=this.data.combo&&this.data.options.length>0;this.data.combo||(D.size=this.data.options.length,this.data.multiSelect&&(D.multiple=!0)),D.addEventListener("resetform",Pt=>{const Vt=this.data.defaultFieldValue;for(const Rt of D.options)Rt.selected=Rt.value===Vt});for(const Pt of this.data.options){const Vt=document.createElement("option");Vt.textContent=Pt.displayValue,Vt.value=Pt.exportValue,p.value.includes(Pt.exportValue)&&(Vt.setAttribute("selected",!0),j=!1),D.append(Vt)}let q=null;if(j){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),D.prepend(Pt),q=()=>{Pt.remove(),D.removeEventListener("input",q),q=null},D.addEventListener("input",q)}const it=Pt=>{const Vt=Pt?"value":"textContent",{options:Rt,multiple:Dt}=D;return Dt?Array.prototype.filter.call(Rt,Ht=>Ht.selected).map(Ht=>Ht[Vt]):Rt.selectedIndex===-1?null:Rt[Rt.selectedIndex][Vt]};let bt=it(!1);const Ft=Pt=>{const Vt=Pt.target.options;return Array.prototype.map.call(Vt,Rt=>({displayValue:Rt.textContent,exportValue:Rt.value}))};return this.enableScripting&&this.hasJSActions?(D.addEventListener("updatefromsandbox",Pt=>{const Vt={value(Rt){q==null||q();const Dt=Rt.detail.value,Ht=new Set(Array.isArray(Dt)?Dt:[Dt]);for(const qt of D.options)qt.selected=Ht.has(qt.value);R.setValue(e,{value:it(!0)}),bt=it(!1)},multipleSelection(Rt){D.multiple=!0},remove(Rt){const Dt=D.options,Ht=Rt.detail.remove;Dt[Ht].selected=!1,D.remove(Ht),Dt.length>0&&Array.prototype.findIndex.call(Dt,Jt=>Jt.selected)===-1&&(Dt[0].selected=!0),R.setValue(e,{value:it(!0),items:Ft(Rt)}),bt=it(!1)},clear(Rt){for(;D.length!==0;)D.remove(0);R.setValue(e,{value:null,items:[]}),bt=it(!1)},insert(Rt){const{index:Dt,displayValue:Ht,exportValue:qt}=Rt.detail.insert,Jt=D.children[Dt],Zt=document.createElement("option");Zt.textContent=Ht,Zt.value=qt,Jt?Jt.before(Zt):D.append(Zt),R.setValue(e,{value:it(!0),items:Ft(Rt)}),bt=it(!1)},items(Rt){const{items:Dt}=Rt.detail;for(;D.length!==0;)D.remove(0);for(const Ht of Dt){const{displayValue:qt,exportValue:Jt}=Ht,Zt=document.createElement("option");Zt.textContent=qt,Zt.value=Jt,D.append(Zt)}D.options.length>0&&(D.options[0].selected=!0),R.setValue(e,{value:it(!0),items:Ft(Rt)}),bt=it(!1)},indices(Rt){const Dt=new Set(Rt.detail.indices);for(const Ht of Rt.target.options)Ht.selected=Dt.has(Ht.index);R.setValue(e,{value:it(!0)}),bt=it(!1)},editable(Rt){Rt.target.disabled=!Rt.detail.editable}};this._dispatchEventFromSandbox(Vt,Pt)}),D.addEventListener("input",Pt=>{var Rt;const Vt=it(!0);R.setValue(e,{value:Vt}),Pt.preventDefault(),(Rt=this.linkService.eventBus)==null||Rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:bt,changeEx:Vt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(D,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):D.addEventListener("input",function(Pt){R.setValue(e,{value:it(!0)})}),this.data.combo&&this._setTextStyle(D),this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class g extends v{constructor(R){const{data:e,elements:p}=R;super(R,{isRenderable:v._hasPopupData(e)}),this.elements=p}render(){this.container.classList.add("popupAnnotation");const R=new r({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const p of this.elements)p.popup=R,e.push(p.data.id),p.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(p=>`${h.AnnotationPrefix}${p}`).join(",")),this.container}}class r{constructor({container:R,color:e,elements:p,titleObj:D,modificationDate:j,contentsObj:q,richText:it,parent:bt,rect:Ft,parentRect:Pt,open:Vt}){I(this,jt);I(this,Wt);I(this,$t);I(this,Yt);I(this,N,null);I(this,et,W(this,jt,Oi).bind(this));I(this,Z,W(this,Yt,li).bind(this));I(this,nt,W(this,$t,oi).bind(this));I(this,ht,W(this,Wt,Me).bind(this));I(this,vt,null);I(this,ut,null);I(this,Mt,null);I(this,Ut,null);I(this,Et,null);I(this,It,null);I(this,ft,!1);I(this,J,null);I(this,Q,null);I(this,dt,null);I(this,wt,null);I(this,Tt,!1);var Dt;tt(this,ut,R),tt(this,wt,D),tt(this,Mt,q),tt(this,dt,it),tt(this,Et,bt),tt(this,vt,e),tt(this,Q,Ft),tt(this,It,Pt),tt(this,Ut,p);const Rt=P.PDFDateString.toDateObject(j);Rt&&tt(this,N,bt.l10n.get("annotation_date_string",{date:Rt.toLocaleDateString(),time:Rt.toLocaleTimeString()})),this.trigger=p.flatMap(Ht=>Ht.getElementsToTriggerPopup());for(const Ht of this.trigger)Ht.addEventListener("click",t(this,ht)),Ht.addEventListener("mouseenter",t(this,nt)),Ht.addEventListener("mouseleave",t(this,Z)),Ht.classList.add("popupTriggerArea");for(const Ht of p)(Dt=Ht.container)==null||Dt.addEventListener("keydown",t(this,et));t(this,ut).hidden=!0,Vt&&W(this,Wt,Me).call(this)}render(){if(t(this,J))return;const{page:{view:R},viewport:{rawDims:{pageWidth:e,pageHeight:p,pageX:D,pageY:j}}}=t(this,Et),q=tt(this,J,document.createElement("div"));if(q.className="popup",t(this,vt)){const se=q.style.outlineColor=h.Util.makeHexColor(...t(this,vt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?q.style.backgroundColor=`color-mix(in srgb, ${se} 30%, white)`:q.style.backgroundColor=h.Util.makeHexColor(...t(this,vt).map(le=>Math.floor(.7*(255-le)+le)))}const it=document.createElement("span");it.className="header";const bt=document.createElement("h1");if(it.append(bt),{dir:bt.dir,str:bt.textContent}=t(this,wt),q.append(it),t(this,N)){const se=document.createElement("span");se.classList.add("popupDate"),t(this,N).then(re=>{se.textContent=re}),it.append(se)}const Ft=t(this,Mt),Pt=t(this,dt);if(Pt!=null&&Pt.str&&(!(Ft!=null&&Ft.str)||Ft.str===Pt.str))B.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:q}),q.lastChild.classList.add("richText","popupContent");else{const se=this._formatContents(Ft);q.append(se)}let Vt=!!t(this,It),Rt=Vt?t(this,It):t(this,Q);for(const se of t(this,Ut))if(!Rt||h.Util.intersect(se.data.rect,Rt)!==null){Rt=se.data.rect,Vt=!0;break}const Dt=h.Util.normalizeRect([Rt[0],R[3]-Rt[1]+R[1],Rt[2],R[3]-Rt[3]+R[1]]),qt=Vt?Rt[2]-Rt[0]+5:0,Jt=Dt[0]+qt,Zt=Dt[1],{style:ne}=t(this,ut);ne.left=`${100*(Jt-D)/e}%`,ne.top=`${100*(Zt-j)/p}%`,t(this,ut).append(q)}_formatContents({str:R,dir:e}){const p=document.createElement("p");p.classList.add("popupContent"),p.dir=e;const D=R.split(/(?:\r\n?|\n)/);for(let j=0,q=D.length;j<q;++j){const it=D[j];p.append(document.createTextNode(it)),j<q-1&&p.append(document.createElement("br"))}return p}forceHide(){tt(this,Tt,this.isVisible),t(this,Tt)&&(t(this,ut).hidden=!0)}maybeShow(){t(this,Tt)&&(tt(this,Tt,!1),t(this,ut).hidden=!1)}get isVisible(){return t(this,ut).hidden===!1}}N=new WeakMap,et=new WeakMap,Z=new WeakMap,nt=new WeakMap,ht=new WeakMap,vt=new WeakMap,ut=new WeakMap,Mt=new WeakMap,Ut=new WeakMap,Et=new WeakMap,It=new WeakMap,ft=new WeakMap,J=new WeakMap,Q=new WeakMap,dt=new WeakMap,wt=new WeakMap,Tt=new WeakMap,jt=new WeakSet,Oi=function(R){R.altKey||R.shiftKey||R.ctrlKey||R.metaKey||(R.key==="Enter"||R.key==="Escape"&&t(this,ft))&&W(this,Wt,Me).call(this)},Wt=new WeakSet,Me=function(){tt(this,ft,!t(this,ft)),t(this,ft)?(W(this,$t,oi).call(this),t(this,ut).addEventListener("click",t(this,ht)),t(this,ut).addEventListener("keydown",t(this,et))):(W(this,Yt,li).call(this),t(this,ut).removeEventListener("click",t(this,ht)),t(this,ut).removeEventListener("keydown",t(this,et)))},$t=new WeakSet,oi=function(){t(this,J)||this.render(),this.isVisible?t(this,ft)&&t(this,ut).classList.add("focused"):(t(this,ut).hidden=!1,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)+1e3)},Yt=new WeakSet,li=function(){t(this,ut).classList.remove("focused"),!(t(this,ft)||!this.isVisible)&&(t(this,ut).hidden=!0,t(this,ut).style.zIndex=parseInt(t(this,ut).style.zIndex)-1e3)};class T extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0}),this.textContent=R.data.textContent,this.textPosition=R.data.textPosition,this.annotationEditorType=h.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const R=document.createElement("div");R.classList.add("annotationTextContent"),R.setAttribute("role","comment");for(const e of this.textContent){const p=document.createElement("span");p.textContent=e,R.append(p)}this.container.append(R)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}d.FreeTextAnnotationElement=T;class m extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});I(this,K,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:p,height:D}=O(e.rect),j=this.svgFactory.create(p,D,!0),q=tt(this,K,this.svgFactory.createElement("svg:line"));return q.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),q.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),q.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),q.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),q.setAttribute("stroke-width",e.borderStyle.width||1),q.setAttribute("stroke","transparent"),q.setAttribute("fill","transparent"),j.append(q),this.container.append(j),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap;class U extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});I(this,G,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:p,height:D}=O(e.rect),j=this.svgFactory.create(p,D,!0),q=e.borderStyle.width,it=tt(this,G,this.svgFactory.createElement("svg:rect"));return it.setAttribute("x",q/2),it.setAttribute("y",q/2),it.setAttribute("width",p-q),it.setAttribute("height",D-q),it.setAttribute("stroke-width",q||1),it.setAttribute("stroke","transparent"),it.setAttribute("fill","transparent"),j.append(it),this.container.append(j),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,G)}addHighlightArea(){this.container.classList.add("highlightArea")}}G=new WeakMap;class V extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});I(this,_t,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:p,height:D}=O(e.rect),j=this.svgFactory.create(p,D,!0),q=e.borderStyle.width,it=tt(this,_t,this.svgFactory.createElement("svg:ellipse"));return it.setAttribute("cx",p/2),it.setAttribute("cy",D/2),it.setAttribute("rx",p/2-q/2),it.setAttribute("ry",D/2-q/2),it.setAttribute("stroke-width",q||1),it.setAttribute("stroke","transparent"),it.setAttribute("fill","transparent"),j.append(it),this.container.append(j),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,_t)}addHighlightArea(){this.container.classList.add("highlightArea")}}_t=new WeakMap;class E extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});I(this,yt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:p,height:D}=O(e.rect),j=this.svgFactory.create(p,D,!0);let q=[];for(const bt of e.vertices){const Ft=bt.x-e.rect[0],Pt=e.rect[3]-bt.y;q.push(Ft+","+Pt)}q=q.join(" ");const it=tt(this,yt,this.svgFactory.createElement(this.svgElementName));return it.setAttribute("points",q),it.setAttribute("stroke-width",e.borderStyle.width||1),it.setAttribute("stroke","transparent"),it.setAttribute("fill","transparent"),j.append(it),this.container.append(j),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,yt)}addHighlightArea(){this.container.classList.add("highlightArea")}}yt=new WeakMap;class $ extends E{constructor(R){super(R),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class st extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class at extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});I(this,ee,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=h.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:p,height:D}=O(e.rect),j=this.svgFactory.create(p,D,!0);for(const q of e.inkLists){let it=[];for(const Ft of q){const Pt=Ft.x-e.rect[0],Vt=e.rect[3]-Ft.y;it.push(`${Pt},${Vt}`)}it=it.join(" ");const bt=this.svgFactory.createElement(this.svgElementName);t(this,ee).push(bt),bt.setAttribute("points",it),bt.setAttribute("stroke-width",e.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),j.append(bt)}return this.container.append(j),this.container}getElementsToTriggerPopup(){return t(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap,d.InkAnnotationElement=at;class H extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ct extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Ct extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class kt extends v{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}d.StampAnnotationElement=kt;class S extends v{constructor(e){var j;super(e,{isRenderable:!0});I(this,Y);I(this,te,null);const{filename:p,content:D}=this.data.file;this.filename=(0,P.getFilenameFromUrl)(p,!0),this.content=D,(j=this.linkService.eventBus)==null||j.dispatch("fileattachmentannotation",{source:this,filename:p,content:D})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:p}=this;let D;p.hasAppearance||p.fillAlpha===0?D=document.createElement("div"):(D=document.createElement("img"),D.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(p.name)?"paperclip":"pushpin"}.svg`,p.fillAlpha&&p.fillAlpha<1&&(D.style=`filter: opacity(${Math.round(p.fillAlpha*100)}%);`)),D.addEventListener("dblclick",W(this,Y,ci).bind(this)),tt(this,te,D);const{isMac:j}=h.FeatureTest.platform;return e.addEventListener("keydown",q=>{q.key==="Enter"&&(j?q.metaKey:q.ctrlKey)&&W(this,Y,ci).call(this)}),!p.popupRef&&this.hasPopupData?this._createPopup():D.classList.add("popupTriggerArea"),e.append(D),e}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,Y=new WeakSet,ci=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:R,accessibilityManager:e,annotationCanvasMap:p,l10n:D,page:j,viewport:q}){I(this,Bt);I(this,At);I(this,Ot,null);I(this,xt,null);I(this,Nt,new Map);this.div=R,tt(this,Ot,e),tt(this,xt,p),this.l10n=D,this.page=j,this.viewport=q,this.zIndex=0,this.l10n||(this.l10n=pt.NullL10n)}async render(R){const{annotations:e}=R,p=this.div;(0,P.setLayerDimensions)(p,this.viewport);const D=new Map,j={data:null,layer:p,linkService:R.linkService,downloadManager:R.downloadManager,imageResourcesPath:R.imageResourcesPath||"",renderForms:R.renderForms!==!1,svgFactory:new P.DOMSVGFactory,annotationStorage:R.annotationStorage||new rt.AnnotationStorage,enableScripting:R.enableScripting===!0,hasJSActions:R.hasJSActions,fieldObjects:R.fieldObjects,parent:this,elements:null};for(const q of e){if(q.noHTML)continue;const it=q.annotationType===h.AnnotationType.POPUP;if(it){const Pt=D.get(q.id);if(!Pt)continue;j.elements=Pt}else{const{width:Pt,height:Vt}=O(q.rect);if(Pt<=0||Vt<=0)continue}j.data=q;const bt=x.create(j);if(!bt.isRenderable)continue;if(!it&&q.popupRef){const Pt=D.get(q.popupRef);Pt?Pt.push(bt):D.set(q.popupRef,[bt])}bt.annotationEditorType>0&&t(this,Nt).set(bt.data.id,bt);const Ft=bt.render();q.hidden&&(Ft.style.visibility="hidden"),W(this,Bt,Ni).call(this,Ft,q.id)}W(this,At,hi).call(this),await this.l10n.translate(p)}update({viewport:R}){const e=this.div;this.viewport=R,(0,P.setLayerDimensions)(e,{rotation:R.rotation}),W(this,At,hi).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Nt).values())}getEditableAnnotation(R){return t(this,Nt).get(R)}}Ot=new WeakMap,xt=new WeakMap,Nt=new WeakMap,Bt=new WeakSet,Ni=function(R,e){var D;const p=R.firstChild||R;p.id=`${h.AnnotationPrefix}${e}`,this.div.append(R),(D=t(this,Ot))==null||D.moveElementInDOM(this.div,R,p,!1)},At=new WeakSet,hi=function(){if(!t(this,xt))return;const R=this.div;for(const[e,p]of t(this,xt)){const D=R.querySelector(`[data-annotation-id="${e}"]`);if(!D)continue;const{firstChild:j}=D;j?j.nodeName==="CANVAS"?j.replaceWith(p):j.before(p):D.append(p)}t(this,xt).clear()},d.AnnotationLayer=i},(mt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ColorConverters=void 0;function ot(rt){return Math.floor(Math.max(0,Math.min(1,rt))*255).toString(16).padStart(2,"0")}function h(rt){return Math.max(0,Math.min(255,255*rt))}class P{static CMYK_G([X,pt,B,F]){return["G",1-Math.min(1,.3*X+.59*B+.11*pt+F)]}static G_CMYK([X]){return["CMYK",0,0,0,1-X]}static G_RGB([X]){return["RGB",X,X,X]}static G_rgb([X]){return X=h(X),[X,X,X]}static G_HTML([X]){const pt=ot(X);return`#${pt}${pt}${pt}`}static RGB_G([X,pt,B]){return["G",.3*X+.59*pt+.11*B]}static RGB_rgb(X){return X.map(h)}static RGB_HTML(X){return`#${X.map(ot).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([X,pt,B,F]){return["RGB",1-Math.min(1,X+F),1-Math.min(1,B+F),1-Math.min(1,pt+F)]}static CMYK_rgb([X,pt,B,F]){return[h(1-Math.min(1,X+F)),h(1-Math.min(1,B+F)),h(1-Math.min(1,pt+F))]}static CMYK_HTML(X){const pt=this.CMYK_RGB(X).slice(1);return this.RGB_HTML(pt)}static RGB_CMYK([X,pt,B]){const F=1-X,f=1-pt,L=1-B,O=Math.min(F,f,L);return["CMYK",F,f,L,O]}}d.ColorConverters=P},(mt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NullL10n=void 0,d.getL10nFallback=h;const ot={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};ot.print_progress_percent="{{progress}}%";function h(X,pt){switch(X){case"find_match_count":X=`find_match_count[${pt.total===1?"one":"other"}]`;break;case"find_match_count_limit":X=`find_match_count_limit[${pt.limit===1?"one":"other"}]`;break}return ot[X]||""}function P(X,pt){return pt?X.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(B,F)=>F in pt?pt[F]:"{{"+F+"}}"):X}const rt={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(X,pt=null,B=h(X,pt)){return P(B,pt)},async translate(X){}};d.NullL10n=rt},(mt,d,ot)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.XfaLayer=void 0;var h=ot(25);class P{static setupStorage(X,pt,B,F,f){const L=F.getValue(pt,{value:null});switch(B.name){case"textarea":if(L.value!==null&&(X.textContent=L.value),f==="print")break;X.addEventListener("input",O=>{F.setValue(pt,{value:O.target.value})});break;case"input":if(B.attributes.type==="radio"||B.attributes.type==="checkbox"){if(L.value===B.attributes.xfaOn?X.setAttribute("checked",!0):L.value===B.attributes.xfaOff&&X.removeAttribute("checked"),f==="print")break;X.addEventListener("change",O=>{F.setValue(pt,{value:O.target.checked?O.target.getAttribute("xfaOn"):O.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&X.setAttribute("value",L.value),f==="print")break;X.addEventListener("input",O=>{F.setValue(pt,{value:O.target.value})})}break;case"select":if(L.value!==null){X.setAttribute("value",L.value);for(const O of B.children)O.attributes.value===L.value?O.attributes.selected=!0:O.attributes.hasOwnProperty("selected")&&delete O.attributes.selected}X.addEventListener("input",O=>{const x=O.target.options,v=x.selectedIndex===-1?"":x[x.selectedIndex].value;F.setValue(pt,{value:v})});break}}static setAttributes({html:X,element:pt,storage:B=null,intent:F,linkService:f}){const{attributes:L}=pt,O=X instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${F}`);for(const[x,v]of Object.entries(L))if(v!=null)switch(x){case"class":v.length&&X.setAttribute(x,v.join(" "));break;case"dataId":break;case"id":X.setAttribute("data-element-id",v);break;case"style":Object.assign(X.style,v);break;case"textContent":X.textContent=v;break;default:(!O||x!=="href"&&x!=="newWindow")&&X.setAttribute(x,v)}O&&f.addLinkAttributes(X,L.href,L.newWindow),B&&L.dataId&&this.setupStorage(X,L.dataId,pt,B)}static render(X){var y;const pt=X.annotationStorage,B=X.linkService,F=X.xfaHtml,f=X.intent||"display",L=document.createElement(F.name);F.attributes&&this.setAttributes({html:L,element:F,intent:f,linkService:B});const O=[[F,-1,L]],x=X.div;if(x.append(L),X.viewport){const u=`matrix(${X.viewport.transform.join(",")})`;x.style.transform=u}f!=="richText"&&x.setAttribute("class","xfaLayer xfaFont");const v=[];for(;O.length>0;){const[u,_,w]=O.at(-1);if(_+1===u.children.length){O.pop();continue}const C=u.children[++O.at(-1)[1]];if(C===null)continue;const{name:A}=C;if(A==="#text"){const l=document.createTextNode(C.value);v.push(l),w.append(l);continue}const a=(y=C==null?void 0:C.attributes)!=null&&y.xmlns?document.createElementNS(C.attributes.xmlns,A):document.createElement(A);if(w.append(a),C.attributes&&this.setAttributes({html:a,element:C,storage:pt,intent:f,linkService:B}),C.children&&C.children.length>0)O.push([C,-1,a]);else if(C.value){const l=document.createTextNode(C.value);h.XfaText.shouldBuildText(A)&&v.push(l),a.append(l)}}for(const u of x.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:v}}static update(X){const pt=`matrix(${X.viewport.transform.join(",")})`;X.div.style.transform=pt,X.div.hidden=!1}}d.XfaLayer=P},(mt,d,ot)=>{var F,f,L,O,x,v,y,u,_,w,C,A,a,l,k,Bi,r,Ui,m,ji,V,Hi,$,di,at,Wi,ct,ui,Ct,zi,S,Gi,n,Vi,o,Xi,b,$i,N,oe,Z,fi,ht,Re,ut,De,Ut,pe,It,pi,J,Ie,dt,qi,Tt,gi,Gt,Yi,Xt,Ki,zt,mi,lt,Le,G,ge;Object.defineProperty(d,"__esModule",{value:!0}),d.InkEditor=void 0;var h=ot(1),P=ot(4),rt=ot(29),X=ot(6),pt=ot(5);const yt=class yt extends P.AnnotationEditor{constructor(Y){super({...Y,name:"inkEditor"});I(this,k);I(this,r);I(this,m);I(this,V);I(this,$);I(this,at);I(this,ct);I(this,Ct);I(this,S);I(this,n);I(this,o);I(this,b);I(this,N);I(this,Z);I(this,ht);I(this,ut);I(this,Ut);I(this,It);I(this,J);I(this,Xt);I(this,zt);I(this,lt);I(this,G);I(this,F,0);I(this,f,0);I(this,L,this.canvasPointermove.bind(this));I(this,O,this.canvasPointerleave.bind(this));I(this,x,this.canvasPointerup.bind(this));I(this,v,this.canvasPointerdown.bind(this));I(this,y,new Path2D);I(this,u,!1);I(this,_,!1);I(this,w,!1);I(this,C,null);I(this,A,0);I(this,a,0);I(this,l,null);this.color=Y.color||null,this.thickness=Y.thickness||null,this.opacity=Y.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Y){P.AnnotationEditor.initialize(Y,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Y,St){switch(Y){case h.AnnotationEditorParamsType.INK_THICKNESS:yt._defaultThickness=St;break;case h.AnnotationEditorParamsType.INK_COLOR:yt._defaultColor=St;break;case h.AnnotationEditorParamsType.INK_OPACITY:yt._defaultOpacity=St/100;break}}updateParams(Y,St){switch(Y){case h.AnnotationEditorParamsType.INK_THICKNESS:W(this,k,Bi).call(this,St);break;case h.AnnotationEditorParamsType.INK_COLOR:W(this,r,Ui).call(this,St);break;case h.AnnotationEditorParamsType.INK_OPACITY:W(this,m,ji).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[h.AnnotationEditorParamsType.INK_THICKNESS,yt._defaultThickness],[h.AnnotationEditorParamsType.INK_COLOR,yt._defaultColor||P.AnnotationEditor._defaultLineColor],[h.AnnotationEditorParamsType.INK_OPACITY,Math.round(yt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[h.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||yt._defaultThickness],[h.AnnotationEditorParamsType.INK_COLOR,this.color||yt._defaultColor||P.AnnotationEditor._defaultLineColor],[h.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??yt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(W(this,ht,Re).call(this),W(this,ut,De).call(this)),this.isAttachedToDOM||(this.parent.add(this),W(this,Ut,pe).call(this)),W(this,G,ge).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,C).disconnect(),tt(this,C,null),super.remove())}setParent(Y){!this.parent&&Y?this._uiManager.removeShouldRescale(this):this.parent&&Y===null&&this._uiManager.addShouldRescale(this),super.setParent(Y)}onScaleChanging(){const[Y,St]=this.parentDimensions,Ot=this.width*Y,xt=this.height*St;this.setDimensions(Ot,xt)}enableEditMode(){t(this,u)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,v)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,v)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,u)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),tt(this,u,!0),this.div.classList.add("disabled"),W(this,G,ge).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Y){this._focusEventsAllowed&&(super.focusin(Y),this.enableEditMode())}canvasPointerdown(Y){Y.button!==0||!this.isInEditMode()||t(this,u)||(this.setInForeground(),Y.preventDefault(),Y.type!=="mouse"&&this.div.focus(),W(this,at,Wi).call(this,Y.offsetX,Y.offsetY))}canvasPointermove(Y){Y.preventDefault(),W(this,ct,ui).call(this,Y.offsetX,Y.offsetY)}canvasPointerup(Y){Y.preventDefault(),W(this,Z,fi).call(this,Y)}canvasPointerleave(Y){W(this,Z,fi).call(this,Y)}get isResizable(){return!this.isEmpty()&&t(this,u)}render(){if(this.div)return this.div;let Y,St;this.width&&(Y=this.x,St=this.y),super.render(),P.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Qt=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",Qt)});const[Ot,xt,Nt,Bt]=W(this,V,Hi).call(this);if(this.setAt(Ot,xt,0,0),this.setDims(Nt,Bt),W(this,ht,Re).call(this),this.width){const[Qt,At]=this.parentDimensions;this.setAspectRatio(this.width*Qt,this.height*At),this.setAt(Y*Qt,St*At,this.width*Qt,this.height*At),tt(this,w,!0),W(this,Ut,pe).call(this),this.setDims(this.width*Qt,this.height*At),W(this,N,oe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return W(this,ut,De).call(this),this.div}setDimensions(Y,St){const Ot=Math.round(Y),xt=Math.round(St);if(t(this,A)===Ot&&t(this,a)===xt)return;tt(this,A,Ot),tt(this,a,xt),this.canvas.style.visibility="hidden";const[Nt,Bt]=this.parentDimensions;this.width=Y/Nt,this.height=St/Bt,this.fixAndSetPosition(),t(this,u)&&W(this,It,pi).call(this,Y,St),W(this,Ut,pe).call(this),W(this,N,oe).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Y,St,Ot){var j,q,it;if(Y instanceof rt.InkAnnotationElement)return null;const xt=super.deserialize(Y,St,Ot);xt.thickness=Y.thickness,xt.color=h.Util.makeHexColor(...Y.color),xt.opacity=Y.opacity;const[Nt,Bt]=xt.pageDimensions,Qt=xt.width*Nt,At=xt.height*Bt,Kt=xt.parentScale,Lt=Y.thickness/2;tt(xt,u,!0),tt(xt,A,Math.round(Qt)),tt(xt,a,Math.round(At));const{paths:R,rect:e,rotation:p}=Y;for(let{bezier:bt}of R){bt=W(j=yt,Gt,Yi).call(j,bt,e,p);const Ft=[];xt.paths.push(Ft);let Pt=Kt*(bt[0]-Lt),Vt=Kt*(bt[1]-Lt);for(let Dt=2,Ht=bt.length;Dt<Ht;Dt+=6){const qt=Kt*(bt[Dt]-Lt),Jt=Kt*(bt[Dt+1]-Lt),Zt=Kt*(bt[Dt+2]-Lt),ne=Kt*(bt[Dt+3]-Lt),se=Kt*(bt[Dt+4]-Lt),re=Kt*(bt[Dt+5]-Lt);Ft.push([[Pt,Vt],[qt,Jt],[Zt,ne],[se,re]]),Pt=se,Vt=re}const Rt=W(this,dt,qi).call(this,Ft);xt.bezierPath2D.push(Rt)}const D=W(q=xt,zt,mi).call(q);return tt(xt,f,Math.max(P.AnnotationEditor.MIN_SIZE,D[2]-D[0])),tt(xt,F,Math.max(P.AnnotationEditor.MIN_SIZE,D[3]-D[1])),W(it=xt,It,pi).call(it,Qt,At),xt}serialize(){if(this.isEmpty())return null;const Y=this.getRect(0,0),St=P.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:h.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:W(this,Xt,Ki).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Y),pageIndex:this.pageIndex,rect:Y,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};F=new WeakMap,f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,A=new WeakMap,a=new WeakMap,l=new WeakMap,k=new WeakSet,Bi=function(Y){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=Y,W(this,G,ge).call(this)},undo:()=>{this.thickness=St,W(this,G,ge).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},r=new WeakSet,Ui=function(Y){const St=this.color;this.addCommands({cmd:()=>{this.color=Y,W(this,N,oe).call(this)},undo:()=>{this.color=St,W(this,N,oe).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,ji=function(Y){Y/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=Y,W(this,N,oe).call(this)},undo:()=>{this.opacity=St,W(this,N,oe).call(this)},mustExec:!0,type:h.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},V=new WeakSet,Hi=function(){const{parentRotation:Y,parentDimensions:[St,Ot]}=this;switch(Y){case 90:return[0,Ot,Ot,St];case 180:return[St,Ot,St,Ot];case 270:return[St,0,Ot,St];default:return[0,0,St,Ot]}},$=new WeakSet,di=function(){const{ctx:Y,color:St,opacity:Ot,thickness:xt,parentScale:Nt,scaleFactor:Bt}=this;Y.lineWidth=xt*Nt/Bt,Y.lineCap="round",Y.lineJoin="round",Y.miterLimit=10,Y.strokeStyle=`${St}${(0,pt.opacityToHex)(Ot)}`},at=new WeakSet,Wi=function(Y,St){this.canvas.addEventListener("contextmenu",X.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,O)),this.canvas.addEventListener("pointermove",t(this,L)),this.canvas.addEventListener("pointerup",t(this,x)),this.canvas.removeEventListener("pointerdown",t(this,v)),this.isEditing=!0,t(this,w)||(tt(this,w,!0),W(this,Ut,pe).call(this),this.thickness||(this.thickness=yt._defaultThickness),this.color||(this.color=yt._defaultColor||P.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=yt._defaultOpacity)),this.currentPath.push([Y,St]),tt(this,_,!1),W(this,$,di).call(this),tt(this,l,()=>{W(this,n,Vi).call(this),t(this,l)&&window.requestAnimationFrame(t(this,l))}),window.requestAnimationFrame(t(this,l))},ct=new WeakSet,ui=function(Y,St){const[Ot,xt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Y===Ot&&St===xt)return;const Nt=this.currentPath;let Bt=t(this,y);if(Nt.push([Y,St]),tt(this,_,!0),Nt.length<=2){Bt.moveTo(...Nt[0]),Bt.lineTo(Y,St);return}Nt.length===3&&(tt(this,y,Bt=new Path2D),Bt.moveTo(...Nt[0])),W(this,o,Xi).call(this,Bt,...Nt.at(-3),...Nt.at(-2),Y,St)},Ct=new WeakSet,zi=function(){if(this.currentPath.length===0)return;const Y=this.currentPath.at(-1);t(this,y).lineTo(...Y)},S=new WeakSet,Gi=function(Y,St){tt(this,l,null),Y=Math.min(Math.max(Y,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),W(this,ct,ui).call(this,Y,St),W(this,Ct,zi).call(this);let Ot;if(this.currentPath.length!==1)Ot=W(this,b,$i).call(this);else{const At=[Y,St];Ot=[[At,At.slice(),At.slice(),At]]}const xt=t(this,y),Nt=this.currentPath;this.currentPath=[],tt(this,y,new Path2D);const Bt=()=>{this.allRawPaths.push(Nt),this.paths.push(Ot),this.bezierPath2D.push(xt),this.rebuild()},Qt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(W(this,ht,Re).call(this),W(this,ut,De).call(this)),W(this,G,ge).call(this))};this.addCommands({cmd:Bt,undo:Qt,mustExec:!0})},n=new WeakSet,Vi=function(){if(!t(this,_))return;tt(this,_,!1);const Y=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),Ot=St.map(Bt=>Bt[0]),xt=St.map(Bt=>Bt[1]);Math.min(...Ot)-Y,Math.max(...Ot)+Y,Math.min(...xt)-Y,Math.max(...xt)+Y;const{ctx:Nt}=this;Nt.save(),Nt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Bt of this.bezierPath2D)Nt.stroke(Bt);Nt.stroke(t(this,y)),Nt.restore()},o=new WeakSet,Xi=function(Y,St,Ot,xt,Nt,Bt,Qt){const At=(St+xt)/2,Kt=(Ot+Nt)/2,Lt=(xt+Bt)/2,R=(Nt+Qt)/2;Y.bezierCurveTo(At+2*(xt-At)/3,Kt+2*(Nt-Kt)/3,Lt+2*(xt-Lt)/3,R+2*(Nt-R)/3,Lt,R)},b=new WeakSet,$i=function(){const Y=this.currentPath;if(Y.length<=2)return[[Y[0],Y[0],Y.at(-1),Y.at(-1)]];const St=[];let Ot,[xt,Nt]=Y[0];for(Ot=1;Ot<Y.length-2;Ot++){const[e,p]=Y[Ot],[D,j]=Y[Ot+1],q=(e+D)/2,it=(p+j)/2,bt=[xt+2*(e-xt)/3,Nt+2*(p-Nt)/3],Ft=[q+2*(e-q)/3,it+2*(p-it)/3];St.push([[xt,Nt],bt,Ft,[q,it]]),[xt,Nt]=[q,it]}const[Bt,Qt]=Y[Ot],[At,Kt]=Y[Ot+1],Lt=[xt+2*(Bt-xt)/3,Nt+2*(Qt-Nt)/3],R=[At+2*(Bt-At)/3,Kt+2*(Qt-Kt)/3];return St.push([[xt,Nt],Lt,R,[At,Kt]]),St},N=new WeakSet,oe=function(){if(this.isEmpty()){W(this,J,Ie).call(this);return}W(this,$,di).call(this);const{canvas:Y,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,Y.width,Y.height),W(this,J,Ie).call(this);for(const Ot of this.bezierPath2D)St.stroke(Ot)},Z=new WeakSet,fi=function(Y){this.canvas.removeEventListener("pointerleave",t(this,O)),this.canvas.removeEventListener("pointermove",t(this,L)),this.canvas.removeEventListener("pointerup",t(this,x)),this.canvas.addEventListener("pointerdown",t(this,v)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",X.noContextMenu)},10),W(this,S,Gi).call(this,Y.offsetX,Y.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ht=new WeakSet,Re=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",P.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Y=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",Y)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ut=new WeakSet,De=function(){tt(this,C,new ResizeObserver(Y=>{const St=Y[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,C).observe(this.div)},Ut=new WeakSet,pe=function(){if(!t(this,w))return;const[Y,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Y),this.canvas.height=Math.ceil(this.height*St),W(this,J,Ie).call(this)},It=new WeakSet,pi=function(Y,St){const Ot=W(this,lt,Le).call(this),xt=(Y-Ot)/t(this,f),Nt=(St-Ot)/t(this,F);this.scaleFactor=Math.min(xt,Nt)},J=new WeakSet,Ie=function(){const Y=W(this,lt,Le).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Y,this.translationY*this.scaleFactor+Y)},dt=new WeakSet,qi=function(Y){const St=new Path2D;for(let Ot=0,xt=Y.length;Ot<xt;Ot++){const[Nt,Bt,Qt,At]=Y[Ot];Ot===0&&St.moveTo(...Nt),St.bezierCurveTo(Bt[0],Bt[1],Qt[0],Qt[1],At[0],At[1])}return St},Tt=new WeakSet,gi=function(Y,St,Ot){const[xt,Nt,Bt,Qt]=St;switch(Ot){case 0:for(let At=0,Kt=Y.length;At<Kt;At+=2)Y[At]+=xt,Y[At+1]=Qt-Y[At+1];break;case 90:for(let At=0,Kt=Y.length;At<Kt;At+=2){const Lt=Y[At];Y[At]=Y[At+1]+xt,Y[At+1]=Lt+Nt}break;case 180:for(let At=0,Kt=Y.length;At<Kt;At+=2)Y[At]=Bt-Y[At],Y[At+1]+=Nt;break;case 270:for(let At=0,Kt=Y.length;At<Kt;At+=2){const Lt=Y[At];Y[At]=Bt-Y[At+1],Y[At+1]=Qt-Lt}break;default:throw new Error("Invalid rotation")}return Y},Gt=new WeakSet,Yi=function(Y,St,Ot){const[xt,Nt,Bt,Qt]=St;switch(Ot){case 0:for(let At=0,Kt=Y.length;At<Kt;At+=2)Y[At]-=xt,Y[At+1]=Qt-Y[At+1];break;case 90:for(let At=0,Kt=Y.length;At<Kt;At+=2){const Lt=Y[At];Y[At]=Y[At+1]-Nt,Y[At+1]=Lt-xt}break;case 180:for(let At=0,Kt=Y.length;At<Kt;At+=2)Y[At]=Bt-Y[At],Y[At+1]-=Nt;break;case 270:for(let At=0,Kt=Y.length;At<Kt;At+=2){const Lt=Y[At];Y[At]=Qt-Y[At+1],Y[At+1]=Bt-Lt}break;default:throw new Error("Invalid rotation")}return Y},Xt=new WeakSet,Ki=function(Y,St,Ot,xt){var Kt,Lt;const Nt=[],Bt=this.thickness/2,Qt=Y*St+Bt,At=Y*Ot+Bt;for(const R of this.paths){const e=[],p=[];for(let D=0,j=R.length;D<j;D++){const[q,it,bt,Ft]=R[D],Pt=Y*q[0]+Qt,Vt=Y*q[1]+At,Rt=Y*it[0]+Qt,Dt=Y*it[1]+At,Ht=Y*bt[0]+Qt,qt=Y*bt[1]+At,Jt=Y*Ft[0]+Qt,Zt=Y*Ft[1]+At;D===0&&(e.push(Pt,Vt),p.push(Pt,Vt)),e.push(Rt,Dt,Ht,qt,Jt,Zt),p.push(Rt,Dt),D===j-1&&p.push(Jt,Zt)}Nt.push({bezier:W(Kt=yt,Tt,gi).call(Kt,e,xt,this.rotation),points:W(Lt=yt,Tt,gi).call(Lt,p,xt,this.rotation)})}return Nt},zt=new WeakSet,mi=function(){let Y=1/0,St=-1/0,Ot=1/0,xt=-1/0;for(const Nt of this.paths)for(const[Bt,Qt,At,Kt]of Nt){const Lt=h.Util.bezierBoundingBox(...Bt,...Qt,...At,...Kt);Y=Math.min(Y,Lt[0]),Ot=Math.min(Ot,Lt[1]),St=Math.max(St,Lt[2]),xt=Math.max(xt,Lt[3])}return[Y,Ot,St,xt]},lt=new WeakSet,Le=function(){return t(this,u)?Math.ceil(this.thickness*this.parentScale):0},G=new WeakSet,ge=function(Y=!1){if(this.isEmpty())return;if(!t(this,u)){W(this,N,oe).call(this);return}const St=W(this,zt,mi).call(this),Ot=W(this,lt,Le).call(this);tt(this,f,Math.max(P.AnnotationEditor.MIN_SIZE,St[2]-St[0])),tt(this,F,Math.max(P.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const xt=Math.ceil(Ot+t(this,f)*this.scaleFactor),Nt=Math.ceil(Ot+t(this,F)*this.scaleFactor),[Bt,Qt]=this.parentDimensions;this.width=xt/Bt,this.height=Nt/Qt,this.setAspectRatio(xt,Nt);const At=this.translationX,Kt=this.translationY;this.translationX=-St[0],this.translationY=-St[1],W(this,Ut,pe).call(this),W(this,N,oe).call(this),tt(this,A,xt),tt(this,a,Nt),this.setDims(xt,Nt);const Lt=Y?Ot/this.scaleFactor/2:0;this.translate(At-this.translationX-Lt,Kt-this.translationY-Lt)},I(yt,dt),I(yt,Tt),I(yt,Gt),ie(yt,"_defaultColor",null),ie(yt,"_defaultOpacity",1),ie(yt,"_defaultThickness",1),ie(yt,"_type","ink");let B=yt;d.InkEditor=B},(mt,d,ot)=>{var B,F,f,L,O,x,v,y,u,_,w,Se,A,Ee,l,Oe,g,bi,T,Ji,U,Qi,E,_i,st,Ne,H,Zi;Object.defineProperty(d,"__esModule",{value:!0}),d.StampEditor=void 0;var h=ot(1),P=ot(4),rt=ot(6),X=ot(29);const gt=class gt extends P.AnnotationEditor{constructor(S){super({...S,name:"stampEditor"});I(this,w);I(this,A);I(this,l);I(this,g);I(this,T);I(this,U);I(this,E);I(this,st);I(this,H);I(this,B,null);I(this,F,null);I(this,f,null);I(this,L,null);I(this,O,null);I(this,x,null);I(this,v,null);I(this,y,null);I(this,u,!1);I(this,_,!1);tt(this,L,S.bitmapUrl),tt(this,O,S.bitmapFile)}static initialize(S){P.AnnotationEditor.initialize(S)}static get supportedTypes(){const S=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,h.shadow)(this,"supportedTypes",S.map(i=>`image/${i}`))}static get supportedTypesStr(){return(0,h.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(S){return this.supportedTypes.includes(S)}static paste(S,i){i.pasteEditor(h.AnnotationEditorType.STAMP,{bitmapFile:S.getAsFile()})}remove(){var S,i;t(this,F)&&(tt(this,B,null),this._uiManager.imageManager.deleteId(t(this,F)),(S=t(this,x))==null||S.remove(),tt(this,x,null),(i=t(this,v))==null||i.disconnect(),tt(this,v,null)),super.remove()}rebuild(){if(!this.parent){t(this,F)&&W(this,l,Oe).call(this);return}super.rebuild(),this.div!==null&&(t(this,F)&&W(this,l,Oe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,f)||t(this,B)||t(this,L)||t(this,O))}get isResizable(){return!0}render(){if(this.div)return this.div;let S,i;if(this.width&&(S=this.x,i=this.y),super.render(),this.div.hidden=!0,t(this,B)?W(this,g,bi).call(this):W(this,l,Oe).call(this),this.width){const[n,s]=this.parentDimensions;this.setAt(S*n,i*s,this.width*n,this.height*s)}return this.div}static deserialize(S,i,n){if(S instanceof X.StampAnnotationElement)return null;const s=super.deserialize(S,i,n),{rect:o,bitmapUrl:c,bitmapId:b,isSvg:M,accessibilityData:N}=S;b&&n.imageManager.isValidId(b)?tt(s,F,b):tt(s,L,c),tt(s,u,M);const[et,Z]=s.pageDimensions;return s.width=(o[2]-o[0])/et,s.height=(o[3]-o[1])/Z,N&&(s.altTextData=N),s}serialize(S=!1,i=null){if(this.isEmpty())return null;const n={annotationType:h.AnnotationEditorType.STAMP,bitmapId:t(this,F),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,u),structTreeParentId:this._structTreeParentId};if(S)return n.bitmapUrl=W(this,st,Ne).call(this,!0),n.accessibilityData=this.altTextData,n;const{decorative:s,altText:o}=this.altTextData;if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),i===null)return n;i.stamps||(i.stamps=new Map);const c=t(this,u)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!i.stamps.has(t(this,F)))i.stamps.set(t(this,F),{area:c,serialized:n}),n.bitmap=W(this,st,Ne).call(this,!1);else if(t(this,u)){const b=i.stamps.get(t(this,F));c>b.area&&(b.area=c,b.serialized.bitmap.close(),b.serialized.bitmap=W(this,st,Ne).call(this,!1))}return n}};B=new WeakMap,F=new WeakMap,f=new WeakMap,L=new WeakMap,O=new WeakMap,x=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,w=new WeakSet,Se=function(S,i=!1){if(!S){this.remove();return}tt(this,B,S.bitmap),i||(tt(this,F,S.id),tt(this,u,S.isSvg)),W(this,g,bi).call(this)},A=new WeakSet,Ee=function(){tt(this,f,null),this._uiManager.enableWaiting(!1),t(this,x)&&this.div.focus()},l=new WeakSet,Oe=function(){if(t(this,F)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,F)).then(i=>W(this,w,Se).call(this,i,!0)).finally(()=>W(this,A,Ee).call(this));return}if(t(this,L)){const i=t(this,L);tt(this,L,null),this._uiManager.enableWaiting(!0),tt(this,f,this._uiManager.imageManager.getFromUrl(i).then(n=>W(this,w,Se).call(this,n)).finally(()=>W(this,A,Ee).call(this)));return}if(t(this,O)){const i=t(this,O);tt(this,O,null),this._uiManager.enableWaiting(!0),tt(this,f,this._uiManager.imageManager.getFromFile(i).then(n=>W(this,w,Se).call(this,n)).finally(()=>W(this,A,Ee).call(this)));return}const S=document.createElement("input");S.type="file",S.accept=gt.supportedTypesStr,tt(this,f,new Promise(i=>{S.addEventListener("change",async()=>{if(!S.files||S.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(S.files[0]);W(this,w,Se).call(this,n)}i()}),S.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>W(this,A,Ee).call(this))),S.click()},g=new WeakSet,bi=function(){const{div:S}=this;let{width:i,height:n}=t(this,B);const[s,o]=this.pageDimensions,c=.75;if(this.width)i=this.width*s,n=this.height*o;else if(i>c*s||n>c*o){const et=Math.min(c*s/i,c*o/n);i*=et,n*=et}const[b,M]=this.parentDimensions;this.setDims(i*b/s,n*M/o),this._uiManager.enableWaiting(!1);const N=tt(this,x,document.createElement("canvas"));S.append(N),S.hidden=!1,W(this,E,_i).call(this,i,n),W(this,H,Zi).call(this),t(this,_)||(this.parent.addUndoableEditor(this),tt(this,_,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},T=new WeakSet,Ji=function(S,i){var c;const[n,s]=this.parentDimensions;this.width=S/n,this.height=i/s,this.setDims(S,i),(c=this._initialOptions)!=null&&c.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,y)!==null&&clearTimeout(t(this,y)),tt(this,y,setTimeout(()=>{tt(this,y,null),W(this,E,_i).call(this,S,i)},200))},U=new WeakSet,Qi=function(S,i){const{width:n,height:s}=t(this,B);let o=n,c=s,b=t(this,B);for(;o>2*S||c>2*i;){const M=o,N=c;o>2*S&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const et=new OffscreenCanvas(o,c);et.getContext("2d").drawImage(b,0,0,M,N,0,0,o,c),b=et.transferToImageBitmap()}return b},E=new WeakSet,_i=function(S,i){S=Math.ceil(S),i=Math.ceil(i);const n=t(this,x);if(!n||n.width===S&&n.height===i)return;n.width=S,n.height=i;const s=t(this,u)?t(this,B):W(this,U,Qi).call(this,S,i),o=n.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(s,0,0,s.width,s.height,0,0,S,i)},st=new WeakSet,Ne=function(S){if(S){if(t(this,u)){const s=this._uiManager.imageManager.getSvgUrl(t(this,F));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=t(this,B),i.getContext("2d").drawImage(t(this,B),0,0),i.toDataURL()}if(t(this,u)){const[i,n]=this.pageDimensions,s=Math.round(this.width*i*rt.PixelsPerInch.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*rt.PixelsPerInch.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(s,o);return c.getContext("2d").drawImage(t(this,B),0,0,t(this,B).width,t(this,B).height,0,0,s,o),c.transferToImageBitmap()}return structuredClone(t(this,B))},H=new WeakSet,Zi=function(){tt(this,v,new ResizeObserver(S=>{const i=S[0].contentRect;i.width&&i.height&&W(this,T,Ji).call(this,i.width,i.height)})),t(this,v).observe(this.div)},ie(gt,"_type","stamp");let pt=gt;d.StampEditor=pt}],__webpack_module_cache__={};function __w_pdfjs_require__(mt){var d=__webpack_module_cache__[mt];if(d!==void 0)return d.exports;var ot=__webpack_module_cache__[mt]={exports:{}};return __webpack_modules__[mt](ot,ot.exports,__w_pdfjs_require__),ot.exports}var __webpack_exports__={};return(()=>{var mt=__webpack_exports__;Object.defineProperty(mt,"__esModule",{value:!0}),Object.defineProperty(mt,"AbortException",{enumerable:!0,get:function(){return d.AbortException}}),Object.defineProperty(mt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return rt.AnnotationEditorLayer}}),Object.defineProperty(mt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return d.AnnotationEditorParamsType}}),Object.defineProperty(mt,"AnnotationEditorType",{enumerable:!0,get:function(){return d.AnnotationEditorType}}),Object.defineProperty(mt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return X.AnnotationEditorUIManager}}),Object.defineProperty(mt,"AnnotationLayer",{enumerable:!0,get:function(){return pt.AnnotationLayer}}),Object.defineProperty(mt,"AnnotationMode",{enumerable:!0,get:function(){return d.AnnotationMode}}),Object.defineProperty(mt,"CMapCompressionType",{enumerable:!0,get:function(){return d.CMapCompressionType}}),Object.defineProperty(mt,"DOMSVGFactory",{enumerable:!0,get:function(){return h.DOMSVGFactory}}),Object.defineProperty(mt,"FeatureTest",{enumerable:!0,get:function(){return d.FeatureTest}}),Object.defineProperty(mt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return B.GlobalWorkerOptions}}),Object.defineProperty(mt,"ImageKind",{enumerable:!0,get:function(){return d.ImageKind}}),Object.defineProperty(mt,"InvalidPDFException",{enumerable:!0,get:function(){return d.InvalidPDFException}}),Object.defineProperty(mt,"MissingPDFException",{enumerable:!0,get:function(){return d.MissingPDFException}}),Object.defineProperty(mt,"OPS",{enumerable:!0,get:function(){return d.OPS}}),Object.defineProperty(mt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return ot.PDFDataRangeTransport}}),Object.defineProperty(mt,"PDFDateString",{enumerable:!0,get:function(){return h.PDFDateString}}),Object.defineProperty(mt,"PDFWorker",{enumerable:!0,get:function(){return ot.PDFWorker}}),Object.defineProperty(mt,"PasswordResponses",{enumerable:!0,get:function(){return d.PasswordResponses}}),Object.defineProperty(mt,"PermissionFlag",{enumerable:!0,get:function(){return d.PermissionFlag}}),Object.defineProperty(mt,"PixelsPerInch",{enumerable:!0,get:function(){return h.PixelsPerInch}}),Object.defineProperty(mt,"PromiseCapability",{enumerable:!0,get:function(){return d.PromiseCapability}}),Object.defineProperty(mt,"RenderingCancelledException",{enumerable:!0,get:function(){return h.RenderingCancelledException}}),Object.defineProperty(mt,"SVGGraphics",{enumerable:!0,get:function(){return ot.SVGGraphics}}),Object.defineProperty(mt,"UnexpectedResponseException",{enumerable:!0,get:function(){return d.UnexpectedResponseException}}),Object.defineProperty(mt,"Util",{enumerable:!0,get:function(){return d.Util}}),Object.defineProperty(mt,"VerbosityLevel",{enumerable:!0,get:function(){return d.VerbosityLevel}}),Object.defineProperty(mt,"XfaLayer",{enumerable:!0,get:function(){return F.XfaLayer}}),Object.defineProperty(mt,"build",{enumerable:!0,get:function(){return ot.build}}),Object.defineProperty(mt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return d.createValidAbsoluteUrl}}),Object.defineProperty(mt,"getDocument",{enumerable:!0,get:function(){return ot.getDocument}}),Object.defineProperty(mt,"getFilenameFromUrl",{enumerable:!0,get:function(){return h.getFilenameFromUrl}}),Object.defineProperty(mt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return h.getPdfFilenameFromUrl}}),Object.defineProperty(mt,"getXfaPageViewport",{enumerable:!0,get:function(){return h.getXfaPageViewport}}),Object.defineProperty(mt,"isDataScheme",{enumerable:!0,get:function(){return h.isDataScheme}}),Object.defineProperty(mt,"isPdfFile",{enumerable:!0,get:function(){return h.isPdfFile}}),Object.defineProperty(mt,"loadScript",{enumerable:!0,get:function(){return h.loadScript}}),Object.defineProperty(mt,"noContextMenu",{enumerable:!0,get:function(){return h.noContextMenu}}),Object.defineProperty(mt,"normalizeUnicode",{enumerable:!0,get:function(){return d.normalizeUnicode}}),Object.defineProperty(mt,"renderTextLayer",{enumerable:!0,get:function(){return P.renderTextLayer}}),Object.defineProperty(mt,"setLayerDimensions",{enumerable:!0,get:function(){return h.setLayerDimensions}}),Object.defineProperty(mt,"shadow",{enumerable:!0,get:function(){return d.shadow}}),Object.defineProperty(mt,"updateTextLayer",{enumerable:!0,get:function(){return P.updateTextLayer}}),Object.defineProperty(mt,"version",{enumerable:!0,get:function(){return ot.version}});var d=__w_pdfjs_require__(1),ot=__w_pdfjs_require__(2),h=__w_pdfjs_require__(6),P=__w_pdfjs_require__(26),rt=__w_pdfjs_require__(27),X=__w_pdfjs_require__(5),pt=__w_pdfjs_require__(29),B=__w_pdfjs_require__(14),F=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;export{_sfc_main as _,pdfExports as p,taskSchema as t};
