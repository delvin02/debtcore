import{_ as Ke,a as We,b as Ye,c as Ge,d as Qe,e as Me,u as fe,f as Xe,g as Ze,h as Je,i as Ce,j as ve,k as et,l as tt,m as at,n as st,o as lt,p as nt,q as ot,r as it,F as Ve,z as T,s as De}from"./Checkbox.vue_vue_type_script_setup_true_lang.B1OsCrsj.js";import{e as R,o as u,c as v,f as rt,n as W,u as s,g as me,r as E,d as c,t as g,a as t,k as o,F as P,v as A,s as k,b as p,x as G,l as x,Z as ee,m as U,M as oe,U as be,V as Pe,X as ye,W as ze,Y as de,a1 as ue,O as ie,T as re,au as ct,y as Te,z as Ue,A as je,i as I,aU as dt,B as we,C as ut,D as te,E as B,J as xe,L,a2 as he,G as $e,a3 as Ae,a4 as He,a5 as Le,_ as O,af as Ee,as as ft,a6 as Ne,at as mt,I as _t,aa as pt,j as gt,a7 as D,av as Ie,a8 as vt,ax as ht,a9 as bt}from"../main.js";import{_ as Z}from"./index.DhdF1qMN.js";import{_ as yt,a as wt,b as xt,c as $t,d as St}from"./index.Dq4Y6CJz.js";import{_ as kt,a as Ct}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.CMtdOpeP.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang.CydXMrwJ.js";import{_ as ae,b as se,a as le,c as ne}from"./CardContent.vue_vue_type_script_setup_true_lang.7hCCP0E-.js";import{_ as Oe}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as Vt}from"./lodash.BtnTHUG3.js";import{l as Dt,f as It}from"./index.DbBGH_1q.js";import{_ as Ft}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.BhXjXo8B.js";import{f as Rt}from"./index.BccI3ZLR.js";import"./index.5qndC0qu.js";const Mt=R({__name:"SheetFooter",props:{class:{}},setup(e){const a=e;return(l,n)=>(u(),v("div",{class:W(s(me)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",a.class))},[rt(l.$slots,"default")],2))}}),Pt={class:"flex items-center justify-between px-2 pb-10"},zt={class:"flex-1 text-sm text-muted-foreground"},Tt={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Ut={class:"flex items-center space-x-2"},jt=c("p",{class:"text-sm font-medium"},"Rows per page",-1),At={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Ht={class:"flex items-center space-x-2"},Lt=c("span",{class:"sr-only"},"Go to first page",-1),Et=c("span",{class:"sr-only"},"Go to previous page",-1),Nt=c("span",{class:"sr-only"},"Go to next page",-1),Ot=c("span",{class:"sr-only"},"Go to last page",-1),Bt=R({__name:"DataTablePagination",props:{table:{}},setup(e){return(a,l)=>{const n=E("VIcon");return u(),v("div",Pt,[c("div",zt,g(a.table.getFilteredSelectedRowModel().rows.length)+" of "+g(a.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),c("div",Tt,[c("div",Ut,[jt,t(s(Ge),{"model-value":`${a.table.getState().pagination.pageSize}`,"onUpdate:modelValue":a.table.setPageSize},{default:o(()=>[t(s(Ke),{class:"h-8 w-[70px]"},{default:o(()=>[t(s(We),{placeholder:`${a.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),t(s(Ye),{side:"top"},{default:o(()=>[(u(),v(P,null,A([10,20,30,40,50],r=>t(s(Qe),{key:r,value:`${r}`},{default:o(()=>[p(g(r),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),c("div",At," Page "+g(a.table.getState().pagination.pageIndex+1)+" of "+g(a.table.getPageCount()),1),c("div",Ht,[t(s(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!a.table.getCanPreviousPage(),onClick:l[0]||(l[0]=r=>a.table.setPageIndex(0))},{default:o(()=>[Lt,t(n,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!a.table.getCanPreviousPage(),onClick:l[1]||(l[1]=r=>a.table.previousPage())},{default:o(()=>[Et,t(n,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!a.table.getCanNextPage(),onClick:l[2]||(l[2]=r=>a.table.nextPage())},{default:o(()=>[Nt,t(n,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),t(s(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!a.table.getCanNextPage(),onClick:l[3]||(l[3]=r=>a.table.setPageIndex(a.table.getPageCount()-1))},{default:o(()=>[Ot,t(n,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),Se=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claiming",icon:"fa-circle"},{value:"3",label:"Done",icon:"fa-check-circle"},{value:"4",label:"Canceled",icon:"fa-times-circle"}],qt={class:"hidden space-x-1 lg:flex"},Kt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Wt=R({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(e){const a=e,l=G(()=>{var i;return(i=a.column)==null?void 0:i.getFacetedUniqueValues()}),n=G(()=>{var i;return new Set((i=a.column)==null?void 0:i.getFilterValue())}),r=i=>{var m;n.value.has(i)?n.value.delete(i):n.value.add(i);const h=Array.from(n.value);(m=a.column)==null||m.setFilterValue(h.length?h:void 0)};return(i,d)=>{const h=E("VIcon");return u(),x(s(re),null,{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(k),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:o(()=>[t(h,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),p(" "+g(i.title)+" ",1),n.value.size>0?(u(),v(P,{key:0},[t(s(ee),{orientation:"vertical",class:"mx-2 h-4"}),t(s(Z),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:o(()=>[p(g(n.value.size),1)]),_:1}),c("div",qt,[n.value.size>2?(u(),x(s(Z),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(n.value.size)+" selected ",1)]),_:1})):(u(!0),v(P,{key:1},A(i.options.filter(m=>n.value.has(m.value)),m=>(u(),x(s(Z),{key:m.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(m.label),1)]),_:2},1024))),128))])],64)):U("",!0)]),_:1})]),_:1}),t(s(ie),{class:"w-[200px] p-0",align:"start"},{default:o(()=>[t(s(be),null,{default:o(()=>[t(s(Pe),{placeholder:i.title},null,8,["placeholder"]),t(s(ye),null,{default:o(()=>[t(s(ze),null,{default:o(()=>[p("No results found.")]),_:1}),t(s(de),null,{default:o(()=>[(u(!0),v(P,null,A(i.options,m=>(u(),x(s(ue),{key:m.value,value:m,onSelect:()=>r(m.value)},{default:o(()=>{var b;return[c("div",{class:W(s(me)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n.value.has(m.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[t(h,{name:"fa-check",class:"h-4 w-4"})],2),m.icon?(u(),x(ct(m.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):U("",!0),c("span",null,g(m.label),1),(b=l.value)!=null&&b.get(m.value)?(u(),v("span",Kt,g(l.value.get(m.value)),1)):U("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),n.value.size>0?(u(),v(P,{key:0},[t(s(yt)),t(s(de),null,{default:o(()=>[t(s(ue),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:d[0]||(d[0]=()=>{var m;return(m=a.column)==null?void 0:m.setFilterValue(void 0)})},{default:o(()=>[p(" Clear filters ")]),_:1})]),_:1})],64)):U("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Yt=R({__name:"DataTableViewOptions",props:{table:{}},setup(e){const a=e,l=G(()=>a.table.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()));return(n,r)=>(u(),x(s(je),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(k),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:o(()=>[p(" View ")]),_:1})]),_:1}),t(s(Ue),{align:"end",class:"w-[150px]"},{default:o(()=>[t(s(kt),null,{default:o(()=>[p("Toggle columns")]),_:1}),t(s(Me)),(u(!0),v(P,null,A(l.value,i=>(u(),x(s(Ct),{key:i.id,class:"capitalize",checked:i.getIsVisible(),"onUpdate:checked":d=>i.toggleVisibility(!!d)},{default:o(()=>{var d;return[p(g(((d=i.columnDef.meta)==null?void 0:d.title)||i.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}});var Gt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Qt=`\r
`,Xt="\uFEFF",_e=e=>Object.assign({},Gt,e);class Zt extends Error{constructor(a){super(a),this.name="CsvGenerationError"}}class Jt extends Error{constructor(a){super(a),this.name="EmptyHeadersError"}}class ea extends Error{constructor(a){super(a),this.name="CsvDownloadEnvironmentError"}}class ta extends Error{constructor(a){super(a),this.name="UnsupportedDataFormatError"}}var X=e=>e,j=e=>e,J=X,pe=X,Q=X,Fe=X,Re=X,aa=function(e,a){return a=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},sa=e=>Fe(typeof e=="object"?e.key:e),la=e=>Re(typeof e=="object"?e.displayLabel:e),na=(e,...a)=>a.reduce((l,n)=>n(l),e),oa=e=>a=>e.useBom?pe(j(a)+Xt):a,ia=e=>a=>e.showTitle?ke(pe(j(a)+e.title))(Q("")):a,ke=e=>a=>pe(j(e)+j(a)+Qt),Be=e=>(a,l)=>ra(e)(Q(j(a)+j(l))),ra=e=>a=>X(j(a)+e.fieldSeparator),ca=(e,a)=>l=>{if(!e.showColumnHeaders)return l;if(a.length<1)throw new Jt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let n=Q("");for(let r=0;r<a.length;r++){const i=la(a[r]);n=Be(e)(n,qe(e,j(i)))}return n=Q(j(n).slice(0,-1)),ke(l)(n)},da=(e,a,l)=>n=>{let r=n;for(var i=0;i<l.length;i++){let d=Q("");for(let h=0;h<a.length;h++){const m=sa(a[h]),b=l[i][j(m)];d=Be(e)(d,qe(e,b))}d=Q(j(d).slice(0,-1)),r=ke(r)(d)}return r},ua=e=>+e===e&&(!isFinite(e)||!!(e%1)),fa=(e,a)=>{if(ua(a)){if(e.decimalSeparator==="locale")return J(a.toLocaleString());if(e.decimalSeparator)return J(a.toString().replace(".",e.decimalSeparator))}return J(a.toString())},ce=(e,a)=>{let l=a;return(e.quoteStrings||e.fieldSeparator&&a.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&a.indexOf(e.quoteCharacter)>-1||a.indexOf(`
`)>-1||a.indexOf("\r")>-1)&&(l=e.quoteCharacter+aa(a,e.quoteCharacter)+e.quoteCharacter),J(l)},ma=(e,a)=>{const l=a?"true":"false";return J(e.boolDisplay[l])},_a=(e,a)=>typeof a>"u"&&e.replaceUndefinedWith!==void 0?ce(e,e.replaceUndefinedWith+""):a===null?ce(e,"null"):ce(e,""),qe=(e,a)=>{if(typeof a=="number")return fa(e,a);if(typeof a=="string")return ce(e,a);if(typeof a=="boolean"&&e.boolDisplay)return ma(e,a);if(a===null||typeof a>"u")return _a(e,a);throw new ta(`
    typeof ${typeof a} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},pa=e=>a=>{const l=_e(e),n=l.useKeysAsHeaders?Object.keys(a[0]):l.columnHeaders;let r=na(pe(""),oa(l),ia(l),ca(l,n),da(l,n,a));if(j(r).length<1)throw new Zt("Output is empty. Is your data formatted correctly?");return r},ga=e=>a=>{const l=_e(e),n=j(a),r=l.useTextFile?"plain":"csv";return new Blob([n],{type:`text/${r};charset=utf8;`})},va=e=>a=>{if(!window)throw new ea("Downloading only supported in a browser environment.");const l=ga(e)(a),n=_e(e),r=n.useTextFile?"txt":"csv",i=`${n.filename}.${r}`,d=document.createElement("a");d.download=i,d.href=URL.createObjectURL(l),d.setAttribute("visibility","hidden"),document.body.appendChild(d),d.click(),document.body.removeChild(d)};const ha=R({__name:"DataTableCreateDebt",props:{table:{}},setup(e){const a=e,l=I(!1),n=_e({fieldSeparator:",",filename:"report",decimalSeparator:".",useKeysAsHeaders:!0}),r=d=>d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),i=()=>{l.value=!0;const h=a.table.getFilteredRowModel().rows.map(b=>{var F;const w=b.getValue("invoice"),z=r(b.getValue("invoice_date")),C=r(b.getValue("due_date")),S=b.getValue("overdue")+" day(s)",V="RM "+b.getValue("amount"),H=`=HYPERLINK("${dt}${b.getValue("document_url")}", "Click Link Here")`,N=(F=Se.find(q=>q.value===b.original.status.toString()))==null?void 0:F.label;return{invoice:w,invoice_date:z,due_date:C,overdue:S,amount:V,attachment:H,status:N}}),m=pa(n)(h);va(n)(m),l.value=!1};return(d,h)=>{const m=E("VIcon");return u(),v("div",null,[t(s(k),{variant:"secondary",size:"sm",class:"hidden h-8 ml-2 lg:flex",onClick:i},{default:o(()=>[l.value?(u(),x(m,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-4"})):(u(),x(m,{key:1,name:"fa-download",class:"size-4"}))]),_:1})])}}}),ba={class:"flex items-center justify-between"},ya={class:"flex flex-1 items-center space-x-2"},wa=R({__name:"DataTableToolbar",props:{table:{}},setup(e){const a=e,l=G(()=>a.table.getState().columnFilters.length>0);return console.error(a.table.getColumn("status")),(n,r)=>{var i;return u(),v("div",ba,[c("div",ya,[t(s(Y),{placeholder:"Search...","model-value":((i=n.table.getColumn("invoice"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:r[0]||(r[0]=d=>n.table.setGlobalFilter(d.target.value))},null,8,["model-value"]),n.table.getColumn("status")?(u(),x(Wt,{key:0,column:n.table.getColumn("status"),title:"Status",options:s(Se)},null,8,["column","options"])):U("",!0),l.value?(u(),x(s(k),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:r[1]||(r[1]=d=>n.table.resetColumnFilters())},{default:o(()=>[p(" Reset ")]),_:1})):U("",!0)]),t(Yt,{table:n.table},null,8,["table"]),t(ha,{table:n.table},null,8,["table"])])}}}),xa={class:"space-y-4 text-muted-foreground"},$a={class:"rounded-md border"},Sa=R({__name:"DataTable",props:{columns:{},data:{}},setup(e){const a=we("tableStore",fe("debt")),l=e,n=I([]),r=I([]),i=I({}),d=I({pageIndex:a.page_index,pageSize:a.page_size}),h=I();function m(w,z){let C;typeof w=="function"?C=w(z.value):C=w,z.value=C,a.set_page_index(C.pageIndex),a.set_page_size(C.pageSize)}const b=Xe({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return n.value},get columnFilters(){return r.value},get columnVisibility(){return i.value},get rowSelection(){return h.value},get pagination(){return d.value}},enableRowSelection:!0,onSortingChange:w=>te(w,n),onPaginationChange:w=>m(w,d),onColumnFiltersChange:w=>te(w,r),onColumnVisibilityChange:w=>te(w,i),onRowSelectionChange:w=>te(w,h),getCoreRowModel:tt(),getFilteredRowModel:at(),getPaginationRowModel:st(),getSortedRowModel:lt(),getFacetedRowModel:nt(),getFacetedUniqueValues:ot()});return ut(()=>{b.setPageIndex(a.page_index),b.setPageSize(a.page_size)}),(w,z)=>(u(),v("div",xa,[t(wa,{table:s(b)},null,8,["table"]),c("div",$a,[t(s(et),{class:"text-xs"},{default:o(()=>[t(s(Ze),null,{default:o(()=>[(u(!0),v(P,null,A(s(b).getHeaderGroups(),C=>(u(),x(s(ve),{key:C.id},{default:o(()=>[(u(!0),v(P,null,A(C.headers,S=>(u(),x(s(it),{key:S.id},{default:o(()=>[S.isPlaceholder?U("",!0):(u(),x(s(Ve),{key:0,render:S.column.columnDef.header,props:S.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),t(s(Je),{id:"dbTableBody"},{default:o(()=>{var C;return[(C=s(b).getRowModel().rows)!=null&&C.length?(u(!0),v(P,{key:0},A(s(b).getRowModel().rows,S=>(u(),x(s(ve),{key:S.id,"data-state":S.getIsSelected()&&"selected"},{default:o(()=>[(u(!0),v(P,null,A(S.getVisibleCells(),V=>(u(),x(s(Ce),{key:V.id},{default:o(()=>[t(s(Ve),{render:V.column.columnDef.cell,props:V.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),x(s(ve),{key:1},{default:o(()=>[t(s(Ce),{colspan:w.columns.length,class:"h-24 text-center"},{default:o(()=>[p(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),t(Bt,{table:s(b)},null,8,["table"])]))}}),ka={class:"grid grid-cols-4 mb-2 gap-4"},Ca={class:"text-2xl font-bold"},Va={class:"text-2xl font-bold"},Da={class:"text-2xl font-bold"},Ia={class:"text-2xl font-bold"},Fa=R({__name:"CustomerDetailCard",props:{customer_id:{}},setup(e){const a=e,l=B({all_time_revenue:0,outstanding_debt_amount:0,overdue_amount:"0.00",total_invoices:"0.00"}),n=`/api/customer/${a.customer_id}/debt/card`,r=async()=>{try{const i=await L.get(n);Object.assign(l,i.data.Result)}catch(i){console.log(i)}};return xe(()=>{r()}),(i,d)=>(u(),v("div",null,[c("div",ka,[c("div",null,[t(s(ne),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("All Time Revenue")]),_:1})]),_:1}),t(s(le),null,{default:o(()=>[c("div",Ca,[c("h1",null,"RM "+g(l.all_time_revenue),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Outstanding Debt Amount")]),_:1})]),_:1}),t(s(le),null,{default:o(()=>[c("div",Va,[c("h1",null,"RM "+g(l.outstanding_debt_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Overdue Amount")]),_:1})]),_:1}),t(s(le),null,{default:o(()=>[c("div",Da,[c("h1",null,"RM "+g(l.overdue_amount),1)])]),_:1})]),_:1})]),c("div",null,[t(s(ne),null,{default:o(()=>[t(s(ae),null,{default:o(()=>[t(s(se),null,{default:o(()=>[p("Total Invoices")]),_:1})]),_:1}),t(s(le),null,{default:o(()=>[c("div",Ia,[c("h1",null,g(l.total_invoices),1)])]),_:1})]),_:1})])])]))}}),Ra={class:"p-4 bg-secondary"},Ma={class:"text-3xl font-bold tracking-tight mt-2 mb-4"},Pa={class:"flex justify-items-center place-items-center items-center"},za={class:"text-muted-foreground ml-2 place-self-center"},Ta={class:"flex justify-items-center place-items-center items-center"},Ua={class:"text-muted-foreground ml-2 place-self-center"},ja={class:"flex justify-items-center place-items-center items-center"},Aa={class:"text-muted-foreground ml-2 place-self-center"},Ha=R({__name:"CustomerDetailInfo",props:{customer_id:{}},setup(e){const a=e,l=B({name:"",whatsapp_phone_number:"",streetAddress:"",city:"",state:"",postcode:"",country_name:""}),n=`/api/customer/${a.customer_id}/`,r=async()=>{try{const d=await L.get(n);Object.assign(l,d.data.Result)}catch(d){console.log(d)}};var i=G(()=>{const h=[l.streetAddress,l.city,l.state,l.postcode].filter(m=>m);return h.length?h.join(", "):""});return xe(()=>{r()}),(d,h)=>{const m=E("VIcon");return u(),v("div",Ra,[c("h2",Ma,g(l.name),1),c("div",Pa,[t(m,{name:"fa-phone-alt",class:"w-4 h-4"}),c("p",za,g(l.whatsapp_phone_number.replace(/(\d{3})(\d{4})(\d{4})/,"$1 $2 $3")),1)]),c("div",Ta,[t(m,{name:"fa-address-book",class:"w-4 h-4"}),c("p",Ua,g(s(i)),1)]),c("div",ja,[t(m,{name:"fa-map-pin",class:"w-4 h-4"}),c("p",Aa,g(l.country_name),1)])])}}}),K=R({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(e){return(a,l)=>{const n=E("VIcon");return a.column.getCanSort()?(u(),v("div",{key:0,class:W(s(me)("flex items-center space-x-2",a.$attrs.class??""))},[t(s(je),null,{default:o(()=>[t(s(Te),{"as-child":""},{default:o(()=>[t(s(k),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[c("span",null,g(a.title),1),a.column.getIsSorted()==="desc"?(u(),x(n,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):a.column.getIsSorted()==="asc"?(u(),x(n,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(u(),x(n,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),t(s(Ue),{align:"start"},{default:o(()=>[t(s(he),{onClick:l[0]||(l[0]=r=>a.column.toggleSorting(!1))},{default:o(()=>[t(n,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Asc ")]),_:1}),t(s(he),{onClick:l[1]||(l[1]=r=>a.column.toggleSorting(!0))},{default:o(()=>[t(n,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Desc ")]),_:1}),t(s(Me)),t(s(he),{onClick:l[2]||(l[2]=r=>a.column.toggleVisibility(!1))},{default:o(()=>[t(n,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(u(),v("div",{key:1,class:W(a.$attrs.class)},g(a.title),3))}}}),La=T.object({id:T.number(),invoice:T.string(),invoice_date:T.preprocess(e=>typeof e=="string"?new Date(e):e,T.date()),due_date:T.preprocess(e=>typeof e=="string"?new Date(e):e,T.date()),term:T.number(),overdue:T.number(),amount:T.string(),document_url:T.string(),status:T.number(),editable:T.boolean()}),Ea={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},Na={class:"col-span-3"},Oa=c("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[p(" Accepted Type: "),c("b",null,"PDF"),p(" (MAX. 5MB) ")],-1),Ba={key:1},qa={class:"flex justify-center my-auto items-center place-items-center mb-2"},Ka={class:"mx-2"},Wa={class:"flex justify-center my-auto items-center place-items-center"},Ya=["src"],Ga={key:0,class:"grid grid-cols-4 items-center gap-4"},Qa=R({__name:"DataTableCheckAttachment",props:{row:{}},setup(e){const a=we("tableStore",fe("debt")),l=e,n=B({document:null,document_url:l.row.document_url}),r=B({pdf:void 0,pages:void 0,info:void 0}),i=I(1),d=I(!1),h=I(!1),m=I(null),b=I(window.innerHeight-250),{toast:w}=$e();function z(M){w({title:"PDF loading error",variant:"destructive"})}async function C(){try{d.value=!0;const M=await L.get(`/api/debt/${l.row.id}/document/`);n.document_url=M.data.Result.document_url;const f=It(n.document_url,{onError:z});mt(()=>{r.pdf=f.pdf,r.pages=f.pages,r.info=f.info})}catch{N(),w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}const S=()=>{const M=document.querySelector("#vp > div > div > div > canvas");if(M){const f=M.offsetHeight,_=window.innerHeight-250,$=680;_>f&&f<$?b.value=f:_>f?b.value=_:b.value=Math.min(Math.max(f,$),_)}};function V(){const M=[{condition:n.document==null,message:"Attachment cannot be blank"}];for(let f of M)if(f.condition)return m.value=f.message,!1;return!0}async function H(){if(V()){d.value=!0;try{const f=await L.patch(`/api/debt/${l.row.id}/document/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});F(),await a.refresh(a.page_index),w({title:f.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}}function N(){n.document_url=null}function F(){h.value=!h.value,h.value&&C()}function q(M){var _;const f=M.target;if((_=f.files)!=null&&_.length){const $=f.files[0];if($.type!=="application/pdf"){w({title:"Please select a PDF file",variant:"destructive"}),f.value="";return}if($.size>5*1024*1024){w({title:"The file size must be under 5MB",variant:"destructive"}),f.value="";return}n.document=$}}return(M,f)=>{const _=E("VIcon");return u(),v("div",null,[c("div",null,[t(s(k),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:F},{default:o(()=>[t(_,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),t(s(Ne),{class:"my-2",open:h.value,"onUpdate:open":f[2]||(f[2]=$=>h.value=$)},{default:o(()=>[t(s(Ae),{isSideBar:!1,class:"sm:max-w-fit"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Le),null,{default:o(()=>[p("Attachment Overview")]),_:1})]),_:1}),c("div",null,[n.document_url?n.document_url.endsWith(".pdf")?(u(),v("div",Ba,[c("div",qa,[t(s(k),{variant:"secondary",onClick:f[0]||(f[0]=$=>i.value=i.value>1?i.value-1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),c("span",Ka,g(i.value)+" / "+g(r.pages),1),t(s(k),{variant:"secondary",onClick:f[1]||(f[1]=$=>i.value=i.value<r.pages?i.value+1:i.value)},{default:o(()=>[t(_,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),t(s(Ee),{class:"border border-primary",style:ft([{width:"720px","overflow-y":"auto","overflow-x":"hidden"},{height:b.value+"px"}])},{default:o(()=>[t(s(Dt),{pdf:r.pdf,page:i.value,"fit-parent":"",onLoaded:S,"annonation-layer":""},{default:o(()=>[c("div",Wa,[t(_,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(u(),v("img",{key:2,src:n.document_url,alt:"Document preview",class:"object-contain"},null,8,Ya)):(u(),v("div",Ea,[t(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Attachment ")]),_:1}),c("div",Na,[t(s(Y),{id:"name",type:"file",onChange:q,class:"col-span-3"})]),Oa]))]),t(s(ee)),m.value?(u(),v("div",Ga,[t(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(m.value),1)]),_:1})])):U("",!0),t(s(Oe),{class:"flex justify-end"},{default:o(()=>[n.document_url?(u(),x(s(k),{key:0,class:"bg-red-600 text-white",onClick:N,disabled:d.value},{default:o(()=>[p(" Replace")]),_:1},8,["disabled"])):(u(),x(s(k),{key:1,onClick:H,disabled:d.value},{default:o(()=>[d.value?(u(),x(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):U("",!0),p(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Xa={class:"grid gap-4 py-4"},Za={class:"grid grid-cols-4 items-center gap-4"},Ja=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),es={class:"grid grid-cols-4 items-center gap-4"},ts=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),as={class:"col-span-3"},ss={class:"grid grid-cols-4 items-center gap-4"},ls=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ns={class:"grid grid-cols-4 items-center gap-4"},os=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),is={class:"col-span-3"},rs={class:"grid grid-cols-4 items-center gap-4"},cs=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ds={class:"grid grid-cols-4 items-center gap-4"},us={class:"col-span-3"},fs={key:0,class:"grid grid-cols-4 items-center gap-4"},ms=R({__name:"DataTableEditModal",props:{row:{}},setup(e){const a=we("tableStore",fe("debt")),l=e,n=B({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),r=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),i=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=I("");async function h(f){r.is_loading=!0;try{const _=await L.get(`/api/customer/list?search=${f||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{r.is_loading=!1}}async function m(){r.is_loading=!0;try{const f=await L.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=f.data.Result}catch(f){console.error("There was an error fetching the select list:",f)}finally{i.is_loading=!1}}const b=I(!1),w=I(!1),z=I(null),{toast:C}=$e();_t(d,Vt.debounce(async f=>{w.value&&await h(f)},500));async function S(){try{const f=await L.get(`/api/debt/${l.row.id}/`);Object.assign(n,f.data.Result)}catch(f){console.log(f)}finally{b.value=!1}}function V(){var _;const f=[{condition:n.invoice==null,message:"Invoice cannot be blank"},{condition:((_=n.invoice_date)==null?void 0:_.toString)==null,message:"Invoice Date cannot be blank"},{condition:n.status==null,message:"Status cannot be blank"},{condition:n.customer==null,message:"Customer cannot be blank"}];for(let $ of f)if($.condition)return z.value=$.message,!1;return!0}async function H(){if(V()){b.value=!0;try{const _=await L.patch(`/api/debt/${l.row.id}/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});N(),await a.refresh(a.page_index),C({title:_.data.Result,variant:"success"})}catch{C({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{b.value=!1}}}function N(){w.value=!w.value,w.value&&(S(),h(d.value),m())}function F(f){n.customer=f.id,r.is_open=!1}function q(f){n.status=f.id,i.is_open=!1}function M(f){const _=new Date(f);n.invoice_date=Rt(_,"yyyy-MM-dd")}return(f,_)=>{const $=E("VIcon");return u(),v("div",null,[c("div",null,[t(s(k),{variant:"default",size:"sm",class:"hidden h-8 lg:flex",onClick:N},{default:o(()=>[t($,{name:"fa-pen",class:"size-4"})]),_:1})]),t(s(Ne),{open:w.value,"onUpdate:open":_[7]||(_[7]=y=>w.value=y)},{default:o(()=>[t(s(Ae),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[t(s(He),null,{default:o(()=>[t(s(Le),null,{default:o(()=>[p("Edit Debt")]),_:1}),t(s(pt),null,{default:o(()=>[p(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),c("div",Xa,[c("div",Za,[t(s(O),{for:"invoice",class:"text-right"},{default:o(()=>[p(" Invoice "),Ja]),_:1}),t(s(Y),{id:"invoice",modelValue:n.invoice,"onUpdate:modelValue":_[0]||(_[0]=y=>n.invoice=y),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),c("div",es,[t(s(O),{for:"customer",class:"text-right leading-normal"},{default:o(()=>[p(" Customer "),ts]),_:1}),c("div",as,[t(s(re),{open:r.is_open,"onUpdate:open":_[2]||(_[2]=y=>r.is_open=y)},{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(k),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:o(()=>{var y;return[p(g(n.customer?(y=r.data.find(ge=>ge.id===n.customer))==null?void 0:y.label:"Select customer")+" ",1),r.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[t(s(be),null,{default:o(()=>[t(s(Pe),{class:"h-9",modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=y=>d.value=y),placeholder:"Search country..."},null,8,["modelValue"]),t(s(ze),null,{default:o(()=>[p("No customer found.")]),_:1}),t(s(ye),null,{default:o(()=>[t(s(de),null,{default:o(()=>[(u(!0),v(P,null,A(r.data,y=>(u(),x(s(ue),{key:y.id,value:y.value??"",onSelect:()=>F(y)},{default:o(()=>[p(g(y.label)+" ",1),t($,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.customer===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),c("div",ss,[t(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Amount "),ls]),_:1}),t(s(Y),{id:"amount",modelValue:n.amount===null?"":n.amount,"onUpdate:modelValue":_[3]||(_[3]=y=>n.amount=y===""?null:y),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),c("div",ns,[t(s(O),{for:"email",class:"text-right"},{default:o(()=>[p(" Invoice Date "),os]),_:1}),c("div",is,[t(s(re),null,{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(k),{variant:"outline",class:W(s(me)("w-full justify-start text-left font-normal",!n.invoice_date&&"text-muted-foreground"))},{default:o(()=>[t($,{name:"bi-calendar-fill",class:"mr-2 size-4"}),c("span",null,g(n.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),t(s(ie),{class:"w-auto p-0"},{default:o(()=>[t(s(Ft),{"onUpdate:modelValue":_[4]||(_[4]=y=>M(y)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),c("div",rs,[t(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Payment Term "),cs]),_:1}),t(s(Y),{id:"amount",modelValue:n.term,"onUpdate:modelValue":_[5]||(_[5]=y=>n.term=y),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),c("div",ds,[t(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Status ")]),_:1}),c("div",us,[t(s(re),{open:i.is_open,"onUpdate:open":_[6]||(_[6]=y=>i.is_open=y)},{default:o(()=>[t(s(oe),{"as-child":""},{default:o(()=>[t(s(k),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:o(()=>{var y;return[p(g(n.status?(y=i.data.find(ge=>ge.id===n.status))==null?void 0:y.label:"Select status")+" ",1),i.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),t(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[t(s(be),null,{default:o(()=>[t(s(ye),null,{default:o(()=>[t(s(de),null,{default:o(()=>[(u(!0),v(P,null,A(i.data,y=>(u(),x(s(ue),{key:y.id,value:y.value??"",onSelect:()=>q(y)},{default:o(()=>[p(g(y.label)+" ",1),t($,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.status===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),t(ee),z.value?(u(),v("div",fs,[t(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[t($,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(z.value),1)]),_:1})])):U("",!0),t(s(Oe),{class:"flex justify-end"},{default:o(()=>[t(s(k),{type:"submit",onClick:H,disabled:b.value},{default:o(()=>[b.value?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):U("",!0),p(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),_s={class:"pr-4"},ps={class:"flex justify-between mt-2"},gs={key:0,class:"text-primary font-bold flex place-items-center self-center"},vs={key:1,class:"text-primary font-bold"},hs={class:"text-primary"},bs={class:"text-sm"},ys={class:"text-xs mt-2"},ws=R({__name:"DataTableBacklog",props:{row:{}},setup(e){const a=gt(),l=e,n=B({debt:l.row.id,message:""}),r=B([]),i=I(!1),d=I(!1),h=I(null),{toast:m}=$e();async function b(){try{const S=await L.get(`/api/debt/${l.row.id}/backlog/`);r.splice(0,r.length,...S.data.Result),i.value=!1}catch{i.value=!1}}function w(){const S=[{condition:n.message=="",message:"Message cannot be blank"},{condition:n.message.length<5,message:"Maybe a little more context?"}];for(let V of S)if(V.condition)return h.value=V.message,!1;return!0}async function z(){if(w()){i.value=!0;try{const V=await L.post(`/api/debt/${l.row.id}/backlog/`,{...n},{headers:{"Content-Type":"application/json"}});await b(),m({title:V.data.Result,variant:"success"}),n.message="",h.value=""}catch{m({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{i.value=!1}}}function C(){d.value=!d.value,d.value&&b()}return(S,V)=>{const H=E("VIcon"),N=E("Label");return u(),v("div",null,[c("div",null,[t(s(k),{variant:"secondary",size:"sm",class:"hidden h-8 lg:flex border border-primary",onClick:C},{default:o(()=>[t(H,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),t(s(St),{open:d.value,"onUpdate:open":V[1]||(V[1]=F=>d.value=F)},{default:o(()=>[t(s(wt),{class:"w-[720px]",side:"right"},{default:o(()=>[t(s(xt),null,{default:o(()=>[t(s($t),null,{default:o(()=>[p("Backlog - "+g(l.row.invoice),1)]),_:1})]),_:1}),t(s(ee),{class:"mt-2 mb-4"}),t(s(Ee),{class:"h-[80vh] flex flex-col"},{default:o(()=>[c("div",_s,[(u(!0),v(P,null,A(r,(F,q)=>(u(),v("div",{key:q,class:"ml-2 pr-4"},[c("div",ps,[F.is_system_generated?(u(),v("div",gs,[t(H,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),p(" System Generated ")])):(u(),v("div",vs,g(F.created_by_name),1))]),c("div",null,[c("div",hs,g(F.created_date),1),t(s(ee),{variant:"default"}),c("div",null,g(F.message),1)])]))),128))])]),_:1}),h.value?(u(),x(N,{key:0,for:"error",class:"text-red-600 flex"},{default:o(()=>[t(H,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c("p",bs,g(h.value),1)]),_:1})):U("",!0),t(s(Mt),{class:"mt-2 justify-between"},{default:o(()=>[t(s(Y),{id:"message",modelValue:n.message,"onUpdate:modelValue":V[0]||(V[0]=F=>n.message=F),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),t(s(k),{type:"submit",onClick:z},{default:o(()=>[p(" Save ")]),_:1})]),_:1}),c("p",ys,g(s(a).getUsername),1)]),_:1})]),_:1},8,["open"])])}}}),xs={class:"flex gap-1"},$s=R({__name:"DataTableRowActions",props:{row:{}},setup(e){const a=e,l=G(()=>La.parse(a.row.original));return(n,r)=>(u(),v("div",xs,[l.value.editable?(u(),x(ms,{key:0,row:l.value},null,8,["row"])):U("",!0),t(Qa,{row:l.value},null,8,["row"]),t(ws,{row:l.value},null,8,["row"])]))}}),Ss=[{id:"select",header:({table:e})=>D(De,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":a=>e.toggleAllPageRowsSelected(!!a),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:e})=>D(De,{checked:e.getIsSelected(),"onUpdate:checked":a=>e.toggleSelected(!!a),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:e})=>D(K,{column:e,title:"Invoice"}),cell:({row:e})=>D("div",{class:`w-20 font-bold ${e.original.editable?"":"line-through decoration-red-600"}`},e.getValue("invoice")),enableSorting:!0,enableHiding:!0,filterFn:(e,a,l)=>{var i;const n=((i=e.getValue(a))==null?void 0:i.toString().toLowerCase())??"",r=l==null?void 0:l.toString().toLowerCase();return n.includes(r)},meta:{title:"Invoice"}},{accessorKey:"invoice_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const a=e.getValue("invoice_date");let l="";if(a){const n=new Date(Date.parse(a));isNaN(n.getTime())?l="Not Provided":l=n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const a=e.getValue("due_date");let l="";if(a){const n=new Date(a);isNaN(n.getTime())?l="Not Provided":l=n.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"overdue",header:({column:e})=>D(K,{column:e,title:"Overdue"}),cell:({row:e})=>{const a=e.getValue("overdue");let l;return a==1?l="1 day":a>0?l=`${a} day(s)`:a===0?l="0 day":l="No overdue",D("div",{class:"w-fit text-red-600 font-bold"},l)},enableHiding:!0,meta:{title:"Overdue"}},{accessorKey:"amount",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>D(Z,{variant:"destructive"},"RM "+e.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:e})=>D(K,{column:e,title:"Attachment"}),cell:({row:e})=>{const a=e.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return D(Ie,{name:a.icon,class:`${a.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:e})=>D(K,{column:e,title:"Status"}),cell:({row:e})=>{const a=Se.find(l=>l.value===e.original.status.toString());return a?D(Z,{variant:"secondary",class:"flex w-fit items-center"},[a.icon&&D(Ie,{name:a.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),D("span",{},a.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(e,a,l)=>{const n=e.getValue(a);if(!n)return!1;const r=n.toString().toLowerCase();return l.some(d=>r.includes(d.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:e})=>D($s,{row:e})}],ks={class:"md:hidden"},Cs={class:"hidden h-full flex-1 flex-col space-y-8 p-8 md:flex"},Vs=c("div",{class:"mb-4"},[c("h2",{class:"text-2xl font-bold tracking-tight"},"Statement")],-1),Es=R({__name:"CustomerDetail",setup(e){const l=ht().params.customer_id,n=fe("debt"),r=`/api/customer/${l}/debt`,i=d=>({id:d.id,status:d.status,invoice:d.invoice,invoice_date:new Date(d.invoice_date),due_date:new Date(d.due_date),overdue:d.overdue,amount:d.amount,term:d.term,document_url:d.document_url,editable:d.editable});return xe(async()=>{await n.fetch(r,0,i)}),bt("tableStore",n),vt(()=>{n.$reset()}),(d,h)=>{const m=E("VPImage");return u(),v(P,null,[c("div",ks,[t(m,{alt:"Tasks",width:"1280",height:"1214",class:"block",image:{dark:"/examples/tasks-dark.png",light:"/examples/tasks-light.png"}},null,8,["image"])]),c("div",Cs,[t(Ha,{customer_id:s(l)},null,8,["customer_id"]),t(Fa,{customer_id:s(l)},null,8,["customer_id"]),c("div",null,[Vs,t(Sa,{data:s(n).tasks,columns:s(Ss)},null,8,["data","columns"])])])],64)}}});export{Es as default};
