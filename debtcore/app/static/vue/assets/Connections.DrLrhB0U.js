import{_ as p,a as d,b as m}from"./CardDescription.vue_vue_type_script_setup_true_lang.nuAmEoIx.js";import{_ as b}from"./CardTitle.vue_vue_type_script_setup_true_lang.CooFW0om.js";import{_ as w}from"./CardContent.vue_vue_type_script_setup_true_lang.D46BGtUZ.js";import{e as _,o as c,c as C,f as B,n as W,u as t,g as T,az as S,H as y,I as v,G as $,a1 as V,r as z,l as r,k as s,d as n,a,b as o,Y as g,s as k,i as I,aA as N}from"../main.js";import{_ as x}from"./index.DhdF1qMN.js";const D=_({__name:"CardFooter",props:{class:{}},setup(u){const e=u;return(i,l)=>(c(),C("div",{class:W(t(T)("flex items-center p-6 pt-0",e.class))},[B(i.$slots,"default")],2))}}),E=u=>S(u,{state:()=>({is_authenticated:!1,authenticate_url:"",url:"",link:"",is_loading:!1}),actions:{async init(e){this.url=e,this.is_loading=!0;try{const i=await y.get(e,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=i.data.Result.is_authenticated,this.authenticate_url=i.data.Result.authenticate_url}catch(i){console.log("this was an error initializing the connection",i)}finally{this.is_loading=!1}},async disconnect(){this.is_loading=!0;try{const e=await y.put(this.url,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});this.is_authenticated=!1}catch(e){console.log("There was an error disconnecting the connection",e)}finally{this.is_loading=!1}}}})(),F={class:"flex flex-col md:flex-row border-t-4 border-green-600/80 rounded"},P={class:"flex items-stretch"},R=n("b",null,"'Connect to WhatsApp'",-1),Y=n("b",null,"'Disconnect from WhatsApp'",-1),j=n("b",null,"'Authenticate'",-1),q=n("a",{href:"https://metastatus.com/whatsapp-business-api",class:"text-blue-600 underline"},"Status",-1),H=["href"],M=_({__name:"Whatsapp",setup(u){const e=E("whatsapp"),{toast:i}=v();$(()=>{e.init("/api/connections/facebook")});const l=()=>{e.disconnect(),i({title:"Whatsapp disconnected successfully!",variant:"success"})};return V(()=>{e.$reset()}),(A,h)=>{const f=z("VIcon");return t(e).is_loading?(c(),r(t(m),{key:1},{default:s(()=>[a(f,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})]),_:1})):(c(),r(t(m),{key:0,class:"shadow-none"},{default:s(()=>[n("div",F,[a(t(p),null,{default:s(()=>[a(t(b),null,{default:s(()=>[a(f,{name:"fa-whatsapp",class:"size-24 fill-green-500"})]),_:1})]),_:1}),a(t(p),{class:"flex-1"},{default:s(()=>[a(t(w),{class:"py-2 pl-0"},{default:s(()=>[n("div",P,[a(t(b),null,{default:s(()=>[o("WhatsApp Business")]),_:1}),t(e).is_authenticated?(c(),r(t(x),{key:0,class:"ml-3",variant:"success"},{default:s(()=>[o(" Connected")]),_:1})):(c(),r(t(x),{key:1,class:"ml-3",variant:"destructive"},{default:s(()=>[o(" Not Connected")]),_:1}))])]),_:1}),a(t(g),{class:"w-full"}),a(t(w),{class:"py-1 pl-0"},{default:s(()=>[n("div",null,[a(t(d),null,{default:s(()=>[o("To connect to WhatsApp Business, click the "),R,o(" button. You will be taken to the Meta Business website to allow DebtCore to connect to your Organisation.")]),_:1}),a(t(d),null,{default:s(()=>[o("To disconnect from WhatsApp Business, click the "),Y,o(" button. This button will only be displayed when a connection has been established.")]),_:1}),a(t(d),{class:"mt-4"},{default:s(()=>[o("When the connection requires authentication, click the "),j,o(" button. You will be taken to Facebook to re-establish connection to your Organisation.")]),_:1}),a(t(d),{class:"mt-8"},{default:s(()=>[o("Whatsapp Business API "),q,o(".")]),_:1})])]),_:1})]),_:1})]),a(t(g),{class:"w-full"}),a(t(D),{class:"flex items-end justify-end mt-5"},{default:s(()=>[t(e).is_authenticated?(c(),r(t(k),{key:1,variant:"destructive",onClick:h[0]||(h[0]=()=>l())},{default:s(()=>[o(" Disconnect")]),_:1})):(c(),r(t(k),{key:0,variant:"default"},{default:s(()=>[n("a",{href:t(e).authenticate_url}," Connect to WhatsApp",8,H)]),_:1}))]),_:1})]),_:1}))}}}),O={class:"p-4 md:p-8 space-y-8"},U=n("div",{class:"flex items-center justify-between space-y-2"},[n("div",null,[n("h2",{class:"text-2xl font-bold tracking-tight"},"Connections"),n("p",{class:"text-muted-foreground"},"Here's a list of your connected apps!")])],-1),X=_({__name:"Connections",setup(u){const e=N();I("Unknown");const{toast:i}=v();return $(()=>{const l=e.query.error;l&&i({title:"Authentication Failed!",description:l,variant:"destructive"})}),(l,A)=>(c(),C("div",O,[U,n("div",null,[a(M)])]))}});export{X as default};
