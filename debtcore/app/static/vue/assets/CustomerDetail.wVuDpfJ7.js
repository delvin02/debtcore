import{_ as Ke,a as We,b as Ye,c as Ge,d as Qe,e as Me,u as fe,f as Xe,g as Ze,h as Je,i as Ce,j as he,k as et,l as tt,m as at,n as st,o as lt,p as nt,q as ot,r as it,F as Ve,z as T,s as De}from"./Checkbox.vue_vue_type_script_setup_true_lang.5ojqHNh9.js";import{e as F,o as u,c as v,f as rt,n as W,u as s,g as _e,r as L,d as c,t as g,a,k as o,F as P,v as U,s as k,b as p,x as G,l as x,Y as ee,m as A,N as oe,a4 as ye,a5 as Pe,a8 as we,a6 as ze,a7 as de,a9 as ue,Q as ie,R as re,at as ct,y as Te,z as Ae,A as je,i as I,B as xe,C as dt,D as te,E as B,G as $e,H as E,T as be,I as Se,U as Ue,W as He,X as Ee,_ as O,ae as Le,ar as ut,Z as Ne,as as mt,K as ft,a3 as _t,j as pt,au as gt,av as vt,aw as ht,ax as bt,a0 as D,ay as Ie,a1 as yt,aA as wt,a2 as xt}from"../main.js";import{_ as Z}from"./index.DhdF1qMN.js";import{_ as $t}from"./CommandSeparator.vue_vue_type_script_setup_true_lang.DZgg3MH5.js";import{_ as St,a as kt}from"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang.DeeBgwnz.js";import{_ as Y}from"./Input.vue_vue_type_script_setup_true_lang.CSFnz65k.js";import{_ as ae,a as se,b as le}from"./CardDescription.vue_vue_type_script_setup_true_lang.nuAmEoIx.js";import{_ as ne}from"./CardContent.vue_vue_type_script_setup_true_lang.D46BGtUZ.js";import{_ as Oe}from"./DialogFooter.vue_vue_type_script_setup_true_lang.CUbi7heN.js";import{_ as Ct}from"./lodash.BtnTHUG3.js";import{l as Vt,A as Dt}from"./index.EdlJKn0d.js";import{_ as It}from"./CalendarPrevButton.vue_vue_type_script_setup_true_lang.DOcqctDd.js";import{f as Rt}from"./index.BccI3ZLR.js";import"./index.5qndC0qu.js";const Ft=F({__name:"SheetFooter",props:{class:{}},setup(e){const t=e;return(l,n)=>(u(),v("div",{class:W(s(_e)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",t.class))},[rt(l.$slots,"default")],2))}}),Mt={class:"flex flex-col items-center justify-between px-2 pb-10"},Pt={class:"flex-1 text-sm text-muted-foreground mb-4 md:mb-0"},zt={class:"flex items-center space-x-6 lg:space-x-8 text-primary"},Tt={class:"flex items-center space-x-2"},At=c("p",{class:"text-sm font-medium"},"Rows per page",-1),jt={class:"flex w-[100px] items-center justify-center text-sm font-medium"},Ut={class:"flex items-center space-x-2"},Ht=c("span",{class:"sr-only"},"Go to first page",-1),Et=c("span",{class:"sr-only"},"Go to previous page",-1),Lt=c("span",{class:"sr-only"},"Go to next page",-1),Nt=c("span",{class:"sr-only"},"Go to last page",-1),Ot=F({__name:"DataTablePagination",props:{table:{}},setup(e){return(t,l)=>{const n=L("VIcon");return u(),v("div",Mt,[c("div",Pt,g(t.table.getFilteredSelectedRowModel().rows.length)+" of "+g(t.table.getFilteredRowModel().rows.length)+" row(s) selected. ",1),c("div",zt,[c("div",Tt,[At,a(s(Ge),{"model-value":`${t.table.getState().pagination.pageSize}`,"onUpdate:modelValue":t.table.setPageSize},{default:o(()=>[a(s(Ke),{class:"h-8 w-[70px]"},{default:o(()=>[a(s(We),{placeholder:`${t.table.getState().pagination.pageSize}`},null,8,["placeholder"])]),_:1}),a(s(Ye),{side:"top"},{default:o(()=>[(u(),v(P,null,U([10,20,30,40,50],r=>a(s(Qe),{key:r,value:`${r}`},{default:o(()=>[p(g(r),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),c("div",jt," Page "+g(t.table.getState().pagination.pageIndex+1)+" of "+g(t.table.getPageCount()),1),c("div",Ut,[a(s(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanPreviousPage(),onClick:l[0]||(l[0]=r=>t.table.setPageIndex(0))},{default:o(()=>[Ht,a(n,{name:"fa-arrow-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(s(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanPreviousPage(),onClick:l[1]||(l[1]=r=>t.table.previousPage())},{default:o(()=>[Et,a(n,{name:"fa-chevron-left",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(s(k),{variant:"outline",class:"h-8 w-8 p-0",disabled:!t.table.getCanNextPage(),onClick:l[2]||(l[2]=r=>t.table.nextPage())},{default:o(()=>[Lt,a(n,{name:"fa-chevron-right",class:"h-4 w-4"})]),_:1},8,["disabled"]),a(s(k),{variant:"outline",class:"hidden h-8 w-8 p-0 lg:flex",disabled:!t.table.getCanNextPage(),onClick:l[3]||(l[3]=r=>t.table.setPageIndex(t.table.getPageCount()-1))},{default:o(()=>[Nt,a(n,{name:"fa-arrow-right",class:"h-4 w-4"})]),_:1},8,["disabled"])])])])}}}),me=[{value:"1",label:"In Progress",icon:"bi-stopwatch"},{value:"2",label:"Claimed",icon:"fa-check-circle"},{value:"3",label:"Canceled",icon:"fa-times-circle"}],Bt={class:"hidden space-x-1 lg:flex"},qt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},Kt=F({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(e){const t=e,l=G(()=>{var i;return(i=t.column)==null?void 0:i.getFacetedUniqueValues()}),n=G(()=>{var i;return new Set((i=t.column)==null?void 0:i.getFilterValue())}),r=i=>{var f;n.value.has(i)?n.value.delete(i):n.value.add(i);const h=Array.from(n.value);(f=t.column)==null||f.setFilterValue(h.length?h:void 0)};return(i,d)=>{const h=L("VIcon");return u(),x(s(re),null,{default:o(()=>[a(s(oe),{"as-child":""},{default:o(()=>[a(s(k),{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:o(()=>[a(h,{name:"fa-plus-circle",class:"mr-2 h-4 w-4"}),p(" "+g(i.title)+" ",1),n.value.size>0?(u(),v(P,{key:0},[a(s(ee),{orientation:"vertical",class:"mx-2 h-4"}),a(s(Z),{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:o(()=>[p(g(n.value.size),1)]),_:1}),c("div",Bt,[n.value.size>2?(u(),x(s(Z),{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(n.value.size)+" selected ",1)]),_:1})):(u(!0),v(P,{key:1},U(i.options.filter(f=>n.value.has(f.value)),f=>(u(),x(s(Z),{key:f.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:o(()=>[p(g(f.label),1)]),_:2},1024))),128))])],64)):A("",!0)]),_:1})]),_:1}),a(s(ie),{class:"w-[200px] p-0",align:"start"},{default:o(()=>[a(s(ye),null,{default:o(()=>[a(s(Pe),{placeholder:i.title},null,8,["placeholder"]),a(s(we),null,{default:o(()=>[a(s(ze),null,{default:o(()=>[p("No results found.")]),_:1}),a(s(de),null,{default:o(()=>[(u(!0),v(P,null,U(i.options,f=>(u(),x(s(ue),{key:f.value,value:f,onSelect:()=>r(f.value)},{default:o(()=>{var b;return[c("div",{class:W(s(_e)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",n.value.has(f.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[a(h,{name:"fa-check",class:"h-4 w-4"})],2),f.icon?(u(),x(ct(f.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):A("",!0),c("span",null,g(f.label),1),(b=l.value)!=null&&b.get(f.value)?(u(),v("span",qt,g(l.value.get(f.value)),1)):A("",!0)]}),_:2},1032,["value","onSelect"]))),128))]),_:1}),n.value.size>0?(u(),v(P,{key:0},[a(s($t)),a(s(de),null,{default:o(()=>[a(s(ue),{value:{label:"Clear filters"},class:"justify-center text-center",onSelect:d[0]||(d[0]=()=>{var f;return(f=t.column)==null?void 0:f.setFilterValue(void 0)})},{default:o(()=>[p(" Clear filters ")]),_:1})]),_:1})],64)):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Wt=F({__name:"DataTableViewOptions",props:{table:{}},setup(e){const t=e,l=G(()=>t.table.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()));return(n,r)=>(u(),x(s(je),null,{default:o(()=>[a(s(Te),{"as-child":""},{default:o(()=>[a(s(k),{variant:"outline",size:"sm",class:"ml-auto hidden h-8 lg:flex"},{default:o(()=>[p(" View ")]),_:1})]),_:1}),a(s(Ae),{align:"end",class:"w-[150px]"},{default:o(()=>[a(s(St),null,{default:o(()=>[p("Toggle columns")]),_:1}),a(s(Me)),(u(!0),v(P,null,U(l.value,i=>(u(),x(s(kt),{key:i.id,class:"capitalize",checked:i.getIsVisible(),"onUpdate:checked":d=>i.toggleVisibility(!!d)},{default:o(()=>{var d;return[p(g(((d=i.columnDef.meta)==null?void 0:d.title)||i.id),1)]}),_:2},1032,["checked","onUpdate:checked"]))),128))]),_:1})]),_:1}))}});var Yt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Gt=`\r
`,Qt="\uFEFF",pe=e=>Object.assign({},Yt,e);class Xt extends Error{constructor(t){super(t),this.name="CsvGenerationError"}}class Zt extends Error{constructor(t){super(t),this.name="EmptyHeadersError"}}class Jt extends Error{constructor(t){super(t),this.name="CsvDownloadEnvironmentError"}}class ea extends Error{constructor(t){super(t),this.name="UnsupportedDataFormatError"}}var X=e=>e,j=e=>e,J=X,ge=X,Q=X,Re=X,Fe=X,ta=function(e,t){return t=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},aa=e=>Re(typeof e=="object"?e.key:e),sa=e=>Fe(typeof e=="object"?e.displayLabel:e),la=(e,...t)=>t.reduce((l,n)=>n(l),e),na=e=>t=>e.useBom?ge(j(t)+Qt):t,oa=e=>t=>e.showTitle?ke(ge(j(t)+e.title))(Q("")):t,ke=e=>t=>ge(j(e)+j(t)+Gt),Be=e=>(t,l)=>ia(e)(Q(j(t)+j(l))),ia=e=>t=>X(j(t)+e.fieldSeparator),ra=(e,t)=>l=>{if(!e.showColumnHeaders)return l;if(t.length<1)throw new Zt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let n=Q("");for(let r=0;r<t.length;r++){const i=sa(t[r]);n=Be(e)(n,qe(e,j(i)))}return n=Q(j(n).slice(0,-1)),ke(l)(n)},ca=(e,t,l)=>n=>{let r=n;for(var i=0;i<l.length;i++){let d=Q("");for(let h=0;h<t.length;h++){const f=aa(t[h]),b=l[i][j(f)];d=Be(e)(d,qe(e,b))}d=Q(j(d).slice(0,-1)),r=ke(r)(d)}return r},da=e=>+e===e&&(!isFinite(e)||!!(e%1)),ua=(e,t)=>{if(da(t)){if(e.decimalSeparator==="locale")return J(t.toLocaleString());if(e.decimalSeparator)return J(t.toString().replace(".",e.decimalSeparator))}return J(t.toString())},ce=(e,t)=>{let l=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf(`
`)>-1||t.indexOf("\r")>-1)&&(l=e.quoteCharacter+ta(t,e.quoteCharacter)+e.quoteCharacter),J(l)},ma=(e,t)=>{const l=t?"true":"false";return J(e.boolDisplay[l])},fa=(e,t)=>typeof t>"u"&&e.replaceUndefinedWith!==void 0?ce(e,e.replaceUndefinedWith+""):t===null?ce(e,"null"):ce(e,""),qe=(e,t)=>{if(typeof t=="number")return ua(e,t);if(typeof t=="string")return ce(e,t);if(typeof t=="boolean"&&e.boolDisplay)return ma(e,t);if(t===null||typeof t>"u")return fa(e,t);throw new ea(`
    typeof ${typeof t} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},_a=e=>t=>{const l=pe(e),n=l.useKeysAsHeaders?Object.keys(t[0]):l.columnHeaders;let r=la(ge(""),na(l),oa(l),ra(l,n),ca(l,n,t));if(j(r).length<1)throw new Xt("Output is empty. Is your data formatted correctly?");return r},pa=e=>t=>{const l=pe(e),n=j(t),r=l.useTextFile?"plain":"csv";return new Blob([n],{type:`text/${r};charset=utf8;`})},ga=e=>t=>{if(!window)throw new Jt("Downloading only supported in a browser environment.");const l=pa(e)(t),n=pe(e),r=n.useTextFile?"txt":"csv",i=`${n.filename}.${r}`,d=document.createElement("a");d.download=i,d.href=URL.createObjectURL(l),d.setAttribute("visibility","hidden"),document.body.appendChild(d),d.click(),document.body.removeChild(d)};const va=F({__name:"DataTableExportReport",props:{table:{}},setup(e){const t=e,l=I(!1),n=pe({fieldSeparator:",",filename:"report",decimalSeparator:".",useKeysAsHeaders:!0}),r=d=>d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),i=()=>{l.value=!0;const h=t.table.getFilteredRowModel().rows.map(b=>{var R;const w=b.getValue("invoice"),z=r(b.getValue("invoice_date")),C=r(b.getValue("due_date")),S=b.getValue("overdue")+" day(s)",V="RM "+b.getValue("amount"),H=`=HYPERLINK("${window.location.origin}${b.getValue("document_url")}", "Click Link Here")`,N=(R=me.find(q=>q.value===b.original.status.toString()))==null?void 0:R.label;return{invoice:w,invoice_date:z,due_date:C,overdue:S,amount:V,attachment:H,status:N}}),f=_a(n)(h);ga(n)(f),l.value=!1};return(d,h)=>{const f=L("VIcon");return u(),v("div",null,[a(s(k),{variant:"secondary",size:"sm",class:"flex h-8 ml-2",onClick:i},{default:o(()=>[l.value?(u(),x(f,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-4"})):(u(),x(f,{key:1,name:"fa-download",class:"size-4"}))]),_:1})])}}}),ha={class:"flex items-center justify-between"},ba={class:"flex flex-1 items-center space-x-2"},ya=F({__name:"DataTableToolbar",props:{table:{}},setup(e){const t=e,l=G(()=>t.table.getState().columnFilters.length>0);return(n,r)=>{var i;return u(),v("div",ha,[c("div",ba,[a(s(Y),{placeholder:"Search...","model-value":((i=n.table.getColumn("invoice"))==null?void 0:i.getFilterValue())??"",class:"h-8 w-[150px] lg:w-[250px]",onInput:r[0]||(r[0]=d=>n.table.setGlobalFilter(d.target.value))},null,8,["model-value"]),n.table.getColumn("status")?(u(),x(Kt,{key:0,column:n.table.getColumn("status"),title:"Status",options:s(me)},null,8,["column","options"])):A("",!0),l.value?(u(),x(s(k),{key:1,variant:"ghost",class:"h-8 px-2 lg:px-3",onClick:r[1]||(r[1]=d=>n.table.resetColumnFilters())},{default:o(()=>[p(" Reset ")]),_:1})):A("",!0)]),a(Wt,{table:n.table},null,8,["table"]),a(va,{table:n.table},null,8,["table"])])}}}),wa={class:"space-y-4 text-muted-foreground"},xa={class:"rounded-md border"},$a=F({__name:"DataTable",props:{columns:{},data:{}},setup(e){const t=xe("tableStore",fe("debt")),l=e,n=I([]),r=I([]),i=I({}),d=I({pageIndex:t.page_index,pageSize:t.page_size}),h=I();function f(w,z){let C;typeof w=="function"?C=w(z.value):C=w,z.value=C,t.set_page_index(C.pageIndex),t.set_page_size(C.pageSize)}const b=Xe({get data(){return l.data},get columns(){return l.columns},state:{get sorting(){return n.value},get columnFilters(){return r.value},get columnVisibility(){return i.value},get rowSelection(){return h.value},get pagination(){return d.value}},enableRowSelection:!0,onSortingChange:w=>te(w,n),onPaginationChange:w=>f(w,d),onColumnFiltersChange:w=>te(w,r),onColumnVisibilityChange:w=>te(w,i),onRowSelectionChange:w=>te(w,h),getCoreRowModel:tt(),getFilteredRowModel:at(),getPaginationRowModel:st(),getSortedRowModel:lt(),getFacetedRowModel:nt(),getFacetedUniqueValues:ot()});return dt(()=>{b.setPageIndex(t.page_index),b.setPageSize(t.page_size)}),(w,z)=>(u(),v("div",wa,[a(ya,{table:s(b)},null,8,["table"]),c("div",xa,[a(s(et),{class:"text-xs"},{default:o(()=>[a(s(Ze),null,{default:o(()=>[(u(!0),v(P,null,U(s(b).getHeaderGroups(),C=>(u(),x(s(he),{key:C.id},{default:o(()=>[(u(!0),v(P,null,U(C.headers,S=>(u(),x(s(it),{key:S.id},{default:o(()=>[S.isPlaceholder?A("",!0):(u(),x(s(Ve),{key:0,render:S.column.columnDef.header,props:S.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),a(s(Je),{id:"dbTableBody"},{default:o(()=>{var C;return[(C=s(b).getRowModel().rows)!=null&&C.length?(u(!0),v(P,{key:0},U(s(b).getRowModel().rows,S=>(u(),x(s(he),{key:S.id,"data-state":S.getIsSelected()&&"selected"},{default:o(()=>[(u(!0),v(P,null,U(S.getVisibleCells(),V=>(u(),x(s(Ce),{key:V.id},{default:o(()=>[a(s(Ve),{render:V.column.columnDef.cell,props:V.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state"]))),128)):(u(),x(s(he),{key:1},{default:o(()=>[a(s(Ce),{colspan:w.columns.length,class:"h-24 text-center"},{default:o(()=>[p(" No results. ")]),_:1},8,["colspan"])]),_:1}))]}),_:1})]),_:1})]),a(Ot,{table:s(b)},null,8,["table"])]))}}),Sa={class:"grid grid-cols-2 md:grid-cols-4 mb-2 gap-4"},ka={class:"text-2xl font-bold"},Ca={class:"text-2xl font-bold"},Va={class:"text-2xl font-bold"},Da={class:"text-2xl font-bold"},Ia=F({__name:"CustomerDetailCard",props:{customer_id:{}},setup(e){const t=e,l=B({all_time_revenue:0,outstanding_debt_amount:0,overdue_amount:"0.00",total_invoices:"0.00"}),n=`/api/customer/${t.customer_id}/debt/card`,r=async()=>{try{const i=await E.get(n);Object.assign(l,i.data.Result)}catch(i){console.log(i)}};return $e(()=>{r()}),(i,d)=>(u(),v("div",null,[c("div",Sa,[c("div",null,[a(s(le),null,{default:o(()=>[a(s(ae),null,{default:o(()=>[a(s(se),null,{default:o(()=>[p("All Time Revenue")]),_:1})]),_:1}),a(s(ne),null,{default:o(()=>[c("div",ka,[c("h1",null,"RM "+g(l.all_time_revenue),1)])]),_:1})]),_:1})]),c("div",null,[a(s(le),null,{default:o(()=>[a(s(ae),null,{default:o(()=>[a(s(se),null,{default:o(()=>[p("Outstanding Debt Amount")]),_:1})]),_:1}),a(s(ne),null,{default:o(()=>[c("div",Ca,[c("h1",null,"RM "+g(l.outstanding_debt_amount),1)])]),_:1})]),_:1})]),c("div",null,[a(s(le),null,{default:o(()=>[a(s(ae),null,{default:o(()=>[a(s(se),null,{default:o(()=>[p("Overdue Amount")]),_:1})]),_:1}),a(s(ne),null,{default:o(()=>[c("div",Va,[c("h1",null,"RM "+g(l.overdue_amount),1)])]),_:1})]),_:1})]),c("div",null,[a(s(le),null,{default:o(()=>[a(s(ae),null,{default:o(()=>[a(s(se),null,{default:o(()=>[p("Total Invoices")]),_:1})]),_:1}),a(s(ne),null,{default:o(()=>[c("div",Da,[c("h1",null,g(l.total_invoices),1)])]),_:1})]),_:1})])])]))}}),Ra={class:"p-4 bg-secondary"},Fa={class:"text-3xl font-bold tracking-tight mt-2 mb-4"},Ma={class:"flex justify-items-center place-items-center items-center"},Pa={class:"text-muted-foreground ml-2 place-self-center"},za={class:"flex justify-items-center place-items-center items-center"},Ta={class:"text-muted-foreground ml-2 place-self-center"},Aa={class:"flex justify-items-center place-items-center items-center"},ja={class:"text-muted-foreground ml-2 place-self-center"},Ua=F({__name:"CustomerDetailInfo",props:{customer_id:{}},setup(e){const t=e,l=B({name:"",whatsapp_phone_number:"",streetAddress:"",city:"",state:"",postcode:"",country_name:""}),n=`/api/customer/${t.customer_id}/`,r=async()=>{try{const d=await E.get(n);Object.assign(l,d.data.Result)}catch(d){console.log(d)}};var i=G(()=>{const h=[l.streetAddress,l.city,l.state,l.postcode].filter(f=>f);return h.length?h.join(", "):""});return $e(()=>{r()}),(d,h)=>{const f=L("VIcon");return u(),v("div",Ra,[c("h2",Fa,g(l.name),1),c("div",Ma,[a(f,{name:"fa-phone-alt",class:"w-4 h-4"}),c("p",Pa,g(l.whatsapp_phone_number.replace(/(\d{3})(\d{4})(\d{4})/,"$1 $2 $3")),1)]),c("div",za,[a(f,{name:"fa-address-book",class:"w-4 h-4"}),c("p",Ta,g(s(i)),1)]),c("div",Aa,[a(f,{name:"fa-map-pin",class:"w-4 h-4"}),c("p",ja,g(l.country_name),1)])])}}}),K=F({__name:"DataTableColumnHeader",props:{column:{},title:{}},setup(e){return(t,l)=>{const n=L("VIcon");return t.column.getCanSort()?(u(),v("div",{key:0,class:W(s(_e)("flex items-center space-x-2",t.$attrs.class??""))},[a(s(je),null,{default:o(()=>[a(s(Te),{"as-child":""},{default:o(()=>[a(s(k),{variant:"ghost",size:"sm",class:"-ml-3 h-8 data-[state=open]:bg-accent"},{default:o(()=>[c("span",null,g(t.title),1),t.column.getIsSorted()==="desc"?(u(),x(n,{key:0,name:"fa-arrow-down",class:"ml-2 h-4 w-4"})):t.column.getIsSorted()==="asc"?(u(),x(n,{key:1,name:"fa-arrow-up",class:"ml-2 h-4 w-4"})):(u(),x(n,{key:2,name:"fa-sort",class:"ml-2 h-4 w-4"}))]),_:1})]),_:1}),a(s(Ae),{align:"start"},{default:o(()=>[a(s(be),{onClick:l[0]||(l[0]=r=>t.column.toggleSorting(!1))},{default:o(()=>[a(n,{name:"fa-arrow-up",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Asc ")]),_:1}),a(s(be),{onClick:l[1]||(l[1]=r=>t.column.toggleSorting(!0))},{default:o(()=>[a(n,{name:"fa-arrow-down",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Desc ")]),_:1}),a(s(Me)),a(s(be),{onClick:l[2]||(l[2]=r=>t.column.toggleVisibility(!1))},{default:o(()=>[a(n,{name:"fa-regular-eye-slash",class:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),p(" Hide ")]),_:1})]),_:1})]),_:1})],2)):(u(),v("div",{key:1,class:W(t.$attrs.class)},g(t.title),3))}}}),Ha=T.object({id:T.number(),invoice:T.string(),invoice_date:T.preprocess(e=>typeof e=="string"?new Date(e):e,T.date()),due_date:T.preprocess(e=>typeof e=="string"?new Date(e):e,T.date()),term:T.number(),overdue:T.number(),amount:T.string(),document_url:T.string(),status:T.number(),editable:T.boolean()}),Ea={key:0,class:"grid grid-cols-4 items-center gap-x-4 text-primary"},La={class:"col-span-3"},Na=c("p",{class:"col-start-2 col-span-3 mt-1 text-sm text-gray-500 dark:text-gray-300"},[p(" Accepted Type: "),c("b",null,"PDF"),p(" (MAX. 5MB) ")],-1),Oa={key:1},Ba={class:"flex justify-center my-auto items-center place-items-center mb-2"},qa={class:"mx-2"},Ka={class:"flex justify-center my-auto items-center place-items-center"},Wa=["src"],Ya={key:0,class:"grid grid-cols-4 items-center gap-4"},Ga=F({__name:"DataTableCheckAttachment",props:{row:{}},setup(e){const t=xe("tableStore",fe("debt")),l=e,n=B({document:null,document_url:l.row.document_url}),r=B({pdf:void 0,pages:void 0,info:void 0}),i=I(1),d=I(!1),h=I(!1),f=I(null),b=I(window.innerHeight-250),{toast:w}=Se();function z(M){w({title:"PDF loading error",variant:"destructive"})}async function C(){try{d.value=!0;const M=await E.get(`/api/debt/${l.row.id}/document/`);n.document_url=M.data.Result.document_url;const m=Dt(n.document_url,{onError:z});mt(()=>{r.pdf=m.pdf,r.pages=m.pages,r.info=m.info})}catch{N(),w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}const S=()=>{const M=document.querySelector("#vp > div > div > div > canvas");if(M){const m=M.offsetHeight,_=window.innerHeight-250,$=680;_>m&&m<$?b.value=m:_>m?b.value=_:b.value=Math.min(Math.max(m,$),_)}};function V(){const M=[{condition:n.document==null,message:"Attachment cannot be blank"}];for(let m of M)if(m.condition)return f.value=m.message,!1;return!0}async function H(){if(V()){d.value=!0;try{const m=await E.patch(`/api/debt/${l.row.id}/document/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});R(),await t.refresh(t.page_index),w({title:m.data.Result,variant:"success"})}catch{w({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{d.value=!1}}}function N(){n.document_url=null}function R(){h.value=!h.value,h.value&&C()}function q(M){var _;const m=M.target;if((_=m.files)!=null&&_.length){const $=m.files[0];if($.type!=="application/pdf"){w({title:"Please select a PDF file",variant:"destructive"}),m.value="";return}if($.size>5*1024*1024){w({title:"The file size must be under 5MB",variant:"destructive"}),m.value="";return}n.document=$}}return(M,m)=>{const _=L("VIcon");return u(),v("div",null,[c("div",null,[a(s(k),{variant:"default",size:"sm",class:"h-8 flex",onClick:R},{default:o(()=>[a(_,{name:"fa-regular-file-image",class:"size-4"})]),_:1})]),a(s(Ne),{class:"my-2",open:h.value,"onUpdate:open":m[2]||(m[2]=$=>h.value=$)},{default:o(()=>[a(s(Ue),{isSideBar:!1,class:"sm:max-w-fit"},{default:o(()=>[a(s(He),null,{default:o(()=>[a(s(Ee),null,{default:o(()=>[p("Attachment Overview")]),_:1})]),_:1}),c("div",null,[n.document_url?n.document_url.endsWith(".pdf")?(u(),v("div",Oa,[c("div",Ba,[a(s(k),{variant:"secondary",onClick:m[0]||(m[0]=$=>i.value=i.value>1?i.value-1:i.value)},{default:o(()=>[a(_,{name:"fa-chevron-left",class:"size-fit"})]),_:1}),c("span",qa,g(i.value)+" / "+g(r.pages),1),a(s(k),{variant:"secondary",onClick:m[1]||(m[1]=$=>i.value=i.value<r.pages?i.value+1:i.value)},{default:o(()=>[a(_,{name:"fa-chevron-right",class:"size-fit"})]),_:1})]),a(s(Le),{class:"border border-primary md:w-[720px] w-full",style:ut([{"overflow-y":"auto","overflow-x":"hidden"},{height:b.value+"px"}])},{default:o(()=>[a(s(Vt),{pdf:r.pdf,page:i.value,"fit-parent":"",onLoaded:S,"annonation-layer":""},{default:o(()=>[c("div",Ka,[a(_,{name:"fa-circle-notch",animation:"spin",speed:"slow",class:"size-8 mr-2 my-auto"})])]),_:1},8,["pdf","page"])]),_:1},8,["style"])])):(u(),v("img",{key:2,src:n.document_url,alt:"Document preview",class:"object-contain"},null,8,Wa)):(u(),v("div",Ea,[a(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Attachment ")]),_:1}),c("div",La,[a(s(Y),{id:"name",type:"file",onChange:q,class:"col-span-3"})]),Na]))]),a(s(ee)),f.value?(u(),v("div",Ya,[a(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[a(_,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(f.value),1)]),_:1})])):A("",!0),a(s(Oe),{class:"flex justify-end"},{default:o(()=>[n.document_url?(u(),x(s(k),{key:0,class:"bg-red-600 text-white",onClick:N,disabled:d.value},{default:o(()=>[p(" Replace")]),_:1},8,["disabled"])):(u(),x(s(k),{key:1,onClick:H,disabled:d.value},{default:o(()=>[d.value?(u(),x(_,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):A("",!0),p(" Update ")]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Qa={class:"grid gap-4 py-4"},Xa={class:"grid grid-cols-4 items-center gap-4"},Za=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),Ja={class:"grid grid-cols-4 items-center gap-4"},es=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ts={class:"col-span-3"},as={class:"grid grid-cols-4 items-center gap-4"},ss=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ls={class:"grid grid-cols-4 items-center gap-4"},ns=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),os={class:"col-span-3"},is={class:"grid grid-cols-4 items-center gap-4"},rs=c("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),cs={class:"grid grid-cols-4 items-center gap-4"},ds={class:"col-span-3"},us={key:0,class:"grid grid-cols-4 items-center gap-4"},ms=F({__name:"DataTableEditModal",props:{row:{}},setup(e){const t=xe("tableStore",fe("debt")),l=e,n=B({invoice:l.row.id,customer:null,amount:l.row.amount,invoice_date:new Date(l.row.invoice_date),term:l.row.term,status:l.row.status}),r=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),i=B({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=I("");async function h(m){r.is_loading=!0;try{const _=await E.get(`/api/customer/list?search=${m||""}`,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=_.data.Result}catch(_){console.error("There was an error fetching the select list:",_)}finally{r.is_loading=!1}}async function f(){r.is_loading=!0;try{const m=await E.get("/api/debt/status/edit/list",{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});i.data=m.data.Result}catch(m){console.error("There was an error fetching the select list:",m)}finally{i.is_loading=!1}}const b=I(!1),w=I(!1),z=I(null),{toast:C}=Se();ft(d,Ct.debounce(async m=>{w.value&&await h(m)},500));async function S(){try{const m=await E.get(`/api/debt/${l.row.id}/`);Object.assign(n,m.data.Result)}catch(m){console.log(m)}finally{b.value=!1}}function V(){var _;const m=[{condition:n.invoice==null,message:"Invoice cannot be blank"},{condition:((_=n.invoice_date)==null?void 0:_.toString)==null,message:"Invoice Date cannot be blank"},{condition:n.status==null,message:"Status cannot be blank"},{condition:n.customer==null,message:"Customer cannot be blank"}];for(let $ of m)if($.condition)return z.value=$.message,!1;return!0}async function H(){if(V()){b.value=!0;try{const _=await E.patch(`/api/debt/${l.row.id}/`,{...n},{headers:{"Content-Type":"multipart/form-data"}});N(),await t.refresh(t.page_index),C({title:_.data.Result,variant:"success"})}catch{C({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{b.value=!1}}}function N(){w.value=!w.value,w.value&&(S(),h(d.value),f())}function R(m){n.customer=m.id,r.is_open=!1}function q(m){n.status=m.id,i.is_open=!1}function M(m){const _=new Date(m);n.invoice_date=Rt(_,"yyyy-MM-dd")}return(m,_)=>{const $=L("VIcon");return u(),v("div",null,[c("div",null,[a(s(k),{variant:"default",size:"sm",class:"flex h-8",onClick:N},{default:o(()=>[a($,{name:"fa-pen",class:"size-4"})]),_:1})]),a(s(Ne),{open:w.value,"onUpdate:open":_[7]||(_[7]=y=>w.value=y)},{default:o(()=>[a(s(Ue),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[a(s(He),null,{default:o(()=>[a(s(Ee),null,{default:o(()=>[p("Edit Debt")]),_:1}),a(s(_t),null,{default:o(()=>[p(" Insert the details of the debt here. Click edit when you're done. ")]),_:1})]),_:1}),c("div",Qa,[c("div",Xa,[a(s(O),{for:"invoice",class:"text-right"},{default:o(()=>[p(" Invoice "),Za]),_:1}),a(s(Y),{id:"invoice",modelValue:n.invoice,"onUpdate:modelValue":_[0]||(_[0]=y=>n.invoice=y),placeholder:"INV-001",class:"col-span-3"},null,8,["modelValue"])]),c("div",Ja,[a(s(O),{for:"customer",class:"text-right leading-normal"},{default:o(()=>[p(" Customer "),es]),_:1}),c("div",ts,[a(s(re),{open:r.is_open,"onUpdate:open":_[2]||(_[2]=y=>r.is_open=y)},{default:o(()=>[a(s(oe),{"as-child":""},{default:o(()=>[a(s(k),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:o(()=>{var y;return[p(g(n.customer?(y=r.data.find(ve=>ve.id===n.customer))==null?void 0:y.label:"Select customer")+" ",1),r.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),a(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[a(s(ye),null,{default:o(()=>[a(s(Pe),{class:"h-9",modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=y=>d.value=y),placeholder:"Search country..."},null,8,["modelValue"]),a(s(ze),null,{default:o(()=>[p("No customer found.")]),_:1}),a(s(we),null,{default:o(()=>[a(s(de),null,{default:o(()=>[(u(!0),v(P,null,U(r.data,y=>(u(),x(s(ue),{key:y.id,value:y.value??"",onSelect:()=>R(y)},{default:o(()=>[p(g(y.label)+" ",1),a($,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.customer===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),c("div",as,[a(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Amount "),ss]),_:1}),a(s(Y),{id:"amount",modelValue:n.amount===null?"":n.amount,"onUpdate:modelValue":_[3]||(_[3]=y=>n.amount=y===""?null:y),placeholder:"800.00",class:"col-span-3"},null,8,["modelValue"])]),c("div",ls,[a(s(O),{for:"email",class:"text-right"},{default:o(()=>[p(" Invoice Date "),ns]),_:1}),c("div",os,[a(s(re),null,{default:o(()=>[a(s(oe),{"as-child":""},{default:o(()=>[a(s(k),{variant:"outline",class:W(s(_e)("w-full justify-start text-left font-normal",!n.invoice_date&&"text-muted-foreground"))},{default:o(()=>[a($,{name:"bi-calendar-fill",class:"mr-2 size-4"}),c("span",null,g(n.invoice_date??"Select a date"),1)]),_:1},8,["class"])]),_:1}),a(s(ie),{class:"w-auto p-0"},{default:o(()=>[a(s(It),{"onUpdate:modelValue":_[4]||(_[4]=y=>M(y)),masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}})]),_:1})]),_:1})])]),c("div",is,[a(s(O),{for:"amount",class:"text-right"},{default:o(()=>[p(" Payment Term "),rs]),_:1}),a(s(Y),{id:"amount",modelValue:n.term,"onUpdate:modelValue":_[5]||(_[5]=y=>n.term=y),placeholder:"7",class:"col-span-3"},null,8,["modelValue"])]),c("div",cs,[a(s(O),{for:"mobile",class:"text-right"},{default:o(()=>[p(" Status ")]),_:1}),c("div",ds,[a(s(re),{open:i.is_open,"onUpdate:open":_[6]||(_[6]=y=>i.is_open=y)},{default:o(()=>[a(s(oe),{"as-child":""},{default:o(()=>[a(s(k),{variant:"outline",role:"combobox","aria-expanded":i.is_open,class:"w-full justify-between px-3",disabled:i.is_loading},{default:o(()=>{var y;return[p(g(n.status?(y=i.data.find(ve=>ve.id===n.status))==null?void 0:y.label:"Select status")+" ",1),i.is_loading?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(u(),x($,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),a(s(ie),{class:"w-[500px] p-1"},{default:o(()=>[a(s(ye),null,{default:o(()=>[a(s(we),null,{default:o(()=>[a(s(de),null,{default:o(()=>[(u(!0),v(P,null,U(i.data,y=>(u(),x(s(ue),{key:y.id,value:y.value??"",onSelect:()=>q(y)},{default:o(()=>[p(g(y.label)+" ",1),a($,{name:"fa-check",class:W(["ml-auto h-4 w-4",n.status===y.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])])]),a(ee),z.value?(u(),v("div",us,[a(s(O),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[a($,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),p(" "+g(z.value),1)]),_:1})])):A("",!0),a(s(Oe),{class:"flex justify-end"},{default:o(()=>[a(s(k),{type:"submit",onClick:H,disabled:b.value},{default:o(()=>[b.value?(u(),x($,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):A("",!0),p(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),fs={class:"pr-4"},_s={class:"flex justify-between mt-2"},ps={key:0,class:"text-primary font-bold flex place-items-center self-center"},gs={key:1,class:"text-primary font-bold"},vs={class:"text-primary"},hs={class:"text-sm"},bs={class:"text-xs mt-2"},ys=F({__name:"DataTableBacklog",props:{row:{}},setup(e){const t=pt(),l=e,n=B({debt:l.row.id,message:""}),r=B([]),i=I(!1),d=I(!1),h=I(null),{toast:f}=Se();async function b(){try{const S=await E.get(`/api/debt/${l.row.id}/backlog/`);r.splice(0,r.length,...S.data.Result),i.value=!1}catch{i.value=!1}}function w(){const S=[{condition:n.message=="",message:"Message cannot be blank"},{condition:n.message.length<5,message:"Maybe a little more context?"}];for(let V of S)if(V.condition)return h.value=V.message,!1;return!0}async function z(){if(w()){i.value=!0;try{const V=await E.post(`/api/debt/${l.row.id}/backlog/`,{...n},{headers:{"Content-Type":"application/json"}});await b(),f({title:V.data.Result,variant:"success"}),n.message="",h.value=""}catch{f({title:"Whoops, something went wrong",description:"An unexpected error occurred.",variant:"destructive"})}finally{i.value=!1}}}function C(){d.value=!d.value,d.value&&b()}return(S,V)=>{const H=L("VIcon"),N=L("Label");return u(),v("div",null,[c("div",null,[a(s(k),{variant:"secondary",size:"sm",class:"h-8 flex border border-primary",onClick:C},{default:o(()=>[a(H,{name:"bi-bookmark-plus-fill",class:"size-4"})]),_:1})]),a(s(bt),{open:d.value,"onUpdate:open":V[1]||(V[1]=R=>d.value=R)},{default:o(()=>[a(s(gt),{class:"w-[720px]",side:"right"},{default:o(()=>[a(s(vt),null,{default:o(()=>[a(s(ht),null,{default:o(()=>[p("Backlog - "+g(l.row.invoice),1)]),_:1})]),_:1}),a(s(ee),{class:"mt-2 mb-4"}),a(s(Le),{class:"h-[80vh] flex flex-col"},{default:o(()=>[c("div",fs,[(u(!0),v(P,null,U(r,(R,q)=>(u(),v("div",{key:q,class:"ml-2 pr-4"},[c("div",_s,[R.is_system_generated?(u(),v("div",ps,[a(H,{name:"bi-circle-fill",class:"size-3 my-auto fill-green-600 mr-2",animation:"pulse"}),p(" System Generated ")])):(u(),v("div",gs,g(R.created_by_name),1))]),c("div",null,[c("div",vs,g(R.created_date),1),a(s(ee),{variant:"default"}),c("div",null,g(R.message),1)])]))),128))])]),_:1}),h.value?(u(),x(N,{key:0,for:"error",class:"text-red-600 flex"},{default:o(()=>[a(H,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),c("p",hs,g(h.value),1)]),_:1})):A("",!0),a(s(Ft),{class:"mt-2 justify-between"},{default:o(()=>[a(s(Y),{id:"message",modelValue:n.message,"onUpdate:modelValue":V[0]||(V[0]=R=>n.message=R),placeholder:"Enter your message here",class:"w-full flex-1"},null,8,["modelValue"]),a(s(k),{type:"submit",onClick:z},{default:o(()=>[p(" Save ")]),_:1})]),_:1}),c("p",bs,g(s(t).getUsername),1)]),_:1})]),_:1},8,["open"])])}}}),ws={class:"flex gap-1"},xs=F({__name:"DataTableRowActions",props:{row:{}},setup(e){const t=e,l=G(()=>Ha.parse(t.row.original));return(n,r)=>(u(),v("div",ws,[l.value.editable?(u(),x(ms,{key:0,row:l.value},null,8,["row"])):A("",!0),a(Ga,{row:l.value},null,8,["row"]),a(ys,{row:l.value},null,8,["row"])]))}}),$s=[{id:"select",header:({table:e})=>D(De,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":t=>e.toggleAllPageRowsSelected(!!t),ariaLabel:"Select all",class:"translate-y-0.5"}),cell:({row:e})=>D(De,{checked:e.getIsSelected(),"onUpdate:checked":t=>e.toggleSelected(!!t),ariaLabel:"Select row",class:"translate-y-0.5"}),enableSorting:!1,enableHiding:!1,meta:{title:"Select"}},{accessorKey:"invoice",header:({column:e})=>D(K,{column:e,title:"Invoice"}),cell:({row:e})=>{const t=me.find(l=>l.value===e.original.status.toString());return t?D("div",{class:`w-20 font-bold ${t.label=="Canceled"?"line-through decoration-red-600":""}`},e.getValue("invoice")):null},enableSorting:!0,enableHiding:!0,filterFn:(e,t,l)=>{var i;const n=((i=e.getValue(t))==null?void 0:i.toString().toLowerCase())??"",r=l==null?void 0:l.toString().toLowerCase();return n.includes(r)},meta:{title:"Invoice"}},{accessorKey:"invoice_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const t=e.getValue("invoice_date");let l="";if(t){const n=new Date(Date.parse(t));isNaN(n.getTime())?l="Not Provided":l=n.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Invoice Date"}},{accessorKey:"due_date",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>{const t=e.getValue("due_date");let l="";if(t){const n=new Date(t);isNaN(n.getTime())?l="Not Provided":l=n.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}else l="Not provided";return D("div",{class:`w-fit ${l!=="Not Provided"?"":"text-red-600 font-bold"}`},l)},enableSorting:!0,enableHiding:!0,meta:{title:"Due Date"}},{accessorKey:"overdue",header:({column:e})=>D(K,{column:e,title:"Overdue"}),cell:({row:e})=>{const t=e.getValue("overdue");let l;return t==1?l="1 day":t>0?l=`${t} day(s)`:t===0?l="0 day":l="No overdue",D("div",{class:"w-fit text-red-600 font-bold"},l)},enableHiding:!0,meta:{title:"Overdue"}},{accessorKey:"amount",header:({column:e})=>D(K,{column:e,title:e.columnDef.meta.title}),cell:({row:e})=>D(Z,{variant:"destructive"},"RM "+e.getValue("amount")),enableSorting:!0,enableHiding:!0,meta:{title:"Amount"}},{accessorKey:"document_url",header:({column:e})=>D(K,{column:e,title:"Attachment"}),cell:({row:e})=>{const t=e.getValue("document_url")!=null?{icon:"bi-check",iconClass:"bg-green-600"}:{icon:"bi-x",iconClass:"bg-red-600"};return D(Ie,{name:t.icon,class:`${t.iconClass} mr-1 h-8 w-8 rounded-full fill-white`})},enableSorting:!0,enableHiding:!0,meta:{title:"Attachment"}},{accessorKey:"status",header:({column:e})=>D(K,{column:e,title:"Status"}),cell:({row:e})=>{const t=me.find(l=>l.value===e.original.status.toString());return t?D(Z,{variant:"secondary",class:"inline items-center whitespace-nowrap"},[t.icon&&D(Ie,{name:t.icon,class:"mr-1 h-4 w-4 text-muted-foreground"}),D("span",{},t.label)]):null},enableSorting:!0,enableHiding:!0,filterFn:(e,t,l)=>{const n=e.getValue(t);if(!n)return!1;const r=n.toString().toLowerCase();return l.some(d=>r.includes(d.toLowerCase()))},meta:{title:"Status"}},{id:"actions",cell:({row:e})=>D(xs,{row:e})}],Ss={class:"md:hidden"},ks={class:"block h-full flex-1 flex-col space-y-8 p-4 md:p-8 md:flex"},Cs=c("div",{class:"mb-4"},[c("h2",{class:"text-2xl font-bold tracking-tight"},"Statement")],-1),Ls=F({__name:"CustomerDetail",setup(e){const l=wt().params.customer_id,n=fe("debt"),r=`/api/customer/${l}/debt`,i=d=>({id:d.id,status:d.status,invoice:d.invoice,invoice_date:new Date(d.invoice_date),due_date:new Date(d.due_date),overdue:d.overdue,amount:d.amount,term:d.term,document_url:d.document_url,editable:d.editable});return $e(async()=>{await n.fetch(r,0,i)}),xt("tableStore",n),yt(()=>{n.$reset()}),(d,h)=>{const f=L("VPImage");return u(),v(P,null,[c("div",Ss,[a(f,{alt:"Tasks",width:"1280",height:"1214",class:"block",image:{dark:"/examples/tasks-dark.png",light:"/examples/tasks-light.png"}})]),c("div",ks,[a(Ua,{customer_id:s(l)},null,8,["customer_id"]),a(Ia,{customer_id:s(l)},null,8,["customer_id"]),c("div",null,[Cs,a($a,{data:s(n).tasks,columns:s($s)},null,8,["data","columns"])])])],64)}}});export{Ls as default};
