import{e as D,ao as C,i as w,ap as Y,a0 as P,r as j,o as p,c as y,d as l,a as e,k as o,u as a,aq as $,b as i,s as g,as as q,at as G,au as Q,_ as f,O as I,G as M,t as x,l as v,N as E,H,I as J,K,J as Z,L as ee,F as ae,D as te,E as N,n as B,g as se,m as X,av as ne,M as oe,v as le,x as ie,y as re}from"../main.js";import{_ as T,u as de}from"./Checkbox.vue_vue_type_script_setup_true_lang-Di5NrHb0.js";import{_ as ce}from"./lodash-BtnTHUG3.js";import{_ as ue}from"./pdf-w6A7GF9I.js";import{_ as _e}from"./DialogScrollContent.vue_vue_type_script_setup_true_lang-ao_tKgWI.js";import{_ as pe}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUbi7heN.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-BaBacWsD.js";import{_ as me}from"./Textarea.vue_vue_type_script_setup_true_lang-qr6l5tRX.js";import{f as fe}from"./index-Bo0Z6eNZ.js";const he={class:"grid gap-4 py-4"},ge={class:"grid grid-cols-4 items-center gap-4"},ve=l("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),ye={class:"grid grid-cols-4 items-center gap-4"},be=l("span",{class:"absolute translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 text-red-500 rounded-full"},"*",-1),we={class:"col-span-3"},xe={class:"grid grid-cols-4 items-center gap-4"},$e={class:"grid grid-cols-4 items-center gap-4"},Ve={class:"grid grid-cols-4 items-center gap-4"},ke={class:"grid grid-cols-4 items-center gap-4"},Ce={class:"grid grid-cols-4 items-center gap-4"},Xe={class:"grid grid-cols-4 items-center gap-4"},De={class:"col-span-3"},Se={key:0,class:"grid grid-cols-4 items-center gap-4"},Ue=D({__name:"EditCompanyModal",setup(S){const t=C({name:"",country:0,whatsapp_business_account_id:"",whatsapp_phone_number_id:"",notes:"",is_active:!1,is_onboarded:!1,date_live:null}),r=C({is_loading:!1,is_open:!1,data:[{value:"",label:""}]}),d=w("");async function m(c,n){r.is_loading=!0;try{var u=`http://127.0.0.1:8000/api/country/list?search=${c}`;n&&(u+=`&current_country=${n}`);const s=await $.get(u,{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});r.data=s.data.Result}catch(s){console.error("There was an error fetching the select list:",s)}finally{r.is_loading=!1}}const h=w(!1),_=w(!1),b=w(null),{toast:V}=Y();P(d,ce.debounce(async c=>{r.is_open&&await m(c,t.country)},500));async function W(){try{const c=await $.get("http://127.0.0.1:8000/api/company/setup/");Object.assign(t,c.data.Result),t.country&&await m("",t.country)}catch{_.value=!1,V({title:"Whoops, something went wrong",description:"An unexpected error occurred",variant:"destructive"})}finally{h.value=!1}}function z(){var n;const c=[{condition:t.name==null||t.name=="",message:"Company name cannot be blank"},{condition:((n=t.country)==null?void 0:n.toString)==null,message:"Country cannot be blank"}];for(let u of c)if(u.condition)return b.value=u.message,!1;return!0}async function A(){if(z()){h.value=!0;try{const n=await $.patch("http://127.0.0.1:8000/api/company/setup/",{...t},{headers:{"Content-Type":"application/json"}});U(),b.value="",V({title:n.data.Result,variant:"success"})}catch{V({title:"Whoops, something went wrong",description:"An unexpected error occurred",variant:"destructive"})}finally{h.value=!1}}}function U(){_.value=!_.value,_.value&&(W(),m(d.value))}function L(c){t.country=c.id,r.is_open=!1}function R(c){const n=new Date(c);t.date_live=fe(n,"yyyy-MM-dd")}function F(c){d.value=c.target.value}return(c,n)=>{const u=j("VIcon");return p(),y("div",null,[l("div",null,[e(a(g),{variant:"default",size:"sm",class:"p-2 px-3",onClick:U},{default:o(()=>[i(" Edit Company ")]),_:1})]),e(a(ne),{open:_.value,"onUpdate:open":n[10]||(n[10]=s=>_.value=s)},{default:o(()=>[e(a(_e),{isSideBar:!1,class:"sm:max-w-[700px]"},{default:o(()=>[e(a(q),null,{default:o(()=>[e(a(G),null,{default:o(()=>[i("Edit Company")]),_:1}),e(a(Q),null,{default:o(()=>[i(" Insert the details of the company here. Click edit when you're done. ")]),_:1})]),_:1}),l("div",he,[l("div",ge,[e(a(f),{for:"company_name",class:"text-right"},{default:o(()=>[i(" Company Name "),ve]),_:1}),e(a(k),{id:"company_name",modelValue:t.name,"onUpdate:modelValue":n[0]||(n[0]=s=>t.name=s),placeholder:"George Sdn Bhd",class:"col-span-3"},null,8,["modelValue"])]),l("div",ye,[e(a(f),{for:"country",class:"text-right leading-normal"},{default:o(()=>[i(" Country "),be]),_:1}),l("div",we,[e(a(I),{open:r.is_open,"onUpdate:open":n[2]||(n[2]=s=>r.is_open=s)},{default:o(()=>[e(a(M),{"as-child":""},{default:o(()=>[e(a(g),{variant:"outline",role:"combobox","aria-expanded":r.is_open,class:"w-full justify-between px-3",disabled:r.is_loading},{default:o(()=>{var s;return[i(x(t.country?(s=r.data.find(O=>O.id===t.country))==null?void 0:s.label:"Select Country")+" ",1),r.is_loading?(p(),v(u,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):(p(),v(u,{key:1,name:"fa-angle-down",class:"h-4 w-4 shrink-0 opacity-50"}))]}),_:1},8,["aria-expanded","disabled"])]),_:1}),e(a(E),{class:"w-[500px] p-1"},{default:o(()=>[e(a(H),null,{default:o(()=>[e(a(J),{class:"h-9",modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=s=>d.value=s),placeholder:"Search country...",onInput:F},null,8,["modelValue"]),e(a(K),null,{default:o(()=>[i("No country found.")]),_:1}),e(a(Z),null,{default:o(()=>[e(a(ee),null,{default:o(()=>[(p(!0),y(ae,null,te(r.data,s=>(p(),v(a(oe),{key:s.id,value:s.value??"",onSelect:()=>L(s)},{default:o(()=>[i(x(s.label)+" ",1),e(u,{name:"fa-check",class:B(["ml-auto h-4 w-4",t.country===s.id?"opacity-100":"opacity-0"])},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]),e(N),l("div",xe,[e(a(f),{for:"whatsapp_business_id",class:"text-right"},{default:o(()=>[i(" Whatsapp Business ID ")]),_:1}),e(a(k),{id:"whatsapp_business_id",modelValue:t.whatsapp_business_account_id,"onUpdate:modelValue":n[3]||(n[3]=s=>t.whatsapp_business_account_id=s),placeholder:"XXXXXXXXXXXX",class:"col-span-3"},null,8,["modelValue"])]),l("div",$e,[e(a(f),{for:"whatsapp_business_id",class:"text-right"},{default:o(()=>[i(" Whatsapp Phone Number ID ")]),_:1}),e(a(k),{id:"whatsapp_phone_number_id",modelValue:t.whatsapp_phone_number_id,"onUpdate:modelValue":n[4]||(n[4]=s=>t.whatsapp_phone_number_id=s),placeholder:"XXXXXXXXXXXX",class:"col-span-3"},null,8,["modelValue"])]),e(N),l("div",Ve,[e(a(f),{for:"is_active",class:"text-right"},{default:o(()=>[i(" Notes ")]),_:1}),e(a(me),{id:"is_active",modelValue:t.notes,"onUpdate:modelValue":n[5]||(n[5]=s=>t.notes=s),placeholder:"Leave your footnote here...",class:"col-span-3"},null,8,["modelValue"])]),l("div",ke,[e(a(f),{for:"is_active",class:"text-right"},{default:o(()=>[i(" Active ")]),_:1}),e(a(T),{id:"is_active",checked:t.is_active,"onUpdate:checked":n[6]||(n[6]=s=>t.is_active=s),"update:open":"form.is_active = $event",class:"col-span-3"},null,8,["checked"])]),l("div",Ce,[e(a(f),{for:"is_onboarded",class:"text-right"},{default:o(()=>[i(" Onboarded ")]),_:1}),e(a(T),{id:"is_onboarded",checked:t.is_onboarded,"onUpdate:checked":n[7]||(n[7]=s=>t.is_onboarded=s),"update:open":"form.is_active = $event",class:"col-span-3"},null,8,["checked"])]),l("div",Xe,[e(a(f),{for:"email",class:"text-right"},{default:o(()=>[i(" Active Date ")]),_:1}),l("div",De,[e(a(I),null,{default:o(()=>[e(a(M),{"as-child":""},{default:o(()=>[e(a(g),{variant:"outline",class:B(a(se)("w-full justify-start text-left font-normal",!t.date_live&&"text-muted-foreground"))},{default:o(()=>[e(u,{name:"fa-regular-calendar-alt",class:"mr-2 h-4 w-4"}),l("span",null,x(t.date_live?t.date_live:"Pick a date"),1)]),_:1},8,["class"])]),_:1}),e(a(E),{class:"w-auto p-0"},{default:o(()=>[e(a(ue),{modelValue:t.date_live,"onUpdate:modelValue":[n[8]||(n[8]=s=>t.date_live=s),n[9]||(n[9]=s=>R(s))],masks:{L:"YYYY-MM-DD"},modelConfig:{type:"string",mask:"YYYY/MM/DD"}},null,8,["modelValue"])]),_:1})]),_:1})])])]),b.value?(p(),y("div",Se,[e(a(f),{for:"name",class:"text-red-600 col-span-3 col-start-2"},{default:o(()=>[e(u,{name:"fa-exclamation-triangle",class:"size-4 fill-red-600"}),i(" "+x(b.value),1)]),_:1})])):X("",!0),e(a(pe),{class:"flex justify-end"},{default:o(()=>[e(a(g),{type:"submit",onClick:A,disabled:h.value},{default:o(()=>[h.value?(p(),v(u,{key:0,name:"fa-circle-notch",animation:"spin",speed:"slow",class:"w-fit h-fit mr-2"})):X("",!0),i(" Edit")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ie=l("h4",{class:"text-lg font-bold py-3"},"Company",-1),Me={class:"w-full border-t-2 border-primary bg-secondary mb-5"},Ee={class:"p-2"},Ne=l("h4",{class:"text-lg font-bold py-3"},"Management",-1),Be={class:"w-full border-t-2 border-primary bg-secondary gap-4 overflow-auto"},Te={class:"pb-2 border-primary border-b"},Ye=l("td",{class:"p-2 text-sm w-1/4"},"Whatsapp Template",-1),je=l("td",{class:"font-bold text-center"},"Created",-1),We={class:"px-2"},ze={class:"px-2"},Ae=D({__name:"Import",setup(S){const t=C({is_loading:!1}),{toast:r}=Y();async function d(){t.is_loading=!0;try{const m=await $.post("http://127.0.0.1:8000/api/template");r({title:m.data.Result,variant:"success"})}catch{r({title:"Whoops, something went wrong",description:"An unexpected error occurred",variant:"destructive"})}finally{t.is_loading=!1}}return(m,h)=>{const _=j("VIcon");return p(),y("div",null,[Ie,l("table",Me,[l("tr",null,[l("td",Ee,[e(Ue)])])]),Ne,l("table",Be,[l("tr",Te,[Ye,je,l("td",We,[e(a(g),{class:"my-2",onClick:d,disabled:t.is_loading},{default:o(()=>[t.is_loading?(p(),v(_,{key:0,name:"fa-circle-notch",animation:"spin",class:"w-4 h-4 mr-2"})):X("",!0),e(_,{name:"fa-share-square",class:"h-4 w-4 shrink-0 mr-2"}),i(" Export Default Template")]),_:1},8,["disabled"])]),l("td",ze,[e(a(g),{class:"my-2"},{default:o(()=>[e(_,{name:"fa-sync",class:"h-4 w-4 shrink-0 mr-2"}),i(" Import")]),_:1})])])])])}}}),Le={class:"p-8 space-y-4 h-full"},Re=l("div",{class:"flex items-center justify-between space-y-2"},[l("div",null,[l("h2",{class:"text-2xl font-bold tracking-tight"},"Setup")])],-1),Fe=l("hr",null,null,-1),Oe="http://127.0.0.1:8000/api/debt",aa=D({__name:"Setup",setup(S){const t=de("debt"),r=d=>({id:d.id,status:d.status,invoice:d.invoice,customer_name:d.customer_name,due_date:new Date(d.due_date),amount:d.amount,document_url:d.document_url});return le(async()=>{await t.fetch(Oe,0,r)}),re("tableStore",t),ie(()=>{t.$reset()}),(d,m)=>(p(),y("div",Le,[Re,Fe,e(Ae)]))}});export{aa as default};
